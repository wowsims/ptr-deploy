import{s as e,bn as t,c as a,a0 as i,n as s,I as o,V as n,bo as r,bp as l,g as c,aa as h,y as d,bq as u,br as p,bs as m,bt as g,bu as f,bv as b,bw as y,bx as w,by as v,bz as x,bA as S,bB as _,bC as k,bD as C,bE as I,bF as E,X as T,bG as A,bH as P,bI as R,bJ as D,bK as M,bL as L,bM as N,bN as O,bO as G,bP as z,q as F,e as H,t as U,bQ as B,bR as W,bS as V,b as Y,C as q,bT as X,bU as $,bV as Z,S as K,ac as J,bW as Q,W as ee,T as te,bX as ae,u as ie,am as se,L as oe,a7 as ne,bY as re,bZ as le,ad as ce,a6 as he,f as de,d as ue,b_ as pe,b$ as me,c0 as ge,c1 as fe,c2 as be,c3 as ye,c4 as we,c5 as ve,c6 as xe,l as Se,P as _e,c7 as ke,c8 as Ce,c9 as Ie,ca as Ee,cb as Te,cc as Ae,cd as Pe,ce as Re,cf as De,cg as Me,ch as Le,ci as Ne,cj as Oe,U as Ge,p as ze,E as Fe,h as He,v as Ue,ck as Be,cl as We,cm as Ve,cn as je,co as Ye,cp as qe,cq as Xe,M as $e,cr as Ze,cs as Ke,ab as Je,ct as Qe,cu as et,cv as tt,cw as at,at as it,cx as st,cy as ot,cz as nt,cA as rt,cB as lt,cC as ct,cD as ht,cE as dt,cF as ut,cG as pt,cH as mt,cI as gt,cJ as ft,cK as bt,cL as yt,cM as wt,cN as vt,cO as xt,cP as St,cQ as _t,bd as kt,cR as Ct,b6 as It,aV as Et,aW as Tt,aQ as At,aR as Pt,aN as Rt,aJ as Dt,cS as Mt,cT as Lt,cU as Nt,aA as Ot,cV as Gt,au as zt,ak as Ft,af as Ht,cW as Ut,Z as Bt,cX as Wt,G as Vt,cY as jt,cZ as Yt,c_ as qt,c$ as Xt,d0 as $t,d1 as Zt,d2 as Kt,d3 as Jt,d4 as Qt,d5 as ea,d6 as ta,d7 as aa,d8 as ia,d9 as sa,da as oa,F as na,db as ra,dc as la,dd as ca,de as ha,df as da,dg as ua,dh as pa,di as ma,dj as ga,dk as fa,dl as ba,dm as ya,dn as wa,bf as va,dp as xa,dq as Sa,dr as _a,ds as ka,dt as Ca,du as Ia,dv as Ea,dw as Ta,dx as Aa,dy as Pa,dz as Ra,dA as Da,dB as Ma,dC as La,dD as Na,dE as Oa,dF as Ga,dG as za,dH as Fa,dI as Ha,dJ as Ua,dK as Ba,dL as Wa,dM as Va,dN as ja,dO as Ya,dP as qa,dQ as Xa,dR as $a,dS as Za,dT as Ka,dU as Ja,dV as Qa,dW as ei,dX as ti,dY as ai,dZ as ii,d_ as si,d$ as oi,e0 as ni,e1 as ri,e2 as li,e3 as ci,e4 as hi,e5 as di,e6 as ui,e7 as pi,e8 as mi,e9 as gi,ea as fi,eb as bi,ec as yi,ed as wi,ee as vi,ef as xi,eg as Si,eh as _i,ei as ki,ej as Ci,ek as Ii,el as Ei,em as Ti,en as Ai,eo as Pi,ep as Ri,eq as Di,er as Mi,es as Li,et as Ni,eu as Oi,ev as Gi,ew as zi,ex as Fi,ey as Hi,ez as Ui,eA as Bi,eB as Wi,eC as Vi,eD as ji,eE as Yi,eF as qi,eG as Xi,eH as $i,eI as Zi,eJ as Ki,eK as Ji,eL as Qi,eM as es,eN as ts,eO as as,eP as is,eQ as ss,eR as os,eS as ns,eT as rs,eU as ls,eV as cs,eW as hs,eX as ds,eY as us,eZ as ps,e_ as ms,e$ as gs,f0 as fs,f1 as bs,f2 as ys,f3 as ws,f4 as vs,f5 as xs,f6 as Ss,f7 as _s,f8 as ks,f9 as Cs,fa as Is,fb as Es,fc as Ts,fd as As,fe as Ps,ff as Rs,fg as Ds,fh as Ms,fi as Ls,fj as Ns,bk as Os,fk as Gs,fl as zs,fm as Fs,fn as Hs,fo as Us,fp as Bs,fq as Ws,fr as Vs,fs as js,ft as Ys,fu as qs,fv as Xs,fw as $s,fx as Zs,fy as Ks,fz as Js,fA as Qs,fB as eo,fC as to,fD as ao,fE as io,fF as so,bm as oo,fG as no,fH as ro,b0 as lo,bl as co,fI as ho,aK as uo,fJ as po,fK as mo,fL as go,aq as fo,fM as bo,fN as yo,fO as wo,fP as vo,fQ as xo,fR as So,fS as _o,fT as ko,fU as Co,fV as Io,fW as Eo,fX as To,fY as Ao,fZ as Po,N as Ro,f_ as Do,a4 as Mo,a1 as Lo,a3 as No,a2 as Oo,$ as Go,f$ as zo,g0 as Fo,ba as Ho,Y as Uo,D as Bo,g1 as Wo,g2 as Vo,g3 as jo,g4 as Yo,g5 as qo,g6 as Xo,g7 as $o,g8 as Zo,g9 as Ko,ga as Jo,gb as Qo,Q as en,gc as tn,a as an,gd as sn,ge as on,gf as nn,gg as rn,gh as ln,gi as cn,z as hn,gj as dn,j as un,w as pn,gk as mn,gl as gn,gm as fn,gn as bn,go as yn,gp as wn,gq as vn,gr as xn,gs as Sn,gt as _n,gu as kn,gv as Cn,gw as In,gx as En,gy as Tn,gz as An,O as Pn,gA as Rn,gB as Dn,gC as Mn,gD as Ln,gE as Nn,gF as On,gG as Gn,b2 as zn,gH as Fn,gI as Hn,gJ as Un,gK as Bn,gL as Wn,gM as Vn,gN as jn,gO as Yn,gP as qn,gQ as Xn,gR as $n,k as Zn,gS as Kn,r as Jn,b1 as Qn,o as er,gT as tr,x as ar,gU as ir,gV as sr,gW as or}from"./localization-efQrTVzH.chunk.js";e(t).filter(e=>e!=t.GemColorUnknown),t.GemColorRed,t.GemColorYellow,t.GemColorBlue,t.GemColorGreen,t.GemColorPurple,t.GemColorOrange;const nr=new Map;function rr(e,t){return function(e,t){return e==t||nr.has(t)&&nr.get(t).includes(e)}(e.color,t)}function lr(e,a){switch(a){case t.GemColorMeta:return e.color==t.GemColorMeta;case t.GemColorCogwheel:return e.color==t.GemColorCogwheel;case t.GemColorShaTouched:return e.color==t.GemColorShaTouched;default:return e.color!=t.GemColorMeta&&e.color!=t.GemColorCogwheel&&e.color!=t.GemColorShaTouched}}function cr(e,t){return!e.unique&&e.requiredProfession==a.ProfessionUnknown&&(null==t||e.phase<=t)}function hr(e,t){return e.stats.some((e,a)=>e>0&&t.includes(a))}nr.set(t.GemColorMeta,[t.GemColorMeta]),nr.set(t.GemColorBlue,[t.GemColorBlue,t.GemColorPurple,t.GemColorGreen,t.GemColorPrismatic]),nr.set(t.GemColorRed,[t.GemColorRed,t.GemColorPurple,t.GemColorOrange,t.GemColorPrismatic]),nr.set(t.GemColorYellow,[t.GemColorYellow,t.GemColorOrange,t.GemColorGreen,t.GemColorPrismatic]),nr.set(t.GemColorPrismatic,[t.GemColorRed,t.GemColorOrange,t.GemColorYellow,t.GemColorGreen,t.GemColorBlue,t.GemColorPurple,t.GemColorPrismatic]),nr.set(t.GemColorCogwheel,[t.GemColorCogwheel]),nr.set(t.GemColorShaTouched,[t.GemColorShaTouched]);class dr{constructor(e,t,a,i,s,o,n){this.id=e,this.description=t,this.minRed=a,this.minYellow=i,this.minBlue=s,this.compareColorGreater=o,this.compareColorLesser=n,ur.set(this.id,this)}isMet(e,a,i){if(!(e>=this.minRed&&a>=this.minYellow&&i>=this.minBlue))return!1;if(this.compareColorGreater==t.GemColorUnknown)return!0;return dr.getNumInCategory(this.compareColorGreater,e,a,i)>dr.getNumInCategory(this.compareColorLesser,e,a,i)}isCompareColorCondition(){return 0==this.minRed&&0==this.minYellow&&0==this.minBlue}isOneOfEach(){return 1==this.minRed&&1==this.minYellow&&1==this.minBlue}isTwoAndOne(){return[this.minRed,this.minYellow,this.minBlue].includes(2)}isThreeOfAColor(){return 3==this.minRed||3==this.minYellow||3==this.minBlue}static getNumInCategory(e,a,i,s){if(e==t.GemColorRed)return a;if(e==t.GemColorYellow)return i;if(e==t.GemColorBlue)return s;throw new Error("Invalid gem color for category check: "+e)}static fromMinColors(e,a,i,s,o){return new dr(e,a,i,s,o,t.GemColorUnknown,t.GemColorUnknown)}static fromCompareColors(e,t,a,i){return new dr(e,t,0,0,0,a,i)}}const ur=new Map;function pr(e){return ur.get(e)}function mr(e){return pr(e.id)?.description??""}dr.fromMinColors(52289,"Requires at least 2 Yellow Gems.",0,2,0),dr.fromMinColors(52291,"Requires at least 3 Red Gems.",3,0,0),dr.fromMinColors(52292,"Requires at least 1 Blue Gem and 1 Yellow Gem.",0,1,1),dr.fromMinColors(52293,"Requires at least 3 Blue Gems.",0,0,3),dr.fromMinColors(52294,"Requries at least 2 Yellow Gems.",0,2,0),dr.fromMinColors(52295,"Requires at least 1 Red Gem and 1 Yellow Gem.",1,1,0),dr.fromMinColors(52296,"Requires at least 2 Yellow Gems.",0,2,0),dr.fromMinColors(52297,"Requires at least 1 Blue Gem and 1 Yellow Gem.",0,1,1),dr.fromMinColors(52298,"Requires at least 2 Red Gems.",2,0,0),dr.fromMinColors(52299,"Requires at least 2 Blue Gems.",0,0,2),dr.fromMinColors(52300,"Requires at least 1 Blue Gem and 1 Yellow Gem.",0,1,1),dr.fromMinColors(52301,"Requires at least 1 Blue Gem and 1 Yellow Gem.",0,1,1),dr.fromMinColors(52302,"Requires at least 1 Blue Gem and 1 Yellwo Gem.",0,1,1),dr.fromMinColors(68778,"Requires at least 3 Red Gems.",3,0,0),dr.fromMinColors(68779,"Requires at least 3 Red Gems.",3,0,0),dr.fromMinColors(68780,"Requires at least 3 Red Gems.",3,0,0),dr.fromMinColors(41285,"Requires at least 3 Red Gems.",3,0,0),dr.fromMinColors(41307,"Requires at least 1 Red Gem, at least 1 Yellow Gem, and at least 1 Blue Gem.",1,1,1),dr.fromMinColors(41333,"Requires at least 3 Red Gems.",3,0,0),dr.fromMinColors(41335,"Requires at least 2 Red Gems and at least 1 Yellow Gem.",2,1,0),dr.fromMinColors(41377,"Requires at least 2 Blue Gems and at least 1 Red Gem.",1,0,2),dr.fromMinColors(41339,"Requires at least 2 Yellow Gems and at least 1 Red Gem.",1,2,0),dr.fromMinColors(41375,"Requires at least 1 Red Gem, at least 1 Yellow Gem, and at least 1 Blue Gem.",1,1,1),dr.fromMinColors(41376,"Requires at least 2 Red Gems.",2,0,0),dr.fromMinColors(41378,"Requires at least 2 Yellow Gems and at least 1 Blue Gem.",0,2,1),dr.fromMinColors(41379,"Requires at least 2 Red Gems and at least 1 Blue Gem.",2,0,1),dr.fromMinColors(41380,"Requires at least 2 Blue Gems and at least 1 Red Gem.",1,0,2),dr.fromMinColors(41381,"Requires at least 2 Yellow Gems and at least 1 Blue Gem.",0,2,1),dr.fromMinColors(41382,"Requires at least 1 Red Gem, at least 1 Yellow Gem, and at least 1 Blue Gem.",1,1,1),dr.fromMinColors(41385,"Requires at least 2 Blue Gems and at least 1 Red Gem.",1,0,2),dr.fromMinColors(41389,"Requires at least 2 Red Gems and at least 1 Yellow Gem.",2,1,0),dr.fromMinColors(41395,"Requires at least 2 Red Gems and at least 1 Blue Gem.",2,0,1),dr.fromMinColors(41396,"Requires at least 2 Red Gems and at least 1 Blue Gem.",2,0,1),dr.fromMinColors(41397,"Requires at least 3 Blue Gems.",0,0,3),dr.fromMinColors(41398,"Requires at least 3 Red Gems.",3,0,0),dr.fromMinColors(41400,"Requires at least 1 Red Gem, at least 1 Yellow Gem, and at least 1 Blue Gem.",1,1,1),dr.fromMinColors(41401,"Requires at least 1 Red Gem, at least 1 Yellow Gem, and at least 1 Blue Gem.",1,1,1),dr.fromMinColors(44076,"Requires at least 2 Yellow Gems and at least 1 Red Gem.",1,2,0),dr.fromMinColors(44078,"Requires at least 1 Red Gem, at least 1 Yellow Gem, and at least 1 Blue Gem.",1,1,1),dr.fromMinColors(44081,"Requires at least 2 Red Gems and at least 1 Blue Gem.",2,0,1),dr.fromMinColors(44082,"Requires at least 2 Blue Gems and at least 1 Red Gem.",1,0,2),dr.fromMinColors(44084,"Requires at least 2 Yellow Gems and at least 1 Blue Gem.",0,2,1),dr.fromMinColors(44087,"Requires at least 3 Blue Gems.",0,0,3),dr.fromMinColors(44088,"Requires at least 2 Blue Gems and at least 1 Yellow Gem.",0,1,2),dr.fromMinColors(44089,"Requires at least 1 Red Gem, at least 1 Yellow Gem, and at least 1 Blue Gem.",1,1,1),dr.fromMinColors(25899,"Requires at least 2 Red Gems, at least 2 Yellow Gems, and at least 2 Blue Gems.",2,2,2),dr.fromMinColors(34220,"Requires at least 2 Blue Gems.",0,0,2),dr.fromMinColors(25890,"Requires at least 2 Red Gems, at least 2 Yellow Gems, and at least 2 Blue Gems.",2,2,2),dr.fromMinColors(35503,"Requires at least 3 Red Gems.",3,0,0),dr.fromMinColors(35501,"Requires at least 2 Blue Gems and at least 1 Yellow Gem.",0,1,2),dr.fromMinColors(32641,"Requires at least 3 Yellow Gems.",0,3,0),dr.fromMinColors(25901,"Requires at least 2 Red Gems, at least 2 Yellow Gems, and at least 2 Blue Gems.",2,2,2),dr.fromMinColors(25896,"Requires at least 3 Blue Gems.",0,0,3),dr.fromMinColors(32409,"Requires at least 2 Red Gems, at least 2 Yellow Gems, and at least 2 Blue Gems.",2,2,2),dr.fromMinColors(25894,"Requires at least 2 Yellow Gems and at least 1 Red Gem.",1,2,0),dr.fromMinColors(28557,"Requires at least 2 Yellow Gems and at least 1 Red Gem.",1,2,0),dr.fromMinColors(28556,"Requires at least 2 Yellow Gems and at least 1 Red Gem.",1,2,0),dr.fromMinColors(25898,"Requires at least 5 Blue Gems.",0,0,5),dr.fromMinColors(32410,"Requires at least 2 Red Gems, at least 2 Yellow Gems, and at least 2 Blue Gems.",2,2,2),dr.fromCompareColors(25897,"Requires more Red Gems than Blue Gems.",t.GemColorRed,t.GemColorBlue),dr.fromCompareColors(25895,"Requires more Red Gems than Yellow Gems.",t.GemColorRed,t.GemColorYellow),dr.fromCompareColors(25893,"Requires more Blue Gems than Yellow Gems.",t.GemColorBlue,t.GemColorYellow),dr.fromCompareColors(32640,"Requires more Blue Gems than Yellow Gems.",t.GemColorBlue,t.GemColorYellow);const gr={[t.GemColorBlue]:"https://wow.zamimg.com/images/icons/socket-blue.gif",[t.GemColorMeta]:"https://wow.zamimg.com/images/icons/socket-meta.gif",[t.GemColorRed]:"https://wow.zamimg.com/images/icons/socket-red.gif",[t.GemColorYellow]:"https://wow.zamimg.com/images/icons/socket-yellow.gif",[t.GemColorPrismatic]:"https://wow.zamimg.com/images/icons/socket-prismatic.gif",[t.GemColorCogwheel]:"https://wow.zamimg.com/images/icons/socket-cogwheel.gif",[t.GemColorShaTouched]:"https://wow.zamimg.com/images/icons/socket-hydraulic.gif"};function fr(e){if(gr[e])return gr[e];throw new Error("No empty socket url for gem socket color: "+e)}class br{constructor(e){this.getItemSlots().forEach(t=>{e[t]||(e[t]=null)}),this.gear=e}equals(e){const t=e.asArray();return this.asArray().every((e,a)=>u(e,t[a],(e,t)=>e.equals(t)))}getEquippedItem(e){return this.gear[e]||null}getEquippedItems(){return Object.values(this.gear)}asArray(){return Object.values(this.gear)}asMap(){const e={};return this.getItemSlots().map(e=>Number(e)).forEach(t=>{e[t]=this.getEquippedItem(t)}),e}getTrinkets(){return[this.getEquippedItem(i.ItemSlotTrinket1),this.getEquippedItem(i.ItemSlotTrinket2)]}hasTrinket(e){return this.getTrinkets().map(e=>e?.item.id).includes(e)}hasTrinketFromOptions(e){return this.getTrinkets().filter(e=>!!e).map(e=>e.item.id).some(t=>e.includes(t))}withEquippedItemInternal(e,t,a){const i=this.asMap();return t&&(this.removeUniqueGems(i,t),this.removeUniqueItems(i,t)),i[e]=t,br.validateWeaponCombo(i,e,a),i}removeUniqueGems(e,t){t.gems.filter(e=>e?.unique).forEach(t=>{this.getItemSlots().map(e=>Number(e)).forEach(a=>{e[a]=e[a]?.removeGemsWithId(t.id)||null})})}removeUniqueItems(e,t){(t.item.unique||t.item.limitCategory)&&this.getItemSlots().map(e=>Number(e)).forEach(a=>{(t.item.limitCategory&&e[a]?.item.limitCategory==t.item.limitCategory||t.item.unique&&e[a]?.item.id==t.item.id)&&(e[a]=null)})}static validateWeaponCombo(e,t,a){p(e[i.ItemSlotMainHand]?.item,e[i.ItemSlotOffHand]?.item,a)||(t==i.ItemSlotOffHand?(a||e[i.ItemSlotOffHand]?.item.handType!=h.HandTypeTwoHand||(e[i.ItemSlotOffHand]=null),e[i.ItemSlotMainHand]=null):e[i.ItemSlotOffHand]=null)}toDatabase(e){const t=this.asArray().filter(e=>null!=e),a={items:c(t.map(e=>br.itemToDB(e.item))),randomSuffixes:c(t.filter(e=>e.randomSuffix).map(e=>e.randomSuffix)),reforgeStats:c(t.filter(e=>e.reforge).map(t=>e.getReforgeById(t.reforge.id)??{})),itemEffectRandPropPoints:c(t.flatMap(t=>e.getItemEffectRandPropPoints(t.ilvl)).filter(e=>!!e)),enchants:c(t.flatMap(e=>{const t=[];return e.enchant&&t.push(br.enchantToDB(e.enchant)),e.tinker&&t.push(br.enchantToDB(e.tinker)),t})),gems:c(t.map(e=>e._gems.filter(e=>null!=e).map(e=>br.gemToDB(e))).flat())};return m.create(a)}static itemToDB(e){return g.fromJson(f.toJson(e),{ignoreUnknownFields:!0})}static enchantToDB(e){return b.fromJson(y.toJson(e),{ignoreUnknownFields:!0})}static gemToDB(e){return w.fromJson(v.toJson(e),{ignoreUnknownFields:!0})}}class yr extends br{constructor(e){super(e)}getItemSlots(){return e(i)}withEquippedItem(e,t,a){return new yr(this.withEquippedItemInternal(e,t,a))}asSpec(){return s.create({items:this.asArray().map(e=>e?e.asSpec():o.create())})}getAllGems(e){return this.asArray().map(t=>null==t?[]:t.curEquippedGems(e)).flat()}getNonMetaGems(e){return this.getAllGems(e).filter(e=>e.color!=t.GemColorMeta)}statsFromGems(e){let t=new n;const a=this.getAllGems(e);for(let s=0;s<a.length;s++)t=t.add(new n(a[s].stats));const i=this.asArray().filter(e=>null!=e);for(let s=0;s<i.length;s++)t=t.add(i[s].socketBonusStats());return t}getGemsOfColor(e,t){return this.getAllGems(t).filter(t=>t.color==e)}getJCGems(e){return this.getAllGems(e).filter(e=>e.requiredProfession==a.Jewelcrafting)}getMetaGem(){return this.getGemsOfColor(t.GemColorMeta,!0)[0]||null}gemColorCounts(e){const a=this.getAllGems(e);return{red:a.filter(e=>rr(e,t.GemColorRed)).length,yellow:a.filter(e=>rr(e,t.GemColorYellow)).length,blue:a.filter(e=>rr(e,t.GemColorBlue)).length}}withChallengeMode(e){let t=this;for(const a of this.getItemSlots()){const i=this.getEquippedItem(a);i&&(t=t.withEquippedItem(a,i.withChallengeMode(e),!0))}return t}hasActiveMetaGem(e){const t=this.getMetaGem();if(!t)return!1;const a=this.gemColorCounts(e);return function(e,t,a,i){return pr(e.id)?.isMet(t,a,i)??!0}(t,a.red,a.yellow,a.blue)}hasInactiveMetaGem(e){return null!=this.getMetaGem()&&!this.hasActiveMetaGem(e)}withGem(e,t,a){const i=this.getEquippedItem(e);return i?this.withEquippedItem(e,i.withGem(a,t),!0):this}withSingleGemSubstitution(e,t,a){for(const i of this.getItemSlots()){const s=this.getEquippedItem(i);if(!s)continue;const o=s.curGems(a);if(o.includes(e)){const a=o.indexOf(e);return this.withGem(i,a,t)}}return this}findGem(e,t){const a=[];for(const i of this.getItemSlots()){const s=this.getEquippedItem(i);if(s)for(const[o,n]of s.curGems(t).entries())n?.id===e.id&&a.push([i,o])}return a}withMetaGem(e){const a=this.getEquippedItem(i.ItemSlotHead);if(a)for(const[s,o]of a.allSocketColors().entries())if(o==t.GemColorMeta)return this.withEquippedItem(i.ItemSlotHead,a.withGem(e,s),!0);return this}withoutMetaGem(){const e=this.getEquippedItem(i.ItemSlotHead),t=this.getMetaGem();return e&&t?this.withEquippedItem(i.ItemSlotHead,e.removeGemsWithId(t.id),!0):this}withoutGems(e,t,a){let i=this;const s=this.getMetaGem();for(const o of this.getItemSlots()){const a=this.getEquippedItem(o);a&&!t?.has(o)&&(i=i.withEquippedItem(o,a.removeAllGems(),e))}return a?i.withMetaGem(s):i}withoutReforges(e,t){let a=this;for(const i of this.getItemSlots()){const s=this.getEquippedItem(i);s&&!t?.has(i)&&(a=a.withEquippedItem(i,s.withItem(s.item).withRandomSuffix(s._randomSuffix),e))}return a}withoutUpgrades(e){let t=this;for(const a of this.getItemSlots()){const i=this.getEquippedItem(a);i&&(t=t.withEquippedItem(a,i.withUpgrade(0),e))}return t}withoutBlacksmithSockets(){let e=this;const t=this.getEquippedItem(i.ItemSlotWrist);t&&(e=e.withEquippedItem(i.ItemSlotWrist,t.withGem(null,t.numPossibleSockets-1),!0));const a=this.getEquippedItem(i.ItemSlotHands);return a&&(e=e.withEquippedItem(i.ItemSlotHands,a.withGem(null,a.numPossibleSockets-1),!0)),e}hasBluntMHWeapon(){const e=this.getEquippedItem(i.ItemSlotMainHand);return null!=e&&r(e.item.weaponType)}hasSharpMHWeapon(){const e=this.getEquippedItem(i.ItemSlotMainHand);return null!=e&&l(e.item.weaponType)}hasBluntOHWeapon(){const e=this.getEquippedItem(i.ItemSlotOffHand);return null!=e&&r(e.item.weaponType)}hasSharpOHWeapon(){const e=this.getEquippedItem(i.ItemSlotOffHand);return null!=e&&l(e.item.weaponType)}getProfessionRequirements(){return c(this.asArray().filter(e=>null!=e).map(e=>e.getProfessionRequirements()).flat())}getFailedProfessionRequirements(e){return this.asArray().filter(e=>null!=e).map(t=>t.getFailedProfessionRequirements(e)).flat()}getItemSetCount(e,t){if(!e)return 0;const a=[i.ItemSlotHead,i.ItemSlotShoulder,i.ItemSlotChest,i.ItemSlotHands,i.ItemSlotLegs];let s=0;for(const i of a){const a=this.getEquippedItem(i);(a?.item?.setName===e||t&&a?.item.setName===t)&&s++}return s}getAllReforges(){const e=new Map;return this.getEquippedItems().forEach((t,a)=>{const i=t?.getReforgeData();i&&e.set(a,i)}),e}getAverageItemLevel(e){const t=this.getEquippedItems();let a=this.getItemSlots().length;t?.[i.ItemSlotMainHand]?.item?.handType===h.HandTypeTwoHand&&!e&&(a-=1);return d(t.filter(e=>null!=e).map(e=>e.ilvl))/a}}class wr extends br{constructor(e){super(e)}getItemSlots(){return e(i)}withEquippedItem(e,t,a){return new wr(this.withEquippedItemInternal(e,t,a))}}function vr(e){var t,a,i="";if("string"==typeof e||"number"==typeof e)i+=e;else if("object"==typeof e)if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(a=vr(e[t]))&&(i&&(i+=" "),i+=a)}else for(a in e)e[a]&&(i&&(i+=" "),i+=a);return i}function xr(){for(var e,t,a=0,i="",s=arguments.length;a<s;a++)(e=arguments[a])&&(t=vr(e))&&(i&&(i+=" "),i+=t);return i}class Sr{constructor(e={}){this.data=new Map,this.keysToKeep=e.keysToKeep}has(e){return this.data.has(e)}get(e){return this.data.get(e)}set(e,t){this.data.set(e,t),this.keysToKeep&&this.keepMostRecent()}keepMostRecent(){if(this.keysToKeep&&this.data.size>this.keysToKeep){const e=[...this.data.keys()];e.slice(0,e.length-this.keysToKeep).forEach(e=>this.data.delete(e))}}}const _r=e=>[I.ItemTypeWeapon,I.ItemTypeRanged].includes(e.type)&&![A.WeaponTypeOffHand,A.WeaponTypeShield].includes(e.weaponType)&&3==e.phase&&e.sources.some(e=>"drop"===e.source.oneofKind&&6622===e.source.drop.zoneId),kr=e=>e.gemSockets.some(e=>e===t.GemColorShaTouched),Cr=(e,t,a=x.Base)=>{let s=new n;if(e.weaponSpeed>0){const o=((e,t=x.Base)=>{const{weaponDamageMin:a,weaponDamageMax:i}=e.scalingOptions[t];return(a+i)/2/(e.weaponSpeed||1)})(e,a);t===i.ItemSlotMainHand?s=e.rangedWeaponType>E.RangedWeaponTypeUnknown?s.withPseudoStat(T.PseudoStatRangedDps,o):s.withPseudoStat(T.PseudoStatMainHandDps,o):t===i.ItemSlotOffHand&&(s=s.withPseudoStat(T.PseudoStatOffHandDps,o))}return s};class Ir{constructor({item:e,enchant:t,gems:a,randomSuffix:i,reforge:s,upgrade:o,challengeMode:n,tinker:r}){this._item=e,this._enchant=t||null,this._tinker=r||null,this._gems=a||[],this._randomSuffix=i||null,this._reforge=s||null,this._upgrade=this.hasUpgrade(o)&&o||x.Base,this._challengeMode=n??!1,this.numPossibleSockets=this.numSockets(!0),this._gems.length<this.numPossibleSockets&&(this._gems=this._gems.concat(new Array(this.numPossibleSockets-this._gems.length).fill(null)))}get item(){return f.clone(this._item)}get id(){return this._item.id}get randomSuffix(){return this._randomSuffix?S.clone(this._randomSuffix):null}get enchant(){return this._enchant?y.clone(this._enchant):null}get tinker(){return this._tinker?y.clone(this._tinker):null}get reforge(){return this._reforge?_.clone(this._reforge):null}get gems(){return this._gems.map(e=>null==e?null:v.clone(e))}get gemSockets(){return[...this._item.gemSockets]}get upgrade(){let e;return e=this._challengeMode?this._item.scalingOptions[this._upgrade].ilvl<=k?x.Base:x.ChallengeMode:this._upgrade,e}get randomPropPoints(){return this.item.scalingOptions[this.upgrade].randPropPoints||this.item.randPropPoints}get ilvl(){return this.item.scalingOptions[this.upgrade].ilvl}get ilvlFromPrevious(){return this.upgrade<1?0:this.item.scalingOptions[this.upgrade].ilvl-this.item.scalingOptions[this.upgrade-1].ilvl}get ilvlFromBase(){return this.upgrade<1?0:this.item.scalingOptions[this.upgrade].ilvl-this.item.scalingOptions[x.Base].ilvl}getReforgeData(e){if(!(e=e||this.reforge))return null;const{id:t,fromStat:a,toStat:i,multiplier:s}=e,o=this.item;return{id:t,reforge:e,item:o,fromStat:a,fromAmount:Math.ceil(-o.stats[a]*s),toStat:i,toAmount:Math.floor(o.stats[a]*s)}}getBaseScalingItemProperties(){return this._item.scalingOptions[x.Base]}getUpgrades(){const{scalingOptions:e}=this.item;return delete e[x.ChallengeMode],e}getMaxUpgradeCount(){return Object.keys(this.getUpgrades()).length-1}equals(e,t,a,i,s){if(this.id!=e.id)return!1;if(!f.equals(this._item,e.item)&&!s)return!1;if(null==this._randomSuffix!=(null==e.randomSuffix))return!1;if(this._randomSuffix&&e.randomSuffix&&!S.equals(this._randomSuffix,e.randomSuffix))return!1;if(null==this._reforge!=(null==e.reforge)&&!t)return!1;if(this._reforge&&e.reforge&&!_.equals(this._reforge,e.reforge)&&!t)return!1;if(null==this._enchant!=(null==e.enchant)&&!a)return!1;if(null==this._tinker!=(null==e.tinker)&&!a)return!1;if(this._enchant&&e.enchant&&!y.equals(this._enchant,e.enchant)&&!a)return!1;if(this._tinker&&e.tinker&&!y.equals(this._tinker,e.tinker)&&!a)return!1;if(this._gems.length!=e.gems.length&&!i)return!1;if(!i)for(let o=0;o<this._gems.length;o++){if(null==this._gems[o]!=(null==e.gems[o]))return!1;if(this._gems[o]&&e.gems[o]&&!v.equals(this._gems[o],e.gems[o]))return!1}return!(this._upgrade!==e._upgrade&&!s)&&this._challengeMode===e._challengeMode}withItem(e){let t=null,a=null;this._enchant&&C(this._enchant,e)&&(t=this._enchant),this._tinker&&C(this._tinker,e)&&(a=this._tinker);const i=new Array(e.gemSockets.length).fill(null);return this._gems.slice(0,this._item.gemSockets.length).filter(e=>null!=e).forEach(t=>{const a=e.gemSockets.findIndex((e,a)=>!i[a]&&rr(t,e)),s=e.gemSockets.findIndex((e,a)=>!i[a]&&lr(t,e));-1!=a?i[a]=t:-1!=s&&(i[s]=t)}),this.couldHaveExtraSocket()&&i.push(this._gems[this._gems.length-1]),new Ir({item:e,enchant:t,tinker:a,gems:i,upgrade:this._upgrade,challengeMode:this._challengeMode})}withEnchant(e){return new Ir({item:this._item,enchant:e,tinker:this._tinker,gems:this._gems,randomSuffix:this._randomSuffix,reforge:this._reforge,upgrade:this._upgrade,challengeMode:this._challengeMode})}withTinker(e){return new Ir({item:this._item,tinker:e,enchant:this._enchant,gems:this._gems,randomSuffix:this._randomSuffix,reforge:this._reforge,upgrade:this._upgrade,challengeMode:this._challengeMode})}withReforge(e){return new Ir({item:this._item,enchant:this._enchant,tinker:this._tinker,gems:this._gems,randomSuffix:this._randomSuffix,reforge:e,upgrade:this._upgrade,challengeMode:this._challengeMode})}withUpgrade(e){return new Ir({item:this._item,enchant:this._enchant,gems:this._gems,tinker:this._tinker,randomSuffix:this._randomSuffix,reforge:this._reforge,upgrade:e,challengeMode:this._challengeMode})}withChallengeMode(e){return new Ir({item:this._item,enchant:this._enchant,gems:this._gems,tinker:this._tinker,randomSuffix:this._randomSuffix,reforge:this._reforge,upgrade:this._upgrade,challengeMode:e})}withGemHelper(e,t){if(this._gems.length<=t)throw new Error("No gem socket with index "+t);const a=this._gems.slice();return a[t]=e,new Ir({item:this._item,enchant:this._enchant,tinker:this._tinker,gems:a,randomSuffix:this._randomSuffix,reforge:this._reforge,upgrade:this._upgrade,challengeMode:this._challengeMode})}withGem(e,t){let a=this;return e&&e.unique&&(a=a.removeGemsWithId(e.id)),a.withGemHelper(e,t)}removeGemsWithId(e){let t=this;for(let a=0;a<t._gems.length;a++)t._gems[a]?.id==e&&(t=t.withGemHelper(null,a));return t}removeAllGems(){let e=this;for(let t=0;t<e._gems.length;t++)e=e.withGemHelper(null,t);return e}withRandomSuffix(e){return new Ir({item:this._item,enchant:this._enchant,tinker:this._tinker,gems:this._gems,randomSuffix:e,reforge:this._reforge,upgrade:this._upgrade,challengeMode:this._challengeMode})}withDynamicStats(){const e=this.item,t=e.scalingOptions[this.upgrade];return e.stats=(new n).asProtoArray().map((e,a)=>t.stats[a]||0),e.weaponDamageMin=t.weaponDamageMin,e.weaponDamageMax=t.weaponDamageMax,e.randPropPoints=t.randPropPoints,this._randomSuffix&&(e.stats=e.stats.map((t,a)=>this._randomSuffix.stats[a]>0?Math.floor(this._randomSuffix.stats[a]*e.randPropPoints/1e4):t)),new Ir({item:e,enchant:this._enchant,tinker:this._tinker,gems:this._gems,randomSuffix:this._randomSuffix,reforge:this._reforge,upgrade:this._upgrade,challengeMode:this._challengeMode})}calcStats(e){const t=this.item;let a=new n(t.stats);return"number"==typeof e&&(a=a.add(Cr(t,e,this.upgrade))),a}asActionId(){return Lr.fromItemId(this._item.id,void 0,this._randomSuffix?.id||void 0,void 0,this.upgrade)}asSpec(){return o.create({id:this._item.id,randomSuffix:this._randomSuffix?.id,enchant:this._enchant?.effectId,tinker:this._tinker?.effectId,gems:this._gems.map(e=>e?.id||0),reforging:this._reforge?.id,upgradeStep:this._upgrade,challengeMode:this._challengeMode})}meetsSocketBonus(){return this._item.gemSockets.every((e,t)=>this._gems[t]&&rr(this._gems[t],e))}socketBonusStats(){return this.meetsSocketBonus()?new n(this._item.socketBonus):new n}couldHaveExtraSocket(){return[I.ItemTypeWrist,I.ItemTypeHands].includes(this.item.type)}requiresExtraSocket(){return this.couldHaveExtraSocket()&&this.hasExtraGem()&&null!=this._gems[this._gems.length-1]}hasExtraSocket(e){return e&&this.couldHaveExtraSocket()}numSockets(e){return this._item.gemSockets.length+(this.hasExtraSocket(e)?1:0)}numSocketsOfColor(e){let t=0;for(const a of this._item.gemSockets)a==e&&(t+=1);return t}hasRandomSuffixOptions(){return!!this._item.randomSuffixOptions.length}hasUpgradeOptions(){return!!Object.keys(this._item.scalingOptions).filter(e=>Number(e)>0).length}hasUpgrade(e){return!(!e||!this.getUpgrades()[e])}hasExtraGem(){return this._gems.length>this.item.gemSockets.length}hasSocketedGem(e){return null!=this._gems[e]}allSocketColors(){return this.couldHaveExtraSocket()?this.gemSockets.concat([t.GemColorPrismatic]):this.gemSockets}curSocketColors(e){return this.hasExtraSocket(e)?this.gemSockets.concat([t.GemColorPrismatic]):this.gemSockets}curGems(e){return this._gems.slice(0,this.numSockets(e))}curEquippedGems(e){return this.curGems(e).filter(e=>null!=e)}getProfessionRequirements(){const e=[];return this._item.requiredProfession!=a.ProfessionUnknown&&e.push(this._item.requiredProfession),null!=this._enchant&&this._enchant.requiredProfession!=a.ProfessionUnknown&&e.push(this._enchant.requiredProfession),this._gems.forEach(t=>{null!=t&&t.requiredProfession!=a.ProfessionUnknown&&e.push(t.requiredProfession)}),this.requiresExtraSocket()&&e.push(a.Blacksmithing),c(e)}getFailedProfessionRequirements(e){const t=[];return this._item.requiredProfession==a.ProfessionUnknown||e.includes(this._item.requiredProfession)||t.push(this._item),null==this._enchant||this._enchant.requiredProfession==a.ProfessionUnknown||e.includes(this._enchant.requiredProfession)||t.push(this._enchant),this._gems.forEach(i=>{null==i||i.requiredProfession==a.ProfessionUnknown||e.includes(i.requiredProfession)||t.push(i)}),t}}const Er=new Sr,Tr=class e{constructor(e){this.items=new Map,this.randomSuffixes=new Map,this.reforgeStats=new Map,this.itemEffectRandPropPoints=new Map,this.enchantsBySlot={},this.gems=new Map,this.npcs=new Map,this.zones=new Map,this.presetEncounters=new Map,this.presetTargets=new Map,this.itemIcons={},this.spellIcons={},this.glyphIds=[],this.consumables=new Map,this.spellEffects=new Map,this.loadedLeftovers=!1,this.loadProto(e)}static async get(t={}){return e.loadPromise||(e.loadPromise=(async()=>{let a;{const e=await fetch("/mop/assets/database/db.json",{signal:t?.signal}),i=await e.json();a=P.fromJson(i)}const i=new e(a);return e.instance=i,i})()),e.loadPromise}static getSync(){if(!e.instance)throw new Error("Database not yet loaded; call `await Database.get()` before using getSync()");return e.instance}static async getLeftovers(){return fetch("/mop/assets/database/leftover_db.json").then(e=>e.json()).then(e=>P.fromJson(e))}static async loadLeftoversIfNecessary(t){const a=await e.get();if(a.loadedLeftovers)return a;if(t.items.some(e=>0!=e.id&&!a.items.has(e.id))){const t=await e.getLeftovers();a.loadProto(t),a.loadedLeftovers=!0}return a}loadProto(e){e.items.forEach(e=>{const t={...e},a=e.scalingOptions[Math.max(...Object.keys(e.scalingOptions).map(Number))];t.weaponDamageMax=a.weaponDamageMax,t.weaponDamageMin=a.weaponDamageMin,t.randPropPoints=a.randPropPoints,t.ilvl=a.ilvl,t.stats=n.fromMap(a.stats).asProtoArray(),this.items.set(t.id,t)}),e.randomSuffixes.forEach(e=>this.randomSuffixes.set(e.id,e)),e.reforgeStats.forEach(e=>this.reforgeStats.set(e.id,e)),e.itemEffectRandPropPoints.forEach(e=>this.itemEffectRandPropPoints.set(e.ilvl,e)),e.enchants.forEach(e=>{R(e).forEach(t=>{this.enchantsBySlot[t]||(this.enchantsBySlot[t]=[]),this.enchantsBySlot[t].push(e)})}),e.gems.forEach(e=>this.gems.set(e.id,e)),e.npcs.forEach(e=>this.npcs.set(e.id,e)),e.zones.forEach(e=>this.zones.set(e.id,e)),e.encounters.forEach(e=>this.presetEncounters.set(e.path,e)),e.encounters.map(e=>e.targets).flat().forEach(e=>this.presetTargets.set(e.path,e)),e.items.forEach(e=>this.itemIcons[e.id]=D.create({id:e.id,name:e.name,icon:e.icon})),e.gems.forEach(e=>this.itemIcons[e.id]=D.create({id:e.id,name:e.name,icon:e.icon})),e.itemIcons.forEach(e=>this.itemIcons[e.id]=e),e.spellIcons.forEach(e=>this.spellIcons[e.id]=e),e.glyphIds.forEach(e=>this.glyphIds.push(e)),e.consumables.forEach(e=>this.consumables.set(e.id,e))}getAllItems(){return Array.from(this.items.values())}getAllItemIds(){return Array.from(this.items.keys())}getItems(e){return this.getAllItems().filter(t=>M(t).includes(e))}getItemById(e){return this.items.get(e)}getItemIdsForSet(e){return this.getAllItemIds().filter(t=>this.getItemById(t).setId===e)}getSpellEffect(e){return this.spellEffects.get(e)}getConsumables(){return Array.from(this.consumables.values())}getConsumable(e){return this.consumables.get(e)}getConsumablesByType(e){return this.getConsumables().filter(t=>t.type==e)}getConsumablesByTypeAndStats(e,t){return this.getConsumablesByType(e).filter(e=>e.buffsMainStat||t.some(t=>e.stats[t]>0))}getRandomSuffixById(e){return this.randomSuffixes.get(e)}getReforgeById(e){return this.reforgeStats.get(e)}getItemEffectRandPropPoints(e){return this.itemEffectRandPropPoints.get(e)}getAvailableReforges(e){return Array.from(this.reforgeStats.values()).filter(t=>e.stats[t.fromStat]>0&&0==e.stats[t.toStat])}getEnchants(e){return this.enchantsBySlot[e]||[]}getGems(e){if(!e)return Array.from(this.gems.values());const t=[];for(const a of this.gems.values())lr(a,e)&&t.push(a);return t}getNpc(e){return this.npcs.get(e)||null}getZone(e){return this.zones.get(e)||null}getMatchingGems(e){const t=[];for(const a of this.gems.values())rr(a,e)&&t.push(a);return t}lookupGem(e){return this.gems.get(e)||null}lookupItemSpec(e){const t=this.items.get(e.id);if(!t)return null;let a=null;if(e.enchant){const i=M(t);for(let t=0;t<i.length&&(a=(this.enchantsBySlot[i[t]]||[]).find(t=>[t.effectId,t.itemId,t.spellId].includes(e.enchant))||null,!a);t++);}let i=null;if(e.tinker){const a=M(t);for(let t=0;t<a.length&&(i=(this.enchantsBySlot[a[t]]||[]).find(t=>[t.effectId,t.itemId,t.spellId].includes(e.tinker))||null,!i);t++);}const s=e.gems.map(e=>this.lookupGem(e));let o=null;e.randomSuffix&&this.getRandomSuffixById(e.randomSuffix)&&(o=this.getRandomSuffixById(e.randomSuffix));let n=null;return e.reforging&&(n=this.getReforgeById(e.reforging)||null),new Ir({item:t,enchant:a,tinker:i,gems:s,randomSuffix:o,reforge:n,upgrade:e.upgradeStep??x.Base,challengeMode:e.challengeMode??!1})}lookupEquipmentSpec(e){const t={};return e.items.forEach(e=>{const a=this.lookupItemSpec(e);if(!a)return;const i=M(a.item).find(e=>!t[e]);if(null==i)throw new Error("No slots left to equip "+f.toJsonString(a.item));t[i]=a}),new yr(t)}lookupItemSwap(e){const t=e.items.reduce((e,t,a)=>{const i=this.lookupItemSpec(t);if(i){const t=M(i.item),s=t.some(e=>e===a)?a:t[0];"number"==typeof s&&(e[s]=i)}return e},{});return new wr(t)}enchantSpellIdToEnchant(e){return Object.values(this.enchantsBySlot).flat().find(t=>t.spellId==e)}glyphItemToSpellId(e){return this.glyphIds.find(t=>t.itemId==e)?.spellId||0}glyphSpellToItemId(e){return this.glyphIds.find(t=>t.spellId==e)?.itemId||0}getPresetEncounter(e){return this.presetEncounters.get(e)||null}getPresetTarget(e){return this.presetTargets.get(e)||null}getAllPresetEncounters(){return Array.from(this.presetEncounters.values())}getAllPresetTargets(){return Array.from(this.presetTargets.values())}static async getItemIconData(t,a={}){const i=await e.get({signal:a?.signal}),s=i.itemIcons[t],o=`item-${t}`;return s?.icon||(Er.has(o)||Er.set(o,e.getWowheadItemTooltipData(t,{signal:a?.signal})),i.itemIcons[t]=await Er.get(o)),i.itemIcons[t]}static async getSpellIconData(t,a={}){const i=await e.get({signal:a?.signal}),s=i.spellIcons[t],o=`spell-${t}`;return s?.icon||(Er.has(o)||Er.set(o,e.getWowheadSpellTooltipData(t,{signal:a?.signal})),i.spellIcons[t]=await Er.get(o)),i.spellIcons[t]}static async getWowheadItemTooltipData(t,a={}){return e.getWowheadTooltipData(t,"item",{signal:a?.signal})}static async getWowheadSpellTooltipData(t,a={}){return e.getWowheadTooltipData(t,"spell",{signal:a?.signal})}static async getWowheadTooltipData(e,t,a={}){const i=`https://nether.wowhead.com/mop-classic/tooltip/${t}/${e}?lvl=${L}&dataEnv=${Pr}`;try{const t=await fetch(i,{signal:a?.signal}),s=await t.json();return D.create({id:e,name:s.name,icon:s.icon,hasBuff:""!==s.buff})}catch(s){return s instanceof DOMException&&"AbortError"===s.name||console.error("Error while fetching url: "+i+"\n\n"+s),D.create()}}static mergeSimDatabases(e,t){return m.create({items:c(e.items.concat(t.items),(e,t)=>e.id==t.id),randomSuffixes:c(e.randomSuffixes.concat(t.randomSuffixes),(e,t)=>e.id==t.id),reforgeStats:c(e.reforgeStats.concat(t.reforgeStats),(e,t)=>e.id==t.id),itemEffectRandPropPoints:c(e.itemEffectRandPropPoints.concat(t.itemEffectRandPropPoints),(e,t)=>e.ilvl==t.ilvl),enchants:c(e.enchants.concat(t.enchants),(e,t)=>e.effectId==t.effectId),gems:c(e.gems.concat(t.gems),(e,t)=>e.id==t.id),spellEffects:c(e.spellEffects.concat(t.spellEffects),(e,t)=>e.id==t.id),consumables:c(e.consumables.concat(t.consumables),(e,t)=>e.id==t.id)})}};Tr.loadPromise=null,Tr.instance=null;let Ar=Tr;const Pr=15,Rr=async e=>{const t=N(),a=new URLSearchParams,i=t&&"en"!=t?t+".":"";if(a.set("domain",`${i}mop-classic`),a.set("dataEnv",String(Pr)),a.set("lvl",String(e.level||L)),"spellId"in e&&(e.spellId&&a.set("spell",String(e.spellId)),e.useBuffAura)){(await Ar.getSpellIconData(e.spellId)).hasBuff&&a.set("buff","1")}return"itemId"in e&&(a.set("item",String(e.itemId)),e.itemLevel&&a.set("ilvl",String(e.itemLevel)),e.gemIds?.length&&a.set("gems",e.gemIds.join(":")),e.enchantIds&&a.set("ench",e.enchantIds.join(":")),e.reforgeId&&a.set("forg",String(e.reforgeId)),e.randomEnchantmentId&&a.set("rand",String(e.randomEnchantmentId)),"number"==typeof e.upgradeStep&&a.set("upgd",String(e.upgradeStep)),e.setPieceIds?.length&&a.set("pcs",e.setPieceIds.join(":")),e.hasExtraSocket&&a.set("sock",""),e.transmogId&&a.set("transmog",String(e.transmogId))),decodeURIComponent(a.toString())};function Dr(){const e=N();return"en"===e?"":`${e}/`}const Mr=class e{constructor({itemId:e,spellId:t,otherId:a,tag:i,baseName:s,name:o,iconUrl:n,randomSuffixId:r,reforgeId:l,upgradeStep:c}={}){switch(this.itemId=e??0,this.randomSuffixId=r??0,this.reforgeId=l??0,this.upgradeStep=c??0,this.spellId=t??0,this.otherId=a??O.OtherActionNone,this.tag=i??0,a){case O.OtherActionNone:break;case O.OtherActionWait:s="Wait",n="https://wow.zamimg.com/images/wow/icons/large/inv_misc_pocketwatch_01.jpg";break;case O.OtherActionManaRegen:o="Mana Tick",n=Hr[G.ResourceTypeMana],1==i?o+=" (In Combat)":2==i&&(o+=" (Out of Combat)");break;case O.OtherActionEnergyRegen:s="Energy Tick",n=Hr[G.ResourceTypeEnergy];break;case O.OtherActionFocusRegen:s="Focus Tick",n=Hr[G.ResourceTypeFocus];break;case O.OtherActionManaGain:s="Mana Gain",n=Hr[G.ResourceTypeMana];break;case O.OtherActionRageGain:s="Rage Gain",n=Hr[G.ResourceTypeRage];break;case O.OtherActionAttack:o="Attack",n="https://wow.zamimg.com/images/wow/icons/large/inv_sword_04.jpg",1==this.tag?o+=" (Main Hand)":2==this.tag?o+=" (Off Hand)":68476==this.tag?o+=" (Horridon)":69374==this.tag?o+=" (War-God Jalak)":99999==this.tag?o+=" (Boss)":99998==this.tag?(console.log(this,this.tag),o+=" (Add)"):this.tag>6445300?o+=` (Set'thik Windblade ${(this.tag-6445300).toFixed(0)})`:this.tag>4191800&&(o+=` (Animated Bone Warrior ${(this.tag-4191800).toFixed(0)})`);break;case O.OtherActionShoot:o="Shoot",n="https://wow.zamimg.com/images/wow/icons/large/ability_marksmanship.jpg";break;case O.OtherActionPet:break;case O.OtherActionRefund:s="Refund",n="https://wow.zamimg.com/images/wow/icons/large/inv_misc_coin_01.jpg";break;case O.OtherActionDamageTaken:s="Damage Taken",n="https://wow.zamimg.com/images/wow/icons/large/inv_sword_04.jpg";break;case O.OtherActionHealingModel:s="Incoming HPS",n="https://wow.zamimg.com/images/wow/icons/large/spell_holy_renew.jpg";break;case O.OtherActionBloodRuneGain:s="Blood Rune Gain",n="https://wow.zamimg.com/images/wow/icons/medium/spell_deathknight_deathstrike.jpg";break;case O.OtherActionFrostRuneGain:s="Frost Rune Gain",n="https://wow.zamimg.com/images/wow/icons/medium/spell_deathknight_deathstrike2.jpg";break;case O.OtherActionUnholyRuneGain:s="Unholy Rune Gain",n="https://wow.zamimg.com/images/wow/icons/medium/spell_deathknight_empowerruneblade.jpg";break;case O.OtherActionDeathRuneGain:s="Death Rune Gain",n="https://wow.zamimg.com/images/wow/icons/medium/spell_deathknight_empowerruneblade.jpg";break;case O.OtherActionPotion:s="Potion",n="https://wow.zamimg.com/images/wow/icons/large/inv_alchemy_elixir_04.jpg";break;case O.OtherActionMove:s="Moving",n="https://wow.zamimg.com/images/wow/icons/medium/inv_boots_cloth_03.jpg";break;case O.OtherActionPrepull:s="Prepull",n="https://wow.zamimg.com/images/wow/icons/medium/inv_misc_pocketwatch_02.jpg";break;case O.OtherActionEncounterStart:s="Encounter Start",n="https://wow.zamimg.com/images/wow/icons/medium/achievement_faction_elders.jpg"}this.baseName=s??"",this.name=(o||s)??"",this.iconUrl=n??"",this.spellIdTooltipOverride=this.spellTooltipOverride?.spellId||null}anyId(){return this.itemId||this.spellId||this.otherId}equals(e){return this.equalsIgnoringTag(e)&&this.tag==e.tag}equalsIgnoringTag(e){return this.itemId==e.itemId&&this.randomSuffixId==e.randomSuffixId&&this.spellId==e.spellId&&this.otherId==e.otherId&&this.upgradeStep===e.upgradeStep}setBackground(e){this.iconUrl&&(e.style.backgroundImage=`url('${this.iconUrl}')`)}static makeItemUrl(e,t,a,i){const s=Dr(),o=new URL(`https://wowhead.com/mop-classic/${s}item=${e}`);return o.searchParams.set("level",String(L)),o.searchParams.set("rand",String(t||0)),a&&o.searchParams.set("forg",String(a)),i===x.ChallengeMode?o.searchParams.set("ilvl",String(k)):i&&o.searchParams.set("upgd",String(i)),o.toString()}static makeSpellUrl(e){return`https://wowhead.com/mop-classic/${Dr()}spell=${e}`}static async makeItemTooltipData(e,t){return Rr({itemId:e,...t})}static async makeSpellTooltipData(e,t){return Rr({spellId:e,...t})}static makeQuestUrl(e){return`https://wowhead.com/mop-classic/${Dr()}quest=${e}`}static makeNpcUrl(e){return`https://wowhead.com/mop-classic/${Dr()}npc=${e}`}static makeZoneUrl(e){return`https://wowhead.com/mop-classic/${Dr()}zone=${e}`}setWowheadHref(t){this.itemId?t.href=e.makeItemUrl(this.itemId,this.randomSuffixId,this.reforgeId,this.upgradeStep):this.spellId&&(t.href=e.makeSpellUrl(this.spellIdTooltipOverride||this.spellId))}async setWowheadDataset(t,a){(this.itemId?e.makeItemTooltipData(this.itemId,a):e.makeSpellTooltipData(this.spellIdTooltipOverride||this.spellId,a)).then(e=>{t&&(t.dataset.wowhead=e)})}setBackgroundAndHref(e){this.setBackground(e),this.setWowheadHref(e)}async fillAndSet(e,t,a,i={}){const s=await this.fill(void 0,i);return t&&s.setWowheadHref(e),a&&s.setBackground(e),s}async fill(t,a={}){if(this.name||this.iconUrl)return this;if(this.otherId)return this;const i=await e.getTooltipData(this,{signal:a?.signal}),s=i.name;let o=s,n=this.tag;switch(n>=138228?n-=138228:n>=71086&&n<=71096&&(o="Dragonwrath - "+o,n-=71086),s){case"Minor Speed":o="Minor Run Speed (8%)";break;case"Arcane Missiles":break;case"Arcane Blast":1==n?o+=" (No Stacks)":2==n?o+=" (1 Stack)":n>2&&(o+=` (${n-1} Stacks)`);break;case"Hot Streak":n&&(o+=" (Crits)");break;case"Fireball":case"Flamestrike":1==n&&(o+=" (Blast Wave)");break;case"Pyroblast":case"Combustion":n&&(o+=" (DoT)");break;case"Frost Bomb":case"Living Bomb":1==n?o+=" (DoT)":2==n&&(o+=" (Explosion)");break;case"Nether Tempest":1==n&&(o+=" (DoT)"),2==n&&(o+=" (Cleave)");break;case"Ice Lance":case"Frostbolt":case"Frostfire Bolt":1==n&&(o+=" (Glyph)");break;case"Evocation":1==n?o+=" (1 Tick)":2==n?o+=" (2 Tick)":3==n?o+=" (3 Tick)":4==n?o+=" (4 Tick)":5==n&&(o+=" (5 Tick)");break;case"Mind Flay":15407===this.spellId?1==n?o+=" (1 Tick)":2==n?o+=" (2 Tick)":3==n?o+=" (3 Tick)":77486==n&&(o+=" (Mastery)"):0===n?o+=" (LFR)":1===n?o+=" (Normal)":2===n&&(o+=" (Heroic)");break;case"Mind Sear":1==n?o+=" (1 Tick)":2==n?o+=" (2 Tick)":3==n?o+=" (3 Tick)":77486==n&&(o+=" (Mastery)");break;case"Devotion Aura":case"Shattering Throw":case"Skull Banner":case"Stormlash":case"Vigilance":case"Pain Suppression":case"Rallying Cry":o+=-1===n?" (raid)":" (self)";break;case"Envenom":case"Eviscerate":case"Rupture":case"Slice and Dice":n&&(o+=` (${n} CP)`);break;case"Crimson Tempest":7==n?o+=" (DoT)":n&&(o+=` (${n} CP)`);break;case"Deadly Poison":o+=1==n?" (DoT)":" (Hit)";break;case"Shadow Blades":1==n?o="Shadow Blade":2==n&&(o="Shadow Blade Off-hand");break;case"Bladestorm":case"Killing Spree":1==n?o+=" (Main Hand)":2==n&&(o+=" (Off Hand)");break;case"Tricks of the Trade":1==n&&(o+=" (Not Self)");break;case"Mutilate":0==n?o+=" (Cast)":1==n?o+=" (Main Hand)":2==n&&(o+=" (Off Hand)");break;case"Hemorrhage":o+=1==n?" (Hit)":" (DoT)";break;case"Wind Lash":case"Stormstrike":case"Stormblast":0==n?o+=" (Cast)":1==n?o+=" (Main Hand)":2==n&&(o+=" (Off Hand)");break;case"Elemental Blast":case"Chain Lightning":case"Lightning Bolt":case"Lava Beam":case"Lava Burst":case"Unleash Flame":case"Unleash Frost":6==n?o+=" (Overload)":7==n?o+=" (Echo)":8==n?o+=" (Echo Overload)":9==n?o+=" (Mastery)":10==n?o+=" (Haste)":11==n?o+=" (Crit)":12==n?o+=" (Agi)":n&&(o+=` (${n} MW)`);break;case"Flame Shock":case"Earth Shock":case"Frost Shock":case"Fire Nova":1==n?o+=" (DoT)":7==n&&(o+=" (Echo)");break;case"Fulmination":o+=` (${n+2})`;break;case"Lightning Shield":1==n&&(o+=" (Wasted)");break;case"Crescendo of Suffering":1==n&&(o+=" (Pre-Pull)");break;case"Soul Fire":104027==this.spellId&&(o+=" (Demon form)");break;case"Shadowflame":case"Moonfire":case"Sunfire":1==n&&(o+=" (DoT)");break;case"Sacred Shield":65148===this.spellId&&(o+=" (Absorb)");break;case"Censure":2==n&&(o+=" (DoT)");break;case"Hammer of the Righteous":88263===this.spellId?o+=" (Holy)":o+=" (Physical)";break;case"Seal of Righteousness":1===n&&(o+=" (DS)");break;case"Harsh Word":o="Word of Glory (Damage",n>0&&(o+=`, ${n} HP`),o+=")";break;case"Word of Glory":case"Eternal Flame":n>0&&(o+=`(${n} HP)`);break;case"Exorcism":2===n&&(o="Glyph of Mass Exorcism");break;case"Templar's Verdict":2===n&&(o+=" (T15 4P)");break;case"Bloodlust":case"Ferocious Inspiration":case"Innervate":case"Focus Magic":case"Mana Tide Totem":case"Stormlash Totem":case"Unholy Frenzy":case"Power Infusion":o+=-1!=n?n===t||null==t?" (self)":` (from #${n+1})`:" (raid)";break;case"Elemental Mastery":o=64701===this.spellId?`${o} (Buff)`:`${o} (Instant)`;break;case"Heart Strike":2==n&&(o+=" (Off-target)");break;case"Raging Blow":2==n?o+=" (Main Hand)":3==n&&(o+=" (Off Hand)");break;case"Soul Reaper":0===n&&(o+=" (Tick)");break;case"Whirlwind":case"Storm Bolt":case"Frost Strike":case"Plague Strike":case"Blood Strike":case"Obliterate":case"Rune of Razorice":case"Blood-Caked Strike":case"Festering Strike":case"Razor Frost":case"Lightning Speed":case"Windfury Weapon":case"Berserk":1==n?o+=" (Main Hand)":2==n&&(o+=" (Off Hand)");break;case"Death Strike":1==n?o+=" (Main Hand)":2==n?o+=" (Off Hand)":45470===this.spellId&&(o+=" (Heal)");break;case"Battle Shout":1==n&&(o+=" (Snapshot)");break;case"Heroic Strike":case"Cleave":case"Maul":1==n&&(o+=" (Queue)");break;case"Seed of Corruption":0==n?o+=" (DoT)":1==n&&(o+=" (Explosion)");break;case"Thunderfury":1==n?o+=" (ST)":2==n&&(o+=" (MT)");break;case"Devouring Plague":if(1==n){o+=" (DoT)";break}if(2==n){o+=" (Heal)";break}if(77486==n){o+=" (Mastery)";break}case"Shadow Word: Death":1==n&&(o+=" (No Orb)");case"Steady Focus":2==n&&(o+=" (pre)");break;case"Immolate":case"Chaos Bolt":1==n&&(o+=" (DoT)");break;case"Immolation Aura":2==n&&(o+=" (Tick)");break;case"Frozen Blows":case"Opportunity Strike":break;case"Slam":1==n&&(o+=" (Sweeping Strikes)");break;case"Drain Life":109828===this.spellId?o+=" 1.3%":108022===this.spellId?o+=" 1.5%":109831===this.spellId&&(o+=" 1.7%"),2===n&&(o+=" (Heal)");break;case"Flameblast":case"Iceblast":case"Shadowblast":109871===this.spellId||109869===this.spellId||109867===this.spellId?o+=" (LFR)":107785===this.spellId||107789===this.spellId||107787===this.spellId?o+=" (Normal)":109872!==this.spellId&&109870!==this.spellId&&109868!==this.spellId||(o+=" (Heroic)");break;case"Item - Paladin T14 Retribution 2P Bonus":o="White Tiger Battlegear - T14 2pc";break;case"Item - Paladin T10 Retribution 4P Bonus":o="White Tiger Battlegear - T14 4pc";break;case"Item - Paladin T14 Protection 2P Bonus":o="White Tiger Plate - T14 2pc";break;case"Item - Paladin T14 Protection 4P Bonus":o="White Tiger Plate - T14 4pc";break;case"Item - Paladin T15 Retribution 2P Bonus":o="Battlegear of the Lightning Emperor - T15 2pc";break;case"Item - Paladin T15 Retribution 4P Bonus":o="Battlegear of the Lightning Emperor - T15 4pc";break;case"Item - Paladin T15 Protection 2P Bonus":o="Plate of the Lightning Emperor - T15 2pc";break;case"Item - Paladin T15 Protection 4P Bonus":o="Plate of the Lightning Emperor - T15 4pc";break;case"Item - Paladin T16 Retribution 2P Bonus":o="Battlegear of Winged Triumph - T16 2pc";break;case"Item - Paladin T16 Retribution 4P Bonus":o="Battlegear of Winged Triumph - T16 4pc";break;case"Item - Paladin T16 Protection 2P Bonus":o="Plate of Winged Triumph - T16 2pc";break;case"Item - Paladin T16 Protection 4P Bonus":o="Plate of Winged Triumph - T16 4pc";break;case"Hurricane":case"Dancing Steel":case"Bloody Dancing Steel":1==n?o+=" (Main Hand)":2==n?o+=" (Off Hand)":3==n&&(o+=" (Spell)");break;case"Landslide":1==n?o+=" (Main Hand)":2==n&&(o+=" (Off Hand)");break;case"Jade Spirit":1==n?o+=" (Intellect)":2==n&&(o+=" (Spirit)");break;case"Tiger Strikes":120274===this.spellId?o+=" (Main Hand)":o+=" (Off Hand)";break;case"Blackout Kick":2===n&&(o+=" (DoT)");break;case"Expel Harm":115072===this.spellId?o+=" (Heal)":o+=" (Damage)";break;case"Chi Wave":132463===this.spellId?o+=" (Heal)":132467===this.spellId&&(o+=" (Damage)");break;case"Zen Sphere":case"Zen Sphere: Detonate":124081===this.spellId&&([4,5].includes(this.tag)&&(o+=": Detonate"),1===this.tag?o+=" (# of Spheres)":[0,2,4].includes(this.tag)?o+=" (Heal)":[3,5].includes(this.tag)&&(o+=" (Damage)"));break;case"Chi Burst":130654===this.spellId?o+=" (Heal)":148135===this.spellId&&(o+=" (Damage)");break;case"Stagger":1===this.tag&&(o+=" (Dot)");break;case"Dampen Harm":break;case"Healing Sphere":115460===this.spellId&&(o+=1===n?" (Stacks)":" (Cast)"),115464===this.spellId&&(o+=" (Heal)");break;case"Vampiric Touch":case"Shadow Word: Pain":77486==n&&(o+=" (Mastery)");break;case"Cascade":1==n&&(o+=" (Bounce)");break;case"Agony":case"Unstable Affliction":case"Corruption":1==n&&(o+=" (Malefic)");break;case"Holy Prism":114852===this.spellId?1===n?o+=" (Damage)":2===n&&(o+=" (Aoe heal)"):114871===this.spellId&&(1===n?o+=" (Heal)":2===n&&(o+=" (Aoe damage)"));break;case"Alter Time":1==n&&(o+=" (Restore)");break;case"Glaive Toss":1==n?o+=" (Glaive 1)":2==n&&(o+=" (Glaive 2)");break;case"Serpent Sting":1==n&&(o+=" (Improved)");break;case"Soul Swap":1==n?o+=": Inhale":2==n&&(o+=": Soulburn");break;default:n&&(o+=" (??)")}let r=e.makeIconUrl(i.icon);const l=this.spellTooltipOverride||this.spellIconOverride;if(l){const t=await e.getTooltipData(l,{signal:a?.signal});r=e.makeIconUrl(t.icon)}return new e({itemId:this.itemId,spellId:this.spellId,otherId:this.otherId,tag:this.tag,baseName:s,name:o,iconUrl:r,randomSuffixId:this.randomSuffixId,reforgeId:this.reforgeId,upgradeStep:this.upgradeStep})}toString(){return this.toStringIgnoringTag()+(this.tag?"-"+this.tag:"")}toStringIgnoringTag(){return this.itemId?"item-"+this.itemId:this.spellId?"spell-"+this.spellId:this.otherId?"other-"+this.otherId:(console.error("Empty action id!"),this.name)}toProto(){const e=z.create({tag:this.tag});return this.itemId?e.rawId={oneofKind:"itemId",itemId:this.itemId}:this.spellId?e.rawId={oneofKind:"spellId",spellId:this.spellId}:this.otherId&&(e.rawId={oneofKind:"otherId",otherId:this.otherId}),e}toProtoString(){return z.toJsonString(this.toProto())}withoutTag(){return new e({itemId:this.itemId,spellId:this.spellId,otherId:this.otherId,baseName:this.baseName,iconUrl:this.iconUrl,randomSuffixId:this.randomSuffixId,reforgeId:this.reforgeId,upgradeStep:this.upgradeStep})}static fromEmpty(){return new e}static fromItemId(t,a,i,s,o){return new e({itemId:t,tag:a,randomSuffixId:i,reforgeId:s,upgradeStep:o})}static fromSpellId(t,a){return new e({spellId:t,tag:a})}static fromOtherId(t,a){return new e({otherId:t,tag:a})}static fromPetName(t){return zr[t]||new e({baseName:t,iconUrl:Fr[t]})}static fromItem(t){return e.fromItemId(t.id)}static fromRandomSuffix(t,a){return e.fromItemId(t.id,0,a.id)}static fromReforge(t,a){return e.fromItemId(t.id,0,0,a.id)}static fromProto(t){return"spellId"==t.rawId.oneofKind?e.fromSpellId(t.rawId.spellId,t.tag):"itemId"==t.rawId.oneofKind?e.fromItemId(t.rawId.itemId,t.tag):"otherId"==t.rawId.oneofKind?e.fromOtherId(t.rawId.otherId,t.tag):e.fromEmpty()}static fromMatch(t){const a=t[1],i=parseInt(t[5]);return new e({itemId:"ItemID"==a?i:void 0,spellId:"SpellID"==a?i:void 0,otherId:"OtherID"==a?i:void 0,tag:t[7]?parseInt(t[7]):void 0})}static fromLogString(t){const a=t.match(e.logRegex);return a?e.fromMatch(a):(console.warn("Failed to parse action id from log: "+t),e.fromEmpty())}static async replaceAllInString(t){const a=[...t.matchAll(e.logRegexGlobal)],i=await Promise.all(a.map(async t=>{const a=e.fromMatch(t),i=await a.fill();return{firstIndex:t.index||0,len:t[0].length,actionId:i}}));for(let e=i.length-1;e>=0;e--){const a=i[e];t=t.substring(0,a.firstIndex)+a.actionId.name+t.substring(a.firstIndex+a.len)}return t}static makeIconUrl(e){return`https://wow.zamimg.com/images/wow/icons/large/${e}.jpg`}static async getTooltipData(e,t={}){return e.itemId?Ar.getItemIconData(e.itemId,{signal:t?.signal}):Ar.getSpellIconData(e.spellId,{signal:t?.signal})}get spellIconOverride(){const t=Nr.get(JSON.stringify({spellId:this.spellId}));return t?t.itemId?e.fromItemId(t.itemId):e.fromSpellId(t.spellId):null}get spellTooltipOverride(){const t=Or.get(JSON.stringify({spellId:this.spellId,tag:this.tag}));return t?t.itemId?e.fromItemId(t.itemId):e.fromSpellId(t.spellId):null}};Mr.logRegex=/{((SpellID)|(ItemID)|(OtherID)): (\d+)(, Tag: (-?\d+))?}/,Mr.logRegexGlobal=new RegExp(Mr.logRegex,"g");let Lr=Mr;const Nr=new Map([[JSON.stringify({spellId:37212}),{itemId:29035}],[JSON.stringify({spellId:37223}),{itemId:29040}],[JSON.stringify({spellId:37447}),{itemId:30720}],[JSON.stringify({spellId:123077}),{itemId:85338}],[JSON.stringify({spellId:123078}),{itemId:85334}],[JSON.stringify({spellId:123079}),{itemId:85338}],[JSON.stringify({spellId:123080}),{itemId:85334}],[JSON.stringify({spellId:138343}),{itemId:95225}],[JSON.stringify({spellId:138347}),{itemId:95229}],[JSON.stringify({spellId:138195}),{itemId:95225}],[JSON.stringify({spellId:138197}),{itemId:95229}],[JSON.stringify({spellId:144899}),{itemId:99188}],[JSON.stringify({spellId:144907}),{itemId:99179}],[JSON.stringify({spellId:144934}),{itemId:99188}],[JSON.stringify({spellId:144950}),{itemId:99179}],[JSON.stringify({spellId:123180}),{itemId:85343}],[JSON.stringify({spellId:70762}),{itemId:85339}],[JSON.stringify({spellId:123104}),{itemId:85343}],[JSON.stringify({spellId:123107}),{itemId:85339}],[JSON.stringify({spellId:138159}),{itemId:95280}],[JSON.stringify({spellId:138164}),{itemId:95284}],[JSON.stringify({spellId:138238}),{itemId:95280}],[JSON.stringify({spellId:138244}),{itemId:95284}],[JSON.stringify({spellId:144586}),{itemId:99136}],[JSON.stringify({spellId:144593}),{itemId:99132}],[JSON.stringify({spellId:144580}),{itemId:99136}],[JSON.stringify({spellId:144566}),{itemId:99132}],[JSON.stringify({spellId:13889}),{spellId:109709}],[JSON.stringify({spellId:65658}),{spellId:48721}]]),Or=new Map([[JSON.stringify({spellId:55090,tag:2}),{spellId:70890}],[JSON.stringify({spellId:114867,tag:1}),{spellId:114866}],[JSON.stringify({spellId:114867,tag:2}),{spellId:130735}],[JSON.stringify({spellId:114867,tag:3}),{spellId:130736}],[JSON.stringify({spellId:85256,tag:2}),{spellId:138165}],[JSON.stringify({spellId:879,tag:2}),{spellId:122032}],[JSON.stringify({spellId:2818,tag:2}),{spellId:113780}],[JSON.stringify({spellId:121411,tag:7}),{spellId:122233}],[JSON.stringify({spellId:121471,tag:1}),{spellId:121473}],[JSON.stringify({spellId:117050,tag:1}),{spellId:120755}],[JSON.stringify({spellId:117050,tag:2}),{spellId:120756}],[JSON.stringify({spellId:1978,tag:1}),{spellId:82834}],[JSON.stringify({spellId:49998,tag:2}),{spellId:66188}],[JSON.stringify({spellId:49143,tag:2}),{spellId:66196}],[JSON.stringify({spellId:49020,tag:2}),{spellId:66198}],[JSON.stringify({spellId:45462,tag:2}),{spellId:66216}],[JSON.stringify({spellId:1329,tag:2}),{spellId:27576}],[JSON.stringify({spellId:121471,tag:2}),{spellId:121474}],[JSON.stringify({spellId:17364,tag:2}),{spellId:32176}],[JSON.stringify({spellId:85288,tag:2}),{spellId:96103}],[JSON.stringify({spellId:85288,tag:3}),{spellId:85384}],[JSON.stringify({spellId:1680,tag:2}),{spellId:44949}],[JSON.stringify({spellId:107570,tag:2}),{spellId:145585}],[JSON.stringify({spellId:2944,tag:2}),{spellId:127626}],[JSON.stringify({spellId:124081,tag:3}),{spellId:124098}],[JSON.stringify({spellId:124081,tag:4}),{spellId:124101}],[JSON.stringify({spellId:124081,tag:5}),{spellId:125033}],[JSON.stringify({spellId:44457,tag:2}),{spellId:44461}],[JSON.stringify({spellId:114923,tag:2}),{spellId:114954}],[JSON.stringify({spellId:30455,tag:1}),{spellId:131080}],[JSON.stringify({spellId:116,tag:1}),{spellId:131079}],[JSON.stringify({spellId:44614,tag:1}),{spellId:131081}],[JSON.stringify({spellId:104025,tag:2}),{spellId:129476}],[JSON.stringify({spellId:47897,tag:1}),{spellId:47960}],[JSON.stringify({spellId:30108,tag:1}),{spellId:131736}],[JSON.stringify({spellId:980,tag:1}),{spellId:131737}],[JSON.stringify({spellId:172,tag:1}),{spellId:131740}]]),Gr="https://wow.zamimg.com/images/wow/icons/large/spell_shadow_metamorphosis.jpg",zr={"Ancient Guardian":Lr.fromSpellId(86698),"Army of the Dead":Lr.fromSpellId(42650),Bloodworm:Lr.fromSpellId(50452),"Dire Beast Pet":Lr.fromSpellId(120679),Stampede:Lr.fromSpellId(121818),"Fallen Zandalari":Lr.fromSpellId(138342),"Flame Orb":Lr.fromSpellId(82731),"Frozen Orb":Lr.fromSpellId(84721),Gargoyle:Lr.fromSpellId(49206),Ghoul:Lr.fromSpellId(46584),"Gnomish Flame Turret":Lr.fromItemId(23841),"Greater Earth Elemental":Lr.fromSpellId(2062),"Greater Fire Elemental":Lr.fromSpellId(2894),"Primal Earth Elemental":Lr.fromSpellId(2062),"Primal Fire Elemental":Lr.fromSpellId(2894),"Mirror Image":Lr.fromSpellId(55342),"Rune Weapon":Lr.fromSpellId(49028),Shadowfiend:Lr.fromSpellId(34433),Mindbender:Lr.fromSpellId(123040),"Spirit Wolf 1":Lr.fromSpellId(51533),"Spirit Wolf 2":Lr.fromSpellId(51533),Valkyr:Lr.fromSpellId(71844),"Tentacle of the Old Ones":Lr.fromSpellId(107818),Treant:Lr.fromSpellId(33831),"Water Elemental":Lr.fromSpellId(31687),Felhunter:Lr.fromSpellId(691),Imp:Lr.fromSpellId(688),Succubus:Lr.fromSpellId(712),Voidwalker:Lr.fromSpellId(697),Doomguard:Lr.fromSpellId(18540),Infernal:Lr.fromSpellId(1122),"Fel Imp":Lr.fromSpellId(112866),Shivarra:Lr.fromSpellId(112868),Observer:Lr.fromSpellId(112869),Voidlord:Lr.fromSpellId(112867),Terrorguard:Lr.fromSpellId(112927),Abyssal:Lr.fromSpellId(112921),"Grimoire: Imp":Lr.fromSpellId(111859),"Grimoire: Voidwalker":Lr.fromSpellId(111895),"Grimoire: Felhunter":Lr.fromSpellId(111897),"Grimoire: Succubus":Lr.fromSpellId(111896),Felguard:Lr.fromSpellId(30146),"Wild Imp":Lr.fromSpellId(114592),"Grimoire: Felguard":Lr.fromSpellId(111898),Wrathguard:Lr.fromSpellId(112870),"Xuen, The White Tiger":Lr.fromSpellId(123904),"Earth Spirit":Lr.fromSpellId(138121),"Storm Spirit":Lr.fromSpellId(138122),"Fire Spirit":Lr.fromSpellId(138123)},Fr={Bat:"https://wow.zamimg.com/images/wow/icons/medium/ability_hunter_pet_bat.jpg",Bear:"https://wow.zamimg.com/images/wow/icons/medium/ability_hunter_pet_bear.jpg","Bird of Prey":"https://wow.zamimg.com/images/wow/icons/medium/ability_hunter_pet_owl.jpg",Boar:"https://wow.zamimg.com/images/wow/icons/medium/ability_hunter_pet_boar.jpg","Burning Treant":"https://wow.zamimg.com/images/wow/icons/large/ability_druid_forceofnature.jpg","Carrion Bird":"https://wow.zamimg.com/images/wow/icons/medium/ability_hunter_pet_vulture.jpg",Cat:"https://wow.zamimg.com/images/wow/icons/medium/ability_hunter_pet_cat.jpg",Chimaera:"https://wow.zamimg.com/images/wow/icons/medium/ability_hunter_pet_chimera.jpg","Core Hound":"https://wow.zamimg.com/images/wow/icons/medium/ability_hunter_pet_corehound.jpg",Crab:"https://wow.zamimg.com/images/wow/icons/medium/ability_hunter_pet_crab.jpg",Crocolisk:"https://wow.zamimg.com/images/wow/icons/medium/ability_hunter_pet_crocolisk.jpg",Devilsaur:"https://wow.zamimg.com/images/wow/icons/medium/ability_hunter_pet_devilsaur.jpg",Dragonhawk:"https://wow.zamimg.com/images/wow/icons/medium/ability_hunter_pet_dragonhawk.jpg","Fallen Zandalari":"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_animatedead.jpg",Felguard:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_summonfelguard.jpg",Felhunter:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_summonfelhunter.jpg",Infernal:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_summoninfernal.jpg",Doomguard:"https://wow.zamimg.com/images/wow/icons/large/warlock_summon_doomguard.jpg","Ebon Imp":"https://wow.zamimg.com/images/wow/icons/large/spell_nature_removecurse.jpg","Fiery Imp":"https://wow.zamimg.com/images/wow/icons/large/ability_warlock_empoweredimp.jpg",Gorilla:"https://wow.zamimg.com/images/wow/icons/medium/ability_hunter_pet_gorilla.jpg",Hyena:"https://wow.zamimg.com/images/wow/icons/medium/ability_hunter_pet_hyena.jpg",Imp:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_summonimp.jpg",Moth:"https://wow.zamimg.com/images/wow/icons/medium/ability_hunter_pet_moth.jpg","Nether Ray":"https://wow.zamimg.com/images/wow/icons/medium/ability_hunter_pet_netherray.jpg",Owl:"https://wow.zamimg.com/images/wow/icons/medium/ability_hunter_pet_owl.jpg",Raptor:"https://wow.zamimg.com/images/wow/icons/medium/ability_hunter_pet_raptor.jpg",Ravager:"https://wow.zamimg.com/images/wow/icons/medium/ability_hunter_pet_ravager.jpg",Rhino:"https://wow.zamimg.com/images/wow/icons/medium/ability_hunter_pet_rhino.jpg",Scorpid:"https://wow.zamimg.com/images/wow/icons/medium/ability_hunter_pet_scorpid.jpg",Serpent:"https://wow.zamimg.com/images/wow/icons/medium/spell_nature_guardianward.jpg",Silithid:"https://wow.zamimg.com/images/wow/icons/medium/ability_hunter_pet_silithid.jpg",Spider:"https://wow.zamimg.com/images/wow/icons/medium/ability_hunter_pet_spider.jpg","Shale Spider":"https://wow.zamimg.com/images/wow/icons/medium/ability_hunter_pet_spider.jpg","Spirit Beast":"https://wow.zamimg.com/images/wow/icons/medium/ability_druid_primalprecision.jpg","Spore Bat":"https://wow.zamimg.com/images/wow/icons/medium/ability_hunter_pet_sporebat.jpg",Succubus:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_summonsuccubus.jpg",Tallstrider:"https://wow.zamimg.com/images/wow/icons/medium/ability_hunter_pet_tallstrider.jpg",Thunderhawk:"https://wow.zamimg.com/images/wow/icons/medium/ability_hunter_pet_windserpent.jpg",Turtle:"https://wow.zamimg.com/images/wow/icons/medium/ability_hunter_pet_turtle.jpg","Warp Stalker":"https://wow.zamimg.com/images/wow/icons/medium/ability_hunter_pet_warpstalker.jpg",Wasp:"https://wow.zamimg.com/images/wow/icons/medium/ability_hunter_pet_wasp.jpg","Wind Serpent":"https://wow.zamimg.com/images/wow/icons/medium/ability_hunter_pet_windserpent.jpg",Wolf:"https://wow.zamimg.com/images/wow/icons/medium/ability_hunter_pet_wolf.jpg",Worm:"https://wow.zamimg.com/images/wow/icons/medium/ability_hunter_pet_worm.jpg",Fox:"https://wow.zamimg.com/images/wow/icons/medium/inv_misc_monstertail_07.jpg"};const Hr={[G.ResourceTypeNone]:"",[G.ResourceTypeHealth]:"https://wow.zamimg.com/images/wow/icons/medium/inv_elemental_mote_life01.jpg",[G.ResourceTypeMana]:"https://wow.zamimg.com/images/wow/icons/medium/inv_elemental_mote_mana.jpg",[G.ResourceTypeEnergy]:"https://wow.zamimg.com/images/wow/icons/medium/spell_shadow_shadowworddominate.jpg",[G.ResourceTypeRage]:"https://wow.zamimg.com/images/wow/icons/medium/spell_misc_emotionangry.jpg",[G.ResourceTypeChi]:"https://wow.zamimg.com/images/wow/icons/medium/ability_monk_healthsphere.jpg",[G.ResourceTypeComboPoints]:"https://wow.zamimg.com/images/wow/icons/medium/inv_mace_2h_pvp410_c_01.jpg",[G.ResourceTypeFocus]:"https://wow.zamimg.com/images/wow/icons/medium/ability_hunter_focusfire.jpg",[G.ResourceTypeRunicPower]:"https://wow.zamimg.com/images/wow/icons/medium/inv_sword_62.jpg",[G.ResourceTypeBloodRune]:"https://wow.zamimg.com/images/wow/icons/medium/spell_deathknight_bloodpresence.jpg",[G.ResourceTypeFrostRune]:"https://wow.zamimg.com/images/wow/icons/medium/spell_deathknight_frostpresence.jpg",[G.ResourceTypeUnholyRune]:"https://wow.zamimg.com/images/wow/icons/medium/spell_deathknight_unholypresence.jpg",[G.ResourceTypeDeathRune]:"/mop/assets/img/death_rune.png",[G.ResourceTypeSolarEnergy]:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_eclipseorange.jpg",[G.ResourceTypeLunarEnergy]:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_eclipse.jpg",[G.ResourceTypeGenericResource]:"https://wow.zamimg.com/images/wow/icons/medium/spell_holy_holybolt.jpg"},Ur={96228:Lr.fromSpellId(82174),96229:Lr.fromSpellId(82174),96230:Lr.fromSpellId(82174),132403:Lr.fromSpellId(53600),138169:Lr.fromSpellId(85256),131900:Lr.fromSpellId(131894)},Br={footer:!1,header:!0,scrollContents:!1,size:"lg",title:null};class Wr extends F{constructor(e,t,a={disposeOnClose:!0}){super(e,"modal"),this.isOpen=!1,this.onHideCallbacks=[],this.modalConfig={...Br,...a};const i=U(),s=U(),o=U(),n=U(),r=this.modalConfig.size&&"md"!=this.modalConfig.size?`modal-${this.modalConfig.size}`:"";this.rootElem.classList.add("fade"),this.rootElem.appendChild(H("div",{className:`modal-dialog ${t} ${r} ${this.modalConfig.scrollContents?"modal-overflow-scroll":""}`,ref:i},H("div",{className:"modal-content"},H("div",{className:"modal-header "+(this.modalConfig.header||this.modalConfig.title?"":"p-0 border-0"),ref:s},this.modalConfig.title&&H("h5",{className:"modal-title"},this.modalConfig.title),H("button",{type:"button",className:"btn-close "+(this.modalConfig.closeButton?.fixed?"position-fixed":""),onclick:()=>this.close(),attributes:{"aria-label":"Close"}},H("i",{className:"fas fa-times fa-2xl"}))),H("div",{className:"modal-body",ref:o}),this.modalConfig.footer&&H("div",{className:"modal-footer",ref:n})))),this.dialog=i.value,this.header=s.value,this.body=o.value,this.footer=n.value,this.modal=new B(this.rootElem),this.modalConfig.disposeOnClose&&this.rootElem.addEventListener("hidden.bs.modal",()=>{this.rootElem.remove(),this.dispose()},{once:!0})}open(){const e=this.closeModalOnEscKey.bind(this),t=this.showBSFn.bind(this),a=this.hideBSFn.bind(this),i=this.hiddenBSFn.bind(this);document.addEventListener("keydown",e),this.rootElem.addEventListener("show.bs.modal",t),this.rootElem.addEventListener("hide.bs.modal",a),this.rootElem.addEventListener("hidden.bs.modal",i),this.addOnHideCallback(()=>document.removeEventListener("keydown",e)),this.addOnHideCallback(()=>this.rootElem.removeEventListener("show.bs.modal",t)),this.addOnHideCallback(()=>this.rootElem.removeEventListener("hide.bs.modal",a)),this.addOnHideCallback(()=>this.rootElem.removeEventListener("hidden.bs.modal",i)),this.modal.show(),this.isOpen=!0}close(){this.modal.hide(),this.isOpen=!1}addOnHideCallback(e){this.onHideCallbacks.push(e)}onShow(e){}onHide(e){this.onHideCallbacks.forEach(e=>e())}async showBSFn(e){e.stopImmediatePropagation();const t=await new Promise(e=>{setTimeout(()=>{this.modal._backdrop._element&&e(this.modal._backdrop._element)},100)});this.rootElem.insertAdjacentElement("afterend",t),this.onShow(e)}hideBSFn(e){e.stopImmediatePropagation(),this.onHide(e)}hiddenBSFn(e){e.stopPropagation()}closeModalOnEscKey(e){"Escape"==e.key&&this.close()}}const Vr={[W.ItemQualityJunk]:"text-junk",[W.ItemQualityCommon]:"text-common",[W.ItemQualityUncommon]:"text-uncommon",[W.ItemQualityRare]:"text-rare",[W.ItemQualityEpic]:"text-epic",[W.ItemQualityLegendary]:"text-legendary",[W.ItemQualityArtifact]:"text-artifact",[W.ItemQualityHeirloom]:"text-heirloom"};function jr(e,t){Object.values(Vr).forEach(t=>e.classList.remove(t)),t&&e.classList.add(Vr[t])}const Yr=new Map([[V.ArmorTypeUnknown,"Unknown"],[V.ArmorTypeCloth,"Cloth"],[V.ArmorTypeLeather,"Leather"],[V.ArmorTypeMail,"Mail"],[V.ArmorTypePlate,"Plate"]]),qr=new Map([[Y.RaceUnknown,"None"],[Y.RaceBloodElf,"Blood Elf"],[Y.RaceDraenei,"Draenei"],[Y.RaceDwarf,"Dwarf"],[Y.RaceGnome,"Gnome"],[Y.RaceGoblin,"Goblin"],[Y.RaceHuman,"Human"],[Y.RaceNightElf,"Night Elf"],[Y.RaceOrc,"Orc"],[Y.RaceAlliancePandaren,"Pandaren (A)"],[Y.RaceHordePandaren,"Pandaren (H)"],[Y.RaceTauren,"Tauren"],[Y.RaceTroll,"Troll"],[Y.RaceUndead,"Undead"],[Y.RaceWorgen,"Worgen"]]);function Xr(e){const t=e.toLowerCase().replaceAll(" ","");for(const[a,i]of qr)if(i.toLowerCase().replaceAll(" ","")==t)return a;return Y.RaceUnknown}const $r=new Map([[q.ClassUnknown,"None"],[q.ClassDruid,"Druid"],[q.ClassHunter,"Hunter"],[q.ClassMage,"Mage"],[q.ClassMonk,"Monk"],[q.ClassPaladin,"Paladin"],[q.ClassPriest,"Priest"],[q.ClassRogue,"Rogue"],[q.ClassShaman,"Shaman"],[q.ClassWarlock,"Warlock"],[q.ClassWarrior,"Warrior"],[q.ClassDeathKnight,"Death Knight"]]);function Zr(e){const t=e.toLowerCase();for(const[a,i]of $r)if(i.toLowerCase().replace(/\s+/g,"")==t)return a;return q.ClassUnknown}const Kr=new Map([[a.ProfessionUnknown,"None"],[a.Alchemy,"Alchemy"],[a.Blacksmithing,"Blacksmithing"],[a.Enchanting,"Enchanting"],[a.Engineering,"Engineering"],[a.Herbalism,"Herbalism"],[a.Inscription,"Inscription"],[a.Jewelcrafting,"Jewelcrafting"],[a.Leatherworking,"Leatherworking"],[a.Mining,"Mining"],[a.Skinning,"Skinning"],[a.Tailoring,"Tailoring"],[a.Archeology,"Archeology"]]);const Jr=new Map([[2,"Physical"],[4,"Arcane"],[8,"Fire"],[16,"Frost"],[32,"Holy"],[64,"Nature"],[128,"Shadow"],[68,"Astral"],[136,"Shadowflame"],[12,"Spellfire"],[20,"Spellfrost"],[24,"Frostfire"],[144,"Shadowfrost"],[192,"Plague"],[72,"Firestorm"],[88,"Elemental"]]),Qr=new Map([[G.ResourceTypeNone,"None"],[G.ResourceTypeHealth,"Health"],[G.ResourceTypeMana,"Mana"],[G.ResourceTypeEnergy,"Energy"],[G.ResourceTypeRage,"Rage"],[G.ResourceTypeChi,"Chi"],[G.ResourceTypeComboPoints,"Combo Points"],[G.ResourceTypeFocus,"Focus"],[G.ResourceTypeRunicPower,"Runic Power"],[G.ResourceTypeBloodRune,"Blood Rune"],[G.ResourceTypeFrostRune,"Frost Rune"],[G.ResourceTypeUnholyRune,"Unholy Rune"],[G.ResourceTypeDeathRune,"Death Rune"],[G.ResourceTypeSolarEnergy,"Solar Energy"],[G.ResourceTypeLunarEnergy,"Lunar Energy"],[G.ResourceTypeGenericResource,"Generic Resource"]]);G.ResourceTypeNone,G.ResourceTypeHealth,G.ResourceTypeMana,G.ResourceTypeEnergy,G.ResourceTypeRage,G.ResourceTypeChi,G.ResourceTypeComboPoints,G.ResourceTypeFocus,G.ResourceTypeRunicPower,G.ResourceTypeBloodRune,G.ResourceTypeFrostRune,G.ResourceTypeUnholyRune,G.ResourceTypeDeathRune,G.ResourceTypeSolarEnergy,G.ResourceTypeLunarEnergy,G.ResourceTypeGenericResource;const el=new Map([[X.DifficultyUnknown,"Unknown"],[X.DifficultyNormal,"N"],[X.DifficultyHeroic,"H"],[X.DifficultyCelestial,"CEL"],[X.DifficultyRaid10,"10N"],[X.DifficultyRaid10H,"10H"],[X.DifficultyRaid25RF,"RF"],[X.DifficultyRaid25,"RN"],[X.DifficultyRaid25H,"RH"],[X.DifficultyRaidFlex,"RFL"]]),tl={[$.RepLevelUnknown]:"Unknown",[$.RepLevelHated]:"Hated",[$.RepLevelHostile]:"Hostile",[$.RepLevelUnfriendly]:"Unfriendly",[$.RepLevelNeutral]:"Neutral",[$.RepLevelFriendly]:"Friendly",[$.RepLevelHonored]:"Honored",[$.RepLevelRevered]:"Revered",[$.RepLevelExalted]:"Exalted"},al={[Z.RepFactionUnknown]:"Unknown",[Z.RepFactionTheEarthenRing]:"The Earthen Ring",[Z.RepFactionGuardiansOfHyjal]:"Guardians of Hyjal",[Z.RepFactionTherazane]:"Therazane",[Z.RepFactionDragonmawClan]:"Dragonmaw Clan",[Z.RepFactionRamkahen]:"Ramkahen",[Z.RepFactionWildhammerClan]:"Wildhammer Clan",[Z.RepFactionBaradinsWardens]:"Baradin's Wardens",[Z.RepFactionHellscreamsReach]:"Hellscream's Reach",[Z.RepFactionAvengersOfHyjal]:"Avengers of Hyjal",[Z.RepFactionGoldenLotus]:"Golden Lotus",[Z.RepFactionTheTillers]:"The Tillers",[Z.RepFactionShadoPan]:"Shado-Pan",[Z.RepFactionShadoPanAssault]:"Shado-Pan Assault",[Z.RepFactionTheBrewmasters]:"The Brewmasters",[Z.RepFactionTheKlaxxi]:"The Klaxxi",[Z.RepFactionTheAugustCelestials]:"The August Celestials",[Z.RepFactionTheAnglers]:"The Anglers",[Z.RepFactionEmperorShaohao]:"Emperor Shaohao",[Z.RepFactionSunreaverOnslaught]:"Sunreaver Onslaught",[Z.RepFactionKirinTorOffensive]:"Kirin Tor Offensive",[Z.RepFactionDominanceOffensive]:"Dominance Offensive",[Z.RepFactionOrderOfTheCloudSerpent]:"Order of the Cloud Serpent",[Z.RepFactionShangXisAcademy]:"Shang Xis Academy",[Z.RepFactionTheLorewalkers]:"The Lorewalkers",[Z.RepFactionTheBlackPrince]:"The Black Prince",[Z.RepFactionForestHozen]:"Forest Hozen",[Z.RepFactionPearlfinJinyu]:"Pearlfin Jinyu",[Z.RepFactionHozen]:"Hozen",[Z.RepFactionOperationShieldwall]:"Operation: Shieldwall"},il={[Z.RepFactionUnknown]:0,[Z.RepFactionTheEarthenRing]:50324,[Z.RepFactionGuardiansOfHyjal]:50314,[Z.RepFactionTherazane]:45408,[Z.RepFactionDragonmawClan]:49387,[Z.RepFactionRamkahen]:48617,[Z.RepFactionWildhammerClan]:49386,[Z.RepFactionBaradinsWardens]:47328,[Z.RepFactionHellscreamsReach]:48531,[Z.RepFactionAvengersOfHyjal]:54401,[Z.RepFactionGoldenLotus]:59908,[Z.RepFactionTheTillers]:58706,[Z.RepFactionShadoPan]:64595,[Z.RepFactionShadoPanAssault]:70346,[Z.RepFactionTheBrewmasters]:64596,[Z.RepFactionTheKlaxxi]:64599,[Z.RepFactionTheAugustCelestials]:64032,[Z.RepFactionTheAnglers]:63721,[Z.RepFactionEmperorShaohao]:0,[Z.RepFactionSunreaverOnslaught]:67672,[Z.RepFactionKirinTorOffensive]:68e3,[Z.RepFactionDominanceOffensive]:69060,[Z.RepFactionOrderOfTheCloudSerpent]:58414,[Z.RepFactionShangXisAcademy]:0,[Z.RepFactionTheLorewalkers]:64605,[Z.RepFactionTheBlackPrince]:0,[Z.RepFactionForestHozen]:0,[Z.RepFactionPearlfinJinyu]:0,[Z.RepFactionHozen]:0,[Z.RepFactionOperationShieldwall]:69059},sl=new Map([[K.SpecAssassinationRogue,76803],[K.SpecCombatRogue,76806],[K.SpecSubtletyRogue,76808],[K.SpecBloodDeathKnight,77513],[K.SpecFrostDeathKnight,77514],[K.SpecUnholyDeathKnight,77515],[K.SpecBalanceDruid,77492],[K.SpecFeralDruid,77493],[K.SpecGuardianDruid,77494],[K.SpecRestorationDruid,77495],[K.SpecHolyPaladin,76669],[K.SpecProtectionPaladin,76671],[K.SpecRetributionPaladin,76672],[K.SpecElementalShaman,77222],[K.SpecEnhancementShaman,77223],[K.SpecRestorationShaman,77226],[K.SpecBeastMasteryHunter,76657],[K.SpecMarksmanshipHunter,76659],[K.SpecSurvivalHunter,76658],[K.SpecArmsWarrior,76838],[K.SpecFuryWarrior,76856],[K.SpecProtectionWarrior,76857],[K.SpecArcaneMage,76547],[K.SpecFireMage,12846],[K.SpecFrostMage,76613],[K.SpecDisciplinePriest,77484],[K.SpecHolyPriest,77485],[K.SpecShadowPriest,77486],[K.SpecAfflictionWarlock,77215],[K.SpecDemonologyWarlock,77219],[K.SpecDestructionWarlock,77220],[K.SpecBrewmasterMonk,117906],[K.SpecMistweaverMonk,117907],[K.SpecWindwalkerMonk,1247280]]),ol=new Map([[J.TypeHardCap,"Hard cap"],[J.TypeSoftCap,"Soft cap"],[J.TypeThreshold,"Threshold"]]);class nl extends F{constructor(e,t,a,i){super(e,"input-root",i.rootElem),this.enabled=!0,this.changeEmitter=new te("input-change"),this.abortController=new AbortController,this.signal=this.abortController.signal,this.inputConfig=i,this.modObject=a,this.rootElem.classList.add(t),i.inline&&this.rootElem.classList.add("input-inline"),i.extraCssClasses&&this.rootElem.classList.add(...i.extraCssClasses),i.label&&this.rootElem.appendChild(this.buildLabel(i)),i.description&&this.rootElem.appendChild(this.buildDescription(i));const s=i.changedEvent(this.modObject).on(()=>{const e=this.getInputElem();ae(e)&&ae(this.rootElem)?(this.setInputValue(this.getSourceValue()),this.update()):this.dispose()});this.addOnDisposeCallback(()=>{this.abortController?.abort(),s.dispose()})}buildLabel(e){const t=H("label",{htmlFor:e.id||void 0,className:"form-label",title:e.label},e.label);if(e.labelTooltip){const a=ie(t,{content:e.labelTooltip});this.addOnDisposeCallback(()=>a.destroy())}return t}buildDescription(e){return H("div",{className:"input-description"},e.description)}update(){!this.inputConfig.enableWhen||this.inputConfig.enableWhen(this.modObject)?(this.enabled=!0,this.rootElem.classList.remove("disabled"),this.getInputElem()?.removeAttribute("disabled")):(this.enabled=!1,this.rootElem.classList.add("disabled"),this.getInputElem()?.setAttribute("disabled",""));!this.inputConfig.showWhen||this.inputConfig.showWhen(this.modObject)?this.rootElem.classList.remove("hide"):this.rootElem.classList.add("hide")}init(){const e=this.inputConfig.defaultValue?this.inputConfig.defaultValue:this.inputConfig.getValue(this.modObject);this.setInputValue(e),this.update()}getSourceValue(){return this.inputConfig.getValue(this.modObject)}setSourceValue(e,t){this.inputConfig.setValue(e,this.modObject,t)}sourceToValue(e){return this.inputConfig.sourceToValue?this.inputConfig.sourceToValue(e):e}valueToSource(e){return this.inputConfig.valueToSource?this.inputConfig.valueToSource(e):e}inputChanged(e){this.setSourceValue(e,this.getInputValue()),this.changeEmitter.emit(e)}setValue(e,t){this.inputConfig.setValue(e,this.modObject,t)}static newGroupContainer(e){return H("div",{className:xr("picker-group",e)})}}class rl extends nl{constructor(e,t,a){super(e,"number-picker-root",t,a),this.float=a.float??!1,this.maxDecimalDigits=a.maxDecimalDigits??2,this.positive=a.positive??!1,this.showZeroes=a.showZeroes??!0,this.inputElem=document.createElement("input"),this.inputElem.id=a.id,this.inputElem.type="text",this.inputElem.classList.add("form-control","number-picker-input"),this.positive&&this.inputElem.addEventListener("change",()=>{this.float?this.inputElem.value=se(Math.abs(Number(this.inputElem.value)),{minimumFractionDigits:2,maximumFractionDigits:this.maxDecimalDigits}):this.inputElem.value=Math.abs(parseInt(this.inputElem.value)).toString()},{signal:this.signal}),this.inputElem.addEventListener("change",()=>{this.inputChanged(te.nextEventID())},{signal:this.signal}),this.inputElem.addEventListener("input",()=>{this.updateSize()},{signal:this.signal}),this.rootElem.appendChild(this.inputElem),this.init(),this.updateSize()}getInputElem(){return this.inputElem}getInputValue(){return this.float?Number(this.inputElem.value||"")||0:parseInt(this.inputElem.value||"")||0}setInputValue(e){0!==e||this.showZeroes?this.float?this.inputElem.value=se(e,{useGrouping:!1,minimumFractionDigits:2,maximumFractionDigits:this.maxDecimalDigits}):this.inputElem.value=String(e):this.inputElem.value=""}updateSize(){const e=Math.max(3,this.inputElem.value.length);this.inputElem.size!=e&&(this.inputElem.size=e)}}class ll extends F{constructor(e,t,a,i,s,o){super(e,"character-stats-root"),this.hasRacialHitBonus=!1,this.activeRacialExpertiseBonuses=[!1,!1],this.stats=[],this.player=a,this.modifyDisplayStats=s,this.overwriteDisplayStats=o;const n=document.createElement("label");n.classList.add("character-stats-label"),n.textContent=oe.t("sidebar.character_stats.title"),this.rootElem.appendChild(n);const r=document.createElement("table");r.classList.add("character-stats-table"),this.rootElem.appendChild(r),this.valueElems=[];const l=new Map([["Primary",[ne.fromStat(ee.StatHealth),ne.fromStat(ee.StatMana)]],["Attributes",[ne.fromStat(ee.StatStrength),ne.fromStat(ee.StatAgility),ne.fromStat(ee.StatStamina),ne.fromStat(ee.StatIntellect),ne.fromStat(ee.StatSpirit)]],["Defense",[ne.fromStat(ee.StatArmor),ne.fromStat(ee.StatBonusArmor),ne.fromPseudoStat(T.PseudoStatDodgePercent),ne.fromPseudoStat(T.PseudoStatParryPercent),ne.fromPseudoStat(T.PseudoStatBlockPercent)]],["Physical",[ne.fromStat(ee.StatAttackPower),ne.fromStat(ee.StatRangedAttackPower),ne.fromPseudoStat(T.PseudoStatMeleeHastePercent),ne.fromPseudoStat(T.PseudoStatRangedHastePercent),ne.fromPseudoStat(T.PseudoStatPhysicalHitPercent),ne.fromPseudoStat(T.PseudoStatPhysicalCritPercent)]],["Spell",[ne.fromStat(ee.StatSpellPower),ne.fromPseudoStat(T.PseudoStatSpellHastePercent),ne.fromPseudoStat(T.PseudoStatSpellHitPercent),ne.fromPseudoStat(T.PseudoStatSpellCritPercent)]]]);if(this.player.getPlayerSpec().isTankSpec){const e=l.get("Physical").findIndex(e=>e.equalsPseudoStat(T.PseudoStatPhysicalHitPercent));l.get("Physical").splice(e+1,0,ne.fromStat(ee.StatExpertiseRating)),l.get("Defense").push(ne.fromStat(ee.StatMasteryRating))}else if([ee.StatIntellect,ee.StatSpellPower].includes(t.individualConfig.epReferenceStat)){const e=l.get("Spell").findIndex(e=>e.equalsPseudoStat(T.PseudoStatSpellHitPercent));l.get("Spell").splice(e+1,0,ne.fromStat(ee.StatExpertiseRating)),l.get("Spell").push(ne.fromStat(ee.StatMasteryRating))}else{const e=l.get("Physical").findIndex(e=>e.equalsPseudoStat(T.PseudoStatPhysicalHitPercent));l.get("Physical").splice(e+1,0,ne.fromStat(ee.StatExpertiseRating)),l.get("Physical").push(ne.fromStat(ee.StatMasteryRating))}l.forEach((e,t)=>{const s=e.filter(e=>i.find(t=>t.equals(e)));if(!s.length)return;if(["Physical","Spell"].includes(t)&&1===s.length)return;const o=H("tbody",null);s.forEach(e=>{this.stats.push(e);const t=e.getShortName(a.getClass()),i=U(),s=H("tr",{className:"character-stats-table-row"},H("td",{className:"character-stats-table-label"},t,e.equalsStat(ee.StatMasteryRating)&&H("div",null,re(this.player.getSpec()))),H("td",{ref:i,className:"character-stats-table-value"},e.hasRootStat()&&this.bonusStatsLink(e)));if(o.appendChild(s),this.valueElems.push(i.value),e.isPseudoStat()&&e.getPseudoStat()===T.PseudoStatPhysicalCritPercent&&this.shouldShowMeleeCritCap(a)){const e=H("tr",{className:"character-stats-table-row"},H("td",{className:"character-stats-table-label"},oe.t("sidebar.character_stats.melee_crit_cap")),H("td",{className:"character-stats-table-value"},H("span",{className:"px-2 border-start border-end border-body border-brand",style:{"--bs-border-opacity":"0"}})));o.appendChild(e);const t=e.getElementsByClassName("character-stats-table-value")[0];this.valueElems.push(t)}}),r.appendChild(o)}),this.updateStats(a),te.onAny([a.currentStatsEmitter,a.sim.changeEmitter,a.talentsChangeEmitter]).on(()=>{this.updateStats(a)})}updateStats(e){const t=e.getCurrentStats(),a=this.modifyDisplayStats?this.modifyDisplayStats(this.player):{};this.hasRacialHitBonus=this.player.getRace()===Y.RaceDraenei,this.activeRacialExpertiseBonuses=this.player.getActiveRacialExpertiseBonuses();const i=n.fromProto(t.baseStats),s=n.fromProto(t.gearStats),o=n.fromProto(t.talentsStats),r=n.fromProto(t.buffsStats),l=n.fromProto(t.consumesStats),c=e.getBonusStats();let h=n.fromProto(t.finalStats).add(a.base||new n).add(a.gear||new n).add(a.talents||new n).add(a.buffs||new n).add(a.consumes||new n).add(a.final||new n),d=i.add(a.base||new n),u=s.subtract(i).subtract(c).add(a.gear||new n),p=o.subtract(s).add(a.talents||new n),m=r.subtract(o).add(a.buffs||new n),g=l.subtract(r).add(a.consumes||new n);if(this.overwriteDisplayStats){const e=this.overwriteDisplayStats(this.player);e.stats&&e.stats.forEach((t,a)=>{d=d.withStat(t,e.base.getStat(t)),u=u.withStat(t,e.gear.getStat(t)),p=p.withStat(t,e.talents.getStat(t)),m=m.withStat(t,e.buffs.getStat(t)),g=g.withStat(t,e.consumes.getStat(t)),h=h.withStat(t,e.final.getStat(t))})}const f=this.player.getBaseMastery()+(t.finalStats?.stats[ee.StatMasteryRating]||0)/le;let b=0;this.stats.forEach(t=>{const a=t.hasRootStat()?c.getStat(t.getRootStat()):0;let i;i=0==a?"text-white":a>0?"text-success":"text-danger";const s=U();let o=[this.player.getMasteryPerPointModifier()],n=[0];switch(e.getSpec()){case K.SpecDestructionWarlock:n=[1,0],o=[1,...o];break;case K.SpecDemonologyWarlock:n=[0,0],o=[1,...o];break;case K.SpecProtectionWarrior:n=[0,0],o=[.5,...o];break;case K.SpecWindwalkerMonk:n=[3.5,0];break;case K.SpecBalanceDruid:n=[15]}const r=H("div",{className:"stat-value-link-container"},H("button",{ref:s,className:xr("stat-value-link",i)},`${this.statDisplayString(h,t,!0)} `),t.equalsStat(ee.StatMasteryRating)&&o.map((e,t)=>H("a",{href:Lr.makeSpellUrl(sl.get(this.player.getSpec())||0),className:xr("stat-value-link-mastery",i),target:"_blank"},`${(f*e+n[t]).toFixed(2)}%`))),l=s.value;this.valueElems[b].querySelector(".stat-value-link-container")?.remove(),this.valueElems[b].prepend(r);const y=H("div",null,H("div",{className:"character-stats-tooltip-row"},H("span",null,oe.t("sidebar.character_stats.tooltip.base")),H("span",null,this.statDisplayString(d,t,!0))),H("div",{className:"character-stats-tooltip-row"},H("span",null,oe.t("sidebar.character_stats.tooltip.gear")),H("span",null,this.statDisplayString(u,t))),H("div",{className:"character-stats-tooltip-row"},H("span",null,oe.t("sidebar.character_stats.tooltip.talents")),H("span",null,this.statDisplayString(p,t))),H("div",{className:"character-stats-tooltip-row"},H("span",null,oe.t("sidebar.character_stats.tooltip.buffs")),H("span",null,this.statDisplayString(m,t))),H("div",{className:"character-stats-tooltip-row"},H("span",null,oe.t("sidebar.character_stats.tooltip.consumes")),H("span",null,this.statDisplayString(g,t))),0!==a&&H("div",{className:"character-stats-tooltip-row"},H("span",null,oe.t("sidebar.character_stats.tooltip.bonus")),H("span",null,this.statDisplayString(c,t))),H("div",{className:"character-stats-tooltip-row"},H("span",null,oe.t("sidebar.character_stats.tooltip.total")),H("span",null,this.statDisplayString(h,t,!0))),t.isPseudoStat()&&t.getPseudoStat()===T.PseudoStatSpellHitPercent&&H("div",{className:"character-stats-tooltip-row"},H("span",null,H("i",null,"Total Includes Expertise"))),t.isStat()&&t.getStat()===ee.StatExpertiseRating&&H("div",{className:"character-stats-tooltip-row"},H("span",null,H("i",null,"Contributes to Spell Hit"))));if(t.isPseudoStat()&&t.getPseudoStat()===T.PseudoStatPhysicalCritPercent&&this.shouldShowMeleeCritCap(e)){b++;const t=e.getMeleeCritCapInfo(),a=H("button",{className:"stat-value-link"},this.meleeCritCapDisplayString(e,h)," "),i=t.playerCritCapDelta;0==i?a.classList.add("text-white"):i>0?a.classList.add("text-danger"):i<0&&a.classList.add("text-success"),this.valueElems[b].querySelector(".stat-value-link-container")?.remove(),this.valueElems[b].prepend(H("div",{className:"stat-value-link-container"},a));const s=H("div",null,H("div",{className:"character-stats-tooltip-row"},H("span",null,oe.t("sidebar.character_stats.attack_table.glancing")),H("span",null,`${t.glancing.toFixed(2)}%`)),H("div",{className:"character-stats-tooltip-row"},H("span",null,oe.t("sidebar.character_stats.attack_table.suppression")),H("span",null,`${t.suppression.toFixed(2)}%`)),H("div",{className:"character-stats-tooltip-row"},H("span",null,oe.t("sidebar.character_stats.attack_table.to_hit_cap")),H("span",null,`${t.remainingMeleeHitCap.toFixed(2)}%`)),H("div",{className:"character-stats-tooltip-row"},H("span",null,oe.t("sidebar.character_stats.attack_table.to_exp_cap")),H("span",null,`${t.remainingExpertiseCap.toFixed(2)}%`)),0!=t.specSpecificOffset&&H("div",{className:"character-stats-tooltip-row"},H("span",null,oe.t("sidebar.character_stats.attack_table.spec_offsets")),H("span",null,`${t.specSpecificOffset.toFixed(2)}%`)),H("div",{className:"character-stats-tooltip-row"},H("span",null,oe.t("sidebar.character_stats.attack_table.final_crit_cap")),H("span",null,`${t.baseCritCap.toFixed(2)}%`)),H("hr",null),H("div",{className:"character-stats-tooltip-row"},H("span",null,oe.t("sidebar.character_stats.attack_table.can_raise_by")),H("span",null,`${(t.remainingExpertiseCap+t.remainingMeleeHitCap).toFixed(2)}%`)));ie(a,{content:s})}ie(l,{content:y}),b++})}statDisplayString(e,t,a){const s=t.hasRootStat()?t.getRootStat():null;let o=null!==s?e.getStat(s):null,n=t.convertDefaultUnitsToPercent(e.getUnitStat(t));const r=t.equalsStat(ee.StatMasteryRating)?` ${oe.t("sidebar.character_stats.points_suffix")}`:oe.t("sidebar.character_stats.percent_suffix");if(t.equalsStat(ee.StatMasteryRating)&&a)n+=this.player.getBaseMastery();else if(s===ee.StatHitRating&&a&&this.hasRacialHitBonus)null!==o&&o>0&&(o-=ce);else if(t.equalsStat(ee.StatExpertiseRating)&&a){const[e,t]=this.activeRacialExpertiseBonuses;null!==o&&o>0&&e&&(o-=4*he);const a=e&&t,s=this.player.getEquippedItem(i.ItemSlotOffHand);if(!a&&(e||t)&&null!==s&&s.item.weaponType!==A.WeaponTypeShield&&s.item.weaponType!==A.WeaponTypeOffHand){const e=null===o||0===o&&null!==n,a=e?"":String(Math.round(o)),i=`${n.toFixed(2)}`+r,s=`${(n+(t?1:-1)).toFixed(2)}`+r;return a+(e?`${i} / ${s}`:` (${i} / ${s})`)}}const l=null===o||0===o&&null!==n,c=l?"":String(Math.round(o)),h=null===n?"":`${n.toFixed(2)}`+r;return c+(l||null===n?h:` (${h})`)}bonusStatsLink(e){const t=e.getRootStat(),a=(i=t)==ee.StatRangedAttackPower?"Ranged AP":ee[i].split(/(?<![A-Z])(?=[A-Z])/).slice(1).join(" ");var i;const s=U(),o=U(),n=H("button",{ref:s,className:"add-bonus-stats text-white ms-2",dataset:{bsToggle:"popover"}},H("i",{ref:o,className:"fas fa-plus-minus"}));return ie(o.value,{content:`${oe.t("sidebar.character_stats.bonus_prefix")} ${a}`}),ie(s.value,{interactive:!0,trigger:"click",theme:"bonus-stats-popover",placement:"right",onShow:e=>{const i=new rl(null,this.player,{id:`character-bonus-stat-${t}`,label:`${oe.t("sidebar.character_stats.bonus_prefix")} ${a}`,extraCssClasses:["mb-0"],changedEvent:e=>e.bonusStatsChangeEmitter,getValue:e=>e.getBonusStats().getStat(t),setValue:(a,i,s)=>{const o=i.getBonusStats().withStat(t,s);i.setBonusStats(a,o),e?.hide()}});e.setContent(i.rootElem)}}),n}shouldShowMeleeCritCap(e){return e.getPlayerSpec().isMeleeDpsSpec}meleeCritCapDisplayString(e,t){const a=e.getMeleeCritCap();if(0===a)return oe.t("sidebar.character_stats.crit_cap.exact");return`${a>0?oe.t("sidebar.character_stats.crit_cap.over_by"):oe.t("sidebar.character_stats.crit_cap.under_by")} ${Math.abs(a).toFixed(2)}%`}}const cl=new Map([[Q.SecondaryResourceTypeArcaneCharges,{name:"Arcane Charges",icon:"https://wow.zamimg.com/images/wow/icons/medium/spell_arcane_arcane01.jpg"}],[Q.SecondaryResourceTypeShadowOrbs,{name:"Shadow Orbs",icon:"https://wow.zamimg.com/images/wow/icons/medium/spell_priest_shadoworbs.jpg"}],[Q.SecondaryResourceTypeDemonicFury,{name:"Demonic Fury",icon:"https://wow.zamimg.com/images/wow/icons/medium/ability_warlock_eradication.jpg"}],[Q.SecondaryResourceTypeHolyPower,{name:"Holy Power",icon:"https://wow.zamimg.com/images/wow/icons/medium/spell_holy_holybolt.jpg"}],[Q.SecondaryResourceTypeBurningEmbers,{name:"Burning Embers",icon:"https://wow.zamimg.com/images/wow/icons/medium/inv_mace_2h_pvp410_c_01.jpg"}],[Q.SecondaryResourceTypeSoulShards,{name:"Soul Shards",icon:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_gem_amethyst_02.jpg"}]]),hl=new Map([[K.SpecRetributionPaladin,Q.SecondaryResourceTypeHolyPower],[K.SpecProtectionPaladin,Q.SecondaryResourceTypeHolyPower],[K.SpecHolyPaladin,Q.SecondaryResourceTypeHolyPower],[K.SpecAfflictionWarlock,Q.SecondaryResourceTypeSoulShards],[K.SpecDemonologyWarlock,Q.SecondaryResourceTypeDemonicFury],[K.SpecDestructionWarlock,Q.SecondaryResourceTypeBurningEmbers],[K.SpecShadowPriest,Q.SecondaryResourceTypeShadowOrbs],[K.SpecArcaneMage,Q.SecondaryResourceTypeArcaneCharges]]);class dl{constructor(e){const t=dl.getGenericResourcesForSpec(e);this.config=t||null}get name(){return this.config?.name}get icon(){return this.config?.icon}static hasSecondaryResource(e){return hl.has(e)}static getGenericResourcesForSpec(e){const t=hl.get(e);return t?cl.get(t):null}static create(e){return dl.hasSecondaryResource(e)?new dl(e):null}replaceResourceName(e){return e.replaceAll(/{GENERIC_RESOURCE}/g,this.name||"")}}const ul=class e{constructor(e,t,a,i,s){this.name=e,this.ownerName=t,this.index=a,this.isTarget=i,this.isPet=s}equals(e){return this.isTarget==e.isTarget&&this.isPet==e.isPet&&this.index==e.index&&this.name==e.name}toString(){return this.isTarget?`Target ${this.index+1}`:this.isPet?`${this.ownerName} (#${this.index+1}) - ${this.name}`:`${this.name} (#${this.index+1})`}toHTML(){return this.isTarget?H("span",{className:"text-danger"},"[Target ",this.index+1,"]"):this.isPet?H(de,null,H("span",{className:"text-primary"},`[${this.ownerName} ${this.index+1}]`)," - ",this.name):H("span",{className:"text-primary"},`[${this.name} ${this.index+1}]`)}static parseAll(t){return Array.from(t.matchAll(e.parseRegex)).map(t=>{if(t[1])return new e(t[1],"",parseInt(t[2])-1,!0,!1);if(t[3])return new e(t[6],t[4],parseInt(t[5])-1,!1,!0);if(t[7])return new e(t[8],"",parseInt(t[9])-1,!1,!1);throw new Error("Invalid Entity match")})}};ul.parseRegex=/\[(Target (\d+))|(([a-zA-Z0-9]+) \(#(\d+)\) - ([a-zA-Z0-9\s:,]+))|(([a-zA-Z0-9\s]+) \(#(\d+)\))\]/g;let pl=ul;const ml=new Sr;class gl{constructor(e){this.actionIdAsString=null,this.cachedHTML={},this.raw=e.raw,this.logIndex=e.logIndex,this.timestamp=e.timestamp,this.source=e.source,this.target=e.target,this.actionId=e.actionId;try{this.actionIdAsString=this.actionId?.toString()||null}catch{}this.spellSchool=e.spellSchool,this.threat=e.threat,this.activeAuras=[]}toHTML(e=!0){return this.cacheOutput(e,()=>{let t=H(de,null,this.raw);if(!e){const e=/(\[[0-9.-]+\]) (\[[0-9a-zA-Z\s\-()#]+\])?(.*)/;if(this.raw.match(e)){const a=e.exec(this.raw);a&&4==a.length&&(t=H(de,null,a[3]))}}return this.source&&(t=H(de,null,this.source.toHTML()," ",t)),t})}toPrefix(e=!0){let t="";return e&&(t=`[${this.timestamp.toFixed(2)}]`),H(de,null,t,this.source?.toHTML())}formattedTimestamp(){const e=Math.abs(this.timestamp),t=Math.floor(e/60),a=Math.floor(e-60*t),i=(1e3*(e-Math.floor(e))).toFixed();let s=`${String(t).padStart(2,"0")}:${String(a).padStart(2,"0")}:${String(i).padStart(3,"0")}`;return this.timestamp<0&&(s=`-${s}`),s}newActionIdLink(e){const t=this.actionIdAsString?`${this.actionIdAsString}${e||""}`:void 0,a=t?ml.get(t):null;if(a)return a.cloneNode(!0);const i=H("span",{className:"icon icon-sm"}),s=H("a",{className:"log-action",target:"_blank"},H("span",null,i," ",this.actionId.name));return this.actionId?.setBackground(i),this.actionId?.setWowheadHref(s),this.actionId?.setWowheadDataset(s,{useBuffAura:e}),t&&ml.set(t,s.cloneNode(!0)),s}static async parseAll(e){const t=e.logs.split("\n");return Promise.all(t.map((e,t)=>{const a={raw:e,logIndex:t,timestamp:0,source:null,target:null,actionId:null,spellSchool:null,threat:0},i=e.match(/ \(SpellSchool: (-?[0-9]+)\)/);i&&(a.spellSchool=parseInt(i[1]));const s=e.match(/ \(Threat: (-?[0-9]+\.[0-9]+)\)/);s&&(a.threat=parseFloat(s[1]),e=e.substring(0,s.index));const o=e.match(/\[(-?[0-9]+\.[0-9]+)\]\w*(.*)/);if(!o||!o[1])return new gl(a);a.timestamp=parseFloat(o[1]);const n=o[2],r=pl.parseAll(n);return a.source=r[0]||null,a.target=r[1]||null,fl.parse(a)||_l.parse(a)||vl.parse(a)||xl.parse(a)||Cl.parse(a)||Il.parse(a)||El.parse(a)||Al.parse(a)||Promise.resolve(new gl(a))}))}isDamageDealt(){return this instanceof fl}isResourceChanged(){return this instanceof _l}isAuraEvent(){return this instanceof vl}isAuraStacksChange(){return this instanceof xl}isMajorCooldownUsed(){return this instanceof Cl}isCastBegan(){return this instanceof Il}isCastCompleted(){return this instanceof El}isStatChange(){return this instanceof Al}static groupDuplicateTimestamps(e){const t=[];let a=[];return e.forEach(e=>{0==a.length||e.timestamp==a[0].timestamp?a.push(e):(t.push(a),a=[e])}),a.length>0&&t.push(a),t}cacheOutput(e,t){return this.cachedHTML[String(e)]||(this.cachedHTML[String(e)]=t()),this.cachedHTML[String(e)]}}class fl extends gl{constructor(e,t,a,i,s,o,n,r,l,c,h,d,u,p){super(e),this.amount=t,this.type=a,this.miss=i,this.glance=n,this.dodge=r,this.parry=l,this.block=c,this.hit=!i&&!s,this.crit=s,this.crush=o,this.tick=h,this.partialResist1_4=d,this.partialResist2_4=u,this.partialResist3_4=p}isDamage(){return"damage"==this.type}isHealing(){return"healing"==this.type}isShielding(){return"shielding"==this.type}result(){const e="number"==typeof this.spellSchool?Jr.get(this.spellSchool):void 0;return H(de,null,this.isHealing()?"Healed ":"",this.isShielding()?"Shielded ":"",!(this.isHealing()||this.isShielding())&&H(de,null,this.miss?"Miss":this.dodge?"Dodge":this.parry?"Parry":this.block?this.crit?"Critical Block":this.glance?"Blocked Glance":"Block":this.glance?"Glance":this.crit?"Crit":this.crush?"Crush":this.tick?"Tick":"Hit")," ",this.target?.toHTML()||"",this.miss||this.dodge||this.parry?"":H(de,null," ","for"," ",this.isHealing()||this.isShielding()?H("strong",{className:xr("resource-health")},this.amount.toFixed(2)," health"):H("strong",{className:xr("text-danger",e&&`spell-school-${e.toLowerCase()}`)},this.amount.toFixed(2)," damage",e&&H(de,null," (",e,")")),this.partialResist1_4?H(de,null," (10% Resist)"):this.partialResist2_4?H(de,null," (20% Resist)"):this.partialResist3_4?H(de,null," (30% Resist)"):"","."))}toHTML(e=!0){return this.cacheOutput(e,()=>{const t=this.source?.isTarget?"":` (${this.threat.toFixed(2)} Threat)`;return H(de,null,this.toPrefix(e)," ",this.newActionIdLink()," ",this.result(),t)})}static parse(e){const t=e.raw.match(/] (.*?) (tick )?((Miss)|(Hit)|(CriticalBlock)|(Crit)|(Crush)|(GlanceBlock)|(Glance)|(Dodge)|(Parry)|(Block))( \((\d+)% Resist\))?( for (\d+\.\d+) ((damage)|(healing)|(shielding)))?/);return t?Lr.fromLogString(t[1]).fill(e.source?.index).then(a=>{e.actionId=a;const i=t[17]?parseFloat(t[17]):0,s=t[18]||"";return new fl(e,i,s,"Miss"==t[3],"Crit"==t[3]||"CriticalBlock"==t[3],"Crush"==t[3],"Glance"==t[3]||"GlanceBlock"==t[3],"Dodge"==t[3],"Parry"==t[3],"Block"==t[3]||"CriticalBlock"==t[3]||"GlanceBlock"==t[3],Boolean(t[2])&&t[2].includes("tick"),"10"==t[15],"20"==t[15],"30"==t[15])}):null}}const bl=class e extends gl{constructor(e,t,a){super(e),this.dps=t,this.damageLogs=a}static fromLogs(t){const a=gl.groupDuplicateTimestamps(t);let i=[],s=0;return a.map(t=>{t.forEach(e=>{i.push(e),s+=e.amount});const a=i.findIndex(a=>{const i=a.timestamp>t[0].timestamp-e.DPS_WINDOW;return i||(s-=a.amount),i});i=-1==a?[]:i.slice(a);const o=s/e.DPS_WINDOW;return isNaN(o)&&console.warn("NaN dps!"),new e({raw:"",logIndex:t[0].logIndex,timestamp:t[0].timestamp,source:t[0].source,target:null,actionId:null,spellSchool:t[0].spellSchool,threat:0},o,t)})}};bl.DPS_WINDOW=15;let yl=bl;class wl extends gl{constructor(e,t,a,i){super(e),this.threatBefore=t,this.threatAfter=a,this.logs=i}static fromLogs(e){const t=gl.groupDuplicateTimestamps(e.filter(e=>0!=e.threat));let a=0;return t.map(e=>{const t=d(e.map(e=>e.threat)),i=new wl({raw:"",logIndex:e[0].logIndex,timestamp:e[0].timestamp,source:e[0].source,target:e[0].target,actionId:null,spellSchool:e[0].spellSchool,threat:t},a,a+t,e);return a+=t,i})}}class vl extends gl{constructor(e,t,a,i){super(e),this.isGained=t,this.isFaded=a,this.isRefreshed=i}toHTML(e=!0){return this.cacheOutput(e,()=>H(de,null,this.toPrefix(e),"  Aura  ",this.isGained?"gained":this.isFaded?"faded":"refreshed",": ",this.newActionIdLink(!0),"."))}static parse(e){const t=e.raw.match(/Aura ((gained)|(faded)|(refreshed)): (.*)/);return t&&t[5]?Lr.fromLogString(t[5]).fill(e.source?.index).then(a=>{e.actionId=a;const i=t[1];return new vl(e,"gained"==i,"faded"==i,"refreshed"==i)}):null}}class xl extends gl{constructor(e,t,a){super(e),this.oldStacks=t,this.newStacks=a}toHTML(e=!0){return this.cacheOutput(e,()=>H(de,null,this.toPrefix(e)," ",this.newActionIdLink(!0)," stacks: ",this.oldStacks,"  ",this.newStacks,"."))}static parse(e){const t=e.raw.match(/(.*) stacks: ([0-9]+) --> ([0-9]+)/);return t&&t[1]?Lr.fromLogString(t[1]).fill(e.source?.index).then(a=>(e.actionId=a,new xl(e,parseInt(t[2]),parseInt(t[3])))):null}}class Sl extends gl{constructor(e,t,a){super(e),this.gainedAt=e.timestamp,this.fadedAt=t,this.stacksChange=a}static fromLogs(e,t,a){const i=[],s=[];return e.forEach(e=>{if(!e.source||!e.source.equals(t))return;if(e.isAuraStacksChange()){if(e.newStacks<=0)return;const t=i.findIndex(t=>t.gained.actionId.equals(e.actionId)||t.gained.actionId.equalsIgnoringTag(e.actionId));return-1==t?void console.warn("Unmatched aura stacks change log: "+e.actionId.name):void i[t].stacks.push(e)}if(!e.isAuraEvent())return;if(e.isGained)return void i.push({gained:e,stacks:[]});const a=i.findIndex(t=>t.gained.actionId.equals(e.actionId)||t.gained.actionId.equalsIgnoringTag(e.actionId));if(-1==a)return void console.warn("Unmatched aura faded log: "+e.actionId.name);const{gained:o,stacks:n}=i.splice(a,1)[0];s.push(new Sl({raw:e.raw,logIndex:o.logIndex,timestamp:o.timestamp,source:e.source,target:e.target,actionId:o.actionId,spellSchool:e.spellSchool,threat:o.threat},e.timestamp,n)),e.isRefreshed&&i.push({gained:e,stacks:[]})}),i.forEach(e=>{const{gained:t,stacks:i}=e;s.push(new Sl({raw:t.raw,logIndex:t.logIndex,timestamp:t.timestamp,source:t.source,target:t.target,actionId:t.actionId,spellSchool:t.spellSchool,threat:t.threat},a,i))}),s.sort((e,t)=>e.gainedAt-t.gainedAt),s}static populateActiveAuras(e,t){let a=[],i=0;e.forEach(e=>{for(;i<t.length&&t[i].gainedAt<=e.timestamp;)a.push(t[i]),i++;a=a.filter(t=>t.fadedAt>e.timestamp);const s=a.slice();s.sort((e,t)=>pe(e.actionId.name,t.actionId.name)),e.activeAuras=s})}}class _l extends gl{constructor(e,t,a,i,s,o,n){super(e),this.resourceType=t,this.valueBefore=a,this.valueAfter=i,this.isSpend=s,this.total=o,this.secondaryResourceType=n}toHTML(e=!0){return this.cacheOutput(e,()=>{const t=(this.valueAfter-this.valueBefore)*(this.isSpend?-1:1),a=this.resourceType==G.ResourceTypeHealth?this.isSpend?"Lost":"Recovered":this.isSpend?"Spent":"Gained",i=void 0!==this.secondaryResourceType?cl.get(this.secondaryResourceType).name:Qr.get(this.resourceType),s=`resource-${i.replace(/\s/g,"-").toLowerCase()}`;return H(de,null,this.toPrefix(e)," ",a," ",H("strong",{className:s},t.toFixed(1)," ",i)," from ",this.newActionIdLink(),". (",this.valueBefore.toFixed(1),"  ",this.valueAfter.toFixed(1),")")})}resultString(){const e=this.valueAfter-this.valueBefore;return e<0?e.toFixed(1):"+"+e.toFixed(1)}static parse(e){const t=e.raw.match(/(Gained|Spent) (\d+\.?\d*) (\S.+?\S) from (.*?) \((\d+\.?\d*) --> (\d+\.?\d*)\)( of (\d+\.?\d*) total)?/);if(t){const[a,i]=function(e){for(const[t,a]of Qr)if(a.toLowerCase()==e.toLowerCase())return[t,void 0];for(const t of Object.keys(Q).filter(e=>isNaN(Number(e))))if(t.toLowerCase()==e.toLowerCase())return[G.ResourceTypeGenericResource,Q[t]];return[G.ResourceTypeNone,void 0]}(t[3]),s=void 0!==t[8]?parseFloat(t[8]):0;return Lr.fromLogString(t[4]).fill(e.source?.index).then(o=>(e.actionId=o,new _l(e,a,parseFloat(t[5]),parseFloat(t[6]),"Spent"==t[1],s,i)))}return null}}class kl extends gl{constructor(e,t,a,i,s,o){super(e),this.resourceType=t,this.valueBefore=a,this.valueAfter=i,this.maxValue=s,this.logs=o}toHTML(e=!0){return this.cacheOutput(e,()=>H(de,null,this.toPrefix(e)," ",Qr.get(this.resourceType),": ",this.valueBefore.toFixed(1),"  ",this.valueAfter.toFixed(1)))}static fromLogs(t){const a=t.filter(e=>e.isResourceChanged()),i={};return e(G).filter(e=>e!=G.ResourceTypeNone).forEach(e=>{const t=a.filter(t=>t.resourceType==e),s=gl.groupDuplicateTimestamps(t);i[e]=s.map(t=>new kl({raw:"",logIndex:t[0].logIndex,timestamp:t[0].timestamp,source:t[0].source,target:t[0].target,actionId:null,spellSchool:t[0].spellSchool,threat:0},e,t[0].valueBefore,t[t.length-1].valueAfter,function(e){let t=0;return e.forEach(e=>{e.total>t&&(t=e.total)}),t}(t),t))}),i}}class Cl extends gl{constructor(e){super(e)}toHTML(e=!0){return this.cacheOutput(e,()=>H(de,null,this.toPrefix(e)," Major cooldown used: ",this.newActionIdLink(),"."))}static parse(e){const t=e.raw.match(/Major cooldown used: (.*)/);return t?Lr.fromLogString(t[1]).fill(e.source?.index).then(t=>(e.actionId=t,new Cl(e))):null}}class Il extends gl{constructor(e,t,a,i){super(e),this.manaCost=t,this.castTime=a,this.effectiveTime=i}toHTML(e=!0){return this.cacheOutput(e,()=>H(de,null,this.toPrefix(e)," Casting ",this.newActionIdLink()," (Cast time: ",this.castTime.toFixed(2),"s, Cost: ",this.manaCost.toFixed(1)," ","Mana)."))}static parse(e){const t=e.raw.match(/Casting (.*) \(Cost = (\d+\.?\d*), Cast Time = (\d+\.?\d*)(m?s), Effective Time = (\d+\.?\d*)(m?s)\)/);if(t){let a=parseFloat(t[3]);"ms"==t[4]&&(a/=1e3);let i=parseFloat(t[5]);return"ms"==t[6]&&(i/=1e3),Lr.fromLogString(t[1]).fill(e.source?.index).then(s=>(e.actionId=s,new Il(e,parseFloat(t[2]),a,i)))}return null}}class El extends gl{constructor(e){super(e)}toHTML(e=!0){return this.cacheOutput(e,()=>H(de,null,this.toPrefix(e)," Completed cast ",this.actionId.name,"."))}static parse(e){const t=e.raw.match(/Completed cast (.*)/);return t?Lr.fromLogString(t[1]).fill(e.source?.index).then(t=>(e.actionId=t,new El(e))):null}}class Tl extends gl{constructor(e,t,a){super({raw:e.raw,logIndex:e.logIndex,timestamp:e.timestamp,source:e.source,target:e.target,actionId:t?.actionId||e.actionId,spellSchool:t?.spellSchool||e.spellSchool,threat:t?.threat||e.threat}),this.castTime=e.castTime,this.effectiveTime=e.effectiveTime,this.castBeganLog=e,this.castCompletedLog=t,this.damageDealtLogs=a,this.castCompletedLog&&this.castBeganLog&&(this.castTime=this.castCompletedLog.timestamp-this.castBeganLog.timestamp,this.effectiveTime=this.castCompletedLog.timestamp-this.castBeganLog.timestamp),this.castCompletedLog&&this.damageDealtLogs.length>=1&&this.castCompletedLog.timestamp<this.damageDealtLogs[0].timestamp&&!this.damageDealtLogs[0].tick?this.travelTime=this.damageDealtLogs[0].timestamp-this.castCompletedLog.timestamp:this.travelTime=0}toHTML(e=!0){return this.cacheOutput(e,()=>H(de,null,this.toPrefix(e)," Casting ",this.actionId.name," (Cast time = ",this.castTime.toFixed(2),"s)."))}totalDamage(){return d(this.damageDealtLogs.map(e=>e.amount))}static fromLogs(e){const t=e.filter(e=>e.isCastBegan()),a=e.filter(e=>e.isCastCompleted()),i=e.filter(e=>e.isDamageDealt()),s=e=>30451==e.spellId||127632==e.spellId?e.toStringIgnoringTag():e.toString(),o=ue(t,e=>s(e.actionId)),n=ue(a,e=>s(e.actionId)),r=ue(i,e=>s(e.actionId)),l=[];return Object.keys(o).forEach(e=>{const t=o[e],a=n[e],i=r[e];let s=0;for(let o=0;o<t.length;o++){const e=t[o];let n=null,r=null;a&&o<a.length&&(n=a[o],o+1<a.length&&(r=a[o+1]));const c=[];for(;i&&s<i.length&&(!r||i[s].timestamp<r.timestamp);)c.push(i[s]),s++;l.push(new Tl(e,n,c))}}),l.sort((e,t)=>e.timestamp-t.timestamp),l}}class Al extends gl{constructor(e,t,a){super(e),this.isGain=t,this.stats=a}toHTML(e=!0){return this.cacheOutput(e,()=>this.isGain?H(de,null,this.toPrefix(e)," Gained ",this.stats," from ",this.newActionIdLink(),"."):H(de,null,this.toPrefix(e)," Lost ",this.stats," from fading ",this.newActionIdLink(),"."))}static parse(e){const t=e.raw.match(/((Gained)|(Lost)) ({.*}) from (fading )?(.*)/);return t?Lr.fromLogString(t[6]).fill(e.source?.index).then(a=>{e.actionId=a;const i="Lost"==t[1]?-1:1;return new Al(e,1==i,t[4])}):null}}const Pl=new Sr({keysToKeep:2});class Rl{constructor(e,t){this.request=e,this.result=t}get iterations(){return this.request.simOptions?.iterations||1}get duration(){return this.result.avgIterationDuration||1}get firstIterationDuration(){return this.result.firstIterationDuration||1}}class Dl{constructor(e,t,a,i,s){this.id=e.requestId,this.request=e,this.result=t,this.raidMetrics=a,this.encounterMetrics=i,this.logs=s,this.players=a.parties.map(e=>e.players).flat(),this.units=this.players.concat(i.targets)}get iterations(){return this.request.simOptions?.iterations||1}get duration(){return this.result.avgIterationDuration||1}get firstIterationDuration(){return this.result.firstIterationDuration||1}getPlayers(e){if(e?.player||0===e?.player){const t=this.getUnitWithIndex(e.player);return t?[t]:[]}return this.raidMetrics.parties.map(e=>e.players).flat()}getRaidIndexedPlayers(e){if(e?.player||0===e?.player){const t=this.getPlayerWithRaidIndex(e.player);return t?[t]:[]}return this.raidMetrics.parties.map(e=>e.players).flat()}getFirstPlayer(){return this.getPlayers()[0]||null}getPlayerWithIndex(e){return this.players.find(t=>t.unitIndex==e)||null}getPlayerWithRaidIndex(e){return this.players.find(t=>t.index==e)||null}getTargets(e){if(e?.target||0===e?.target){const t=this.getUnitWithIndex(e.target);return t?[t]:[]}return this.encounterMetrics.targets.slice()}getTargetWithIndex(e){return this.getTargets().find(t=>t.unitIndex==e)||null}getTargetWithEncounterIndex(e){return this.getTargets().find(t=>t.index==e)||null}getUnitWithIndex(e){return this.units.find(t=>t.unitIndex==e)||null}getDamageMetrics(e){return e.player||0===e.player?this.getPlayerWithIndex(e.player)?.dps||me.create():this.raidMetrics.dps}getActionMetrics(e){return Fl.joinById(this.getPlayers(e).map(t=>t.getPlayerAndPetActions().map(t=>t.forTarget(e))).flat())}getRaidIndexedActionMetrics(e){return Fl.joinById(this.getRaidIndexedPlayers(e).map(t=>t.getPlayerAndPetActions().map(t=>t.forTarget(e))).flat())}getSpellMetrics(e){return this.getActionMetrics(e).filter(e=>0!=e.hitAttempts&&!e.isMeleeAction)}getMeleeMetrics(e){return this.getActionMetrics(e).filter(e=>0!=e.hitAttempts&&e.isMeleeAction)}getResourceMetrics(e,t){return zl.joinById(this.getPlayers(t).map(t=>t.resources.filter(t=>t.type==e)).flat())}getBuffMetrics(e){return Gl.joinById(this.getPlayers(e).map(e=>e.auras).flat())}getDebuffMetrics(e){return Gl.joinById(this.getTargets(e).map(e=>e.auras).flat()).filter(e=>0!=e.uptimePercent)}toProto(){return ge.create({request:this.request,result:this.result})}static async fromProto(e){return Dl.makeNew(e.request||fe.create(),e.result||be.create())}static async makeNew(e,t){const a=e.requestId,i=Pl.get(a);if(i)return i;const s=new Rl(e,t),o=await gl.parseAll(t),n=Ml.makeNew(s,e.raid,t.raidMetrics,o),r=Ol.makeNew(s,e.encounter,t.encounterMetrics,o),l=await n,c=await r,h=new Dl(e,t,l,c,o);return Pl.set(a,h),h}}class Ml{constructor(e,t,a){this.raid=e,this.metrics=t,this.dps=this.metrics.dps,this.hps=this.metrics.hps,this.parties=a}static async makeNew(e,t,a,i){const s=Math.min(t.parties.length,a.parties.length),o=await Promise.all([...new Array(s).keys()].map(s=>Ll.makeNew(e,t.parties[s],a.parties[s],s,i)));return new Ml(t,a,o)}}class Ll{constructor(e,t,a,i){this.party=e,this.metrics=t,this.partyIndex=a,this.dps=this.metrics.dps,this.hps=this.metrics.hps,this.players=i}static async makeNew(e,t,a,i,s){const o=Math.min(t.players.length,a.players.length),n=await Promise.all([...new Array(o).keys()].filter(e=>t.players[e].class!=q.ClassUnknown).map(o=>Nl.makeNewPlayer(e,t.players[o],a.players[o],5*i+o,!1,s)));return new Ll(t,a,i,n)}}class Nl{constructor(e,t,a,i,s,o,n,r,l,c,h){this.player=e,this.target=t,this.metrics=i,this.index=s,this.unitIndex=i.unitIndex,this.name=i.name,this.spec=this.player?Se(this.player):null,this.petActionId=a,this.iconUrl=this.isPlayer?this.spec?.getIcon("medium")??"":this.isTarget?Gr:"",this.classColor=this.isTarget?"":_e.getPlayerClass(this.spec).friendlyName.toLowerCase().replace(/\s/g,"-")??"",this.dps=this.metrics.dps,this.hps=this.metrics.hps,this.tps=this.metrics.threat,this.dtps=this.metrics.dtps,this.tmi=this.metrics.tmi,this.tto=this.metrics.tto,this.actions=o,this.auras=n,this.resources=r,this.pets=l,this.logs=c,this.iterations=h.iterations,this.duration=h.duration,this.damageDealtLogs=this.logs.filter(e=>e.isDamageDealt()),this.dpsLogs=yl.fromLogs(this.damageDealtLogs),this.castLogs=Tl.fromLogs(this.logs),this.threatLogs=wl.fromLogs(this.logs),this.auraUptimeLogs=Sl.fromLogs(this.logs,new pl(this.name,"",this.index,null!=this.target,this.isPet),h.firstIterationDuration),this.majorCooldownLogs=this.logs.filter(e=>e.isMajorCooldownUsed()),this.groupedResourceLogs=kl.fromLogs(this.logs),Sl.populateActiveAuras(this.dpsLogs,this.auraUptimeLogs),Sl.populateActiveAuras(this.groupedResourceLogs[G.ResourceTypeMana],this.auraUptimeLogs),this.majorCooldownAuraUptimeLogs=this.auraUptimeLogs.filter(e=>this.majorCooldownLogs.find(t=>t.actionId.equals(e.actionId)))}get label(){return null==this.target?`${this.name} (#${this.index+1})`:`${this.name} (${this.target.name})`}get isPlayer(){return null!=this.player}get isTarget(){return null!=this.target}get isPet(){return null!=this.petActionId}getTargetIndex(e){if(!e)return null;const t=this.isPlayer?e.target:e.player;return null==t||-1==t?null:t}get inFrontOfTarget(){return!!this.isTarget||!!this.isPlayer&&this.player.inFrontOfTarget}get chanceOfDeath(){const e=this.metrics.chanceOfDeath,t=Math.sqrt(e*(1-e)/this.iterations);return me.create({avg:100*e,stdev:100*t})}get maxThreat(){return this.threatLogs[this.threatLogs.length-1]?.threatAfter||0}get secondsOomAvg(){return this.metrics.secondsOomAvg}get totalDamage(){return this.dps.avg*this.duration}get totalDamageTaken(){return this.dtps.avg*this.duration}getPlayerAndPetActions(){return this.actions.concat(this.pets.map(e=>e.getPlayerAndPetActions()).flat())}getActionsForDisplay(){return this.actions.filter(e=>0!=e.hitAttempts||0!=e.tps||0!=e.dps)}getMeleeActions(){return this.getActionsForDisplay().filter(e=>e.isMeleeAction)}getMeleeDamageActions(){return this.getMeleeActions().filter(e=>0!==e.dps&&0===e.hps)}getSpellActions(){return this.getActionsForDisplay().filter(e=>!e.isMeleeAction)}getSpellDamageActions(){return this.getSpellActions().filter(e=>0!==e.dps&&0===e.hps)}getDamageActions(){return this.getActionsForDisplay().filter(e=>0!==e.dps&&0===e.hps)}getHealingActions(){return this.getActionsForDisplay()}getResourceMetrics(e){return this.resources.filter(t=>t.type==e)}static async makeNewPlayer(e,t,a,i,s,o){const n=o.filter(e=>e.source&&!e.source.isTarget&&s==e.source.isPet&&(s?e.source.name==a.name:e.source.index==i)),r=o.filter(e=>e.source&&!e.source.isTarget&&e.source.isPet&&e.source.index==i),l=Promise.all(a.actions.map(t=>Fl.makeNew(null,e,t,i))),c=Promise.all(a.auras.map(t=>Gl.makeNew(null,e,t,i))),h=Promise.all(a.resources.map(t=>zl.makeNew(null,e,t,i))),d=Promise.all(a.pets.map(a=>Nl.makeNewPlayer(e,t,a,i,!0,r)));let u=Promise.resolve(null);s&&(u=Lr.fromPetName(a.name).fill(i));const p=await l,m=await c,g=await h,f=await d,b=await u,y=new Nl(t,null,b,a,i,p,m,g,f,n,e);return p.forEach(e=>{e.unit=y,e.resources=g.filter(t=>t.actionId.equals(e.actionId))}),m.forEach(e=>e.unit=y),g.forEach(e=>e.unit=y),y}static async makeNewTarget(e,t,a,i,s){const o=s.filter(e=>e.source&&e.source.isTarget&&e.source.index==i),n=Promise.all(a.actions.map(t=>Fl.makeNew(null,e,t,i))),r=Promise.all(a.auras.map(t=>Gl.makeNew(null,e,t))),l=await n,c=await r,h=new Nl(null,t,null,a,i,l,c,[],[],o,e);return l.forEach(e=>e.unit=h),c.forEach(e=>e.unit=h),h}}class Ol{constructor(e,t,a){this.encounter=e,this.metrics=t,this.targets=a}static async makeNew(e,t,a,i){const s=Math.min(t.targets.length,a.targets.length),o=await Promise.all([...new Array(s).keys()].map(s=>Nl.makeNewTarget(e,t.targets[s],a.targets[s],s,i)));return new Ol(t,a,o)}get durationSeconds(){return this.encounter.duration}}class Gl{constructor(e,t,a,i){this.unit=e,this.actionId=t,this.name=t.name,this.iconUrl=t.iconUrl,this.data=a,this.resultData=i,this.iterations=i.iterations,this.duration=i.duration}get uptimePercent(){return this.data.uptimeSecondsAvg/this.duration*100}get averageProcs(){return this.data.procsAvg}get ppm(){return this.data.procsAvg/(this.duration/60)}static async makeNew(e,t,a,i){const s=await Lr.fromProto(a.id).fill(i);return new Gl(e,s,a,t)}static merge(e,{removeTag:t,actionIdOverride:a}={}){const i=e[0],s=e.every(e=>e.unit==i.unit)?i.unit:null;let o=a||i.actionId;return t&&(o=o.withoutTag()),new Gl(s,o,ve.create({uptimeSecondsAvg:Math.max(...e.map(e=>e.data.uptimeSecondsAvg))}),i.resultData)}static groupById(e,t){return t?Object.values(ue(e,e=>e.actionId.toString())):Object.values(ue(e,e=>e.actionId.toStringIgnoringTag()))}static joinById(e,t){return Gl.groupById(e,t).map(e=>Gl.merge(e))}}class zl{constructor(e,t,a,i){this.unit=e,this.actionId=t,this.name=t.name,this.iconUrl=t.iconUrl,this.type=a.type,this.resultData=i,this.iterations=i.iterations,this.duration=i.duration,this.data=a}get events(){return this.data.events/this.iterations}get gain(){return this.data.gain/this.iterations}get gainPerSecond(){return this.data.gain/this.iterations/this.duration}get avgGain(){return this.data.gain/this.data.events}get wastedGain(){return(this.data.gain-this.data.actualGain)/this.iterations}static async makeNew(e,t,a,i){const s=await Lr.fromProto(a.id).fill(i);return new zl(e,s,a,t)}static merge(e,{removeTag:t,actionIdOverride:a}={}){const i=e[0],s=e.every(e=>e.unit==i.unit)?i.unit:null;let o=a||i.actionId;return t&&(o=o.withoutTag()),new zl(s,o,we.create({events:d(e.map(e=>e.data.events)),gain:d(e.map(e=>e.data.gain)),actualGain:d(e.map(e=>e.data.actualGain))}),i.resultData)}static groupById(e,t){return t?Object.values(ue(e,e=>e.actionId.toString())):Object.values(ue(e,e=>e.actionId.toStringIgnoringTag()))}static joinById(e,t){return zl.groupById(e,t).map(e=>zl.merge(e))}}class Fl{constructor(e,t,a,i){this.unit=e,this.actionId=t,this.name=t.name,this.iconUrl=t.iconUrl,this.resultData=i,this.iterations=i.iterations,this.duration=i.duration,this.data=a,this.spellSchool=a.spellSchool,this.targets=a.targets.map(e=>new Hl(e,{iterations:this.iterations,duration:this.duration})),this.combinedMetrics=Hl.merge(this.targets),this.resources=[]}get isMeleeAction(){return this.data.isMelee}get isPassiveAction(){return this.data.isPassive}get totalDamageTakenPercent(){const e=this.resultData.result.encounterMetrics?.targets?.[this.unit?.unitIndex||0].dps?.avg;if(e)return this.avgDamage/(e*this.duration)*100}get totalDamagePercent(){const e=this.resultData.result.raidMetrics?.dps?.avg;if(e)return this.avgDamage/(e*this.duration)*100}get damage(){return this.combinedMetrics.damage}get avgDamage(){return this.combinedMetrics.damage/this.iterations}get avgHitDamage(){return this.avgDamage-this.avgTickDamage-this.avgCritDamage+this.avgCritTickDamage-this.avgGlanceDamage-this.avgGlanceBlockDamage-this.avgBlockDamage-this.avgCritBlockDamage}get critDamage(){return this.combinedMetrics.critDamage}get avgCritDamage(){return this.combinedMetrics.avgCritDamage}get tickDamage(){return this.combinedMetrics.tickDamage}get avgTickDamage(){return this.combinedMetrics.avgTickDamage}get critTickDamage(){return this.combinedMetrics.critTickDamage}get avgCritTickDamage(){return this.combinedMetrics.avgCritTickDamage}get glanceDamage(){return this.combinedMetrics.glanceDamage}get avgGlanceDamage(){return this.combinedMetrics.avgGlanceDamage}get glanceBlockDamage(){return this.combinedMetrics.glanceBlockDamage}get avgGlanceBlockDamage(){return this.combinedMetrics.avgGlanceBlockDamage}get blockDamage(){return this.combinedMetrics.blockDamage}get avgBlockDamage(){return this.combinedMetrics.avgBlockDamage}get critBlockDamage(){return this.combinedMetrics.critBlockDamage}get avgCritBlockDamage(){return this.combinedMetrics.avgCritBlockDamage}get dps(){return this.combinedMetrics.dps}get totalHealingPercent(){const e=this.resultData.result.raidMetrics?.hps?.avg;if(e)return this.avgHealing/(e*this.duration)*100}get healing(){return this.combinedMetrics.healing}get avgHealing(){return this.combinedMetrics.healing/this.iterations}get critHealing(){return this.combinedMetrics.critHealing}get avgCritHealing(){return this.combinedMetrics.critHealing/this.iterations}get hps(){return this.combinedMetrics.hps}get tps(){return this.combinedMetrics.tps}get casts(){return this.isPassiveAction?0:this.combinedMetrics.casts}get castsPerMinute(){return this.isPassiveAction?0:this.combinedMetrics.castsPerMinute}get avgCastTimeMs(){return this.isPassiveAction?0:this.combinedMetrics.avgCastTimeMs}get hpm(){const e=this.combinedMetrics.hps*this.duration,t=this.resources.find(e=>e.type==G.ResourceTypeMana);return t?e/-t.gain:0}get damageThroughput(){return this.unit?.isPet&&!this.actionId.spellId?0:this.combinedMetrics.damageThroughput}get healingThroughput(){return this.combinedMetrics.healingThroughput}get shielding(){return this.combinedMetrics.shielding}get avgCast(){return this.isPassiveAction?0:this.combinedMetrics.avgCast}get avgCastHit(){return this.combinedMetrics.avgCast?this.combinedMetrics.avgCast-this.avgCastTick:0}get avgCastTick(){return this.combinedMetrics.avgCastTick}get avgCastHealing(){return this.isPassiveAction?0:this.combinedMetrics.avgCastHealing}get avgCastThreat(){return this.isPassiveAction?0:this.combinedMetrics.avgCastThreat}get landedHits(){return this.combinedMetrics.landedHits}get landedTicks(){return this.combinedMetrics.landedTicks}get hitAttempts(){return this.combinedMetrics.hitAttempts}get avgHit(){return this.combinedMetrics.avgHit}get avgTick(){return this.combinedMetrics.avgTick}get avgHitHealing(){return this.combinedMetrics.avgHitHealing}get avgHitThreat(){return this.combinedMetrics.avgHitThreat}get totalMisses(){return this.misses+this.dodges+this.parries}get totalMissesPercent(){return this.missPercent+this.dodgePercent+this.parryPercent}get misses(){return this.combinedMetrics.misses}get missPercent(){return this.combinedMetrics.missPercent}get dodges(){return this.combinedMetrics.dodges}get dodgePercent(){return this.combinedMetrics.dodgePercent}get parries(){return this.combinedMetrics.parries}get parryPercent(){return this.combinedMetrics.parryPercent}get hits(){return this.combinedMetrics.hits}get hitPercent(){return this.combinedMetrics.hitPercent}get ticks(){return this.combinedMetrics.ticks}get critTicks(){return this.combinedMetrics.critTicks}get critTickPercent(){return this.combinedMetrics.critTickPercent}get blocks(){return this.combinedMetrics.blocks}get blockPercent(){return this.combinedMetrics.blockPercent}get critBlocks(){return this.combinedMetrics.critBlocks}get critBlockPercent(){return this.combinedMetrics.critBlockPercent}get glances(){return this.combinedMetrics.glances}get glancePercent(){return this.combinedMetrics.glancePercent}get glanceBlocks(){return this.combinedMetrics.glanceBlocks}get glanceBlocksPercent(){return this.combinedMetrics.glanceBlocksPercent}get crits(){return this.combinedMetrics.crits}get critPercent(){return this.combinedMetrics.critPercent}get healingPercent(){return this.combinedMetrics.healingPercent}get healingCritPercent(){return this.combinedMetrics.healingCritPercent}get damageDone(){const e=this.avgDamage-this.avgTickDamage-this.avgCritDamage+this.avgCritTickDamage-this.avgGlanceDamage-this.avgGlanceBlockDamage-this.avgBlockDamage-this.avgCritBlockDamage,t=this.avgTickDamage-this.avgCritTickDamage,a=this.avgCritDamage-this.avgCritTickDamage;return{hit:{value:e,percentage:e/this.avgDamage*100,average:e/this.hits},critHit:{value:a,percentage:a/this.avgDamage*100,average:a/this.crits},tick:{value:t,percentage:t/this.avgDamage*100,average:t/this.ticks},critTick:{value:this.avgCritTickDamage,percentage:this.avgCritTickDamage/this.avgDamage*100,average:this.avgCritTickDamage/this.critTicks},glance:{value:this.avgGlanceDamage,percentage:this.avgGlanceDamage/this.avgDamage*100,average:this.avgGlanceDamage/this.glances},glanceBlock:{value:this.avgGlanceBlockDamage,percentage:this.avgGlanceBlockDamage/this.avgDamage*100,average:this.avgGlanceBlockDamage/this.glanceBlocks},block:{value:this.avgBlockDamage,percentage:this.avgBlockDamage/this.avgDamage*100,average:this.avgBlockDamage/this.blocks},critBlock:{value:this.avgCritBlockDamage,percentage:this.avgCritBlockDamage/this.avgDamage*100,average:this.avgCritBlockDamage/this.critBlocks}}}forTarget(e){const t=this.unit.getTargetIndex(e);if(null==t)return this;{const e=this.targets.find(e=>e.data.unitIndex==t);if(e){const t=ye.clone(this.data);return t.targets=[e.data],new Fl(this.unit,this.actionId,t,this.resultData)}throw new Error("Could not find target with unitIndex "+t)}}static async makeNew(e,t,a,i){const s=await Lr.fromProto(a.id).fill(i);return new Fl(e,s,a,t)}static merge(e,{removeTag:t,actionIdOverride:a}={}){const i=e[0],s=i.unit;let o=a||i.actionId;t&&(o=o.withoutTag());const n=Math.max(...e.map(e=>e.targets.length)),r=[...Array(n).keys()].map(t=>Hl.merge(e.map(e=>e.targets[t]))),l=e.every(e=>e.isPassiveAction);return new Fl(s,o,ye.create({isMelee:i.isMeleeAction,isPassive:l,targets:r.map(e=>e.data),spellSchool:i.spellSchool||void 0}),i.resultData)}static groupById(e,t){return t?Object.values(ue(e,e=>e.actionId.toString())):Object.values(ue(e,e=>e.actionId.toStringIgnoringTag()))}static joinById(e,t){return Fl.groupById(e,t).map(e=>Fl.merge(e))}}class Hl{constructor(e,{iterations:t,duration:a}){this.iterations=t,this.duration=a,this.data=e,this.landedHitsRaw=this.data.hits+this.data.crits+this.data.blocks+this.data.critBlocks+this.data.glances+this.data.glanceBlocks,this.landedTicksRaw=this.data.ticks+this.data.critTicks,this.hitAttempts=this.data.misses+this.data.dodges+this.data.parries+this.data.critBlocks+this.data.blocks+this.data.glances+this.data.glanceBlocks+this.data.crits,0!==this.data.hits?this.hitAttempts+=this.data.hits:0===this.data.hits&&this.data.ticks>0&&(this.hitAttempts+=this.data.casts)}get damage(){return this.data.damage}get avgDamage(){return this.data.damage/this.iterations}get critDamage(){return this.data.critDamage}get avgCritDamage(){return this.data.critDamage/this.iterations}get tickDamage(){return this.data.tickDamage}get avgTickDamage(){return this.data.tickDamage/this.iterations}get critTickDamage(){return this.data.critTickDamage}get avgCritTickDamage(){return this.data.critTickDamage/this.iterations}get glanceDamage(){return this.data.glanceDamage}get avgGlanceDamage(){return this.data.glanceDamage/this.iterations}get glanceBlockDamage(){return this.data.glanceBlockDamage}get avgGlanceBlockDamage(){return this.data.glanceBlockDamage/this.iterations}get blockDamage(){return this.data.blockDamage}get avgBlockDamage(){return this.data.blockDamage/this.iterations}get critBlockDamage(){return this.data.critBlockDamage}get avgCritBlockDamage(){return this.data.critBlockDamage/this.iterations}get dps(){return this.data.damage/this.iterations/this.duration}get healing(){return this.data.healing+this.data.shielding}get avgHealing(){return(this.data.healing+this.data.shielding)/this.iterations}get critHealing(){return this.data.critHealing}get avgCritHealing(){return this.data.critHealing/this.iterations}get shielding(){return this.data.shielding}get hps(){return(this.data.healing+this.data.shielding)/this.iterations/this.duration}get tps(){return this.data.threat/this.iterations/this.duration}get casts(){return this.data.casts/this.iterations}get castsPerMinute(){return this.casts/(this.duration/60)}get avgCastTimeMs(){return this.data.castTimeMs/this.iterations/this.casts}get damageThroughput(){return this.avgCastTimeMs?this.avgCast/(this.avgCastTimeMs/1e3):0}get healingThroughput(){return this.avgCastTimeMs?this.hps/(this.avgCastTimeMs/1e3):0}get timeSpentCastingMs(){return this.data.castTimeMs/this.iterations}get avgCast(){return this.casts?this.data.damage/this.iterations/(this.casts||1):0}get avgCastTick(){return this.data.tickDamage/this.iterations/(this.casts||1)}get avgCastHealing(){return(this.data.healing+this.data.shielding)/this.iterations/(this.casts||1)}get avgCastThreat(){return this.data.threat/this.iterations/(this.casts||1)}get landedHits(){return this.landedHitsRaw/this.iterations}get landedTicks(){return this.landedTicksRaw/this.iterations}get avgHit(){const e=this.landedHitsRaw;return 0==e?0:(this.data.damage-this.data.tickDamage)/e}get avgTick(){const e=this.landedTicksRaw;return 0==e?0:this.data.tickDamage/e}get avgHitHealing(){return(this.data.healing+this.data.shielding)/this.iterations/(this.landedHits||this.landedTicks)}get avgHitThreat(){const e=this.landedHitsRaw;return 0==e?0:this.data.threat/e}get totalMisses(){return this.misses+this.dodges+this.parries}get totalMissesPercent(){return this.missPercent+this.dodgePercent+this.parryPercent}get misses(){return this.data.misses/this.iterations}get missPercent(){return this.data.misses/this.hitAttempts*100}get dodges(){return this.data.dodges/this.iterations}get dodgePercent(){return this.data.dodges/this.hitAttempts*100}get parries(){return this.data.parries/this.iterations}get parryPercent(){return this.data.parries/this.hitAttempts*100}get hits(){return this.data.hits/this.iterations}get hitPercent(){return this.data.hits/this.hitAttempts*100}get ticks(){return this.data.ticks/this.iterations}get critTicks(){return this.data.critTicks/this.iterations}get critTickPercent(){return this.data.critTicks/(this.data.ticks+this.data.critTicks)*100}get blocks(){return this.data.blocks/this.iterations}get blockPercent(){return this.data.blocks/this.hitAttempts*100}get critBlocks(){return this.data.critBlocks/this.iterations}get critBlockPercent(){return this.data.critBlocks/this.hitAttempts*100}get glances(){return this.data.glances/this.iterations}get glancePercent(){return this.data.glances/this.hitAttempts*100}get glanceBlocks(){return this.data.glanceBlocks/this.iterations}get glanceBlocksPercent(){return this.data.glanceBlocks/this.hitAttempts*100}get crits(){return this.data.crits/this.iterations}get critPercent(){return this.data.crits/this.hitAttempts*100}get healingPercent(){return(this.healing-this.critHealing)/this.healing*100}get healingCritPercent(){return this.data.critHealing/this.healing*100}static merge(e){const{iterations:t=1,duration:a=1}=e[0];return new Hl(xe.create({casts:d(e.map(e=>e.data.casts)),hits:d(e.map(e=>e.data.hits)),crits:d(e.map(e=>e.data.crits)),ticks:d(e.map(e=>e.data.ticks)),critTicks:d(e.map(e=>e.data.critTicks)),misses:d(e.map(e=>e.data.misses)),dodges:d(e.map(e=>e.data.dodges)),parries:d(e.map(e=>e.data.parries)),blocks:d(e.map(e=>e.data.blocks)),critBlocks:d(e.map(e=>e.data.critBlocks)),glances:d(e.map(e=>e.data.glances)),glanceBlocks:d(e.map(e=>e.data.glanceBlocks)),damage:d(e.map(e=>e.data.damage)),critDamage:d(e.map(e=>e.data.critDamage)),tickDamage:d(e.map(e=>e.data.tickDamage)),critTickDamage:d(e.map(e=>e.data.critTickDamage)),glanceDamage:d(e.map(e=>e.data.glanceDamage)),glanceBlockDamage:d(e.map(e=>e.data.glanceBlockDamage)),blockDamage:d(e.map(e=>e.data.blockDamage)),critBlockDamage:d(e.map(e=>e.data.critBlockDamage)),threat:d(e.map(e=>e.data.threat)),healing:d(e.map(e=>e.data.healing)),critHealing:d(e.map(e=>e.data.critHealing)),shielding:d(e.map(e=>e.data.shielding)),castTimeMs:d(e.map(e=>e.data.castTimeMs))}),{iterations:t,duration:a})}}class Ul extends F{constructor(e){super(e.parent,e.rootCssClass||"result-component"),this.resetCallbacks=[],this.lastSimResult=null,e.resultsEmitter.on((e,t)=>{t&&(this.lastSimResult=t,this.onSimResult(t))})}hasLastSimResult(){return!!this.lastSimResult}getLastSimResult(){if(this.lastSimResult)return this.lastSimResult;throw new Error("No last sim result!")}addOnResetCallback(e){this.resetCallbacks.push(e)}reset(){this.resetCallbacks.forEach(e=>e()),this.resetCallbacks=[]}}class Bl{constructor(e){if(this.rowData=[],this.sortCol=-1,this.sortFunc=(e,t)=>{const a=e.values[this.sortCol],i=t.values[this.sortCol],s=!this.sortDesc[this.sortCol];return"number"==typeof a&&"number"==typeof i?s?a-i:i-a:s?a.toString().localeCompare(i.toString()):i.toString().localeCompare(a.toString())},void 0===e.tableHead.cells[e.defaultSortCol])throw new Error("Default sort column must be a valid header cell index!");this.cfg=e,this.sortCol=this.cfg.defaultSortCol,this.sortDesc=Array(e.tableHead.cells.length).fill(!0),this.sortDesc[e.defaultSortCol]=e.defaultSortDesc,Array.from(e.tableHead.cells).forEach((e,t)=>{e.addEventListener("click",()=>this.setSort(t))})}sort(){if(!this.rowData.length||!(this.sortCol in this.rowData[0].values))return;const e=[];this.rowData.sort(this.sortFunc);for(const t of this.rowData)e.push(t.rowElement),t.children&&(t.children.sort(this.sortFunc),e.push(...t.children.map(e=>e.rowElement)));this.cfg.tableBody.replaceChildren(...e)}setSort(e=-1){void 0===this.sortDesc[e]&&(e=this.cfg.defaultSortCol),this.sortDesc[e]=!this.sortDesc[e],this.sortCol=e,this.sort()}parseRowValues(e){const t=[];for(const a of e.cells){const e=a.dataset[this.cfg.dataSetKey]??a.innerText,i=parseFloat(e);t.push(isNaN(i)?e:i)}return t}update(){this.rowData.length=0;for(const e of this.cfg.tableBody.rows){const t=this.parseRowValues(e);if(e.classList.contains(this.cfg.childRowClass)){const a=this.rowData[this.rowData.length-1];if(!a)throw new Error("Child row has no parent!");a.children||(a.children=[]),a.children.push({values:t,rowElement:e})}else this.rowData.push({values:t,rowElement:e})}this.sort()}}var Wl=(e=>(e[e.None=0]="None",e[e.Ascending=1]="Ascending",e[e.Descending=2]="Descending",e))(Wl||{});const Vl=new Sr;class jl extends Ul{constructor(e,t){super(e),this.onUpdate=new te("MetricsTableUpdate"),this.columnConfigs=t,this.rootElem.appendChild(H("table",{className:"metrics-table tablesorter"},H("thead",{className:"metrics-table-header"},H("tr",{className:"metrics-table-header-row"})),H("tbody",{className:"metrics-table-body"}))),this.tableElem=this.rootElem.querySelector(".metrics-table"),this.bodyElem=this.rootElem.querySelector(".metrics-table-body");const a=this.rootElem.querySelector(".metrics-table-header-row");this.columnConfigs.forEach(e=>{const t=document.createElement("th"),i=e.tooltip;if(t.classList.add("metrics-table-header-cell"),e.columnClass&&t.classList.add(...e.columnClass.split(" ")),e.headerCellClass&&t.classList.add(...e.headerCellClass.split(" ")),t.appendChild(H("span",null,e.name)),i){const e=ie(t,{content:i,ignoreAttributes:!0});this.addOnResetCallback(()=>e.destroy())}a.appendChild(t)});const i=this.columnConfigs.findIndex(e=>!!e.sort);this.sorter=new Bl({tableHead:a,tableBody:this.bodyElem,dataSetKey:"text",childRowClass:"child-metric",defaultSortCol:-1!==i?i:0,defaultSortDesc:-1!==i&&2==this.columnConfigs[i].sort})}sortMetrics(e){this.columnConfigs.filter(e=>e.sort).forEach(t=>{if(!t.getValue)throw new Error("Can' apply group sorting without getValue");1==t.sort?e.sort((e,a)=>t.getValue(e)-t.getValue(a)):e.sort((e,a)=>t.getValue(a)-t.getValue(e))})}addRow(e,t=!1){const a=document.createElement("tr");return this.bodyElem.appendChild(a),this.columnConfigs.forEach(i=>{const s=document.createElement("td");if(i.getValue&&(s.dataset.text=String(i.getValue(e,t))),i.columnClass&&s.classList.add(i.columnClass),i.fillCell)i.fillCell(e,s,a,t);else{if(!i.getDisplayString)throw new Error("Metrics column config does not provide content function: "+i.name);s.textContent=i.getDisplayString(e,t)}a.appendChild(s)}),this.customizeRowElem(e,a,t),a}addGroup(e){if(0==e.length)return;if(1==e.length&&this.shouldCollapse(e[0]))return void this.addRow(e[0]);this.sortMetrics(e);const t=this.mergeMetrics(e),a=this.addRow(t),i=e.map(e=>this.addRow(e,!0));i.forEach(e=>e.classList.add("child-metric"));let s=!0;a.classList.add("parent-metric","expand"),a.addEventListener("click",()=>{s=!s,s?(i.forEach(e=>e.classList.remove("hide")),a.classList.add("expand")):(i.forEach(e=>e.classList.add("hide")),a.classList.remove("expand"))})}onSimResult(e){this.reset();const t=this.getGroupedMetrics(e).filter(e=>e.length>0);if(!t.length)return this.rootElem.classList.add("hide"),void this.onUpdate.emit(e.eventID);this.rootElem.classList.remove("hide"),t.forEach(e=>this.addGroup(e)),this.sorter.update(),this.onUpdate.emit(e.eventID)}reset(){super.reset(),this.bodyElem.replaceChildren()}shouldCollapse(e){return!0}customizeRowElem(e,t,a=!1){}mergeMetrics(e){return e[0]}static nameCellConfig(e){return{name:oe.t("results_tab.details.columns.name"),fillCell:(t,a,i)=>{const s=e(t),o=s.actionId.toString(),n=U(),r=Vl.get(o);a.appendChild(H("div",{className:"metrics-action"},r?.cloneNode()||H("a",{ref:n,className:"metrics-action-icon"}),H("span",{className:"metrics-action-name text-truncate"},s.name),H("span",{className:"expand-toggle fa fa-caret-right"}),H("span",{className:"expand-toggle fa fa-caret-down"}))),!r&&n.value&&(s.actionId.setBackgroundAndHref(n.value),s.actionId.setWowheadDataset(n.value,{useBuffAura:"AuraMetrics"===s.metricType}),Vl.set(o,n.value))}}}static playerNameCellConfig(){return{name:oe.t("results_tab.details.columns.name"),columnClass:"name-cell",fillCell:(e,t,a)=>{t.appendChild(H(de,null,H("img",{className:"metrics-action-icon",src:e.iconUrl}),H("span",{className:`metrics-action-name text-${e.classColor}`},e.label)))}}}}class Yl extends jl{constructor(e,t){e.rootCssClass=t?"debuff-metrics-root":"buff-metrics-root",super(e,[jl.nameCellConfig(e=>({name:e.name,actionId:e.actionId,metricType:e?.constructor?.name})),{name:oe.t("results_tab.details.columns.procs"),getValue:e=>e.averageProcs,getDisplayString:e=>e.averageProcs.toFixed(2)},{name:oe.t("results_tab.details.columns.ppm"),getValue:e=>e.ppm,getDisplayString:e=>e.ppm.toFixed(2)},{name:oe.t("results_tab.details.columns.uptime"),sort:Wl.Descending,getValue:e=>e.uptimePercent,getDisplayString:e=>e.uptimePercent.toFixed(2)+"%"}]),this.useDebuffs=t}getGroupedMetrics(e){if(this.useDebuffs)return Gl.groupById(e.result.getDebuffMetrics(e.filter));{const t=e.result.getRaidIndexedPlayers(e.filter);if(1!=t.length)return[];const a=t[0],i=this.filterMetrics(a.auras),s=Gl.groupById(i),o=a.pets.map(e=>this.filterMetrics(e.auras));return s.concat(o)}}mergeMetrics(e){return Gl.merge(e,{removeTag:!0,actionIdOverride:e[0].unit?.petActionId||void 0})}shouldCollapse(e){return!e.unit?.isPet}filterMetrics(e){return e.filter(e=>!e.unit?.isPet)}}class ql extends jl{constructor(e){e.rootCssClass="cast-metrics-root",super(e,[jl.nameCellConfig(e=>({name:e.name,actionId:e.actionId,metricType:e.constructor?.name})),{name:oe.t("results_tab.details.columns.casts"),sort:Wl.Descending,getValue:e=>e.casts,getDisplayString:e=>e.casts.toFixed(1)},{name:oe.t("results_tab.details.columns.cpm"),getValue:e=>e.castsPerMinute,getDisplayString:e=>e.castsPerMinute.toFixed(1)}])}getGroupedMetrics(e){const t=e.result.getRaidIndexedPlayers(e.filter);if(1!=t.length)return[];const a=t[0],i=a.actions.filter(e=>0!=e.casts).map(t=>t.forTarget(e.filter)),s=Fl.groupById(i),o=a.pets.map(t=>t.actions.filter(e=>0!=e.casts).map(t=>t.forTarget(e.filter)));return s.concat(o)}mergeMetrics(e){return Fl.merge(e,{removeTag:!0,actionIdOverride:e[0].unit?.petActionId||void 0})}shouldCollapse(e){return!e.unit?.isPet}}const Xl=({percentage:e,max:t,total:a,value:i,overlayValue:s,spellSchool:o,classColor:n})=>{const r="number"==typeof o?Jr.get(o):void 0;return H("div",{className:"metrics-total position-relative d-flex justify-content-between w-100"},H("div",{className:"metrics-total-percentage"},Ce(e||0)),H("div",{className:"metrics-total-bar ms-1 me-1"},H("div",{className:xr("metrics-total-bar-fill",r&&`bg-spell-school-${r.toLowerCase()}`,n&&`bg-${n.toLowerCase()}`),style:{"--percentage":Ce(i/(t??1)*100)}}),s?H("div",{className:"metrics-total-bar-fill bg-black bg-opacity-25",style:{"--percentage":Ce(s/(t??1)*100)}}):void 0),H("div",{className:"metrics-total-amount"},ke(a)))},$l=({tooltipElement:e,tooltipConfig:t,headerValues:a,groups:i,hasMetricBars:s=!0})=>{const o=i.filter(e=>e.data.some(e=>e.value)).map(e=>({...e,data:e.data.filter(e=>e.value)})),n=o.some(e=>e.data.find(e=>"number"==typeof e.average));return i.length&&ie(e,{placement:"auto",theme:"metrics-table",maxWidth:"none",...t,content:H("table",{className:"metrics-table"},H("thead",{className:"metrics-table-header"},H("tr",{className:"metrics-table-header-row"},H("th",{className:"metrics-table-header-cell"},a?.[0]||oe.t("results_tab.details.tooltip_table.type")),H("th",{className:"metrics-table-header-cell"},a?.[1]||oe.t("results_tab.details.tooltip_table.count")),n?H("th",{className:"metrics-table-header-cell"},a?.[2]||oe.t("results_tab.details.tooltip_table.average")):void 0)),H("tbody",{className:"metrics-table-body"},o.map(({name:e,cssClass:t,data:a,spellSchool:i,totalPercentage:n})=>{const r=Math.max(...a.map(e=>e.value)),l=a.some(e=>"number"==typeof e.average)?3:2;return H(de,null,e&&o.length>1?H("tr",{className:xr("metrics-table-group-header",t)},H("th",{className:"text-start fw-normal",colSpan:l},e)):void 0,a.sort((e,t)=>t.value-e.value).map(({name:e,value:a,percentage:o,average:l})=>H(de,null,H("tr",{className:xr(t)},H("td",null,e),H("td",null,s?H(Xl,{spellSchool:i,percentage:o/n*100,max:r,total:a,value:a}):ke(a)),"number"==typeof l?H("td",null,ke(l)):void 0))))})))}),H(de,null)};class Zl extends jl{constructor(e){e.rootCssClass="damage-metrics-root",e.resultsEmitter.on((e,t)=>{const a=t?this.getGroupedMetrics(t).filter(e=>e.length).map(e=>this.mergeMetrics(e)):void 0;this.maxDamageAmount=Math.max(...(a||[]).map(e=>e.damage))}),super(e,[jl.nameCellConfig(e=>({name:e.name,actionId:e.actionId,metricType:e.constructor?.name})),{name:oe.t("results_tab.details.columns.damage_done"),headerCellClass:"text-center metrics-table-cell--primary-metric",columnClass:"metrics-table-cell--primary-metric",getValue:e=>e.avgDamage,fillCell:(e,t)=>{t.appendChild(H(Xl,{spellSchool:e.spellSchool,percentage:e.totalDamagePercent,max:this.maxDamageAmount,total:e.avgDamage,value:e.damage}));const a=e.damageDone.hit,i=e.damageDone.critHit,s=e.damageDone.tick,o=e.damageDone.critTick,n=e.damageDone.glance,r=e.damageDone.glanceBlock,l=e.damageDone.block,c=e.damageDone.critBlock;t.appendChild(H($l,{tooltipElement:t,headerValues:[,oe.t("results_tab.details.tooltip_table.amount")],groups:[{spellSchool:e.spellSchool,total:e.damage,totalPercentage:100,data:[{name:oe.t("results_tab.details.attack_types.hit"),...a},{name:oe.t("results_tab.details.attack_types.critical_hit"),...i},{name:oe.t("results_tab.details.attack_types.tick"),...s},{name:oe.t("results_tab.details.attack_types.critical_tick"),...o},{name:oe.t("results_tab.details.attack_types.glancing_blow"),...n},{name:oe.t("results_tab.details.attack_types.blocked_glancing_blow"),...r},{name:oe.t("results_tab.details.attack_types.blocked_hit"),...l},{name:oe.t("results_tab.details.attack_types.blocked_critical_hit"),...c}]}]}))}},{name:oe.t("results_tab.details.columns.casts"),getValue:e=>e.casts,fillCell:(e,t)=>{if(t.appendChild(H(de,null,se(e.casts,{fallbackString:"-"}))),!e.landedHits&&!e.totalMisses||e.isPassiveAction)return;const a=(e.landedHits||e.casts)/((e.landedHits||e.casts)+e.totalMisses)*100;t.appendChild(H($l,{tooltipElement:t,groups:[{spellSchool:e.spellSchool,total:e.casts,totalPercentage:100,data:[{name:oe.t("results_tab.details.attack_types.hit")+"s",value:e.landedHits||e.casts-e.totalMisses,percentage:a},{name:oe.t("results_tab.details.attack_types.miss"),value:e.misses,percentage:e.missPercent},{name:oe.t("results_tab.details.attack_types.parry"),value:e.parries,percentage:e.parryPercent},{name:oe.t("results_tab.details.attack_types.dodge"),value:e.dodges,percentage:e.dodgePercent}]}]}))}},{name:oe.t("results_tab.details.columns.avg_cast"),tooltip:oe.t("results_tab.details.tooltips.damage_avg_cast_tooltip"),getValue:e=>e.isPassiveAction?0:e.avgCastHit||e.avgCastTick,fillCell:(e,t)=>{t.appendChild(H(de,null,e.isPassiveAction?"-":H(de,null,ke(e.avgCastHit||e.avgCastTick,{fallbackString:"-"}),e.avgCastHit&&e.avgCastTick?H(de,null," (",ke(e.avgCastTick,{fallbackString:"-"}),")"):void 0))),(e.avgCastHit||e.avgCastTick)&&t.appendChild(H($l,{tooltipElement:t,tooltipConfig:{onShow:()=>{if(!!document.querySelector(".hide-threat-metrics"))return!1}},headerValues:[,oe.t("results_tab.details.tooltip_table.amount")],groups:[{spellSchool:e.spellSchool,total:e.avgCastThreat,totalPercentage:100,data:[{name:oe.t("results_tab.details.attack_types.threat"),value:e.avgCastThreat,percentage:100}]}]}))}},{name:oe.t("results_tab.details.columns.hits"),getValue:e=>e.landedHits||e.landedTicks,fillCell:(e,t)=>{if(t.appendChild(H(de,null,se(e.landedHits||e.landedTicks,{fallbackString:"-"}),e.landedHits&&e.landedTicks?H(de,null," (",se(e.landedTicks,{fallbackString:"-"}),")"):void 0)),!e.landedHits&&!e.landedTicks)return;const a=e.hits/e.landedHits*100,i=e.crits/e.landedHits*100,s=e.ticks/e.landedTicks*100,o=e.critTicks/e.landedTicks*100,n=e.glances/e.landedHits*100,r=e.glanceBlocks/e.landedHits*100,l=e.blocks/e.landedHits*100,c=e.critBlocks/e.landedHits*100;t.appendChild(H($l,{tooltipElement:t,groups:[{spellSchool:e.spellSchool,total:e.landedHits,totalPercentage:100,data:[{name:oe.t("results_tab.details.attack_types.hit"),value:e.hits,percentage:a},{name:oe.t("results_tab.details.attack_types.critical_hit"),value:e.crits,percentage:i},{name:oe.t("results_tab.details.attack_types.glancing_blow"),value:e.glances,percentage:n},{name:oe.t("results_tab.details.attack_types.blocked_glancing_blow"),value:e.glanceBlocks,percentage:r},{name:oe.t("results_tab.details.attack_types.blocked_hit"),value:e.blocks,percentage:l},{name:oe.t("results_tab.details.attack_types.blocked_critical_hit"),value:e.critBlocks,percentage:c}]},{spellSchool:e.spellSchool,total:e.landedTicks,totalPercentage:100,data:[{name:oe.t("results_tab.details.attack_types.tick"),value:e.ticks,percentage:s},{name:oe.t("results_tab.details.attack_types.critical_tick"),value:e.critTicks,percentage:o}]}]}))}},{name:oe.t("results_tab.details.columns.avg_hit"),getValue:e=>e.avgHit||e.avgTick,fillCell:(e,t)=>{t.appendChild(H(de,null,ke(e.avgHit||e.avgTick,{fallbackString:"-"}),e.avgHit&&e.avgTick?H(de,null," (",ke(e.avgTick,{fallbackString:"-"}),")"):void 0)),e.avgHitThreat&&t.appendChild(H($l,{tooltipElement:t,tooltipConfig:{onShow:()=>{if(!!document.querySelector(".hide-threat-metrics"))return!1}},headerValues:[,oe.t("results_tab.details.tooltip_table.amount")],groups:[{spellSchool:e.spellSchool,total:e.avgHitThreat,totalPercentage:100,data:[{name:oe.t("results_tab.details.attack_types.threat"),value:e.avgHitThreat,percentage:100}]}]}))}},{name:oe.t("results_tab.details.columns.crit_percent"),getValue:e=>e.critPercent+e.critBlockPercent||e.critTickPercent,getDisplayString:e=>`${Ce(e.critPercent+e.critBlockPercent||e.critTickPercent,{fallbackString:"-"})}${e.critPercent+e.critBlockPercent&&e.critTickPercent?` (${Ce(e.critTickPercent,{fallbackString:"-"})})`:""}`},{name:oe.t("results_tab.details.columns.miss_percent"),getValue:e=>e.totalMissesPercent,fillCell:(e,t)=>{t.appendChild(H(de,null,Ce(e.totalMissesPercent,{fallbackString:"-"}))),e.totalMissesPercent&&t.appendChild(H($l,{tooltipElement:t,groups:[{spellSchool:e.spellSchool,total:e.totalMisses,totalPercentage:e.totalMissesPercent,data:[{name:oe.t("results_tab.details.attack_types.miss"),value:e.misses,percentage:e.missPercent},{name:oe.t("results_tab.details.attack_types.parry"),value:e.parries,percentage:e.parryPercent},{name:oe.t("results_tab.details.attack_types.dodge"),value:e.dodges,percentage:e.dodgePercent}]}]}))}},{name:oe.t("results_tab.details.columns.dpet"),getValue:e=>e.damageThroughput,getDisplayString:e=>ke(e.damageThroughput,{fallbackString:"-"})},{name:oe.t("results_tab.details.columns.dps"),headerCellClass:"text-body",columnClass:"text-success",sort:Wl.Descending,getValue:e=>e.dps,fillCell:(e,t)=>{t.appendChild(H(de,null,se(e.dps,{minimumFractionDigits:2,fallbackString:"-"}))),e.dps&&t.appendChild(H($l,{tooltipElement:t,tooltipConfig:{onShow:()=>{if(!!document.querySelector(".hide-threat-metrics"))return!1}},headerValues:[,oe.t("results_tab.details.tooltip_table.amount")],groups:[{spellSchool:e.spellSchool,total:e.tps,totalPercentage:100,data:[{name:oe.t("results_tab.details.attack_types.threat"),value:e.tps,percentage:100}]}]}))}}]),this.maxDamageAmount=null}customizeRowElem(e,t){0==e.hitAttempts&&0==e.dps&&t.classList.add("threat-metrics")}getGroupedMetrics(e){const t=e.result.getRaidIndexedPlayers(e.filter);if(1!=t.length)return[];const a=t[0],i=a.getDamageActions().map(t=>t.forTarget(e.filter)),s=Fl.groupById(i),o=ue(a.pets,e=>e.name),n=Object.values(o).map(t=>Fl.joinById(t.flatMap(t=>t.getDamageActions().map(t=>t.forTarget(e.filter))),!0));return s.concat(n)}mergeMetrics(e){return Fl.merge(e,{removeTag:!0,actionIdOverride:e[0]?.unit?.petActionId||void 0})}shouldCollapse(e){return!e.unit?.isPet}}class Kl extends Ul{constructor(e){e.rootCssClass="dps-histogram-root",super(e)}onSimResult(e){const t=this.rootElem.getBoundingClientRect();this.rootElem.textContent="";const a=document.createElement("canvas");a.height=t.height,a.width=t.width;const i=e.result.getDamageMetrics(e.filter),s=i.avg-i.stdev,o=i.avg+i.stdev,n=[],r=[],l=Object.keys(i.hist);l.forEach((e,t)=>{n.push(i.hist[Number(e)]);const a=parseInt(e);a>s&&a<o?r.push("#1E87F0"):r.push("#FF6961")});const c=a.getContext("2d");this.rootElem.appendChild(a);const h=new Ie(c,{type:"bar",data:{labels:l,datasets:[{data:n,backgroundColor:r}]},options:{plugins:{title:{display:!0,text:oe.t("results_tab.details.damage.dps_histogram")},legend:{display:!1,labels:{}}},scales:{y:{beginAtZero:!0,ticks:{display:!1}}}}});this.addOnDisposeCallback(()=>h.destroy())}}class Jl extends jl{constructor(e){e.rootCssClass="dtps-metrics-root",e.resultsEmitter.on((e,t)=>{const a=t?this.getGroupedMetrics(t).filter(e=>e.length).map(e=>this.mergeMetrics(e)):void 0;this.maxDtpsAmount=Math.max(...(a||[]).map(e=>e.damage))}),super(e,[jl.nameCellConfig(e=>({name:e.name,actionId:e.actionId,metricType:e.constructor?.name})),{name:oe.t("results_tab.details.columns.damage_taken"),headerCellClass:"text-center metrics-table-cell--primary-metric",columnClass:"metrics-table-cell--primary-metric",getValue:e=>e.avgDamage,fillCell:(e,t)=>{t.appendChild(H(Xl,{spellSchool:e.spellSchool,percentage:e.totalDamageTakenPercent,max:this.maxDtpsAmount,total:e.avgDamage,value:e.damage}));const a=e.damageDone.hit,i=e.damageDone.critHit,s=e.damageDone.tick,o=e.damageDone.critTick,n=e.damageDone.glance,r=e.damageDone.glanceBlock,l=e.damageDone.block,c=e.damageDone.critBlock;t.appendChild(H($l,{tooltipElement:t,headerValues:[,oe.t("results_tab.details.tooltip_table.amount")],groups:[{spellSchool:e.spellSchool,total:e.damage,totalPercentage:100,data:[{name:oe.t("results_tab.details.attack_types.hit"),...a},{name:oe.t("results_tab.details.attack_types.critical_hit"),...i},{name:oe.t("results_tab.details.attack_types.tick"),...s},{name:oe.t("results_tab.details.attack_types.critical_tick"),...o},{name:oe.t("results_tab.details.attack_types.glancing_blow"),...n},{name:oe.t("results_tab.details.attack_types.blocked_glancing_blow"),...r},{name:oe.t("results_tab.details.attack_types.blocked_hit"),...l},{name:oe.t("results_tab.details.attack_types.blocked_critical_hit"),...c}]}]}))}},{name:oe.t("results_tab.details.columns.casts"),getValue:e=>e.casts,fillCell:(e,t)=>{if(t.appendChild(H(de,null,se(e.casts,{fallbackString:"-"}))),!e.landedHits&&!e.totalMisses||e.isPassiveAction)return;const a=(e.landedHits||e.casts)/((e.landedHits||e.casts)+e.totalMisses)*100;t.appendChild(H($l,{tooltipElement:t,groups:[{spellSchool:e.spellSchool,total:e.casts,totalPercentage:100,data:[{name:oe.t("results_tab.details.attack_types.hit")+"s",value:e.landedHits||e.casts-e.totalMisses,percentage:a},{name:oe.t("results_tab.details.attack_types.miss"),value:e.misses,percentage:e.missPercent},{name:oe.t("results_tab.details.attack_types.parry"),value:e.parries,percentage:e.parryPercent},{name:oe.t("results_tab.details.attack_types.dodge"),value:e.dodges,percentage:e.dodgePercent}]}]}))}},{name:oe.t("results_tab.details.columns.avg_cast"),tooltip:oe.t("results_tab.details.tooltips.damage_avg_cast_tooltip"),getValue:e=>e.isPassiveAction?0:e.avgCastHit||e.avgCastTick,fillCell:(e,t)=>{t.appendChild(H(de,null,ke(e.avgCastHit||e.avgCastTick,{fallbackString:"-"}),e.avgCastHit&&e.avgCastTick?H(de,null," (",ke(e.avgCastTick,{fallbackString:"-"}),")"):void 0))}},{name:oe.t("results_tab.details.columns.hits"),getValue:e=>e.landedHits||e.landedTicks,fillCell:(e,t)=>{if(t.appendChild(H(de,null,se(e.landedHits||e.landedTicks,{fallbackString:"-"}),e.landedHits&&e.landedTicks?H(de,null," (",se(e.landedTicks,{fallbackString:"-"}),")"):void 0)),!e.landedHits&&!e.landedTicks)return;const a=e.hits/e.landedHits*100,i=e.crits/e.landedHits*100,s=e.ticks/e.landedTicks*100,o=e.critTicks/e.landedTicks*100,n=e.glances/e.landedHits*100,r=e.glanceBlocks/e.landedHits*100,l=e.blocks/e.landedHits*100,c=e.critBlocks/e.landedHits*100;t.appendChild(H($l,{tooltipElement:t,groups:[{spellSchool:e.spellSchool,total:e.landedHits,totalPercentage:100,data:[{name:oe.t("results_tab.details.attack_types.hit"),value:e.hits,percentage:a},{name:oe.t("results_tab.details.attack_types.critical_hit"),value:e.crits,percentage:i},{name:oe.t("results_tab.details.attack_types.glancing_blow"),value:e.glances,percentage:n},{name:oe.t("results_tab.details.attack_types.blocked_glancing_blow"),value:e.glanceBlocks,percentage:r},{name:oe.t("results_tab.details.attack_types.blocked_hit"),value:e.blocks,percentage:l},{name:oe.t("results_tab.details.attack_types.blocked_critical_hit"),value:e.critBlocks,percentage:c}]},{spellSchool:e.spellSchool,total:e.landedTicks,totalPercentage:100,data:[{name:oe.t("results_tab.details.attack_types.tick"),value:e.ticks,percentage:s},{name:oe.t("results_tab.details.attack_types.critical_tick"),value:e.critTicks,percentage:o}]}]}))}},{name:oe.t("results_tab.details.columns.avg_hit"),getValue:e=>e.avgHit||e.avgTick,fillCell:(e,t)=>{t.appendChild(H(de,null,ke(e.avgHit||e.avgTick,{fallbackString:"-"}),e.avgHit&&e.avgTick?H(de,null," (",ke(e.avgTick,{fallbackString:"-"}),")"):void 0))}},{name:oe.t("results_tab.details.columns.miss_percent"),tooltip:oe.t("results_tab.details.tooltips.hit_miss_percent_tooltip"),getValue:e=>e.totalMissesPercent,fillCell:(e,t)=>{t.appendChild(H(de,null,Ce(e.totalMissesPercent,{fallbackString:"-"}))),e.totalMissesPercent&&t.appendChild(H($l,{tooltipElement:t,groups:[{spellSchool:e.spellSchool,total:e.totalMisses,totalPercentage:e.totalMissesPercent,data:[{name:oe.t("results_tab.details.attack_types.miss"),value:e.misses,percentage:e.missPercent},{name:oe.t("results_tab.details.attack_types.parry"),value:e.parries,percentage:e.parryPercent},{name:oe.t("results_tab.details.attack_types.dodge"),value:e.dodges,percentage:e.dodgePercent}]}]}))}},{name:oe.t("results_tab.details.columns.crit_percent"),getValue:e=>e.critPercent+e.critBlockPercent||e.critTickPercent,getDisplayString:e=>`${Ce(e.critPercent+e.critBlockPercent||e.critTickPercent,{fallbackString:"-"})}${e.critPercent+e.critBlockPercent&&e.critTickPercent?` (${Ce(e.critTickPercent,{fallbackString:"-"})})`:""}`},{name:oe.t("results_tab.details.columns.dtps"),sort:Wl.Descending,headerCellClass:"text-body",columnClass:"text-success",getValue:e=>e.dps,getDisplayString:e=>se(e.dps,{minimumFractionDigits:2,fallbackString:"-"})}]),this.maxDtpsAmount=null}getGroupedMetrics(e){const t=e.result.getRaidIndexedPlayers(e.filter);if(1!=t.length)return[];const a=t[0],i=e.result.getTargets(e.filter).map(e=>e.getDamageActions().map(e=>e.forTarget({player:a.unitIndex}))).flat();return Fl.groupById(i)}mergeMetrics(e){return Fl.merge(e,{removeTag:!0,actionIdOverride:e[0].unit?.petActionId||void 0})}}class Ql extends jl{constructor(e){e.rootCssClass="healing-metrics-root",e.resultsEmitter.on((e,t)=>{const a=t?this.getGroupedMetrics(t).filter(e=>e.length).map(e=>this.mergeMetrics(e)):void 0;this.maxHealingAmount=Math.max(...(a||[]).map(e=>e.healing))}),super(e,[jl.nameCellConfig(e=>({name:e.name,actionId:e.actionId,metricType:e.constructor?.name})),{name:oe.t("results_tab.details.columns.healing_done"),headerCellClass:"text-center metrics-table-cell--primary-metric",columnClass:"metrics-table-cell--primary-metric",getValue:e=>e.avgHealing,fillCell:(e,t)=>{t.appendChild(H(Xl,{spellSchool:e.spellSchool,percentage:e.totalHealingPercent,max:this.maxHealingAmount,total:e.avgHealing,value:e.healing,overlayValue:e.shielding})),t.appendChild(H($l,{tooltipElement:t,groups:[{spellSchool:e.spellSchool,total:e.avgHealing,totalPercentage:100,data:[{name:oe.t("results_tab.details.attack_types.hit"),value:e.avgHealing-e.avgCritHealing,percentage:e.healingPercent,average:(e.avgHealing-e.avgCritHealing)/(e.hits||e.ticks)},{name:oe.t("results_tab.details.attack_types.critical_hit"),value:e.avgCritHealing,percentage:e.healingCritPercent,average:e.avgCritHealing/(e.crits||e.critTicks)}]}]}))}},{name:oe.t("results_tab.details.columns.casts"),getValue:e=>e.casts,getDisplayString:e=>se(e.casts,{fallbackString:"-"})},{name:oe.t("results_tab.details.columns.cpm"),getValue:e=>e.castsPerMinute,getDisplayString:e=>se(e.castsPerMinute,{fallbackString:"-"})},{name:oe.t("results_tab.details.columns.cast_time"),getValue:e=>e.avgCastTimeMs,getDisplayString:e=>se(e.avgCastTimeMs/1e3,{minimumFractionDigits:2,fallbackString:"-"})},{name:oe.t("results_tab.details.columns.avg_cast"),tooltip:oe.t("results_tab.details.tooltips.healing_avg_cast_tooltip"),getValue:e=>e.avgCastHealing,fillCell:(e,t)=>{t.appendChild(H(de,null,ke(e.avgCastHealing,{fallbackString:"-"}))),e.avgCastHealing&&t.appendChild(H($l,{tooltipElement:t,tooltipConfig:{onShow:()=>{if(!!document.querySelector(".hide-threat-metrics"))return!1}},headerValues:[,oe.t("results_tab.details.tooltip_table.amount")],groups:[{spellSchool:e.spellSchool,total:e.avgCastThreat,totalPercentage:100,data:[{name:oe.t("results_tab.details.attack_types.threat"),value:e.avgCastThreat,percentage:100}]}]}))}},{name:oe.t("results_tab.details.columns.hits"),tooltip:oe.t("results_tab.details.tooltips.healing_hits_tooltip"),getValue:e=>e.landedHits,fillCell:(e,t)=>{if(t.appendChild(H(de,null,se(e.landedHits,{fallbackString:"-"}),e.landedTicks?H(de,null," (",se(e.landedTicks,{fallbackString:"-"}),")"):void 0," ")),!e.landedHits&&!e.landedTicks)return;const a=e.hits/e.landedHits*100,i=e.crits/e.landedHits*100,s=e.ticks/e.landedTicks*100,o=e.critTicks/e.landedTicks*100,n=e.glances/e.landedHits*100,r=e.blocks/e.landedHits*100,l=e.critBlocks/e.landedHits*100;t.appendChild(H($l,{tooltipElement:t,groups:[{spellSchool:e.spellSchool,total:e.landedHits,totalPercentage:100,name:"Hits",data:[{name:oe.t("results_tab.details.attack_types.hit"),value:e.hits,percentage:a},{name:oe.t("results_tab.details.attack_types.critical_hit"),value:e.crits,percentage:i},{name:oe.t("results_tab.details.attack_types.glancing_blow"),value:e.glances,percentage:n},{name:oe.t("results_tab.details.attack_types.blocked_hit"),value:e.blocks,percentage:r},{name:oe.t("results_tab.details.attack_types.blocked_critical_hit"),value:e.critBlocks,percentage:l}]},{spellSchool:e.spellSchool,total:e.landedTicks,totalPercentage:100,name:"Ticks",data:[{name:oe.t("results_tab.details.attack_types.tick"),value:e.ticks,percentage:s},{name:oe.t("results_tab.details.attack_types.critical_tick"),value:e.critTicks,percentage:o}]}]}))}},{name:oe.t("results_tab.details.columns.avg_hit"),tooltip:oe.t("results_tab.details.tooltips.healing_avg_hit_tooltip"),getValue:e=>e.avgHitHealing,fillCell:(e,t)=>{t.appendChild(H(de,null,ke(e.avgHitHealing,{fallbackString:"-"}))),e.avgHitHealing&&t.appendChild(H($l,{tooltipElement:t,tooltipConfig:{onShow:()=>{if(!!document.querySelector(".hide-threat-metrics"))return!1}},headerValues:[,oe.t("results_tab.details.tooltip_table.amount")],groups:[{spellSchool:e.spellSchool,total:e.avgHitThreat,totalPercentage:100,data:[{name:oe.t("results_tab.details.attack_types.threat"),value:e.avgHitThreat,percentage:100}]}]}))}},{name:oe.t("results_tab.details.columns.hpm"),getValue:e=>e.hpm,getDisplayString:e=>ke(e.hpm,{fallbackString:"-"})},{name:oe.t("results_tab.details.columns.crit_percent"),getValue:e=>e.critPercent||e.critTickPercent,getDisplayString:e=>Ce(e.critPercent||e.critTickPercent,{fallbackString:"-"})},{name:oe.t("results_tab.details.columns.hpet"),getValue:e=>e.healingThroughput,getDisplayString:e=>ke(e.healingThroughput,{fallbackString:"-"})},{name:oe.t("results_tab.details.columns.hps"),sort:Wl.Descending,headerCellClass:"text-body",columnClass:"text-success",getValue:e=>e.hps,fillCell:(e,t)=>{t.appendChild(H(de,null,se(e.hps,{minimumFractionDigits:2}))),t.appendChild(H($l,{tooltipElement:t,tooltipConfig:{onShow:()=>{if(!!document.querySelector(".hide-threat-metrics"))return!1}},headerValues:[,oe.t("results_tab.details.tooltip_table.amount")],groups:[{spellSchool:e.spellSchool,total:e.tps,totalPercentage:100,data:[{name:oe.t("results_tab.details.attack_types.threat"),value:e.tps,percentage:100}]}]}))}}]),this.maxHealingAmount=null}customizeRowElem(e,t){0==e.hitAttempts&&0==e.hps&&t.classList.add("threat-metrics")}getGroupedMetrics(e){const t=e.result.getRaidIndexedPlayers(e.filter);if(1!=t.length)return[];const a=t[0].getHealingActions().filter(e=>e.hps>0);return Fl.groupById(a)}mergeMetrics(e){return Fl.merge(e,{removeTag:!0,actionIdOverride:e[0]?.unit?.petActionId||void 0})}shouldCollapse(e){return!e.unit?.isPet}}var ec,tc,ac,ic,sc,oc,nc,rc,lc,cc,hc,dc;function uc(){if(oc)return sc;oc=1;var e=function(){if(ic)return ac;ic=1;var e=/\s/;return ac=function(t){for(var a=t.length;a--&&e.test(t.charAt(a)););return a}}(),t=/^\s+/;return sc=function(a){return a?a.slice(0,e(a)+1).replace(t,""):a}}function pc(){if(cc)return lc;cc=1;var e=uc(),t=Pe(),a=function(){if(rc)return nc;rc=1;var e=Te(),t=Ae();return nc=function(a){return"symbol"==typeof a||t(a)&&"[object Symbol]"==e(a)}}(),i=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,o=/^0o[0-7]+$/i,n=parseInt;return lc=function(r){if("number"==typeof r)return r;if(a(r))return NaN;if(t(r)){var l="function"==typeof r.valueOf?r.valueOf():r;r=t(l)?l+"":l}if("string"!=typeof r)return 0===r?r:+r;r=e(r);var c=s.test(r);return c||o.test(r)?n(r.slice(2),c?2:8):i.test(r)?NaN:+r}}const mc=Re(function(){if(dc)return hc;dc=1;var e=Pe(),t=function(){if(tc)return ec;tc=1;var e=Ee();return ec=function(){return e.Date.now()}}(),a=pc(),i=Math.max,s=Math.min;return hc=function(o,n,r){var l,c,h,d,u,p,m=0,g=!1,f=!1,b=!0;if("function"!=typeof o)throw new TypeError("Expected a function");function y(e){var t=l,a=c;return l=c=void 0,m=e,d=o.apply(a,t)}function w(e){var t=e-p;return void 0===p||t>=n||t<0||f&&e-m>=h}function v(){var e=t();if(w(e))return x(e);u=setTimeout(v,function(e){var t=n-(e-p);return f?s(t,h-(e-m)):t}(e))}function x(e){return u=void 0,b&&l?y(e):(l=c=void 0,d)}function S(){var e=t(),a=w(e);if(l=arguments,c=this,p=e,a){if(void 0===u)return function(e){return m=e,u=setTimeout(v,n),g?y(e):d}(p);if(f)return clearTimeout(u),u=setTimeout(v,n),y(p)}return void 0===u&&(u=setTimeout(v,n)),d}return n=a(n)||0,e(r)&&(g=!!r.leading,h=(f="maxWait"in r)?i(a(r.maxWait)||0,n):h,b="trailing"in r?!!r.trailing:b),S.cancel=function(){void 0!==u&&clearTimeout(u),m=0,l=p=c=u=void 0},S.flush=function(){return void 0===u?d:x(t())},S}}());class gc extends nl{constructor(e,t,a){super(e,"boolean-picker-root",t,a),this.rootElem.classList.add("form-check"),this.inputElem=document.createElement("input"),this.inputElem.type="checkbox",this.inputElem.id=a.id,this.inputElem.classList.add("boolean-picker-input","form-check-input"),a.reverse?(this.rootElem.classList.add("form-check-reverse"),this.rootElem.appendChild(this.inputElem)):this.rootElem.prepend(this.inputElem),this.init(),this.inputElem.addEventListener("change",()=>{this.inputChanged(te.nextEventID())},{signal:this.signal})}getInputElem(){return this.inputElem}getInputValue(){return Boolean(this.inputElem.checked)}setInputValue(e){this.inputElem.checked=e}}class fc extends Ul{constructor(e){e.rootCssClass="log-runner-root",super(e),this.virtualScroll=null,this.showDebugChangeEmitter=new te("Show Debug"),this.showDebug=!1,this.cacheOutput={cacheKey:null,logs:null,logsAsHTML:null,logsAsText:null};const t=U(),a=U(),i=U(),s=U(),o=U();this.rootElem.appendChild(H(de,null,H("div",{ref:a,className:"log-runner-actions"},H("input",{ref:t,type:"text",className:"form-control log-search-input",placeholder:oe.t("common.filter")}),H("button",{ref:i,className:"btn btn-primary order-last log-runner-scroll-to-top-btn"},oe.t("results_tab.details.logs.top_button"))),H("div",{ref:s,className:"log-runner-scroll"},H("table",{className:"metrics-table log-runner-table"},H("thead",null,H("tr",{className:"metrics-table-header-row"},H("th",null,oe.t("results_tab.details.logs.time_column")),H("th",null,H("div",{className:"d-flex align-items-end"},oe.t("results_tab.details.logs.event_column"))))),H("tbody",{ref:o,className:"log-runner-logs"}))))),this.ui={search:t.value,actions:a.value,buttonToTop:i.value,scrollContainer:s.value,contentContainer:o.value};const n=()=>{this.searchLogs(this.ui.search.value)};this.ui.search?.addEventListener("input",mc(n,150)),this.ui.buttonToTop?.addEventListener("click",()=>{this.virtualScroll?.scrollToTop()}),new gc(this.ui.actions,this,{id:"log-runner-show-debug",extraCssClasses:["show-debug-picker"],label:oe.t("results_tab.details.logs.show_debug"),inline:!0,reverse:!0,changedEvent:()=>this.showDebugChangeEmitter,getValue:()=>this.showDebug,setValue:(e,t,a)=>{this.showDebug=a,this.showDebugChangeEmitter.emit(e)}}),this.showDebugChangeEmitter.on(()=>{n()}),this.initializeClusterize()}initializeClusterize(){this.virtualScroll=new bc({scrollContainer:this.ui.scrollContainer,contentContainer:this.ui.contentContainer,itemHeight:32})}searchLogs(e){const t=/"([^"]+)"|\S+/g;let a;const i=[];for(;a=t.exec(e);)i.push(a[1]?a[1].toLowerCase():a[0].toLowerCase());const s=this.cacheOutput.logsAsHTML?.filter((e,t)=>{const a=this.cacheOutput.logsAsText[t],s=this.cacheOutput.logs[t].raw;return!(!this.showDebug&&s.match(/.*\[DEBUG\].*/))&&i.every(e=>e.startsWith('"')&&e.endsWith('"')?a.includes(e.slice(1,-1)):a.includes(e))});s&&this.virtualScroll?.setItems(s)}onSimResult(e){this.getLogs(e),this.searchLogs(this.ui.search.value)}getLogs(e){if(!e)return[];const t=e.result.request.requestId;if(this.cacheOutput.cacheKey===t)return this.cacheOutput.logsAsHTML;const a=e.result.logs.filter(e=>!e.isCastCompleted());this.cacheOutput.cacheKey=t,this.cacheOutput.logs=a,this.cacheOutput.logsAsHTML=a.map(e=>this.renderItem(e)),this.cacheOutput.logsAsText=this.cacheOutput.logsAsHTML.map(e=>De(e).trim().toLowerCase())}renderItem(e){return H("tr",null,H("td",{className:"log-timestamp"},e.formattedTimestamp()),H("td",{className:"log-evdsfent"},e.toHTML(!1).cloneNode(!0)))}}class bc{constructor({scrollContainer:e,contentContainer:t,itemHeight:a}){this.scrollContainer=e,this.contentContainer=t,this.items=[],this.itemHeight=a,this.visibleItemsCount=50,this.startIndex=0,this.placeholderTop=document.createElement("div"),this.placeholderBottom=document.createElement("div"),t.prepend(this.placeholderTop),t.append(this.placeholderBottom),this.attachScrollListener()}scrollToTop(){this.scrollContainer.scrollTop=0,this.startIndex=0,this.updateVisibleItems()}setItems(e){this.items=e,this.scrollToTop()}attachScrollListener(){this.scrollContainer.addEventListener("scroll",()=>{const e=Math.floor(this.scrollContainer.scrollTop/this.itemHeight);e!==this.startIndex&&(this.startIndex=e,this.updateVisibleItems())})}updateVisibleItems(){const e=this.startIndex+this.visibleItemsCount,t=this.items.slice(this.startIndex,e),a=this.items.length-e;this.placeholderTop.style.height=this.startIndex*this.itemHeight+"px",this.placeholderBottom.style.height=a*this.itemHeight+"px",this.contentContainer.replaceChildren(H(de,null,this.placeholderTop,t.map(e=>e),this.placeholderBottom))}}const yc=["#dd9933","#67074e","#5a175d","#074e67","#05878a","#c9c1e7","#bdd5ef","#c7e3d0","#e7e6ce","#f2d8cc","#e9ccce"];class wc extends F{constructor(e,t){const a=document.createElement("canvas");super(e,"source-chart-root",a),a.style.height="400px",a.style.width="600px",a.height=400,a.width=600;const i=t.filter(e=>e.damage>0).sort((e,t)=>t.damage-e.damage),s=i.map(e=>e.name),o=d(i.map(e=>e.damage)),n=i.map(e=>e.damage/o),r=yc.slice(0,i.length),l=a.getContext("2d"),c=new Ie(l,{type:"pie",data:{labels:s,datasets:[{data:n,backgroundColor:r}]},options:{plugins:{legend:{display:!0,position:"right"}}}});this.addOnDisposeCallback(()=>c.destroy())}}class vc extends jl{constructor(e,t){e.rootCssClass="player-damage-metrics-root",super(e,[jl.playerNameCellConfig(),{name:oe.t("results_tab.details.columns.amount"),tooltip:oe.t("results_tab.details.tooltips.player_damage"),headerCellClass:"amount-header-cell text-center",fillCell:(e,t,a)=>{t.classList.add("amount-cell");let i=null;const s=()=>{const t=document.createElement("div");a.appendChild(t);const i=e.getPlayerAndPetActions().map(e=>e.forTarget(this.resultsFilter.getFilter())).flat();return new wc(t,i),t};ie(a,{content:"Loading...",placement:"bottom",ignoreAttributes:!0,onShow(e){i||(i=s(),e.setContent(i))}});const o=this.getPlayerDps(e);t.appendChild(H(Xl,{classColor:e.classColor,max:this.maxDps,percentage:o/this.raidDps*100,value:o,total:o*this.getLastSimResult().result.duration}))}},{name:oe.t("results_tab.details.columns.dps"),tooltip:oe.t("results_tab.details.tooltips.dps"),columnClass:"dps-cell",sort:Wl.Descending,getValue:e=>this.getPlayerDps(e),getDisplayString:e=>this.getPlayerDps(e).toFixed(1)}]),this.resultsFilter=t,this.raidDps=0,this.maxDps=0}getPlayerDps(e){const t=e.getPlayerAndPetActions().map(e=>e.forTarget(this.resultsFilter.getFilter())).flat();return d(t.map(e=>e.dps))}customizeRowElem(e,t){t.classList.add("player-damage-row"),t.addEventListener("click",()=>{this.resultsFilter.setPlayer(this.getLastSimResult().eventID,e.index)})}getGroupedMetrics(e){const t=e.result.getPlayers(e.filter),a=t.map(t=>t.getPlayerAndPetActions().map(t=>t.forTarget(e.filter))).flat();this.raidDps=d(a.map(e=>e.dps));const i=Me(t.map(t=>{const a=t.getPlayerAndPetActions().map(t=>t.forTarget(e.filter)).flat();return d(a.map(e=>e.dps))})),s=t[i].getPlayerAndPetActions().map(t=>t.forTarget(e.filter)).flat();return this.maxDps=d(s.map(e=>e.dps)),t.map(e=>[e])}}class xc extends jl{constructor(e,t){e.rootCssClass="player-damage-taken-metrics-root",super(e,[jl.playerNameCellConfig(),{name:oe.t("results_tab.details.columns.amount"),tooltip:oe.t("results_tab.details.tooltips.player_damage_taken"),headerCellClass:"amount-header-cell text-center",fillCell:(e,t,a)=>{t.classList.add("amount-cell");let i=null;const s=()=>{const t=document.createElement("div");if(a.appendChild(t),this.resultData){const a=this.resultData.result.getTargets(this.resultData.filter),i={player:e.unitIndex},s=a.map(e=>e.getPlayerAndPetActions().map(e=>e.forTarget(i))).flat();new wc(t,s)}return t};ie(a,{content:"Loading...",placement:"bottom",ignoreAttributes:!0,onShow(e){i||(i=s(),e.setContent(i))}});const o=this.getPlayerDtps(e);t.appendChild(H(Xl,{classColor:e.classColor,max:this.maxDtps,percentage:o/this.raidDtps*100,value:o,total:o*this.resultData.result.duration}))}},{name:oe.t("results_tab.details.columns.dtps"),tooltip:oe.t("results_tab.details.tooltips.dtps"),columnClass:"dps-cell",sort:Wl.Descending,getValue:e=>this.getPlayerDtps(e),getDisplayString:e=>this.getPlayerDtps(e).toFixed(1)}]),this.resultsFilter=t,this.raidDtps=0,this.maxDtps=0}getPlayerDtps(e){const t=this.resultData.result.getTargets(this.resultData.filter).map(t=>t.getPlayerAndPetActions().map(t=>t.forTarget({player:e.unitIndex}))).flat();return d(t.map(e=>e.dps))}customizeRowElem(e,t){t.classList.add("player-damage-row"),t.addEventListener("click",()=>{this.resultsFilter.setPlayer(this.getLastSimResult().eventID,e.index)})}getGroupedMetrics(e){this.resultData=e;const t=e.result.getPlayers(e.filter),a=e.result.getTargets(e.filter),i=a.map(t=>t.getPlayerAndPetActions().map(t=>t.forTarget(e.filter))).flat();this.raidDtps=d(i.map(e=>e.dps));const s=Me(t.map(e=>{const t=a.map(t=>t.getPlayerAndPetActions().map(t=>t.forTarget({player:e.unitIndex}))).flat();return d(t.map(e=>e.dps))})),o=a.map(e=>e.getPlayerAndPetActions().map(e=>e.forTarget({player:t[s].unitIndex}))).flat();return this.maxDtps=d(o.map(e=>e.dps)),t.map(e=>[e])}}class Sc extends Ul{constructor(e){e.rootCssClass="resource-metrics-root",super(e),Le.forEach(t=>{let a=Qr.get(t);a=t==G.ResourceTypeGenericResource&&e.secondaryResource?e.secondaryResource.name:Ne(t);const i=H("div",{className:"resource-metrics-table-container hide"},H("span",{className:"resource-metrics-table-title"},a));this.rootElem.appendChild(i);const s=new _c({...e,parent:i},t);s.onUpdate.on(()=>{s.rootElem.classList.contains("hide")?i.classList.add("hide"):i.classList.remove("hide")})})}onSimResult(){}}class _c extends jl{constructor(e,t){e.rootCssClass="resource-metrics-table-root",super(e,[jl.nameCellConfig(e=>({name:e.name,actionId:e.actionId,metricType:e.constructor?.name})),{name:oe.t("results_tab.details.columns.casts"),getValue:e=>e.events,getDisplayString:e=>e.events.toFixed(1)},{name:oe.t("results_tab.details.columns.gain"),sort:Wl.Descending,getValue:e=>e.gain,getDisplayString:e=>e.gain.toFixed(1)},{name:oe.t("results_tab.details.columns.gain_per_second"),getValue:e=>e.gainPerSecond,getDisplayString:e=>e.gainPerSecond.toFixed(1)},{name:oe.t("results_tab.details.columns.avg_gain"),getValue:e=>e.avgGain,getDisplayString:e=>e.avgGain.toFixed(1)},{name:oe.t("results_tab.details.columns.wasted_gain"),getValue:e=>e.wastedGain,getDisplayString:e=>e.wastedGain.toFixed(1)}]),this.resourceType=t}getGroupedMetrics(e){const t=e.result.getRaidIndexedPlayers(e.filter);if(1!=t.length)return[];const a=t[0].getResourceMetrics(this.resourceType);return zl.groupById(a)}mergeMetrics(e){return zl.merge(e,{removeTag:!0,actionIdOverride:e[0].unit?.petActionId||void 0})}}class kc extends nl{constructor(e,t,a){super(e,"dropdown-picker-root",t,a),this.resetCallbacks=[],this.config=a,this.valueConfigs=this.config.values.filter(e=>!e.headerText),this.currentSelection=null,this.submenus=[],this.rootElem.classList.add("dropdown");const i=U(),s=U();this.rootElem.appendChild(H(de,null,H("button",{ref:i,id:a.id,className:"dropdown-picker-button btn dropdown-toggle open-on-click",dataset:{bsToggle:"dropdown"},attributes:{"aria-expanded":!1}},a.defaultLabel),H("ul",{ref:s,className:"dropdown-picker-list dropdown-menu"}))),this.buttonElem=i.value,this.listElem=s.value,this.buttonElem.addEventListener("show.bs.dropdown",()=>{this.renderDropdown(this.valueConfigs)},{signal:this.signal}),this.buttonElem.addEventListener("hidden.bs.dropdown",()=>{this.resetDropdown()},{signal:this.signal}),this.init(),this.addOnDisposeCallback(()=>{this.resetDropdown(),this.listElem.remove(),Oe.getOrCreateInstance(this.buttonElem).dispose(),this.buttonElem.remove()})}setOptions(e){const t=ae(this.rootElem),a=ae(this.listElem),i=ae(this.buttonElem);t&&i&&a?(this.valueConfigs=e.filter(e=>!e.headerText),this.setInputValue(this.getSourceValue())):this.dispose()}resetDropdown(){this.listElem.querySelectorAll("[data-bs-toggle=dropdown]").forEach(e=>Oe.getOrCreateInstance(e).dispose()),this.resetCallbacks.forEach(e=>e()),this.listElem.replaceChildren(H(de,null))}renderDropdown(e){this.listElem.replaceChildren(),this.submenus=[],e.forEach(t=>{const a=e.some(e=>e.submenu?.some(e=>!("string"==typeof e)&&this.config.equals(e,t.value))),i=U(),s=U(),o=H("li",{ref:s,className:xr(t.extraCssClasses,t.headerText?"dropdown-picker-header":"dropdown-picker-item")},t.headerText&&H("h6",{className:"dropdown-header"},t.headerText));if(!t.headerText){const e=H("button",{ref:i,className:"dropdown-item"});if(this.config.setOptionContent(i.value,t),t.tooltip){const e=ie(i.value,{animation:!1,theme:"dropdown-tooltip",content:t.tooltip});this.addOnResetCallback(()=>e?.destroy())}const n=()=>{this.updateValue(t),this.inputChanged(te.nextEventID())};i.value.addEventListener("click",n),this.addOnResetCallback(()=>{i.value?.removeEventListener("click",n),i.value?.remove(),o.remove()}),a?this.createSubmenu((t.submenu||[]).concat([t.value]),i.value,s.value):o.appendChild(e)}if(!a){t.submenu&&t.submenu.length>0&&this.createSubmenu(t.submenu);const e=this.getSubmenu(t.submenu);e?e.listElem.appendChild(o):this.listElem.appendChild(o)}})}getSubmenu(e){return e&&this.submenus.find(t=>this.equalPaths(t.path,e))||null}createSubmenu(e,t,a){const i=this.getSubmenu(e);if(i)return i;let s=null;if(e.length>1&&(s=this.createSubmenu(e.slice(0,e.length-1))),a||(a=H("li",{className:"dropdown-picker-item"})),t||(t=H("button",{className:"dropdown-item"})),t.setAttribute("data-bs-toggle","dropdown"),t.setAttribute("aria-expanded","false"),!t.childNodes.length){const a=e[e.length-1];let i=a;if("string"==typeof a&&/^[a-z_]+$/.test(a))try{i=oe.t(`rotation_tab.apl.submenus.${a}`)}catch(r){i=a}t.replaceChildren(i+" ")}const o=U();a.appendChild(H("div",{className:"dropend"},t,H("ul",{ref:o,className:"dropdown-submenu dropdown-menu"}))),(s?.listElem||this.listElem).appendChild(a);const n={path:e,listElem:o.value};return this.submenus.push(n),n}equalPaths(e,t){return(e?.length||0)==(t?.length||0)&&(e||[]).every((e,a)=>"string"==typeof e?e==t[a]:this.config.equals(e,t[a]))}getInputElem(){return this.listElem}getInputValue(){return this.valueToSource(this.currentSelection?.value)}setInputValue(e){const t=this.sourceToValue(e),a=this.valueConfigs.find(e=>this.config.equals(e.value,t));a?this.updateValue(a):null==t?this.updateValue(null):this.config.createMissingValue?this.config.createMissingValue(t).then(e=>this.updateValue(e)):this.updateValue(null)}updateValue(e){this.currentSelection=e,e?(this.buttonElem.innerHTML="",this.config.setOptionContent(this.buttonElem,e,!0)):this.buttonElem.textContent=this.config.defaultLabel}addOnResetCallback(e){this.resetCallbacks.push(e)}}class Cc extends kc{constructor(e,t,a){super(e,t,{...a,setOptionContent:(e,t)=>{e.textContent=t.label}})}}class Ic extends kc{constructor(e,t,a){super(e,t,{...a,equals:(e,t)=>Ge.equals(e?.value||Ge.create(),t?.value||Ge.create()),defaultLabel:"Unit",setOptionContent:(e,t,i)=>{const s=t.value;if(e.className=e.className.replace(/text-[\w]*/,""),s.color&&e.classList.add(`text-${s.color}`),s.iconUrl){let t=null;s.iconUrl instanceof Lr?(t=H("img",{className:"unit-picker-item-icon"}),s.iconUrl.fill().then(e=>{t&&(t.src=e.iconUrl)})):t=s.iconUrl.startsWith("fa-")?H("i",{className:xr("fa",s.iconUrl,"unit-picker-item-icon")}):H("img",{className:"unit-picker-item-icon",src:s.iconUrl}),e.appendChild(t)}const o=a.hideLabelWhenDefaultSelected&&i&&!s.value;s.text&&!o&&e.insertAdjacentText("beforeend",s.text)}}),this.rootElem.classList.add("unit-picker-root")}}const Ec=-1;class Tc extends Ul{constructor(e){e.rootCssClass="results-filter-root",super(e),this.currentFilter={player:Ec,target:Ec},this.changeEmitter=new te,this.playerFilter=new Ic(this.rootElem,this.currentFilter,{id:"results-filter-player-filter",extraCssClasses:["player-filter-root","d-none"],changedEvent:e=>this.changeEmitter,sourceToValue:e=>this.refToValue(e),valueToSource:e=>e.value,getValue:e=>this.numToRef(e.player,!0),setValue:(e,t,a)=>this.setPlayer(e,this.refToNum(a)),values:[]}),this.targetFilter=new Ic(this.rootElem,this.currentFilter,{id:"results-filter-target-filter",extraCssClasses:["target-filter-root","d-none"],changedEvent:e=>this.changeEmitter,sourceToValue:e=>this.refToValue(e),valueToSource:e=>e.value,getValue:e=>this.numToRef(e.target,!1),setValue:(e,t,a)=>this.setTarget(e,this.refToNum(a)),values:[]})}getFilter(){return{player:this.currentFilter.player==Ec?null:this.currentFilter.player,target:this.currentFilter.target==Ec?null:this.currentFilter.target}}onSimResult(e){this.playerFilter.setOptions(this.getUnitOptions(e.eventID,e.result,!0)),this.targetFilter.setOptions(this.getUnitOptions(e.eventID,e.result,!1)),this.playerFilter.rootElem.classList.remove("d-none"),this.targetFilter.rootElem.classList.remove("d-none")}setPlayer(e,t){this.currentFilter.player=null===t?Ec:t,this.changeEmitter.emit(e)}setTarget(e,t){this.currentFilter.target=null===t?Ec:t,this.changeEmitter.emit(e)}refToValue(e){if(!e||e.type==ze.Unknown)return{value:e};if(e.type==ze.AllPlayers)return{iconUrl:"",text:oe.t("results_tab.details.all_players"),value:e};if(e.type==ze.AllTargets)return{iconUrl:"",text:oe.t("results_tab.details.all_targets"),value:e};if(this.hasLastSimResult()){const t=this.getLastSimResult(),a=e.type==ze.Player?t.result.getPlayerWithRaidIndex(e.index):e.type==ze.Target?t.result.getTargetWithEncounterIndex(e.index):null;if(a){let t=a.label;return e.type==ze.Target&&(t=oe.t("results_tab.details.target_number",{number:e.index+1})),{iconUrl:a.iconUrl||"",text:t,color:a.classColor||"",value:e}}}return{value:e}}refToNum(e){return e&&e.type!=ze.AllPlayers&&e.type!=ze.AllTargets?e.index:Ec}numToRef(e,t){return t?e==Ec?Ge.create({type:ze.AllPlayers}):Ge.create({type:ze.Player,index:e}):e==Ec?Ge.create({type:ze.AllTargets}):Ge.create({type:ze.Target,index:e})}getUnitOptions(e,t,a){const i=Ge.create({type:a?ze.AllPlayers:ze.AllTargets}),s=(a?t.getPlayers():t.getTargets()).map(e=>Ge.create({type:a?ze.Player:ze.Target,index:e.index})),o=[i].concat(s),n=this.numToRef(a?this.currentFilter.player:this.currentFilter.target,a);return null!=o.find(e=>Ge.equals(e,n))||(a?this.currentFilter.player=Ec:this.currentFilter.target=Ec,this.changeEmitter.emit(e)),o.map(e=>({value:this.refToValue(e)}))}}
/*!
 * ApexCharts v4.7.0
 * (c) 2018-2025 ApexCharts
 * Released under the MIT License.
 */function Ac(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,i=Array(t);a<t;a++)i[a]=e[a];return i}function Pc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dc(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,jc(i.key),i)}}function Mc(e,t,a){return t&&Dc(e.prototype,t),a&&Dc(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function Lc(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=qc(e))||t){a&&(e=a);var i=0,s=function(){};return{s:s,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,n=!0,r=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return n=e.done,e},e:function(e){r=!0,o=e},f:function(){try{n||null==a.return||a.return()}finally{if(r)throw o}}}}function Nc(e){var t=Fc();return function(){var a,i=Gc(e);if(t){var s=Gc(this).constructor;a=Reflect.construct(i,arguments,s)}else a=i.apply(this,arguments);return function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Pc(e)}(this,a)}}function Oc(e,t,a){return(t=jc(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Gc(e){return(Gc=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zc(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Bc(e,t)}function Fc(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Fc=function(){return!!e})()}function Hc(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,i)}return a}function Uc(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Hc(Object(a),!0).forEach(function(t){Oc(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Hc(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}function Bc(e,t){return(Bc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function Wc(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var i,s,o,n,r=[],l=!0,c=!1;try{if(o=(a=a.call(e)).next,0===t){if(Object(a)!==a)return;l=!1}else for(;!(l=(i=o.call(a)).done)&&(r.push(i.value),r.length!==t);l=!0);}catch(h){c=!0,s=h}finally{try{if(!l&&null!=a.return&&(n=a.return(),Object(n)!==n))return}finally{if(c)throw s}}return r}}(e,t)||qc(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vc(e){return function(e){if(Array.isArray(e))return Ac(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||qc(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jc(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:t+""}function Yc(e){return(Yc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qc(e,t){if(e){if("string"==typeof e)return Ac(e,t);var a={}.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?Ac(e,t):void 0}}var Xc=function(){function e(){Rc(this,e)}return Mc(e,[{key:"shadeRGBColor",value:function(e,t){var a=t.split(","),i=e<0?0:255,s=e<0?-1*e:e,o=parseInt(a[0].slice(4),10),n=parseInt(a[1],10),r=parseInt(a[2],10);return"rgb("+(Math.round((i-o)*s)+o)+","+(Math.round((i-n)*s)+n)+","+(Math.round((i-r)*s)+r)+")"}},{key:"shadeHexColor",value:function(e,t){var a=parseInt(t.slice(1),16),i=e<0?0:255,s=e<0?-1*e:e,o=a>>16,n=a>>8&255,r=255&a;return"#"+(16777216+65536*(Math.round((i-o)*s)+o)+256*(Math.round((i-n)*s)+n)+(Math.round((i-r)*s)+r)).toString(16).slice(1)}},{key:"shadeColor",value:function(t,a){return e.isColorHex(a)?this.shadeHexColor(t,a):this.shadeRGBColor(t,a)}}],[{key:"bind",value:function(e,t){return function(){return e.apply(t,arguments)}}},{key:"isObject",value:function(e){return e&&"object"===Yc(e)&&!Array.isArray(e)&&null!=e}},{key:"is",value:function(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"}},{key:"isSafari",value:function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}},{key:"listToArray",value:function(e){var t,a=[];for(t=0;t<e.length;t++)a[t]=e[t];return a}},{key:"extend",value:function(e,t){var a=this;"function"!=typeof Object.assign&&(Object.assign=function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),a=1;a<arguments.length;a++){var i=arguments[a];if(null!=i)for(var s in i)i.hasOwnProperty(s)&&(t[s]=i[s])}return t});var i=Object.assign({},e);return this.isObject(e)&&this.isObject(t)&&Object.keys(t).forEach(function(s){a.isObject(t[s])&&s in e?i[s]=a.extend(e[s],t[s]):Object.assign(i,Oc({},s,t[s]))}),i}},{key:"extendArray",value:function(t,a){var i=[];return t.map(function(t){i.push(e.extend(a,t))}),i}},{key:"monthMod",value:function(e){return e%12}},{key:"clone",value:function(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new WeakMap;if(null===e||"object"!==Yc(e))return e;if(a.has(e))return a.get(e);if(Array.isArray(e)){t=[],a.set(e,t);for(var i=0;i<e.length;i++)t[i]=this.clone(e[i],a)}else if(e instanceof Date)t=new Date(e.getTime());else for(var s in t={},a.set(e,t),e)e.hasOwnProperty(s)&&(t[s]=this.clone(e[s],a));return t}},{key:"log10",value:function(e){return Math.log(e)/Math.LN10}},{key:"roundToBase10",value:function(e){return Math.pow(10,Math.floor(Math.log10(e)))}},{key:"roundToBase",value:function(e,t){return Math.pow(t,Math.floor(Math.log(e)/Math.log(t)))}},{key:"parseNumber",value:function(e){return null===e?e:parseFloat(e)}},{key:"stripNumber",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return Number.isInteger(e)?e:parseFloat(e.toPrecision(t))}},{key:"randomId",value:function(){return(Math.random()+1).toString(36).substring(4)}},{key:"noExponents",value:function(e){return e.toString().includes("e")?Math.round(e):e}},{key:"elementExists",value:function(e){return!(!e||!e.isConnected)}},{key:"getDimensions",value:function(e){var t=getComputedStyle(e,null),a=e.clientHeight,i=e.clientWidth;return a-=parseFloat(t.paddingTop)+parseFloat(t.paddingBottom),[i-=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight),a]}},{key:"getBoundingClientRect",value:function(e){var t=e.getBoundingClientRect();return{top:t.top,right:t.right,bottom:t.bottom,left:t.left,width:e.clientWidth,height:e.clientHeight,x:t.left,y:t.top}}},{key:"getLargestStringFromArr",value:function(e){return e.reduce(function(e,t){return Array.isArray(t)&&(t=t.reduce(function(e,t){return e.length>t.length?e:t})),e.length>t.length?e:t},0)}},{key:"hexToRgba",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"#999999",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.6;"#"!==e.substring(0,1)&&(e="#999999");var a=e.replace("#","");a=a.match(new RegExp("(.{"+a.length/3+"})","g"));for(var i=0;i<a.length;i++)a[i]=parseInt(1===a[i].length?a[i]+a[i]:a[i],16);return void 0!==t&&a.push(t),"rgba("+a.join(",")+")"}},{key:"getOpacityFromRGBA",value:function(e){return parseFloat(e.replace(/^.*,(.+)\)/,"$1"))}},{key:"rgb2hex",value:function(e){return(e=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===e.length?"#"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):""}},{key:"isColorHex",value:function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)|(^#[0-9A-F]{8}$)/i.test(e)}},{key:"getPolygonPos",value:function(e,t){for(var a=[],i=2*Math.PI/t,s=0;s<t;s++){var o={};o.x=e*Math.sin(s*i),o.y=-e*Math.cos(s*i),a.push(o)}return a}},{key:"polarToCartesian",value:function(e,t,a,i){var s=(i-90)*Math.PI/180;return{x:e+a*Math.cos(s),y:t+a*Math.sin(s)}}},{key:"escapeString",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"x",a=e.toString().slice();return a.replace(/[` ~!@#$%^&*()|+\=?;:'",.<>{}[\]\\/]/gi,t)}},{key:"negToZero",value:function(e){return e<0?0:e}},{key:"moveIndexInArray",value:function(e,t,a){if(a>=e.length)for(var i=a-e.length+1;i--;)e.push(void 0);return e.splice(a,0,e.splice(t,1)[0]),e}},{key:"extractNumber",value:function(e){return parseFloat(e.replace(/[^\d.]*/g,""))}},{key:"findAncestor",value:function(e,t){for(;(e=e.parentElement)&&!e.classList.contains(t););return e}},{key:"setELstyles",value:function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e.style.key=t[a])}},{key:"preciseAddition",value:function(e,t){var a=(String(e).split(".")[1]||"").length,i=(String(t).split(".")[1]||"").length,s=Math.pow(10,Math.max(a,i));return(Math.round(e*s)+Math.round(t*s))/s}},{key:"isNumber",value:function(e){return!isNaN(e)&&parseFloat(Number(e))===e&&!isNaN(parseInt(e,10))}},{key:"isFloat",value:function(e){return Number(e)===e&&e%1!=0}},{key:"isMsEdge",value:function(){var e=window.navigator.userAgent,t=e.indexOf("Edge/");return t>0&&parseInt(e.substring(t+5,e.indexOf(".",t)),10)}},{key:"getGCD",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:7,i=Math.pow(10,a-Math.floor(Math.log10(Math.max(e,t))));for(e=Math.round(Math.abs(e)*i),t=Math.round(Math.abs(t)*i);t;){var s=t;t=e%t,e=s}return e/i}},{key:"getPrimeFactors",value:function(e){for(var t=[],a=2;e>=2;)e%a==0?(t.push(a),e/=a):a++;return t}},{key:"mod",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:7,i=Math.pow(10,a-Math.floor(Math.log10(Math.max(e,t))));return(e=Math.round(Math.abs(e)*i))%(t=Math.round(Math.abs(t)*i))/i}}]),e}(),$c=function(){function e(t){Rc(this,e),this.ctx=t,this.w=t.w}return Mc(e,[{key:"animateLine",value:function(e,t,a,i){e.attr(t).animate(i).attr(a)}},{key:"animateMarker",value:function(e,t,a,i){e.attr({opacity:0}).animate(t).attr({opacity:1}).after(function(){i()})}},{key:"animateRect",value:function(e,t,a,i,s){e.attr(t).animate(i).attr(a).after(function(){return s()})}},{key:"animatePathsGradually",value:function(e){var t=e.el,a=e.realIndex,i=e.j,s=e.fill,o=e.pathFrom,n=e.pathTo,r=e.speed,l=e.delay,c=this.w,h=0;c.config.chart.animations.animateGradually.enabled&&(h=c.config.chart.animations.animateGradually.delay),c.config.chart.animations.dynamicAnimation.enabled&&c.globals.dataChanged&&"bar"!==c.config.chart.type&&(h=0),this.morphSVG(t,a,i,"line"!==c.config.chart.type||c.globals.comboCharts?s:"stroke",o,n,r,l*h)}},{key:"showDelayedElements",value:function(){this.w.globals.delayedElements.forEach(function(e){var t=e.el;t.classList.remove("apexcharts-element-hidden"),t.classList.add("apexcharts-hidden-element-shown")})}},{key:"animationCompleted",value:function(e){var t=this.w;t.globals.animationEnded||(t.globals.animationEnded=!0,this.showDelayedElements(),"function"==typeof t.config.chart.events.animationEnd&&t.config.chart.events.animationEnd(this.ctx,{el:e,w:t}))}},{key:"morphSVG",value:function(e,t,a,i,s,o,n,r){var l=this,c=this.w;s||(s=e.attr("pathFrom")),o||(o=e.attr("pathTo"));var h=function(e){return"radar"===c.config.chart.type&&(n=1),"M 0 ".concat(c.globals.gridHeight)};(!s||s.indexOf("undefined")>-1||s.indexOf("NaN")>-1)&&(s=h()),(!o.trim()||o.indexOf("undefined")>-1||o.indexOf("NaN")>-1)&&(o=h()),c.globals.shouldAnimate||(n=1),e.plot(s).animate(1,r).plot(s).animate(n,r).plot(o).after(function(){Xc.isNumber(a)?a===c.globals.series[c.globals.maxValsInArrayIndex].length-2&&c.globals.shouldAnimate&&l.animationCompleted(e):"none"!==i&&c.globals.shouldAnimate&&(!c.globals.comboCharts&&t===c.globals.series.length-1||c.globals.comboCharts)&&l.animationCompleted(e),l.showDelayedElements()})}}]),e}();const Zc={},Kc=[];function Jc(e,t){if(Array.isArray(e))for(const a of e)Jc(a,t);else if("object"!=typeof e)eh(Object.getOwnPropertyNames(t)),Zc[e]=Object.assign(Zc[e]||{},t);else for(const a in e)Jc(a,e[a])}function Qc(e){return Zc[e]||{}}function eh(e){Kc.push(...e)}function th(e,t){let a;const i=e.length,s=[];for(a=0;a<i;a++)s.push(t(e[a]));return s}function ah(e){return e%360*Math.PI/180}function ih(e){return e.charAt(0).toUpperCase()+e.slice(1)}function sh(e,t,a,i){return null!=t&&null!=a||(i=i||e.bbox(),null==t?t=i.width/i.height*a:null==a&&(a=i.height/i.width*t)),{width:t,height:a}}function oh(e,t){const a=e.origin;let i=null!=e.ox?e.ox:null!=e.originX?e.originX:"center",s=null!=e.oy?e.oy:null!=e.originY?e.originY:"center";null!=a&&([i,s]=Array.isArray(a)?a:"object"==typeof a?[a.x,a.y]:[a,a]);const o="string"==typeof i,n="string"==typeof s;if(o||n){const{height:e,width:a,x:r,y:l}=t.bbox();o&&(i=i.includes("left")?r:i.includes("right")?r+a:r+a/2),n&&(s=s.includes("top")?l:s.includes("bottom")?l+e:l+e/2)}return[i,s]}const nh=new Set(["desc","metadata","title"]),rh=e=>nh.has(e.nodeName),lh=(e,t,a={})=>{const i={...t};for(const s in i)i[s].valueOf()===a[s]&&delete i[s];Object.keys(i).length?e.node.setAttribute("data-svgjs",JSON.stringify(i)):(e.node.removeAttribute("data-svgjs"),e.node.removeAttribute("svgjs:data"))},ch="http://www.w3.org/2000/svg",hh="http://www.w3.org/2000/xmlns/",dh="http://www.w3.org/1999/xlink",uh={window:"undefined"==typeof window?null:window,document:"undefined"==typeof document?null:document};function ph(){return uh.window}let mh=class{};const gh={},fh="___SYMBOL___ROOT___";function bh(e,t=ch){return uh.document.createElementNS(t,e)}function yh(e,t=!1){if(e instanceof mh)return e;if("object"==typeof e)return xh(e);if(null==e)return new gh[fh];if("string"==typeof e&&"<"!==e.charAt(0))return xh(uh.document.querySelector(e));const a=t?uh.document.createElement("div"):bh("svg");return a.innerHTML=e,e=xh(a.firstChild),a.removeChild(a.firstChild),e}function wh(e,t){return t&&(t instanceof uh.window.Node||t.ownerDocument&&t instanceof t.ownerDocument.defaultView.Node)?t:bh(e)}function vh(e){if(!e)return null;if(e.instance instanceof mh)return e.instance;if("#document-fragment"===e.nodeName)return new gh.Fragment(e);let t=ih(e.nodeName||"Dom");return"LinearGradient"===t||"RadialGradient"===t?t="Gradient":gh[t]||(t="Dom"),new gh[t](e)}let xh=vh;function Sh(e,t=e.name,a=!1){return gh[t]=e,a&&(gh[fh]=e),eh(Object.getOwnPropertyNames(e.prototype)),e}let _h=1e3;function kh(e){return"Svgjs"+ih(e)+_h++}function Ch(e){for(let t=e.children.length-1;t>=0;t--)Ch(e.children[t]);return e.id?(e.id=kh(e.nodeName),e):e}function Ih(e,t){let a,i;for(i=(e=Array.isArray(e)?e:[e]).length-1;i>=0;i--)for(a in t)e[i].prototype[a]=t[a]}function Eh(e){return function(...t){const a=t[t.length-1];return!a||a.constructor!==Object||a instanceof Array?e.apply(this,t):e.apply(this,t.slice(0,-1)).attr(a)}}Jc("Dom",{siblings:function(){return this.parent().children()},position:function(){return this.parent().index(this)},next:function(){return this.siblings()[this.position()+1]},prev:function(){return this.siblings()[this.position()-1]},forward:function(){const e=this.position();return this.parent().add(this.remove(),e+1),this},backward:function(){const e=this.position();return this.parent().add(this.remove(),e?e-1:0),this},front:function(){return this.parent().add(this.remove()),this},back:function(){return this.parent().add(this.remove(),0),this},before:function(e){(e=yh(e)).remove();const t=this.position();return this.parent().add(e,t),this},after:function(e){(e=yh(e)).remove();const t=this.position();return this.parent().add(e,t+1),this},insertBefore:function(e){return(e=yh(e)).before(this),this},insertAfter:function(e){return(e=yh(e)).after(this),this}});const Th=/^([+-]?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?)([a-z%]*)$/i,Ah=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,Ph=/rgb\((\d+),(\d+),(\d+)\)/,Rh=/(#[a-z_][a-z0-9\-_]*)/i,Dh=/\)\s*,?\s*/,Mh=/\s/g,Lh=/^#[a-f0-9]{3}$|^#[a-f0-9]{6}$/i,Nh=/^rgb\(/,Oh=/^(\s+)?$/,Gh=/^[+-]?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,zh=/\.(jpg|jpeg|png|gif|svg)(\?[^=]+.*)?/i,Fh=/[\s,]+/,Hh=/[MLHVCSQTAZ]/i;function Uh(e){const t=Math.round(e),a=Math.max(0,Math.min(255,t)).toString(16);return 1===a.length?"0"+a:a}function Bh(e,t){for(let a=t.length;a--;)if(null==e[t[a]])return!1;return!0}function Wh(e,t,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?e+6*(t-e)*a:a<.5?t:a<2/3?e+(t-e)*(2/3-a)*6:e}Jc("Dom",{classes:function(){const e=this.attr("class");return null==e?[]:e.trim().split(Fh)},hasClass:function(e){return-1!==this.classes().indexOf(e)},addClass:function(e){if(!this.hasClass(e)){const t=this.classes();t.push(e),this.attr("class",t.join(" "))}return this},removeClass:function(e){return this.hasClass(e)&&this.attr("class",this.classes().filter(function(t){return t!==e}).join(" ")),this},toggleClass:function(e){return this.hasClass(e)?this.removeClass(e):this.addClass(e)}}),Jc("Dom",{css:function(e,t){const a={};if(0===arguments.length)return this.node.style.cssText.split(/\s*;\s*/).filter(function(e){return!!e.length}).forEach(function(e){const t=e.split(/\s*:\s*/);a[t[0]]=t[1]}),a;if(arguments.length<2){if(Array.isArray(e)){for(const t of e){const e=t;a[t]=this.node.style.getPropertyValue(e)}return a}if("string"==typeof e)return this.node.style.getPropertyValue(e);if("object"==typeof e)for(const t in e)this.node.style.setProperty(t,null==e[t]||Oh.test(e[t])?"":e[t])}return 2===arguments.length&&this.node.style.setProperty(e,null==t||Oh.test(t)?"":t),this},show:function(){return this.css("display","")},hide:function(){return this.css("display","none")},visible:function(){return"none"!==this.css("display")}}),Jc("Dom",{data:function(e,t,a){if(null==e)return this.data(th(function(e,t){let a;const i=e.length,s=[];for(a=0;a<i;a++)t(e[a])&&s.push(e[a]);return s}(this.node.attributes,e=>0===e.nodeName.indexOf("data-")),e=>e.nodeName.slice(5)));if(e instanceof Array){const t={};for(const a of e)t[a]=this.data(a);return t}if("object"==typeof e)for(t in e)this.data(t,e[t]);else if(arguments.length<2)try{return JSON.parse(this.attr("data-"+e))}catch(i){return this.attr("data-"+e)}else this.attr("data-"+e,null===t?null:!0===a||"string"==typeof t||"number"==typeof t?t:JSON.stringify(t));return this}}),Jc("Dom",{remember:function(e,t){if("object"==typeof arguments[0])for(const a in e)this.remember(a,e[a]);else{if(1===arguments.length)return this.memory()[e];this.memory()[e]=t}return this},forget:function(){if(0===arguments.length)this._memory={};else for(let e=arguments.length-1;e>=0;e--)delete this.memory()[arguments[e]];return this},memory:function(){return this._memory=this._memory||{}}});class Vh{constructor(...e){this.init(...e)}static isColor(e){return e&&(e instanceof Vh||this.isRgb(e)||this.test(e))}static isRgb(e){return e&&"number"==typeof e.r&&"number"==typeof e.g&&"number"==typeof e.b}static random(e="vibrant",t){const{random:a,round:i,sin:s,PI:o}=Math;if("vibrant"===e){const e=24*a()+57,t=38*a()+45,i=360*a();return new Vh(e,t,i,"lch")}if("sine"===e){const e=i(80*s(2*o*(t=null==t?a():t)/.5+.01)+150),n=i(50*s(2*o*t/.5+4.6)+200),r=i(100*s(2*o*t/.5+2.3)+150);return new Vh(e,n,r)}if("pastel"===e){const e=8*a()+86,t=17*a()+9,i=360*a();return new Vh(e,t,i,"lch")}if("dark"===e){const e=10+10*a(),t=50*a()+86,i=360*a();return new Vh(e,t,i,"lch")}if("rgb"===e){const e=255*a(),t=255*a(),i=255*a();return new Vh(e,t,i)}if("lab"===e){const e=100*a(),t=256*a()-128,i=256*a()-128;return new Vh(e,t,i,"lab")}if("grey"===e){const e=255*a();return new Vh(e,e,e)}throw new Error("Unsupported random color mode")}static test(e){return"string"==typeof e&&(Lh.test(e)||Nh.test(e))}cmyk(){const{_a:e,_b:t,_c:a}=this.rgb(),[i,s,o]=[e,t,a].map(e=>e/255),n=Math.min(1-i,1-s,1-o);return 1===n?new Vh(0,0,0,1,"cmyk"):new Vh((1-i-n)/(1-n),(1-s-n)/(1-n),(1-o-n)/(1-n),n,"cmyk")}hsl(){const{_a:e,_b:t,_c:a}=this.rgb(),[i,s,o]=[e,t,a].map(e=>e/255),n=Math.max(i,s,o),r=Math.min(i,s,o),l=(n+r)/2,c=n===r,h=n-r;return new Vh(360*(c?0:n===i?((s-o)/h+(s<o?6:0))/6:n===s?((o-i)/h+2)/6:n===o?((i-s)/h+4)/6:0),100*(c?0:l>.5?h/(2-n-r):h/(n+r)),100*l,"hsl")}init(e=0,t=0,a=0,i=0,s="rgb"){if(e=e||0,this.space)for(const d in this.space)delete this[this.space[d]];if("number"==typeof e)s="string"==typeof i?i:s,i="string"==typeof i?0:i,Object.assign(this,{_a:e,_b:t,_c:a,_d:i,space:s});else if(e instanceof Array)this.space=t||("string"==typeof e[3]?e[3]:e[4])||"rgb",Object.assign(this,{_a:e[0],_b:e[1],_c:e[2],_d:e[3]||0});else if(e instanceof Object){const a=function(e,t){const a=Bh(e,"rgb")?{_a:e.r,_b:e.g,_c:e.b,_d:0,space:"rgb"}:Bh(e,"xyz")?{_a:e.x,_b:e.y,_c:e.z,_d:0,space:"xyz"}:Bh(e,"hsl")?{_a:e.h,_b:e.s,_c:e.l,_d:0,space:"hsl"}:Bh(e,"lab")?{_a:e.l,_b:e.a,_c:e.b,_d:0,space:"lab"}:Bh(e,"lch")?{_a:e.l,_b:e.c,_c:e.h,_d:0,space:"lch"}:Bh(e,"cmyk")?{_a:e.c,_b:e.m,_c:e.y,_d:e.k,space:"cmyk"}:{_a:0,_b:0,_c:0,space:"rgb"};return a.space=t||a.space,a}(e,t);Object.assign(this,a)}else if("string"==typeof e)if(Nh.test(e)){const t=e.replace(Mh,""),[a,i,s]=Ph.exec(t).slice(1,4).map(e=>parseInt(e));Object.assign(this,{_a:a,_b:i,_c:s,_d:0,space:"rgb"})}else{if(!Lh.test(e))throw Error("Unsupported string format, can't construct Color");{const t=e=>parseInt(e,16),[,a,i,s]=Ah.exec((o=e,4===o.length?["#",o.substring(1,2),o.substring(1,2),o.substring(2,3),o.substring(2,3),o.substring(3,4),o.substring(3,4)].join(""):o)).map(t);Object.assign(this,{_a:a,_b:i,_c:s,_d:0,space:"rgb"})}}var o;const{_a:n,_b:r,_c:l,_d:c}=this,h="rgb"===this.space?{r:n,g:r,b:l}:"xyz"===this.space?{x:n,y:r,z:l}:"hsl"===this.space?{h:n,s:r,l:l}:"lab"===this.space?{l:n,a:r,b:l}:"lch"===this.space?{l:n,c:r,h:l}:"cmyk"===this.space?{c:n,m:r,y:l,k:c}:{};Object.assign(this,h)}lab(){const{x:e,y:t,z:a}=this.xyz();return new Vh(116*t-16,500*(e-t),200*(t-a),"lab")}lch(){const{l:e,a:t,b:a}=this.lab(),i=Math.sqrt(t**2+a**2);let s=180*Math.atan2(a,t)/Math.PI;return s<0&&(s*=-1,s=360-s),new Vh(e,i,s,"lch")}rgb(){if("rgb"===this.space)return this;if("lab"===(e=this.space)||"xyz"===e||"lch"===e){let{x:e,y:t,z:a}=this;if("lab"===this.space||"lch"===this.space){let{l:i,a:s,b:o}=this;if("lch"===this.space){const{c:e,h:t}=this,a=Math.PI/180;s=e*Math.cos(a*t),o=e*Math.sin(a*t)}const n=(i+16)/116,r=s/500+n,l=n-o/200,c=16/116,h=.008856,d=7.787;e=.95047*(r**3>h?r**3:(r-c)/d),t=1*(n**3>h?n**3:(n-c)/d),a=1.08883*(l**3>h?l**3:(l-c)/d)}const i=3.2406*e+-1.5372*t+-.4986*a,s=-.9689*e+1.8758*t+.0415*a,o=.0557*e+-.204*t+1.057*a,n=Math.pow,r=.0031308,l=i>r?1.055*n(i,1/2.4)-.055:12.92*i,c=s>r?1.055*n(s,1/2.4)-.055:12.92*s,h=o>r?1.055*n(o,1/2.4)-.055:12.92*o;return new Vh(255*l,255*c,255*h)}if("hsl"===this.space){let{h:e,s:t,l:a}=this;if(e/=360,t/=100,a/=100,0===t)return a*=255,new Vh(a,a,a);const i=a<.5?a*(1+t):a+t-a*t,s=2*a-i,o=255*Wh(s,i,e+1/3),n=255*Wh(s,i,e),r=255*Wh(s,i,e-1/3);return new Vh(o,n,r)}if("cmyk"===this.space){const{c:e,m:t,y:a,k:i}=this,s=255*(1-Math.min(1,e*(1-i)+i)),o=255*(1-Math.min(1,t*(1-i)+i)),n=255*(1-Math.min(1,a*(1-i)+i));return new Vh(s,o,n)}return this;var e}toArray(){const{_a:e,_b:t,_c:a,_d:i,space:s}=this;return[e,t,a,i,s]}toHex(){const[e,t,a]=this._clamped().map(Uh);return`#${e}${t}${a}`}toRgb(){const[e,t,a]=this._clamped();return`rgb(${e},${t},${a})`}toString(){return this.toHex()}xyz(){const{_a:e,_b:t,_c:a}=this.rgb(),[i,s,o]=[e,t,a].map(e=>e/255),n=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92,r=s>.04045?Math.pow((s+.055)/1.055,2.4):s/12.92,l=o>.04045?Math.pow((o+.055)/1.055,2.4):o/12.92,c=(.4124*n+.3576*r+.1805*l)/.95047,h=(.2126*n+.7152*r+.0722*l)/1,d=(.0193*n+.1192*r+.9505*l)/1.08883,u=c>.008856?Math.pow(c,1/3):7.787*c+16/116,p=h>.008856?Math.pow(h,1/3):7.787*h+16/116,m=d>.008856?Math.pow(d,1/3):7.787*d+16/116;return new Vh(u,p,m,"xyz")}_clamped(){const{_a:e,_b:t,_c:a}=this.rgb(),{max:i,min:s,round:o}=Math;return[e,t,a].map(e=>i(0,s(o(e),255)))}}class jh{constructor(...e){this.init(...e)}clone(){return new jh(this)}init(e,t){const a=Array.isArray(e)?{x:e[0],y:e[1]}:"object"==typeof e?{x:e.x,y:e.y}:{x:e,y:t};return this.x=null==a.x?0:a.x,this.y=null==a.y?0:a.y,this}toArray(){return[this.x,this.y]}transform(e){return this.clone().transformO(e)}transformO(e){qh.isMatrixLike(e)||(e=new qh(e));const{x:t,y:a}=this;return this.x=e.a*t+e.c*a+e.e,this.y=e.b*t+e.d*a+e.f,this}}function Yh(e,t,a){return Math.abs(t-e)<1e-6}class qh{constructor(...e){this.init(...e)}static formatTransforms(e){const t="both"===e.flip||!0===e.flip,a=e.flip&&(t||"x"===e.flip)?-1:1,i=e.flip&&(t||"y"===e.flip)?-1:1,s=e.skew&&e.skew.length?e.skew[0]:isFinite(e.skew)?e.skew:isFinite(e.skewX)?e.skewX:0,o=e.skew&&e.skew.length?e.skew[1]:isFinite(e.skew)?e.skew:isFinite(e.skewY)?e.skewY:0,n=e.scale&&e.scale.length?e.scale[0]*a:isFinite(e.scale)?e.scale*a:isFinite(e.scaleX)?e.scaleX*a:a,r=e.scale&&e.scale.length?e.scale[1]*i:isFinite(e.scale)?e.scale*i:isFinite(e.scaleY)?e.scaleY*i:i,l=e.shear||0,c=e.rotate||e.theta||0,h=new jh(e.origin||e.around||e.ox||e.originX,e.oy||e.originY),d=h.x,u=h.y,p=new jh(e.position||e.px||e.positionX||NaN,e.py||e.positionY||NaN),m=p.x,g=p.y,f=new jh(e.translate||e.tx||e.translateX,e.ty||e.translateY),b=f.x,y=f.y,w=new jh(e.relative||e.rx||e.relativeX,e.ry||e.relativeY);return{scaleX:n,scaleY:r,skewX:s,skewY:o,shear:l,theta:c,rx:w.x,ry:w.y,tx:b,ty:y,ox:d,oy:u,px:m,py:g}}static fromArray(e){return{a:e[0],b:e[1],c:e[2],d:e[3],e:e[4],f:e[5]}}static isMatrixLike(e){return null!=e.a||null!=e.b||null!=e.c||null!=e.d||null!=e.e||null!=e.f}static matrixMultiply(e,t,a){const i=e.a*t.a+e.c*t.b,s=e.b*t.a+e.d*t.b,o=e.a*t.c+e.c*t.d,n=e.b*t.c+e.d*t.d,r=e.e+e.a*t.e+e.c*t.f,l=e.f+e.b*t.e+e.d*t.f;return a.a=i,a.b=s,a.c=o,a.d=n,a.e=r,a.f=l,a}around(e,t,a){return this.clone().aroundO(e,t,a)}aroundO(e,t,a){const i=e||0,s=t||0;return this.translateO(-i,-s).lmultiplyO(a).translateO(i,s)}clone(){return new qh(this)}decompose(e=0,t=0){const a=this.a,i=this.b,s=this.c,o=this.d,n=this.e,r=this.f,l=a*o-i*s,c=l>0?1:-1,h=c*Math.sqrt(a*a+i*i),d=Math.atan2(c*i,c*a),u=180/Math.PI*d,p=Math.cos(d),m=Math.sin(d),g=(a*s+i*o)/l,f=s*h/(g*a-i)||o*h/(g*i+a);return{scaleX:h,scaleY:f,shear:g,rotate:u,translateX:n-e+e*p*h+t*(g*p*h-m*f),translateY:r-t+e*m*h+t*(g*m*h+p*f),originX:e,originY:t,a:this.a,b:this.b,c:this.c,d:this.d,e:this.e,f:this.f}}equals(e){if(e===this)return!0;const t=new qh(e);return Yh(this.a,t.a)&&Yh(this.b,t.b)&&Yh(this.c,t.c)&&Yh(this.d,t.d)&&Yh(this.e,t.e)&&Yh(this.f,t.f)}flip(e,t){return this.clone().flipO(e,t)}flipO(e,t){return"x"===e?this.scaleO(-1,1,t,0):"y"===e?this.scaleO(1,-1,0,t):this.scaleO(-1,-1,e,t||e)}init(e){const t=qh.fromArray([1,0,0,1,0,0]);return e=e instanceof gd?e.matrixify():"string"==typeof e?qh.fromArray(e.split(Fh).map(parseFloat)):Array.isArray(e)?qh.fromArray(e):"object"==typeof e&&qh.isMatrixLike(e)?e:"object"==typeof e?(new qh).transform(e):6===arguments.length?qh.fromArray([].slice.call(arguments)):t,this.a=null!=e.a?e.a:t.a,this.b=null!=e.b?e.b:t.b,this.c=null!=e.c?e.c:t.c,this.d=null!=e.d?e.d:t.d,this.e=null!=e.e?e.e:t.e,this.f=null!=e.f?e.f:t.f,this}inverse(){return this.clone().inverseO()}inverseO(){const e=this.a,t=this.b,a=this.c,i=this.d,s=this.e,o=this.f,n=e*i-t*a;if(!n)throw new Error("Cannot invert "+this);const r=i/n,l=-t/n,c=-a/n,h=e/n,d=-(r*s+c*o),u=-(l*s+h*o);return this.a=r,this.b=l,this.c=c,this.d=h,this.e=d,this.f=u,this}lmultiply(e){return this.clone().lmultiplyO(e)}lmultiplyO(e){const t=e instanceof qh?e:new qh(e);return qh.matrixMultiply(t,this,this)}multiply(e){return this.clone().multiplyO(e)}multiplyO(e){const t=e instanceof qh?e:new qh(e);return qh.matrixMultiply(this,t,this)}rotate(e,t,a){return this.clone().rotateO(e,t,a)}rotateO(e,t=0,a=0){e=ah(e);const i=Math.cos(e),s=Math.sin(e),{a:o,b:n,c:r,d:l,e:c,f:h}=this;return this.a=o*i-n*s,this.b=n*i+o*s,this.c=r*i-l*s,this.d=l*i+r*s,this.e=c*i-h*s+a*s-t*i+t,this.f=h*i+c*s-t*s-a*i+a,this}scale(){return this.clone().scaleO(...arguments)}scaleO(e,t=e,a=0,i=0){3===arguments.length&&(i=a,a=t,t=e);const{a:s,b:o,c:n,d:r,e:l,f:c}=this;return this.a=s*e,this.b=o*t,this.c=n*e,this.d=r*t,this.e=l*e-a*e+a,this.f=c*t-i*t+i,this}shear(e,t,a){return this.clone().shearO(e,t,a)}shearO(e,t=0,a=0){const{a:i,b:s,c:o,d:n,e:r,f:l}=this;return this.a=i+s*e,this.c=o+n*e,this.e=r+l*e-a*e,this}skew(){return this.clone().skewO(...arguments)}skewO(e,t=e,a=0,i=0){3===arguments.length&&(i=a,a=t,t=e),e=ah(e),t=ah(t);const s=Math.tan(e),o=Math.tan(t),{a:n,b:r,c:l,d:c,e:h,f:d}=this;return this.a=n+r*s,this.b=r+n*o,this.c=l+c*s,this.d=c+l*o,this.e=h+d*s-i*s,this.f=d+h*o-a*o,this}skewX(e,t,a){return this.skew(e,0,t,a)}skewY(e,t,a){return this.skew(0,e,t,a)}toArray(){return[this.a,this.b,this.c,this.d,this.e,this.f]}toString(){return"matrix("+this.a+","+this.b+","+this.c+","+this.d+","+this.e+","+this.f+")"}transform(e){if(qh.isMatrixLike(e))return new qh(e).multiplyO(this);const t=qh.formatTransforms(e),{x:a,y:i}=new jh(t.ox,t.oy).transform(this),s=(new qh).translateO(t.rx,t.ry).lmultiplyO(this).translateO(-a,-i).scaleO(t.scaleX,t.scaleY).skewO(t.skewX,t.skewY).shearO(t.shear).rotateO(t.theta).translateO(a,i);if(isFinite(t.px)||isFinite(t.py)){const e=new jh(a,i).transform(s),o=isFinite(t.px)?t.px-e.x:0,n=isFinite(t.py)?t.py-e.y:0;s.translateO(o,n)}return s.translateO(t.tx,t.ty),s}translate(e,t){return this.clone().translateO(e,t)}translateO(e,t){return this.e+=e||0,this.f+=t||0,this}valueOf(){return{a:this.a,b:this.b,c:this.c,d:this.d,e:this.e,f:this.f}}}function Xh(){if(!Xh.nodes){const e=yh().size(2,0);e.node.style.cssText=["opacity: 0","position: absolute","left: -100%","top: -100%","overflow: hidden"].join(";"),e.attr("focusable","false"),e.attr("aria-hidden","true");const t=e.path().node;Xh.nodes={svg:e,path:t}}if(!Xh.nodes.svg.node.parentNode){const e=uh.document.body||uh.document.documentElement;Xh.nodes.svg.addTo(e)}return Xh.nodes}function $h(e){return!(e.width||e.height||e.x||e.y)}Sh(qh,"Matrix");class Zh{constructor(...e){this.init(...e)}addOffset(){return this.x+=uh.window.pageXOffset,this.y+=uh.window.pageYOffset,new Zh(this)}init(e){return e="string"==typeof e?e.split(Fh).map(parseFloat):Array.isArray(e)?e:"object"==typeof e?[null!=e.left?e.left:e.x,null!=e.top?e.top:e.y,e.width,e.height]:4===arguments.length?[].slice.call(arguments):[0,0,0,0],this.x=e[0]||0,this.y=e[1]||0,this.width=this.w=e[2]||0,this.height=this.h=e[3]||0,this.x2=this.x+this.w,this.y2=this.y+this.h,this.cx=this.x+this.w/2,this.cy=this.y+this.h/2,this}isNulled(){return $h(this)}merge(e){const t=Math.min(this.x,e.x),a=Math.min(this.y,e.y),i=Math.max(this.x+this.width,e.x+e.width)-t,s=Math.max(this.y+this.height,e.y+e.height)-a;return new Zh(t,a,i,s)}toArray(){return[this.x,this.y,this.width,this.height]}toString(){return this.x+" "+this.y+" "+this.width+" "+this.height}transform(e){e instanceof qh||(e=new qh(e));let t=1/0,a=-1/0,i=1/0,s=-1/0;return[new jh(this.x,this.y),new jh(this.x2,this.y),new jh(this.x,this.y2),new jh(this.x2,this.y2)].forEach(function(o){o=o.transform(e),t=Math.min(t,o.x),a=Math.max(a,o.x),i=Math.min(i,o.y),s=Math.max(s,o.y)}),new Zh(t,i,a-t,s-i)}}function Kh(e,t,a){let i;try{if(i=t(e.node),$h(i)&&(s=e.node)!==uh.document&&!(uh.document.documentElement.contains||function(e){for(;e.parentNode;)e=e.parentNode;return e===uh.document}).call(uh.document.documentElement,s))throw new Error("Element not in the dom")}catch(o){i=a(e)}var s;return i}Jc({viewbox:{viewbox(e,t,a,i){return null==e?new Zh(this.attr("viewBox")):this.attr("viewBox",new Zh(e,t,a,i))},zoom(e,t){let{width:a,height:i}=this.attr(["width","height"]);if((a||i)&&"string"!=typeof a&&"string"!=typeof i||(a=this.node.clientWidth,i=this.node.clientHeight),!a||!i)throw new Error("Impossible to get absolute width and height. Please provide an absolute width and height attribute on the zooming element");const s=this.viewbox(),o=a/s.width,n=i/s.height,r=Math.min(o,n);if(null==e)return r;let l=r/e;l===1/0&&(l=Number.MAX_SAFE_INTEGER/100),t=t||new jh(a/2/o+s.x,i/2/n+s.y);const c=new Zh(s).transform(new qh({scale:l,origin:t}));return this.viewbox(c)}}}),Sh(Zh,"Box");class Jh extends Array{constructor(e=[],...t){if(super(e,...t),"number"==typeof e)return this;this.length=0,this.push(...e)}}Ih([Jh],{each(e,...t){return"function"==typeof e?this.map((t,a,i)=>e.call(t,t,a,i)):this.map(a=>a[e](...t))},toArray(){return Array.prototype.concat.apply([],this)}});const Qh=["toArray","constructor","each"];function ed(e,t){return new Jh(th((t||uh.document).querySelectorAll(e),function(e){return vh(e)}))}Jh.extend=function(e){e=e.reduce((e,t)=>(Qh.includes(t)||"_"===t[0]||(t in Array.prototype&&(e["$"+t]=Array.prototype[t]),e[t]=function(...e){return this.each(t,...e)}),e),{}),Ih([Jh],e)};let td=0;const ad={};function id(e){let t=e.getEventHolder();return t===uh.window&&(t=ad),t.events||(t.events={}),t.events}function sd(e){return e.getEventTarget()}function od(e,t,a,i,s){const o=a.bind(i||e),n=yh(e),r=id(n),l=sd(n);t=Array.isArray(t)?t:t.split(Fh),a._svgjsListenerId||(a._svgjsListenerId=++td),t.forEach(function(e){const t=e.split(".")[0],i=e.split(".")[1]||"*";r[t]=r[t]||{},r[t][i]=r[t][i]||{},r[t][i][a._svgjsListenerId]=o,l.addEventListener(t,o,s||!1)})}function nd(e,t,a,i){const s=yh(e),o=id(s),n=sd(s);("function"!=typeof a||(a=a._svgjsListenerId))&&(t=Array.isArray(t)?t:(t||"").split(Fh)).forEach(function(e){const t=e&&e.split(".")[0],r=e&&e.split(".")[1];let l,c;if(a)o[t]&&o[t][r||"*"]&&(n.removeEventListener(t,o[t][r||"*"][a],i||!1),delete o[t][r||"*"][a]);else if(t&&r){if(o[t]&&o[t][r]){for(c in o[t][r])nd(n,[t,r].join("."),c);delete o[t][r]}}else if(r)for(e in o)for(l in o[e])r===l&&nd(n,[e,r].join("."));else if(t){if(o[t]){for(l in o[t])nd(n,[t,l].join("."));delete o[t]}}else{for(e in o)nd(n,e);!function(e){let t=e.getEventHolder();t===uh.window&&(t=ad),t.events&&(t.events={})}(s)}})}class rd extends mh{addEventListener(){}dispatch(e,t,a){return function(e,t,a,i){const s=sd(e);return t instanceof uh.window.Event||(t=new uh.window.CustomEvent(t,{detail:a,cancelable:!0,...i})),s.dispatchEvent(t),t}(this,e,t,a)}dispatchEvent(e){const t=this.getEventHolder().events;if(!t)return!0;const a=t[e.type];for(const i in a)for(const t in a[i])a[i][t](e);return!e.defaultPrevented}fire(e,t,a){return this.dispatch(e,t,a),this}getEventHolder(){return this}getEventTarget(){return this}off(e,t,a){return nd(this,e,t,a),this}on(e,t,a,i){return od(this,e,t,a,i),this}removeEventListener(){}}function ld(){}Sh(rd,"EventTarget");const cd={"fill-opacity":1,"stroke-opacity":1,"stroke-width":0,"stroke-linejoin":"miter","stroke-linecap":"butt",fill:"#000000",stroke:"#000000",opacity:1,x:0,y:0,cx:0,cy:0,width:0,height:0,r:0,rx:0,ry:0,offset:0,"stop-opacity":1,"stop-color":"#000000","text-anchor":"start"};class hd extends Array{constructor(...e){super(...e),this.init(...e)}clone(){return new this.constructor(this)}init(e){return"number"==typeof e||(this.length=0,this.push(...this.parse(e))),this}parse(e=[]){return e instanceof Array?e:e.trim().split(Fh).map(parseFloat)}toArray(){return Array.prototype.concat.apply([],this)}toSet(){return new Set(this)}toString(){return this.join(" ")}valueOf(){const e=[];return e.push(...this),e}}class dd{constructor(...e){this.init(...e)}convert(e){return new dd(this.value,e)}divide(e){return e=new dd(e),new dd(this/e,this.unit||e.unit)}init(e,t){return t=Array.isArray(e)?e[1]:t,e=Array.isArray(e)?e[0]:e,this.value=0,this.unit=t||"","number"==typeof e?this.value=isNaN(e)?0:isFinite(e)?e:e<0?-34e37:34e37:"string"==typeof e?(t=e.match(Th))&&(this.value=parseFloat(t[1]),"%"===t[5]?this.value/=100:"s"===t[5]&&(this.value*=1e3),this.unit=t[5]):e instanceof dd&&(this.value=e.valueOf(),this.unit=e.unit),this}minus(e){return e=new dd(e),new dd(this-e,this.unit||e.unit)}plus(e){return e=new dd(e),new dd(this+e,this.unit||e.unit)}times(e){return e=new dd(e),new dd(this*e,this.unit||e.unit)}toArray(){return[this.value,this.unit]}toJSON(){return this.toString()}toString(){return("%"===this.unit?~~(1e8*this.value)/1e6:"s"===this.unit?this.value/1e3:this.value)+this.unit}valueOf(){return this.value}}const ud=new Set(["fill","stroke","color","bgcolor","stop-color","flood-color","lighting-color"]),pd=[];class md extends rd{constructor(e,t){super(),this.node=e,this.type=e.nodeName,t&&e!==t&&this.attr(t)}add(e,t){return(e=yh(e)).removeNamespace&&this.node instanceof uh.window.SVGElement&&e.removeNamespace(),null==t?this.node.appendChild(e.node):e.node!==this.node.childNodes[t]&&this.node.insertBefore(e.node,this.node.childNodes[t]),this}addTo(e,t){return yh(e).put(this,t)}children(){return new Jh(th(this.node.children,function(e){return vh(e)}))}clear(){for(;this.node.hasChildNodes();)this.node.removeChild(this.node.lastChild);return this}clone(e=!0,t=!0){this.writeDataToDom();let a=this.node.cloneNode(e);return t&&(a=Ch(a)),new this.constructor(a)}each(e,t){const a=this.children();let i,s;for(i=0,s=a.length;i<s;i++)e.apply(a[i],[i,a]),t&&a[i].each(e,t);return this}element(e,t){return this.put(new md(bh(e),t))}first(){return vh(this.node.firstChild)}get(e){return vh(this.node.childNodes[e])}getEventHolder(){return this.node}getEventTarget(){return this.node}has(e){return this.index(e)>=0}html(e,t){return this.xml(e,t,"http://www.w3.org/1999/xhtml")}id(e){return void 0!==e||this.node.id||(this.node.id=kh(this.type)),this.attr("id",e)}index(e){return[].slice.call(this.node.childNodes).indexOf(e.node)}last(){return vh(this.node.lastChild)}matches(e){const t=this.node,a=t.matches||t.matchesSelector||t.msMatchesSelector||t.mozMatchesSelector||t.webkitMatchesSelector||t.oMatchesSelector||null;return a&&a.call(t,e)}parent(e){let t=this;if(!t.node.parentNode)return null;if(t=vh(t.node.parentNode),!e)return t;do{if("string"==typeof e?t.matches(e):t instanceof e)return t}while(t=vh(t.node.parentNode));return t}put(e,t){return e=yh(e),this.add(e,t),e}putIn(e,t){return yh(e).add(this,t)}remove(){return this.parent()&&this.parent().removeElement(this),this}removeElement(e){return this.node.removeChild(e.node),this}replace(e){return e=yh(e),this.node.parentNode&&this.node.parentNode.replaceChild(e.node,this.node),e}round(e=2,t=null){const a=10**e,i=this.attr(t);for(const s in i)"number"==typeof i[s]&&(i[s]=Math.round(i[s]*a)/a);return this.attr(i),this}svg(e,t){return this.xml(e,t,ch)}toString(){return this.id()}words(e){return this.node.textContent=e,this}wrap(e){const t=this.parent();if(!t)return this.addTo(e);const a=t.index(this);return t.put(e,a).put(this)}writeDataToDom(){return this.each(function(){this.writeDataToDom()}),this}xml(e,t,a){if("boolean"==typeof e&&(a=t,t=e,e=null),null==e||"function"==typeof e){t=null==t||t,this.writeDataToDom();let a=this;if(null!=e){if(a=vh(a.node.cloneNode(!0)),t){const t=e(a);if(a=t||a,!1===t)return""}a.each(function(){const t=e(this),a=t||this;!1===t?this.remove():t&&this!==a&&this.replace(a)},!0)}return t?a.node.outerHTML:a.node.innerHTML}t=null!=t&&t;const i=bh("wrapper",a),s=uh.document.createDocumentFragment();i.innerHTML=e;for(let n=i.children.length;n--;)s.appendChild(i.firstElementChild);const o=this.parent();return t?this.replace(s)&&o:this.add(s)}}Ih(md,{attr:function(e,t,a){if(null==e){e={},t=this.node.attributes;for(const a of t)e[a.nodeName]=Gh.test(a.nodeValue)?parseFloat(a.nodeValue):a.nodeValue;return e}if(e instanceof Array)return e.reduce((e,t)=>(e[t]=this.attr(t),e),{});if("object"==typeof e&&e.constructor===Object)for(t in e)this.attr(t,e[t]);else if(null===t)this.node.removeAttribute(e);else{if(null==t)return null==(t=this.node.getAttribute(e))?cd[e]:Gh.test(t)?parseFloat(t):t;"number"==typeof(t=pd.reduce((t,a)=>a(e,t,this),t))?t=new dd(t):ud.has(e)&&Vh.isColor(t)?t=new Vh(t):t.constructor===Array&&(t=new hd(t)),"leading"===e?this.leading&&this.leading(t):"string"==typeof a?this.node.setAttributeNS(a,e,t.toString()):this.node.setAttribute(e,t.toString()),!this.rebuild||"font-size"!==e&&"x"!==e||this.rebuild()}return this},find:function(e){return ed(e,this.node)},findOne:function(e){return vh(this.node.querySelector(e))}}),Sh(md,"Dom");let gd=class extends md{constructor(e,t){super(e,t),this.dom={},this.node.instance=this,(e.hasAttribute("data-svgjs")||e.hasAttribute("svgjs:data"))&&this.setData(JSON.parse(e.getAttribute("data-svgjs"))??JSON.parse(e.getAttribute("svgjs:data"))??{})}center(e,t){return this.cx(e).cy(t)}cx(e){return null==e?this.x()+this.width()/2:this.x(e-this.width()/2)}cy(e){return null==e?this.y()+this.height()/2:this.y(e-this.height()/2)}defs(){const e=this.root();return e&&e.defs()}dmove(e,t){return this.dx(e).dy(t)}dx(e=0){return this.x(new dd(e).plus(this.x()))}dy(e=0){return this.y(new dd(e).plus(this.y()))}getEventHolder(){return this}height(e){return this.attr("height",e)}move(e,t){return this.x(e).y(t)}parents(e=this.root()){const t="string"==typeof e;t||(e=yh(e));const a=new Jh;let i=this;for(;(i=i.parent())&&i.node!==uh.document&&"#document-fragment"!==i.nodeName&&(a.push(i),t||i.node!==e.node)&&(!t||!i.matches(e));)if(i.node===this.root().node)return null;return a}reference(e){if(!(e=this.attr(e)))return null;const t=(e+"").match(Rh);return t?yh(t[1]):null}root(){const e=this.parent(gh[fh]);return e&&e.root()}setData(e){return this.dom=e,this}size(e,t){const a=sh(this,e,t);return this.width(new dd(a.width)).height(new dd(a.height))}width(e){return this.attr("width",e)}writeDataToDom(){return lh(this,this.dom),super.writeDataToDom()}x(e){return this.attr("x",e)}y(e){return this.attr("y",e)}};Ih(gd,{bbox:function(){const e=Kh(this,e=>e.getBBox(),e=>{try{const t=e.clone().addTo(Xh().svg).show(),a=t.node.getBBox();return t.remove(),a}catch(t){throw new Error(`Getting bbox of element "${e.node.nodeName}" is not possible: ${t.toString()}`)}});return new Zh(e)},rbox:function(e){const t=Kh(this,e=>e.getBoundingClientRect(),e=>{throw new Error(`Getting rbox of element "${e.node.nodeName}" is not possible`)}),a=new Zh(t);return e?a.transform(e.screenCTM().inverseO()):a.addOffset()},inside:function(e,t){const a=this.bbox();return e>a.x&&t>a.y&&e<a.x+a.width&&t<a.y+a.height},point:function(e,t){return new jh(e,t).transformO(this.screenCTM().inverseO())},ctm:function(){return new qh(this.node.getCTM())},screenCTM:function(){try{if("function"==typeof this.isRoot&&!this.isRoot()){const e=this.rect(1,1),t=e.node.getScreenCTM();return e.remove(),new qh(t)}return new qh(this.node.getScreenCTM())}catch(e){return console.warn(`Cannot get CTM from SVG node ${this.node.nodeName}. Is the element rendered?`),new qh}}}),Sh(gd,"Element");const fd={stroke:["color","width","opacity","linecap","linejoin","miterlimit","dasharray","dashoffset"],fill:["color","opacity","rule"],prefix:function(e,t){return"color"===t?e:e+"-"+t}};["fill","stroke"].forEach(function(e){const t={};let a;t[e]=function(t){if(void 0===t)return this.attr(e);if("string"==typeof t||t instanceof Vh||Vh.isRgb(t)||t instanceof gd)this.attr(e,t);else for(a=fd[e].length-1;a>=0;a--)null!=t[fd[e][a]]&&this.attr(fd.prefix(e,fd[e][a]),t[fd[e][a]]);return this},Jc(["Element","Runner"],t)}),Jc(["Element","Runner"],{matrix:function(e,t,a,i,s,o){return null==e?new qh(this):this.attr("transform",new qh(e,t,a,i,s,o))},rotate:function(e,t,a){return this.transform({rotate:e,ox:t,oy:a},!0)},skew:function(e,t,a,i){return 1===arguments.length||3===arguments.length?this.transform({skew:e,ox:t,oy:a},!0):this.transform({skew:[e,t],ox:a,oy:i},!0)},shear:function(e,t,a){return this.transform({shear:e,ox:t,oy:a},!0)},scale:function(e,t,a,i){return 1===arguments.length||3===arguments.length?this.transform({scale:e,ox:t,oy:a},!0):this.transform({scale:[e,t],ox:a,oy:i},!0)},translate:function(e,t){return this.transform({translate:[e,t]},!0)},relative:function(e,t){return this.transform({relative:[e,t]},!0)},flip:function(e="both",t="center"){return-1==="xybothtrue".indexOf(e)&&(t=e,e="both"),this.transform({flip:e,origin:t},!0)},opacity:function(e){return this.attr("opacity",e)}}),Jc("radius",{radius:function(e,t=e){return"radialGradient"===(this._element||this).type?this.attr("r",new dd(e)):this.rx(e).ry(t)}}),Jc("Path",{length:function(){return this.node.getTotalLength()},pointAt:function(e){return new jh(this.node.getPointAtLength(e))}}),Jc(["Element","Runner"],{font:function(e,t){if("object"==typeof e){for(t in e)this.font(t,e[t]);return this}return"leading"===e?this.leading(t):"anchor"===e?this.attr("text-anchor",t):"size"===e||"family"===e||"weight"===e||"stretch"===e||"variant"===e||"style"===e?this.attr("font-"+e,t):this.attr(e,t)}}),Jc("Element",["click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove","mouseenter","mouseleave","touchstart","touchmove","touchleave","touchend","touchcancel","contextmenu","wheel","pointerdown","pointermove","pointerup","pointerleave","pointercancel"].reduce(function(e,t){return e[t]=function(e){return null===e?this.off(t):this.on(t,e),this},e},{})),Jc("Element",{untransform:function(){return this.attr("transform",null)},matrixify:function(){return(this.attr("transform")||"").split(Dh).slice(0,-1).map(function(e){const t=e.trim().split("(");return[t[0],t[1].split(Fh).map(function(e){return parseFloat(e)})]}).reverse().reduce(function(e,t){return"matrix"===t[0]?e.lmultiply(qh.fromArray(t[1])):e[t[0]].apply(e,t[1])},new qh)},toParent:function(e,t){if(this===e)return this;if(rh(this.node))return this.addTo(e,t);const a=this.screenCTM(),i=e.screenCTM().inverse();return this.addTo(e,t).untransform().transform(i.multiply(a)),this},toRoot:function(e){return this.toParent(this.root(),e)},transform:function(e,t){if(null==e||"string"==typeof e){const t=new qh(this).decompose();return null==e?t:t[e]}qh.isMatrixLike(e)||(e={...e,origin:oh(e,this)});const a=new qh(!0===t?this:t||!1).transform(e);return this.attr("transform",a)}});class bd extends gd{flatten(){return this.each(function(){if(this instanceof bd)return this.flatten().ungroup()}),this}ungroup(e=this.parent(),t=e.index(this)){return t=-1===t?e.children().length:t,this.each(function(a,i){return i[i.length-a-1].toParent(e,t)}),this.remove()}}Sh(bd,"Container");class yd extends bd{constructor(e,t=e){super(wh("defs",e),t)}flatten(){return this}ungroup(){return this}}Sh(yd,"Defs");class wd extends gd{}function vd(e){return this.attr("rx",e)}function xd(e){return this.attr("ry",e)}function Sd(e){return null==e?this.cx()-this.rx():this.cx(e+this.rx())}function _d(e){return null==e?this.cy()-this.ry():this.cy(e+this.ry())}function kd(e){return this.attr("cx",e)}function Cd(e){return this.attr("cy",e)}function Id(e){return null==e?2*this.rx():this.rx(new dd(e).divide(2))}function Ed(e){return null==e?2*this.ry():this.ry(new dd(e).divide(2))}Sh(wd,"Shape");var Td=Object.freeze({__proto__:null,cx:kd,cy:Cd,height:Ed,rx:vd,ry:xd,width:Id,x:Sd,y:_d});class Ad extends wd{constructor(e,t=e){super(wh("ellipse",e),t)}size(e,t){const a=sh(this,e,t);return this.rx(new dd(a.width).divide(2)).ry(new dd(a.height).divide(2))}}Ih(Ad,Td),Jc("Container",{ellipse:Eh(function(e=0,t=e){return this.put(new Ad).size(e,t).move(0,0)})}),Sh(Ad,"Ellipse");class Pd extends md{constructor(e=uh.document.createDocumentFragment()){super(e)}xml(e,t,a){if("boolean"==typeof e&&(a=t,t=e,e=null),null==e||"function"==typeof e){const e=new md(bh("wrapper",a));return e.add(this.node.cloneNode(!0)),e.xml(!1,a)}return super.xml(e,!1,a)}}function Rd(e,t){return"radialGradient"===(this._element||this).type?this.attr({fx:new dd(e),fy:new dd(t)}):this.attr({x1:new dd(e),y1:new dd(t)})}function Dd(e,t){return"radialGradient"===(this._element||this).type?this.attr({cx:new dd(e),cy:new dd(t)}):this.attr({x2:new dd(e),y2:new dd(t)})}Sh(Pd,"Fragment");var Md=Object.freeze({__proto__:null,from:Rd,to:Dd});class Ld extends bd{constructor(e,t){super(wh(e+"Gradient","string"==typeof e?null:e),t)}attr(e,t,a){return"transform"===e&&(e="gradientTransform"),super.attr(e,t,a)}bbox(){return new Zh}targets(){return ed("svg [fill*="+this.id()+"]")}toString(){return this.url()}update(e){return this.clear(),"function"==typeof e&&e.call(this,this),this}url(){return"url(#"+this.id()+")"}}Ih(Ld,Md),Jc({Container:{gradient(...e){return this.defs().gradient(...e)}},Defs:{gradient:Eh(function(e,t){return this.put(new Ld(e)).update(t)})}}),Sh(Ld,"Gradient");class Nd extends bd{constructor(e,t=e){super(wh("pattern",e),t)}attr(e,t,a){return"transform"===e&&(e="patternTransform"),super.attr(e,t,a)}bbox(){return new Zh}targets(){return ed("svg [fill*="+this.id()+"]")}toString(){return this.url()}update(e){return this.clear(),"function"==typeof e&&e.call(this,this),this}url(){return"url(#"+this.id()+")"}}Jc({Container:{pattern(...e){return this.defs().pattern(...e)}},Defs:{pattern:Eh(function(e,t,a){return this.put(new Nd).update(a).attr({x:0,y:0,width:e,height:t,patternUnits:"userSpaceOnUse"})})}}),Sh(Nd,"Pattern");let Od=class extends wd{constructor(e,t=e){super(wh("image",e),t)}load(e,t){if(!e)return this;const a=new uh.window.Image;return od(a,"load",function(e){const i=this.parent(Nd);0===this.width()&&0===this.height()&&this.size(a.width,a.height),i instanceof Nd&&0===i.width()&&0===i.height()&&i.size(this.width(),this.height()),"function"==typeof t&&t.call(this,e)},this),od(a,"load error",function(){nd(a)}),this.attr("href",a.src=e,dh)}};var Gd;Gd=function(e,t,a){return"fill"!==e&&"stroke"!==e||zh.test(t)&&(t=a.root().defs().image(t)),t instanceof Od&&(t=a.root().defs().pattern(0,0,e=>{e.add(t)})),t},pd.push(Gd),Jc({Container:{image:Eh(function(e,t){return this.put(new Od).size(0,0).load(e,t)})}}),Sh(Od,"Image");class zd extends hd{bbox(){let e=-1/0,t=-1/0,a=1/0,i=1/0;return this.forEach(function(s){e=Math.max(s[0],e),t=Math.max(s[1],t),a=Math.min(s[0],a),i=Math.min(s[1],i)}),new Zh(a,i,e-a,t-i)}move(e,t){const a=this.bbox();if(e-=a.x,t-=a.y,!isNaN(e)&&!isNaN(t))for(let i=this.length-1;i>=0;i--)this[i]=[this[i][0]+e,this[i][1]+t];return this}parse(e=[0,0]){const t=[];(e=e instanceof Array?Array.prototype.concat.apply([],e):e.trim().split(Fh).map(parseFloat)).length%2!=0&&e.pop();for(let a=0,i=e.length;a<i;a+=2)t.push([e[a],e[a+1]]);return t}size(e,t){let a;const i=this.bbox();for(a=this.length-1;a>=0;a--)i.width&&(this[a][0]=(this[a][0]-i.x)*e/i.width+i.x),i.height&&(this[a][1]=(this[a][1]-i.y)*t/i.height+i.y);return this}toLine(){return{x1:this[0][0],y1:this[0][1],x2:this[1][0],y2:this[1][1]}}toString(){const e=[];for(let t=0,a=this.length;t<a;t++)e.push(this[t].join(","));return e.join(" ")}transform(e){return this.clone().transformO(e)}transformO(e){qh.isMatrixLike(e)||(e=new qh(e));for(let t=this.length;t--;){const[a,i]=this[t];this[t][0]=e.a*a+e.c*i+e.e,this[t][1]=e.b*a+e.d*i+e.f}return this}}const Fd=zd;var Hd=Object.freeze({__proto__:null,MorphArray:Fd,height:function(e){const t=this.bbox();return null==e?t.height:this.size(t.width,e)},width:function(e){const t=this.bbox();return null==e?t.width:this.size(e,t.height)},x:function(e){return null==e?this.bbox().x:this.move(e,this.bbox().y)},y:function(e){return null==e?this.bbox().y:this.move(this.bbox().x,e)}});let Ud=class extends wd{constructor(e,t=e){super(wh("line",e),t)}array(){return new zd([[this.attr("x1"),this.attr("y1")],[this.attr("x2"),this.attr("y2")]])}move(e,t){return this.attr(this.array().move(e,t).toLine())}plot(e,t,a,i){return null==e?this.array():(e=void 0!==t?{x1:e,y1:t,x2:a,y2:i}:new zd(e).toLine(),this.attr(e))}size(e,t){const a=sh(this,e,t);return this.attr(this.array().size(a.width,a.height).toLine())}};Ih(Ud,Hd),Jc({Container:{line:Eh(function(...e){return Ud.prototype.plot.apply(this.put(new Ud),null!=e[0]?e:[0,0,0,0])})}}),Sh(Ud,"Line");let Bd=class extends bd{constructor(e,t=e){super(wh("marker",e),t)}height(e){return this.attr("markerHeight",e)}orient(e){return this.attr("orient",e)}ref(e,t){return this.attr("refX",e).attr("refY",t)}toString(){return"url(#"+this.id()+")"}update(e){return this.clear(),"function"==typeof e&&e.call(this,this),this}width(e){return this.attr("markerWidth",e)}};function Wd(e,t){return function(a){return null==a?this[e]:(this[e]=a,t&&t.call(this),this)}}Jc({Container:{marker(...e){return this.defs().marker(...e)}},Defs:{marker:Eh(function(e,t,a){return this.put(new Bd).size(e,t).ref(e/2,t/2).viewbox(0,0,e,t).attr("orient","auto").update(a)})},marker:{marker(e,t,a,i){let s=["marker"];return"all"!==e&&s.push(e),s=s.join("-"),e=arguments[1]instanceof Bd?arguments[1]:this.defs().marker(t,a,i),this.attr(s,e)}}}),Sh(Bd,"Marker");const Vd={"-":function(e){return e},"<>":function(e){return-Math.cos(e*Math.PI)/2+.5},">":function(e){return Math.sin(e*Math.PI/2)},"<":function(e){return 1-Math.cos(e*Math.PI/2)},bezier:function(e,t,a,i){return function(s){return s<0?e>0?t/e*s:a>0?i/a*s:0:s>1?a<1?(1-i)/(1-a)*s+(i-a)/(1-a):e<1?(1-t)/(1-e)*s+(t-e)/(1-e):1:3*s*(1-s)**2*t+3*s**2*(1-s)*i+s**3}},steps:function(e,t="end"){t=t.split("-").reverse()[0];let a=e;return"none"===t?--a:"both"===t&&++a,(i,s=!1)=>{let o=Math.floor(i*e);const n=i*o%1==0;return"start"!==t&&"both"!==t||++o,s&&n&&--o,i>=0&&o<0&&(o=0),i<=1&&o>a&&(o=a),o/a}}};class jd{done(){return!1}}class Yd extends jd{constructor(e=">"){super(),this.ease=Vd[e]||e}step(e,t,a){return"number"!=typeof e?a<1?e:t:e+(t-e)*this.ease(a)}}class qd extends jd{constructor(e){super(),this.stepper=e}done(e){return e.done}step(e,t,a,i){return this.stepper(e,t,a,i)}}function Xd(){const e=(this._duration||500)/1e3,t=this._overshoot||0,a=Math.PI,i=Math.log(t/100+1e-10),s=-i/Math.sqrt(a*a+i*i),o=3.9/(s*e);this.d=2*s*o,this.k=o*o}Ih(class extends qd{constructor(e=500,t=0){super(),this.duration(e).overshoot(t)}step(e,t,a,i){if("string"==typeof e)return e;if(i.done=a===1/0,a===1/0)return t;if(0===a)return e;a>100&&(a=16),a/=1e3;const s=i.velocity||0,o=-this.d*s-this.k*(e-t),n=e+s*a+o*a*a/2;return i.velocity=s+o*a,i.done=Math.abs(t-n)+Math.abs(s)<.002,i.done?t:n}},{duration:Wd("_duration",Xd),overshoot:Wd("_overshoot",Xd)}),Ih(class extends qd{constructor(e=.1,t=.01,a=0,i=1e3){super(),this.p(e).i(t).d(a).windup(i)}step(e,t,a,i){if("string"==typeof e)return e;if(i.done=a===1/0,a===1/0)return t;if(0===a)return e;const s=t-e;let o=(i.integral||0)+s*a;const n=(s-(i.error||0))/a,r=this._windup;return!1!==r&&(o=Math.max(-r,Math.min(o,r))),i.error=s,i.integral=o,i.done=Math.abs(s)<.001,i.done?t:e+(this.P*s+this.I*o+this.D*n)}},{windup:Wd("_windup"),p:Wd("P"),i:Wd("I"),d:Wd("D")});const $d={M:2,L:2,H:1,V:1,C:6,S:4,Q:4,T:2,A:7,Z:0},Zd={M:function(e,t,a){return t.x=a.x=e[0],t.y=a.y=e[1],["M",t.x,t.y]},L:function(e,t){return t.x=e[0],t.y=e[1],["L",e[0],e[1]]},H:function(e,t){return t.x=e[0],["H",e[0]]},V:function(e,t){return t.y=e[0],["V",e[0]]},C:function(e,t){return t.x=e[4],t.y=e[5],["C",e[0],e[1],e[2],e[3],e[4],e[5]]},S:function(e,t){return t.x=e[2],t.y=e[3],["S",e[0],e[1],e[2],e[3]]},Q:function(e,t){return t.x=e[2],t.y=e[3],["Q",e[0],e[1],e[2],e[3]]},T:function(e,t){return t.x=e[0],t.y=e[1],["T",e[0],e[1]]},Z:function(e,t,a){return t.x=a.x,t.y=a.y,["Z"]},A:function(e,t){return t.x=e[5],t.y=e[6],["A",e[0],e[1],e[2],e[3],e[4],e[5],e[6]]}},Kd="mlhvqtcsaz".split("");for(let j=0,Wk=Kd.length;j<Wk;++j)Zd[Kd[j]]=function(e){return function(t,a,i){if("H"===e)t[0]=t[0]+a.x;else if("V"===e)t[0]=t[0]+a.y;else if("A"===e)t[5]=t[5]+a.x,t[6]=t[6]+a.y;else for(let e=0,s=t.length;e<s;++e)t[e]=t[e]+(e%2?a.y:a.x);return Zd[e](t,a,i)}}(Kd[j].toUpperCase());function Jd(e){return e.segment.length&&e.segment.length-1===$d[e.segment[0].toUpperCase()]}function Qd(e,t){e.inNumber&&eu(e,!1);const a=Hh.test(t);if(a)e.segment=[t];else{const t=e.lastCommand,a=t.toLowerCase(),i=t===a;e.segment=["m"===a?i?"l":"L":t]}return e.inSegment=!0,e.lastCommand=e.segment[0],a}function eu(e,t){if(!e.inNumber)throw new Error("Parser Error");e.number&&e.segment.push(parseFloat(e.number)),e.inNumber=t,e.number="",e.pointSeen=!1,e.hasExponent=!1,Jd(e)&&tu(e)}function tu(e){e.inSegment=!1,e.absolute&&(e.segment=function(e){const t=e.segment[0];return Zd[t](e.segment.slice(1),e.p,e.p0)}(e)),e.segments.push(e.segment)}function au(e){if(!e.segment.length)return!1;const t="A"===e.segment[0].toUpperCase(),a=e.segment.length;return t&&(4===a||5===a)}function iu(e){return"E"===e.lastToken.toUpperCase()}const su=new Set([" ",",","\t","\n","\r","\f"]);class ou extends hd{bbox(){return Xh().path.setAttribute("d",this.toString()),new Zh(Xh.nodes.path.getBBox())}move(e,t){const a=this.bbox();if(e-=a.x,t-=a.y,!isNaN(e)&&!isNaN(t))for(let i,s=this.length-1;s>=0;s--)i=this[s][0],"M"===i||"L"===i||"T"===i?(this[s][1]+=e,this[s][2]+=t):"H"===i?this[s][1]+=e:"V"===i?this[s][1]+=t:"C"===i||"S"===i||"Q"===i?(this[s][1]+=e,this[s][2]+=t,this[s][3]+=e,this[s][4]+=t,"C"===i&&(this[s][5]+=e,this[s][6]+=t)):"A"===i&&(this[s][6]+=e,this[s][7]+=t);return this}parse(e="M0 0"){return Array.isArray(e)&&(e=Array.prototype.concat.apply([],e).toString()),function(e,t=!0){let a=0,i="";const s={segment:[],inNumber:!1,number:"",lastToken:"",inSegment:!1,segments:[],pointSeen:!1,hasExponent:!1,absolute:t,p0:new jh,p:new jh};for(;s.lastToken=i,i=e.charAt(a++);)if(s.inSegment||!Qd(s,i))if("."!==i)if(isNaN(parseInt(i)))if(su.has(i))s.inNumber&&eu(s,!1);else if("-"!==i&&"+"!==i)if("E"!==i.toUpperCase()){if(Hh.test(i)){if(s.inNumber)eu(s,!1);else{if(!Jd(s))throw new Error("parser Error");tu(s)}--a}}else s.number+=i,s.hasExponent=!0;else{if(s.inNumber&&!iu(s)){eu(s,!1),--a;continue}s.number+=i,s.inNumber=!0}else{if("0"===s.number||au(s)){s.inNumber=!0,s.number=i,eu(s,!0);continue}s.inNumber=!0,s.number+=i}else{if(s.pointSeen||s.hasExponent){eu(s,!1),--a;continue}s.inNumber=!0,s.pointSeen=!0,s.number+=i}return s.inNumber&&eu(s,!1),s.inSegment&&Jd(s)&&tu(s),s.segments}(e)}size(e,t){const a=this.bbox();let i,s;for(a.width=0===a.width?1:a.width,a.height=0===a.height?1:a.height,i=this.length-1;i>=0;i--)s=this[i][0],"M"===s||"L"===s||"T"===s?(this[i][1]=(this[i][1]-a.x)*e/a.width+a.x,this[i][2]=(this[i][2]-a.y)*t/a.height+a.y):"H"===s?this[i][1]=(this[i][1]-a.x)*e/a.width+a.x:"V"===s?this[i][1]=(this[i][1]-a.y)*t/a.height+a.y:"C"===s||"S"===s||"Q"===s?(this[i][1]=(this[i][1]-a.x)*e/a.width+a.x,this[i][2]=(this[i][2]-a.y)*t/a.height+a.y,this[i][3]=(this[i][3]-a.x)*e/a.width+a.x,this[i][4]=(this[i][4]-a.y)*t/a.height+a.y,"C"===s&&(this[i][5]=(this[i][5]-a.x)*e/a.width+a.x,this[i][6]=(this[i][6]-a.y)*t/a.height+a.y)):"A"===s&&(this[i][1]=this[i][1]*e/a.width,this[i][2]=this[i][2]*t/a.height,this[i][6]=(this[i][6]-a.x)*e/a.width+a.x,this[i][7]=(this[i][7]-a.y)*t/a.height+a.y);return this}toString(){return function(e){let t="";for(let a=0,i=e.length;a<i;a++)t+=e[a][0],null!=e[a][1]&&(t+=e[a][1],null!=e[a][2]&&(t+=" ",t+=e[a][2],null!=e[a][3]&&(t+=" ",t+=e[a][3],t+=" ",t+=e[a][4],null!=e[a][5]&&(t+=" ",t+=e[a][5],t+=" ",t+=e[a][6],null!=e[a][7]&&(t+=" ",t+=e[a][7])))));return t+" "}(this)}}const nu=e=>{const t=typeof e;return"number"===t?dd:"string"===t?Vh.isColor(e)?Vh:Fh.test(e)?Hh.test(e)?ou:hd:Th.test(e)?dd:lu:uu.indexOf(e.constructor)>-1?e.constructor:Array.isArray(e)?hd:"object"===t?du:lu};class ru{constructor(e){this._stepper=e||new Yd("-"),this._from=null,this._to=null,this._type=null,this._context=null,this._morphObj=null}at(e){return this._morphObj.morph(this._from,this._to,e,this._stepper,this._context)}done(){return this._context.map(this._stepper.done).reduce(function(e,t){return e&&t},!0)}from(e){return null==e?this._from:(this._from=this._set(e),this)}stepper(e){return null==e?this._stepper:(this._stepper=e,this)}to(e){return null==e?this._to:(this._to=this._set(e),this)}type(e){return null==e?this._type:(this._type=e,this)}_set(e){this._type||this.type(nu(e));let t=new this._type(e);return this._type===Vh&&(t=this._to?t[this._to[4]]():this._from?t[this._from[4]]():t),this._type===du&&(t=this._to?t.align(this._to):this._from?t.align(this._from):t),t=t.toConsumable(),this._morphObj=this._morphObj||new this._type,this._context=this._context||Array.apply(null,Array(t.length)).map(Object).map(function(e){return e.done=!0,e}),t}}class lu{constructor(...e){this.init(...e)}init(e){return e=Array.isArray(e)?e[0]:e,this.value=e,this}toArray(){return[this.value]}valueOf(){return this.value}}class cu{constructor(...e){this.init(...e)}init(e){return Array.isArray(e)&&(e={scaleX:e[0],scaleY:e[1],shear:e[2],rotate:e[3],translateX:e[4],translateY:e[5],originX:e[6],originY:e[7]}),Object.assign(this,cu.defaults,e),this}toArray(){const e=this;return[e.scaleX,e.scaleY,e.shear,e.rotate,e.translateX,e.translateY,e.originX,e.originY]}}cu.defaults={scaleX:1,scaleY:1,shear:0,rotate:0,translateX:0,translateY:0,originX:0,originY:0};const hu=(e,t)=>e[0]<t[0]?-1:e[0]>t[0]?1:0;class du{constructor(...e){this.init(...e)}align(e){const t=this.values;for(let a=0,i=t.length;a<i;++a){if(t[a+1]===e[a+1]){if(t[a+1]===Vh&&e[a+7]!==t[a+7]){const t=e[a+7],i=new Vh(this.values.splice(a+3,5))[t]().toArray();this.values.splice(a+3,0,...i)}a+=t[a+2]+2;continue}if(!e[a+1])return this;const i=(new e[a+1]).toArray(),s=t[a+2]+3;t.splice(a,s,e[a],e[a+1],e[a+2],...i),a+=t[a+2]+2}return this}init(e){if(this.values=[],Array.isArray(e))return void(this.values=e.slice());e=e||{};const t=[];for(const a in e){const i=nu(e[a]),s=new i(e[a]).toArray();t.push([a,i,s.length,...s])}return t.sort(hu),this.values=t.reduce((e,t)=>e.concat(t),[]),this}toArray(){return this.values}valueOf(){const e={},t=this.values;for(;t.length;){const a=t.shift(),i=t.shift(),s=t.shift(),o=t.splice(0,s);e[a]=new i(o)}return e}}const uu=[lu,cu,du];class pu extends wd{constructor(e,t=e){super(wh("path",e),t)}array(){return this._array||(this._array=new ou(this.attr("d")))}clear(){return delete this._array,this}height(e){return null==e?this.bbox().height:this.size(this.bbox().width,e)}move(e,t){return this.attr("d",this.array().move(e,t))}plot(e){return null==e?this.array():this.clear().attr("d","string"==typeof e?e:this._array=new ou(e))}size(e,t){const a=sh(this,e,t);return this.attr("d",this.array().size(a.width,a.height))}width(e){return null==e?this.bbox().width:this.size(e,this.bbox().height)}x(e){return null==e?this.bbox().x:this.move(e,this.bbox().y)}y(e){return null==e?this.bbox().y:this.move(this.bbox().x,e)}}pu.prototype.MorphArray=ou,Jc({Container:{path:Eh(function(e){return this.put(new pu).plot(e||new ou)})}}),Sh(pu,"Path");var mu=Object.freeze({__proto__:null,array:function(){return this._array||(this._array=new zd(this.attr("points")))},clear:function(){return delete this._array,this},move:function(e,t){return this.attr("points",this.array().move(e,t))},plot:function(e){return null==e?this.array():this.clear().attr("points","string"==typeof e?e:this._array=new zd(e))},size:function(e,t){const a=sh(this,e,t);return this.attr("points",this.array().size(a.width,a.height))}});class gu extends wd{constructor(e,t=e){super(wh("polygon",e),t)}}Jc({Container:{polygon:Eh(function(e){return this.put(new gu).plot(e||new zd)})}}),Ih(gu,Hd),Ih(gu,mu),Sh(gu,"Polygon");class fu extends wd{constructor(e,t=e){super(wh("polyline",e),t)}}Jc({Container:{polyline:Eh(function(e){return this.put(new fu).plot(e||new zd)})}}),Ih(fu,Hd),Ih(fu,mu),Sh(fu,"Polyline");class bu extends wd{constructor(e,t=e){super(wh("rect",e),t)}}Ih(bu,{rx:vd,ry:xd}),Jc({Container:{rect:Eh(function(e,t){return this.put(new bu).size(e,t)})}}),Sh(bu,"Rect");class yu{constructor(){this._first=null,this._last=null}first(){return this._first&&this._first.value}last(){return this._last&&this._last.value}push(e){const t=void 0!==e.next?e:{value:e,next:null,prev:null};return this._last?(t.prev=this._last,this._last.next=t,this._last=t):(this._last=t,this._first=t),t}remove(e){e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),e===this._last&&(this._last=e.prev),e===this._first&&(this._first=e.next),e.prev=null,e.next=null}shift(){const e=this._first;return e?(this._first=e.next,this._first&&(this._first.prev=null),this._last=this._first?this._last:null,e.value):null}}const wu={nextDraw:null,frames:new yu,timeouts:new yu,immediates:new yu,timer:()=>uh.window.performance||uh.window.Date,transforms:[],frame(e){const t=wu.frames.push({run:e});return null===wu.nextDraw&&(wu.nextDraw=uh.window.requestAnimationFrame(wu._draw)),t},timeout(e,t){t=t||0;const a=wu.timer().now()+t,i=wu.timeouts.push({run:e,time:a});return null===wu.nextDraw&&(wu.nextDraw=uh.window.requestAnimationFrame(wu._draw)),i},immediate(e){const t=wu.immediates.push(e);return null===wu.nextDraw&&(wu.nextDraw=uh.window.requestAnimationFrame(wu._draw)),t},cancelFrame(e){null!=e&&wu.frames.remove(e)},clearTimeout(e){null!=e&&wu.timeouts.remove(e)},cancelImmediate(e){null!=e&&wu.immediates.remove(e)},_draw(e){let t=null;const a=wu.timeouts.last();for(;(t=wu.timeouts.shift())&&(e>=t.time?t.run():wu.timeouts.push(t),t!==a););let i=null;const s=wu.frames.last();for(;i!==s&&(i=wu.frames.shift());)i.run(e);let o=null;for(;o=wu.immediates.shift();)o();wu.nextDraw=wu.timeouts.first()||wu.frames.first()?uh.window.requestAnimationFrame(wu._draw):null}},vu=function(e){const t=e.start,a=e.runner.duration();return{start:t,duration:a,end:t+a,runner:e.runner}},xu=function(){const e=uh.window;return(e.performance||e.Date).now()};class Su extends rd{constructor(e=xu){super(),this._timeSource=e,this.terminate()}active(){return!!this._nextFrame}finish(){return this.time(this.getEndTimeOfTimeline()+1),this.pause()}getEndTime(){const e=this.getLastRunnerInfo(),t=e?e.runner.duration():0;return(e?e.start:this._time)+t}getEndTimeOfTimeline(){const e=this._runners.map(e=>e.start+e.runner.duration());return Math.max(0,...e)}getLastRunnerInfo(){return this.getRunnerInfoById(this._lastRunnerId)}getRunnerInfoById(e){return this._runners[this._runnerIds.indexOf(e)]||null}pause(){return this._paused=!0,this._continue()}persist(e){return null==e?this._persist:(this._persist=e,this)}play(){return this._paused=!1,this.updateTime()._continue()}reverse(e){const t=this.speed();if(null==e)return this.speed(-t);const a=Math.abs(t);return this.speed(e?-a:a)}schedule(e,t,a){if(null==e)return this._runners.map(vu);let i=0;const s=this.getEndTime();if(t=t||0,null==a||"last"===a||"after"===a)i=s;else if("absolute"===a||"start"===a)i=t,t=0;else if("now"===a)i=this._time;else if("relative"===a){const a=this.getRunnerInfoById(e.id);a&&(i=a.start+t,t=0)}else{if("with-last"!==a)throw new Error('Invalid value for the "when" parameter');{const e=this.getLastRunnerInfo();i=e?e.start:this._time}}e.unschedule(),e.timeline(this);const o=e.persist(),n={persist:null===o?this._persist:o,start:i+t,runner:e};return this._lastRunnerId=e.id,this._runners.push(n),this._runners.sort((e,t)=>e.start-t.start),this._runnerIds=this._runners.map(e=>e.runner.id),this.updateTime()._continue(),this}seek(e){return this.time(this._time+e)}source(e){return null==e?this._timeSource:(this._timeSource=e,this)}speed(e){return null==e?this._speed:(this._speed=e,this)}stop(){return this.time(0),this.pause()}time(e){return null==e?this._time:(this._time=e,this._continue(!0))}unschedule(e){const t=this._runnerIds.indexOf(e.id);return t<0||(this._runners.splice(t,1),this._runnerIds.splice(t,1),e.timeline(null)),this}updateTime(){return this.active()||(this._lastSourceTime=this._timeSource()),this}_continue(e=!1){return wu.cancelFrame(this._nextFrame),this._nextFrame=null,e?this._stepImmediate():(this._paused||(this._nextFrame=wu.frame(this._step)),this)}_stepFn(e=!1){const t=this._timeSource();let a=t-this._lastSourceTime;e&&(a=0);const i=this._speed*a+(this._time-this._lastStepTime);this._lastSourceTime=t,e||(this._time+=i,this._time=this._time<0?0:this._time),this._lastStepTime=this._time,this.fire("time",this._time);for(let o=this._runners.length;o--;){const e=this._runners[o],t=e.runner;this._time-e.start<=0&&t.reset()}let s=!1;for(let o=0,n=this._runners.length;o<n;o++){const e=this._runners[o],t=e.runner;let a=i;const r=this._time-e.start;r<=0?s=!0:(r<a&&(a=r),t.active()&&(t.step(a).done?!0!==e.persist&&t.duration()-t.time()+this._time+e.persist<this._time&&(t.unschedule(),--o,--n):s=!0))}return s&&!(this._speed<0&&0===this._time)||this._runnerIds.length&&this._speed<0&&this._time>0?this._continue():(this.pause(),this.fire("finished")),this}terminate(){this._startTime=0,this._speed=1,this._persist=0,this._nextFrame=null,this._paused=!0,this._runners=[],this._runnerIds=[],this._lastRunnerId=-1,this._time=0,this._lastSourceTime=0,this._lastStepTime=0,this._step=this._stepFn.bind(this,!1),this._stepImmediate=this._stepFn.bind(this,!0)}}Jc({Element:{timeline:function(e){return null==e?(this._timeline=this._timeline||new Su,this._timeline):(this._timeline=e,this)}}});class _u extends rd{constructor(e){super(),this.id=_u.id++,e="function"==typeof(e=null==e?400:e)?new qd(e):e,this._element=null,this._timeline=null,this.done=!1,this._queue=[],this._duration="number"==typeof e&&e,this._isDeclarative=e instanceof qd,this._stepper=this._isDeclarative?e:new Yd,this._history={},this.enabled=!0,this._time=0,this._lastTime=0,this._reseted=!0,this.transforms=new qh,this.transformId=1,this._haveReversed=!1,this._reverse=!1,this._loopsDone=0,this._swing=!1,this._wait=0,this._times=1,this._frameId=null,this._persist=!!this._isDeclarative||null}static sanitise(e,t,a){let i=1,s=!1,o=0;return t=t??0,a=a||"last","object"!=typeof(e=e??400)||e instanceof jd||(t=e.delay??t,a=e.when??a,s=e.swing||s,i=e.times??i,o=e.wait??o,e=e.duration??400),{duration:e,delay:t,swing:s,times:i,wait:o,when:a}}active(e){return null==e?this.enabled:(this.enabled=e,this)}addTransform(e){return this.transforms.lmultiplyO(e),this}after(e){return this.on("finished",e)}animate(e,t,a){const i=_u.sanitise(e,t,a),s=new _u(i.duration);return this._timeline&&s.timeline(this._timeline),this._element&&s.element(this._element),s.loop(i).schedule(i.delay,i.when)}clearTransform(){return this.transforms=new qh,this}clearTransformsFromQueue(){this.done&&this._timeline&&this._timeline._runnerIds.includes(this.id)||(this._queue=this._queue.filter(e=>!e.isTransform))}delay(e){return this.animate(0,e)}duration(){return this._times*(this._wait+this._duration)-this._wait}during(e){return this.queue(null,e)}ease(e){return this._stepper=new Yd(e),this}element(e){return null==e?this._element:(this._element=e,e._prepareRunner(),this)}finish(){return this.step(1/0)}loop(e,t,a){return"object"==typeof e&&(t=e.swing,a=e.wait,e=e.times),this._times=e||1/0,this._swing=t||!1,this._wait=a||0,!0===this._times&&(this._times=1/0),this}loops(e){const t=this._duration+this._wait;if(null==e){const e=Math.floor(this._time/t),a=(this._time-e*t)/this._duration;return Math.min(e+a,this._times)}const a=e%1,i=t*Math.floor(e)+this._duration*a;return this.time(i)}persist(e){return null==e?this._persist:(this._persist=e,this)}position(e){const t=this._time,a=this._duration,i=this._wait,s=this._times,o=this._swing,n=this._reverse;let r;if(null==e){const e=function(e){const t=o*Math.floor(e%(2*(i+a))/(i+a)),s=t&&!n||!t&&n,r=Math.pow(-1,s)*(e%(i+a))/a+s;return Math.max(Math.min(r,1),0)},l=s*(i+a)-i;return r=t<=0?Math.round(e(1e-5)):t<l?e(t):Math.round(e(l-1e-5)),r}const l=Math.floor(this.loops()),c=o&&l%2==0;return r=l+(c&&!n||n&&c?e:1-e),this.loops(r)}progress(e){return null==e?Math.min(1,this._time/this.duration()):this.time(e*this.duration())}queue(e,t,a,i){return this._queue.push({initialiser:e||ld,runner:t||ld,retarget:a,isTransform:i,initialised:!1,finished:!1}),this.timeline()&&this.timeline()._continue(),this}reset(){return this._reseted||(this.time(0),this._reseted=!0),this}reverse(e){return this._reverse=null==e?!this._reverse:e,this}schedule(e,t,a){if(e instanceof Su||(a=t,t=e,e=this.timeline()),!e)throw Error("Runner cannot be scheduled without timeline");return e.schedule(this,t,a),this}step(e){if(!this.enabled)return this;e=null==e?16:e,this._time+=e;const t=this.position(),a=this._lastPosition!==t&&this._time>=0;this._lastPosition=t;const i=this.duration(),s=this._lastTime<=0&&this._time>0,o=this._lastTime<i&&this._time>=i;this._lastTime=this._time,s&&this.fire("start",this);const n=this._isDeclarative;this.done=!n&&!o&&this._time>=i,this._reseted=!1;let r=!1;return(a||n)&&(this._initialise(a),this.transforms=new qh,r=this._run(n?e:t),this.fire("step",this)),this.done=this.done||r&&n,o&&this.fire("finished",this),this}time(e){if(null==e)return this._time;const t=e-this._time;return this.step(t),this}timeline(e){return void 0===e?this._timeline:(this._timeline=e,this)}unschedule(){const e=this.timeline();return e&&e.unschedule(this),this}_initialise(e){if(e||this._isDeclarative)for(let t=0,a=this._queue.length;t<a;++t){const a=this._queue[t],i=this._isDeclarative||!a.initialised&&e;e=!a.finished,i&&e&&(a.initialiser.call(this),a.initialised=!0)}}_rememberMorpher(e,t){if(this._history[e]={morpher:t,caller:this._queue[this._queue.length-1]},this._isDeclarative){const e=this.timeline();e&&e.play()}}_run(e){let t=!0;for(let a=0,i=this._queue.length;a<i;++a){const i=this._queue[a],s=i.runner.call(this,e);i.finished=i.finished||!0===s,t=t&&i.finished}return t}_tryRetarget(e,t,a){if(this._history[e]){if(!this._history[e].caller.initialised){const t=this._queue.indexOf(this._history[e].caller);return this._queue.splice(t,1),!1}this._history[e].caller.retarget?this._history[e].caller.retarget.call(this,t,a):this._history[e].morpher.to(t),this._history[e].caller.finished=!1;const i=this.timeline();return i&&i.play(),!0}return!1}}_u.id=0;class ku{constructor(e=new qh,t=-1,a=!0){this.transforms=e,this.id=t,this.done=a}clearTransformsFromQueue(){}}Ih([_u,ku],{mergeWith(e){return new ku(e.transforms.lmultiply(this.transforms),e.id)}});const Cu=(e,t)=>e.lmultiplyO(t),Iu=e=>e.transforms;function Eu(){const e=this._transformationRunners.runners.map(Iu).reduce(Cu,new qh);this.transform(e),this._transformationRunners.merge(),1===this._transformationRunners.length()&&(this._frameId=null)}class Tu{constructor(){this.runners=[],this.ids=[]}add(e){if(this.runners.includes(e))return;const t=e.id+1;return this.runners.push(e),this.ids.push(t),this}clearBefore(e){const t=this.ids.indexOf(e+1)||1;return this.ids.splice(0,t,0),this.runners.splice(0,t,new ku).forEach(e=>e.clearTransformsFromQueue()),this}edit(e,t){const a=this.ids.indexOf(e+1);return this.ids.splice(a,1,e+1),this.runners.splice(a,1,t),this}getByID(e){return this.runners[this.ids.indexOf(e+1)]}length(){return this.ids.length}merge(){let e=null;for(let t=0;t<this.runners.length;++t){const a=this.runners[t];if(!(e&&a.done&&e.done)||a._timeline&&a._timeline._runnerIds.includes(a.id)||e._timeline&&e._timeline._runnerIds.includes(e.id))e=a;else{this.remove(a.id);const i=a.mergeWith(e);this.edit(e.id,i),e=i,--t}}return this}remove(e){const t=this.ids.indexOf(e+1);return this.ids.splice(t,1),this.runners.splice(t,1),this}}Jc({Element:{animate(e,t,a){const i=_u.sanitise(e,t,a),s=this.timeline();return new _u(i.duration).loop(i).element(this).timeline(s.play()).schedule(i.delay,i.when)},delay(e,t){return this.animate(0,e,t)},_clearTransformRunnersBefore(e){this._transformationRunners.clearBefore(e.id)},_currentTransform(e){return this._transformationRunners.runners.filter(t=>t.id<=e.id).map(Iu).reduce(Cu,new qh)},_addRunner(e){this._transformationRunners.add(e),wu.cancelImmediate(this._frameId),this._frameId=wu.immediate(Eu.bind(this))},_prepareRunner(){null==this._frameId&&(this._transformationRunners=(new Tu).add(new ku(new qh(this))))}}}),Ih(_u,{attr(e,t){return this.styleAttr("attr",e,t)},css(e,t){return this.styleAttr("css",e,t)},styleAttr(e,t,a){if("string"==typeof t)return this.styleAttr(e,{[t]:a});let i=t;if(this._tryRetarget(e,i))return this;let s=new ru(this._stepper).to(i),o=Object.keys(i);return this.queue(function(){s=s.from(this.element()[e](o))},function(t){return this.element()[e](s.at(t).valueOf()),s.done()},function(t){const a=Object.keys(t),n=(r=o,a.filter(e=>!r.includes(e)));var r;if(n.length){const t=this.element()[e](n),a=new du(s.from()).valueOf();Object.assign(a,t),s.from(a)}const l=new du(s.to()).valueOf();Object.assign(l,t),s.to(l),o=a,i=t}),this._rememberMorpher(e,s),this},zoom(e,t){if(this._tryRetarget("zoom",e,t))return this;let a=new ru(this._stepper).to(new dd(e));return this.queue(function(){a=a.from(this.element().zoom())},function(e){return this.element().zoom(a.at(e),t),a.done()},function(e,i){t=i,a.to(e)}),this._rememberMorpher("zoom",a),this},transform(e,t,a){if(t=e.relative||t,this._isDeclarative&&!t&&this._tryRetarget("transform",e))return this;const i=qh.isMatrixLike(e);a=null!=e.affine?e.affine:null!=a?a:!i;const s=new ru(this._stepper).type(a?cu:qh);let o,n,r,l,c;return this.queue(function(){n=n||this.element(),o=o||oh(e,n),c=new qh(t?void 0:n),n._addRunner(this),t||n._clearTransformRunnersBefore(this)},function(h){t||this.clearTransform();const{x:d,y:u}=new jh(o).transform(n._currentTransform(this));let p=new qh({...e,origin:[d,u]}),m=this._isDeclarative&&r?r:c;if(a){p=p.decompose(d,u),m=m.decompose(d,u);const e=p.rotate,t=m.rotate,a=[e-360,e,e+360],i=a.map(e=>Math.abs(e-t)),s=Math.min(...i),o=i.indexOf(s);p.rotate=a[o]}t&&(i||(p.rotate=e.rotate||0),this._isDeclarative&&l&&(m.rotate=l)),s.from(m),s.to(p);const g=s.at(h);return l=g.rotate,r=new qh(g),this.addTransform(r),n._addRunner(this),s.done()},function(t){(t.origin||"center").toString()!==(e.origin||"center").toString()&&(o=oh(t,n)),e={...t,origin:o}},!0),this._isDeclarative&&this._rememberMorpher("transform",s),this},x(e){return this._queueNumber("x",e)},y(e){return this._queueNumber("y",e)},ax(e){return this._queueNumber("ax",e)},ay(e){return this._queueNumber("ay",e)},dx(e=0){return this._queueNumberDelta("x",e)},dy(e=0){return this._queueNumberDelta("y",e)},dmove(e,t){return this.dx(e).dy(t)},_queueNumberDelta(e,t){if(t=new dd(t),this._tryRetarget(e,t))return this;const a=new ru(this._stepper).to(t);let i=null;return this.queue(function(){i=this.element()[e](),a.from(i),a.to(i+t)},function(t){return this.element()[e](a.at(t)),a.done()},function(e){a.to(i+new dd(e))}),this._rememberMorpher(e,a),this},_queueObject(e,t){if(this._tryRetarget(e,t))return this;const a=new ru(this._stepper).to(t);return this.queue(function(){a.from(this.element()[e]())},function(t){return this.element()[e](a.at(t)),a.done()}),this._rememberMorpher(e,a),this},_queueNumber(e,t){return this._queueObject(e,new dd(t))},cx(e){return this._queueNumber("cx",e)},cy(e){return this._queueNumber("cy",e)},move(e,t){return this.x(e).y(t)},amove(e,t){return this.ax(e).ay(t)},center(e,t){return this.cx(e).cy(t)},size(e,t){let a;return e&&t||(a=this._element.bbox()),e||(e=a.width/a.height*t),t||(t=a.height/a.width*e),this.width(e).height(t)},width(e){return this._queueNumber("width",e)},height(e){return this._queueNumber("height",e)},plot(e,t,a,i){if(4===arguments.length)return this.plot([e,t,a,i]);if(this._tryRetarget("plot",e))return this;const s=new ru(this._stepper).type(this._element.MorphArray).to(e);return this.queue(function(){s.from(this._element.array())},function(e){return this._element.plot(s.at(e)),s.done()}),this._rememberMorpher("plot",s),this},leading(e){return this._queueNumber("leading",e)},viewbox(e,t,a,i){return this._queueObject("viewbox",new Zh(e,t,a,i))},update(e){return"object"!=typeof e?this.update({offset:arguments[0],color:arguments[1],opacity:arguments[2]}):(null!=e.opacity&&this.attr("stop-opacity",e.opacity),null!=e.color&&this.attr("stop-color",e.color),null!=e.offset&&this.attr("offset",e.offset),this)}}),Ih(_u,{rx:vd,ry:xd,from:Rd,to:Dd}),Sh(_u,"Runner");class Au extends bd{constructor(e,t=e){super(wh("svg",e),t),this.namespace()}defs(){return this.isRoot()?vh(this.node.querySelector("defs"))||this.put(new yd):this.root().defs()}isRoot(){return!this.node.parentNode||!(this.node.parentNode instanceof uh.window.SVGElement)&&"#document-fragment"!==this.node.parentNode.nodeName}namespace(){return this.isRoot()?this.attr({xmlns:ch,version:"1.1"}).attr("xmlns:xlink",dh,hh):this.root().namespace()}removeNamespace(){return this.attr({xmlns:null,version:null}).attr("xmlns:xlink",null,hh).attr("xmlns:svgjs",null,hh)}root(){return this.isRoot()?this:super.root()}}Jc({Container:{nested:Eh(function(){return this.put(new Au)})}}),Sh(Au,"Svg",!0);let Pu=class extends bd{constructor(e,t=e){super(wh("symbol",e),t)}};Jc({Container:{symbol:Eh(function(){return this.put(new Pu)})}}),Sh(Pu,"Symbol");var Ru=Object.freeze({__proto__:null,amove:function(e,t){return this.ax(e).ay(t)},ax:function(e){return this.attr("x",e)},ay:function(e){return this.attr("y",e)},build:function(e){return this._build=!!e,this},center:function(e,t,a=this.bbox()){return this.cx(e,a).cy(t,a)},cx:function(e,t=this.bbox()){return null==e?t.cx:this.attr("x",this.attr("x")+e-t.cx)},cy:function(e,t=this.bbox()){return null==e?t.cy:this.attr("y",this.attr("y")+e-t.cy)},length:function(){return this.node.getComputedTextLength()},move:function(e,t,a=this.bbox()){return this.x(e,a).y(t,a)},plain:function(e){return!1===this._build&&this.clear(),this.node.appendChild(uh.document.createTextNode(e)),this},x:function(e,t=this.bbox()){return null==e?t.x:this.attr("x",this.attr("x")+e-t.x)},y:function(e,t=this.bbox()){return null==e?t.y:this.attr("y",this.attr("y")+e-t.y)}});class Du extends wd{constructor(e,t=e){super(wh("text",e),t),this.dom.leading=this.dom.leading??new dd(1.3),this._rebuild=!0,this._build=!1}leading(e){return null==e?this.dom.leading:(this.dom.leading=new dd(e),this.rebuild())}rebuild(e){if("boolean"==typeof e&&(this._rebuild=e),this._rebuild){const e=this;let t=0;const a=this.dom.leading;this.each(function(i){if(rh(this.node))return;const s=uh.window.getComputedStyle(this.node).getPropertyValue("font-size"),o=a*new dd(s);this.dom.newLined&&(this.attr("x",e.attr("x")),"\n"===this.text()?t+=o:(this.attr("dy",i?o+t:0),t=0))}),this.fire("rebuild")}return this}setData(e){return this.dom=e,this.dom.leading=new dd(e.leading||1.3),this}writeDataToDom(){return lh(this,this.dom,{leading:1.3}),this}text(e){if(void 0===e){const t=this.node.childNodes;let a=0;e="";for(let i=0,s=t.length;i<s;++i)"textPath"===t[i].nodeName||rh(t[i])?0===i&&(a=i+1):(i!==a&&3!==t[i].nodeType&&!0===vh(t[i]).dom.newLined&&(e+="\n"),e+=t[i].textContent);return e}if(this.clear().build(!0),"function"==typeof e)e.call(this,this);else for(let t=0,a=(e=(e+"").split("\n")).length;t<a;t++)this.newLine(e[t]);return this.build(!1).rebuild()}}Ih(Du,Ru),Jc({Container:{text:Eh(function(e=""){return this.put(new Du).text(e)}),plain:Eh(function(e=""){return this.put(new Du).plain(e)})}}),Sh(Du,"Text");class Mu extends wd{constructor(e,t=e){super(wh("tspan",e),t),this._build=!1}dx(e){return this.attr("dx",e)}dy(e){return this.attr("dy",e)}newLine(){this.dom.newLined=!0;const e=this.parent();if(!(e instanceof Du))return this;const t=e.index(this),a=uh.window.getComputedStyle(this.node).getPropertyValue("font-size"),i=e.dom.leading*new dd(a);return this.dy(t?i:0).attr("x",e.x())}text(e){return null==e?this.node.textContent+(this.dom.newLined?"\n":""):("function"==typeof e?(this.clear().build(!0),e.call(this,this),this.build(!1)):this.plain(e),this)}}Ih(Mu,Ru),Jc({Tspan:{tspan:Eh(function(e=""){const t=new Mu;return this._build||this.clear(),this.put(t).text(e)})},Text:{newLine:function(e=""){return this.tspan(e).newLine()}}}),Sh(Mu,"Tspan");class Lu extends wd{constructor(e,t=e){super(wh("circle",e),t)}radius(e){return this.attr("r",e)}rx(e){return this.attr("r",e)}ry(e){return this.rx(e)}size(e){return this.radius(new dd(e).divide(2))}}Ih(Lu,{x:Sd,y:_d,cx:kd,cy:Cd,width:Id,height:Ed}),Jc({Container:{circle:Eh(function(e=0){return this.put(new Lu).size(e).move(0,0)})}}),Sh(Lu,"Circle");class Nu extends bd{constructor(e,t=e){super(wh("clipPath",e),t)}remove(){return this.targets().forEach(function(e){e.unclip()}),super.remove()}targets(){return ed("svg [clip-path*="+this.id()+"]")}}Jc({Container:{clip:Eh(function(){return this.defs().put(new Nu)})},Element:{clipper(){return this.reference("clip-path")},clipWith(e){const t=e instanceof Nu?e:this.parent().clip().add(e);return this.attr("clip-path","url(#"+t.id()+")")},unclip(){return this.attr("clip-path",null)}}}),Sh(Nu,"ClipPath");class Ou extends gd{constructor(e,t=e){super(wh("foreignObject",e),t)}}Jc({Container:{foreignObject:Eh(function(e,t){return this.put(new Ou).size(e,t)})}}),Sh(Ou,"ForeignObject");var Gu=Object.freeze({__proto__:null,dmove:function(e,t){return this.children().forEach(a=>{let i;try{i=a.node instanceof ph().SVGSVGElement?new Zh(a.attr(["x","y","width","height"])):a.bbox()}catch(r){return}const s=new qh(a),o=s.translate(e,t).transform(s.inverse()),n=new jh(i.x,i.y).transform(o);a.move(n.x,n.y)}),this},dx:function(e){return this.dmove(e,0)},dy:function(e){return this.dmove(0,e)},height:function(e,t=this.bbox()){return null==e?t.height:this.size(t.width,e,t)},move:function(e=0,t=0,a=this.bbox()){const i=e-a.x,s=t-a.y;return this.dmove(i,s)},size:function(e,t,a=this.bbox()){const i=sh(this,e,t,a),s=i.width/a.width,o=i.height/a.height;return this.children().forEach(e=>{const t=new jh(a).transform(new qh(e).inverse());e.scale(s,o,t.x,t.y)}),this},width:function(e,t=this.bbox()){return null==e?t.width:this.size(e,t.height,t)},x:function(e,t=this.bbox()){return null==e?t.x:this.move(e,t.y,t)},y:function(e,t=this.bbox()){return null==e?t.y:this.move(t.x,e,t)}});class zu extends bd{constructor(e,t=e){super(wh("g",e),t)}}Ih(zu,Gu),Jc({Container:{group:Eh(function(){return this.put(new zu)})}}),Sh(zu,"G");class Fu extends bd{constructor(e,t=e){super(wh("a",e),t)}target(e){return this.attr("target",e)}to(e){return this.attr("href",e,dh)}}Ih(Fu,Gu),Jc({Container:{link:Eh(function(e){return this.put(new Fu).to(e)})},Element:{unlink(){const e=this.linker();if(!e)return this;const t=e.parent();if(!t)return this.remove();const a=t.index(e);return t.add(this,a),e.remove(),this},linkTo(e){let t=this.linker();return t||(t=new Fu,this.wrap(t)),"function"==typeof e?e.call(t,t):t.to(e),this},linker(){const e=this.parent();return e&&"a"===e.node.nodeName.toLowerCase()?e:null}}}),Sh(Fu,"A");class Hu extends bd{constructor(e,t=e){super(wh("mask",e),t)}remove(){return this.targets().forEach(function(e){e.unmask()}),super.remove()}targets(){return ed("svg [mask*="+this.id()+"]")}}Jc({Container:{mask:Eh(function(){return this.defs().put(new Hu)})},Element:{masker(){return this.reference("mask")},maskWith(e){const t=e instanceof Hu?e:this.parent().mask().add(e);return this.attr("mask","url(#"+t.id()+")")},unmask(){return this.attr("mask",null)}}}),Sh(Hu,"Mask");class Uu extends gd{constructor(e,t=e){super(wh("stop",e),t)}update(e){return("number"==typeof e||e instanceof dd)&&(e={offset:arguments[0],color:arguments[1],opacity:arguments[2]}),null!=e.opacity&&this.attr("stop-opacity",e.opacity),null!=e.color&&this.attr("stop-color",e.color),null!=e.offset&&this.attr("offset",new dd(e.offset)),this}}Jc({Gradient:{stop:function(e,t,a){return this.put(new Uu).update(e,t,a)}}}),Sh(Uu,"Stop");class Bu extends gd{constructor(e,t=e){super(wh("style",e),t)}addText(e=""){return this.node.textContent+=e,this}font(e,t,a={}){return this.rule("@font-face",{fontFamily:e,src:t,...a})}rule(e,t){return this.addText(function(e,t){if(!e)return"";if(!t)return e;let a=e+"{";for(const i in t)a+=i.replace(/([A-Z])/g,function(e,t){return"-"+t.toLowerCase()})+":"+t[i]+";";return a+="}",a}(e,t))}}Jc("Dom",{style(e,t){return this.put(new Bu).rule(e,t)},fontface(e,t,a){return this.put(new Bu).font(e,t,a)}}),Sh(Bu,"Style");class Wu extends Du{constructor(e,t=e){super(wh("textPath",e),t)}array(){const e=this.track();return e?e.array():null}plot(e){const t=this.track();let a=null;return t&&(a=t.plot(e)),null==e?a:this}track(){return this.reference("href")}}Jc({Container:{textPath:Eh(function(e,t){return e instanceof Du||(e=this.text(e)),e.path(t)})},Text:{path:Eh(function(e,t=!0){const a=new Wu;let i;if(e instanceof pu||(e=this.defs().path(e)),a.attr("href","#"+e,dh),t)for(;i=this.node.firstChild;)a.node.appendChild(i);return this.put(a)}),textPath(){return this.findOne("textPath")}},Path:{text:Eh(function(e){return e instanceof Du||(e=(new Du).addTo(this.parent()).text(e)),e.path(this)}),targets(){return ed("svg textPath").filter(e=>(e.attr("href")||"").includes(this.id()))}}}),Wu.prototype.MorphArray=ou,Sh(Wu,"TextPath");class Vu extends wd{constructor(e,t=e){super(wh("use",e),t)}use(e,t){return this.attr("href",(t||"")+"#"+e,dh)}}Jc({Container:{use:Eh(function(e,t){return this.put(new Vu).use(e,t)})}}),Sh(Vu,"Use");const ju=yh;Ih([Au,Pu,Od,Nd,Bd],Qc("viewbox")),Ih([Ud,fu,gu,pu],Qc("marker")),Ih(Du,Qc("Text")),Ih(pu,Qc("Path")),Ih(yd,Qc("Defs")),Ih([Du,Mu],Qc("Tspan")),Ih([bu,Ad,Ld,_u],Qc("radius")),Ih(rd,Qc("EventTarget")),Ih(md,Qc("Dom")),Ih(gd,Qc("Element")),Ih(wd,Qc("Shape")),Ih([bd,Pd],Qc("Container")),Ih(Ld,Qc("Gradient")),Ih(_u,Qc("Runner")),Jh.extend([...new Set(Kc)]),function(e=[]){uu.push(...[].concat(e))}([dd,Vh,Zh,qh,hd,zd,ou,jh]),Ih(uu,{to(e){return(new ru).type(this.constructor).from(this.toArray()).to(e)},fromArray(e){return this.init(e),this},toConsumable(){return this.toArray()},morph(e,t,a,i,s){return this.fromArray(e.map(function(e,o){return i.step(e,t[o],a,s[o],s)}))}});class Yu extends gd{constructor(e){super(wh("filter",e),e),this.$source="SourceGraphic",this.$sourceAlpha="SourceAlpha",this.$background="BackgroundImage",this.$backgroundAlpha="BackgroundAlpha",this.$fill="FillPaint",this.$stroke="StrokePaint",this.$autoSetIn=!0}put(e,t){return!(e=super.put(e,t)).attr("in")&&this.$autoSetIn&&e.attr("in",this.$source),e.attr("result")||e.attr("result",e.id()),e}remove(){return this.targets().each("unfilter"),super.remove()}targets(){return ed('svg [filter*="'+this.id()+'"]')}toString(){return"url(#"+this.id()+")"}}class qu extends gd{constructor(e,t){super(e,t),this.result(this.id())}in(e){if(null==e){const e=this.attr("in");return this.parent()&&this.parent().find(`[result="${e}"]`)[0]||e}return this.attr("in",e)}result(e){return this.attr("result",e)}toString(){return this.result()}}const Xu=e=>function(...t){for(let a=e.length;a--;)null!=t[a]&&this.attr(e[a],t[a])},$u={blend:Xu(["in","in2","mode"]),colorMatrix:Xu(["type","values"]),composite:Xu(["in","in2","operator"]),convolveMatrix:function(e){e=new hd(e).toString(),this.attr({order:Math.sqrt(e.split(" ").length),kernelMatrix:e})},diffuseLighting:Xu(["surfaceScale","lightingColor","diffuseConstant","kernelUnitLength"]),displacementMap:Xu(["in","in2","scale","xChannelSelector","yChannelSelector"]),dropShadow:Xu(["in","dx","dy","stdDeviation"]),flood:Xu(["flood-color","flood-opacity"]),gaussianBlur:function(e=0,t=e){this.attr("stdDeviation",e+" "+t)},image:function(e){this.attr("href",e,dh)},morphology:Xu(["operator","radius"]),offset:Xu(["dx","dy"]),specularLighting:Xu(["surfaceScale","lightingColor","diffuseConstant","specularExponent","kernelUnitLength"]),tile:Xu([]),turbulence:Xu(["baseFrequency","numOctaves","seed","stitchTiles","type"])};["blend","colorMatrix","componentTransfer","composite","convolveMatrix","diffuseLighting","displacementMap","dropShadow","flood","gaussianBlur","image","merge","morphology","offset","specularLighting","tile","turbulence"].forEach(e=>{const t=ih(e),a=$u[e];Yu[t+"Effect"]=class extends qu{constructor(e){super(wh("fe"+t,e),e)}update(e){return a.apply(this,e),this}},Yu.prototype[e]=Eh(function(e,...a){const i=new Yu[t+"Effect"];return null==e?this.put(i):("function"==typeof e?e.call(i,i):a.unshift(e),this.put(i).update(a))})}),Ih(Yu,{merge(e){const t=this.put(new Yu.MergeEffect);return"function"==typeof e?(e.call(t,t),t):((e instanceof Array?e:[...arguments]).forEach(e=>{e instanceof Yu.MergeNode?t.put(e):t.mergeNode(e)}),t)},componentTransfer(e={}){const t=this.put(new Yu.ComponentTransferEffect);if("function"==typeof e)return e.call(t,t),t;e.r||e.g||e.b||e.a||(e={r:e,g:e,b:e,a:e});for(const a in e)t.add(new(Yu["Func"+a.toUpperCase()])(e[a]));return t}}),["distantLight","pointLight","spotLight","mergeNode","FuncR","FuncG","FuncB","FuncA"].forEach(e=>{const t=ih(e);Yu[t]=class extends qu{constructor(e){super(wh("fe"+t,e),e)}}}),["funcR","funcG","funcB","funcA"].forEach(function(e){const t=Yu[ih(e)],a=Eh(function(){return this.put(new t)});Yu.ComponentTransferEffect.prototype[e]=a}),["distantLight","pointLight","spotLight"].forEach(e=>{const t=Yu[ih(e)],a=Eh(function(){return this.put(new t)});Yu.DiffuseLightingEffect.prototype[e]=a,Yu.SpecularLightingEffect.prototype[e]=a}),Ih(Yu.MergeEffect,{mergeNode(e){return this.put(new Yu.MergeNode).attr("in",e)}}),Ih(yd,{filter:function(e){const t=this.put(new Yu);return"function"==typeof e&&e.call(t,t),t}}),Ih(bd,{filter:function(e){return this.defs().filter(e)}}),Ih(gd,{filterWith:function(e){const t=e instanceof Yu?e:this.defs().filter(e);return this.attr("filter",t)},unfilter:function(e){return this.attr("filter",null)},filterer(){return this.reference("filter")}});Ih(qu,{blend:function(e,t){return this.parent()&&this.parent().blend(this,e,t)},colorMatrix:function(e,t){return this.parent()&&this.parent().colorMatrix(e,t).in(this)},componentTransfer:function(e){return this.parent()&&this.parent().componentTransfer(e).in(this)},composite:function(e,t){return this.parent()&&this.parent().composite(this,e,t)},convolveMatrix:function(e){return this.parent()&&this.parent().convolveMatrix(e).in(this)},diffuseLighting:function(e,t,a,i){return this.parent()&&this.parent().diffuseLighting(e,a,i).in(this)},displacementMap:function(e,t,a,i){return this.parent()&&this.parent().displacementMap(this,e,t,a,i)},dropShadow:function(e,t,a){return this.parent()&&this.parent().dropShadow(this,e,t,a).in(this)},flood:function(e,t){return this.parent()&&this.parent().flood(e,t)},gaussianBlur:function(e,t){return this.parent()&&this.parent().gaussianBlur(e,t).in(this)},image:function(e){return this.parent()&&this.parent().image(e)},merge:function(e){return e=e instanceof Array?e:[...e],this.parent()&&this.parent().merge(this,...e)},morphology:function(e,t){return this.parent()&&this.parent().morphology(e,t).in(this)},offset:function(e,t){return this.parent()&&this.parent().offset(e,t).in(this)},specularLighting:function(e,t,a,i,s){return this.parent()&&this.parent().specularLighting(e,a,i,s).in(this)},tile:function(){return this.parent()&&this.parent().tile().in(this)},turbulence:function(e,t,a,i,s){return this.parent()&&this.parent().turbulence(e,t,a,i,s).in(this)}}),Ih(Yu.MergeEffect,{in:function(e){return e instanceof Yu.MergeNode?this.add(e,0):this.add((new Yu.MergeNode).in(e),0),this}}),Ih([Yu.CompositeEffect,Yu.BlendEffect,Yu.DisplacementMapEffect],{in2:function(e){if(null==e){const e=this.attr("in2");return this.parent()&&this.parent().find(`[result="${e}"]`)[0]||e}return this.attr("in2",e)}}),Yu.filter={sepiatone:[.343,.669,.119,0,0,.249,.626,.13,0,0,.172,.334,.111,0,0,0,0,0,1,0]};var Zu=function(){function e(t){Rc(this,e),this.ctx=t,this.w=t.w}return Mc(e,[{key:"getDefaultFilter",value:function(e,t){var a=this.w;e.unfilter(!0),(new Yu).size("120%","180%","-5%","-40%"),a.config.chart.dropShadow.enabled&&this.dropShadow(e,a.config.chart.dropShadow,t)}},{key:"applyFilter",value:function(e,t,a){var i,s=this,o=this.w;if(e.unfilter(!0),"none"!==a){var n,r,l=o.config.chart.dropShadow,c="lighten"===a?2:.3;e.filterWith(function(e){e.colorMatrix({type:"matrix",values:"\n          ".concat(c," 0 0 0 0\n          0 ").concat(c," 0 0 0\n          0 0 ").concat(c," 0 0\n          0 0 0 1 0\n        "),in:"SourceGraphic",result:"brightness"}),l.enabled&&s.addShadow(e,t,l,"brightness")}),l.noUserSpaceOnUse||null===(n=e.filterer())||void 0===n||null===(r=n.node)||void 0===r||r.setAttribute("filterUnits","userSpaceOnUse"),this._scaleFilterSize(null===(i=e.filterer())||void 0===i?void 0:i.node)}else this.getDefaultFilter(e,t)}},{key:"addShadow",value:function(e,t,a,i){var s,o=this.w,n=a.blur,r=a.top,l=a.left,c=a.color,h=a.opacity;if(c=Array.isArray(c)?c[t]:c,(null===(s=o.config.chart.dropShadow.enabledOnSeries)||void 0===s?void 0:s.length)>0&&-1===o.config.chart.dropShadow.enabledOnSeries.indexOf(t))return e;e.offset({in:i,dx:l,dy:r,result:"offset"}),e.gaussianBlur({in:"offset",stdDeviation:n,result:"blur"}),e.flood({"flood-color":c,"flood-opacity":h,result:"flood"}),e.composite({in:"flood",in2:"blur",operator:"in",result:"shadow"}),e.merge(["shadow",i])}},{key:"dropShadow",value:function(e,t){var a,i,s,o,n,r=this,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=this.w;return e.unfilter(!0),Xc.isMsEdge()&&"radialBar"===c.config.chart.type||(null===(a=c.config.chart.dropShadow.enabledOnSeries)||void 0===a?void 0:a.length)>0&&-1===(null===(s=c.config.chart.dropShadow.enabledOnSeries)||void 0===s?void 0:s.indexOf(l))||(e.filterWith(function(e){r.addShadow(e,l,t,"SourceGraphic")}),t.noUserSpaceOnUse||null===(o=e.filterer())||void 0===o||null===(n=o.node)||void 0===n||n.setAttribute("filterUnits","userSpaceOnUse"),this._scaleFilterSize(null===(i=e.filterer())||void 0===i?void 0:i.node)),e}},{key:"setSelectionFilter",value:function(e,t,a){var i=this.w;if(void 0!==i.globals.selectedDataPoints[t]&&i.globals.selectedDataPoints[t].indexOf(a)>-1){e.node.setAttribute("selected",!0);var s=i.config.states.active.filter;"none"!==s&&this.applyFilter(e,t,s.type)}}},{key:"_scaleFilterSize",value:function(e){e&&function(t){for(var a in t)t.hasOwnProperty(a)&&e.setAttribute(a,t[a])}({width:"200%",height:"200%",x:"-50%",y:"-50%"})}}]),e}(),Ku=function(){function e(t){Rc(this,e),this.ctx=t,this.w=t.w}return Mc(e,[{key:"roundPathCorners",value:function(e,t){function a(e,t,a){var s=t.x-e.x,o=t.y-e.y,n=Math.sqrt(s*s+o*o);return i(e,t,Math.min(1,a/n))}function i(e,t,a){return{x:e.x+(t.x-e.x)*a,y:e.y+(t.y-e.y)*a}}function s(e,t){e.length>2&&(e[e.length-2]=t.x,e[e.length-1]=t.y)}function o(e){return{x:parseFloat(e[e.length-2]),y:parseFloat(e[e.length-1])}}e.indexOf("NaN")>-1&&(e="");var n=e.split(/[,\s]/).reduce(function(e,t){var a=t.match(/^([a-zA-Z])(.+)/);return a?(e.push(a[1]),e.push(a[2])):e.push(t),e},[]).reduce(function(e,t){return parseFloat(t)==t&&e.length?e[e.length-1].push(t):e.push([t]),e},[]),r=[];if(n.length>1){var l=o(n[0]),c=null;"Z"==n[n.length-1][0]&&n[0].length>2&&(c=["L",l.x,l.y],n[n.length-1]=c),r.push(n[0]);for(var h=1;h<n.length;h++){var d=r[r.length-1],u=n[h],p=u==c?n[1]:n[h+1];if(p&&d&&d.length>2&&"L"==u[0]&&p.length>2&&"L"==p[0]){var m,g,f=o(d),b=o(u),y=o(p);m=a(b,f,t),g=a(b,y,t),s(u,m),u.origPoint=b,r.push(u);var w=i(m,b,.5),v=i(b,g,.5),x=["C",w.x,w.y,v.x,v.y,g.x,g.y];x.origPoint=b,r.push(x)}else r.push(u)}if(c){var S=o(r[r.length-1]);r.push(["Z"]),s(r[0],S)}}else r=n;return r.reduce(function(e,t){return e+t.join(" ")+" "},"")}},{key:"drawLine",value:function(e,t,a,i){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"#a8a8a8",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,n=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,r=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"butt";return this.w.globals.dom.Paper.line().attr({x1:e,y1:t,x2:a,y2:i,stroke:s,"stroke-dasharray":o,"stroke-width":n,"stroke-linecap":r})}},{key:"drawRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"#fefefe",n=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,r=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,h=this.w.globals.dom.Paper.rect();return h.attr({x:e,y:t,width:a>0?a:0,height:i>0?i:0,rx:s,ry:s,opacity:n,"stroke-width":null!==r?r:0,stroke:null!==l?l:"none","stroke-dasharray":c}),h.node.setAttribute("fill",o),h}},{key:"drawPolygon",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#e1e1e1",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"none";return this.w.globals.dom.Paper.polygon(e).attr({fill:i,stroke:t,"stroke-width":a})}},{key:"drawCircle",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;e<0&&(e=0);var a=this.w.globals.dom.Paper.circle(2*e);return null!==t&&a.attr(t),a}},{key:"drawPath",value:function(e){var t=e.d,a=void 0===t?"":t,i=e.stroke,s=void 0===i?"#a8a8a8":i,o=e.strokeWidth,n=void 0===o?1:o,r=e.fill,l=e.fillOpacity,c=void 0===l?1:l,h=e.strokeOpacity,d=void 0===h?1:h,u=e.classes,p=e.strokeLinecap,m=void 0===p?null:p,g=e.strokeDashArray,f=void 0===g?0:g,b=this.w;return null===m&&(m=b.config.stroke.lineCap),(a.indexOf("undefined")>-1||a.indexOf("NaN")>-1)&&(a="M 0 ".concat(b.globals.gridHeight)),b.globals.dom.Paper.path(a).attr({fill:r,"fill-opacity":c,stroke:s,"stroke-opacity":d,"stroke-linecap":m,"stroke-width":n,"stroke-dasharray":f,class:u})}},{key:"group",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.w.globals.dom.Paper.group();return null!==e&&t.attr(e),t}},{key:"move",value:function(e,t){return["M",e,t].join(" ")}},{key:"line",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=null;return null===a?i=[" L",e,t].join(" "):"H"===a?i=[" H",e].join(" "):"V"===a&&(i=[" V",t].join(" ")),i}},{key:"curve",value:function(e,t,a,i,s,o){return["C",e,t,a,i,s,o].join(" ")}},{key:"quadraticCurve",value:function(e,t,a,i){return["Q",e,t,a,i].join(" ")}},{key:"arc",value:function(e,t,a,i,s,o,n){var r="A";return arguments.length>7&&void 0!==arguments[7]&&arguments[7]&&(r="a"),[r,e,t,a,i,s,o,n].join(" ")}},{key:"renderPaths",value:function(e){var t,a=e.j,i=e.realIndex,s=e.pathFrom,o=e.pathTo,n=e.stroke,r=e.strokeWidth,l=e.strokeLinecap,c=e.fill,h=e.animationDelay,d=e.initialSpeed,u=e.dataChangeSpeed,p=e.className,m=e.chartType,g=e.shouldClipToGrid,f=void 0===g||g,b=e.bindEventsOnPaths,y=void 0===b||b,w=e.drawShadow,v=void 0===w||w,x=this.w,S=new Zu(this.ctx),_=new $c(this.ctx),k=this.w.config.chart.animations.enabled,C=k&&this.w.config.chart.animations.dynamicAnimation.enabled;if(s&&s.startsWith("M 0 0")&&o){var I=o.match(/^M\s+[\d.-]+\s+[\d.-]+/);I&&(s=s.replace(/^M\s+0\s+0/,I[0]))}var E=!!(k&&!x.globals.resized||C&&x.globals.dataChanged&&x.globals.shouldAnimate);E?t=s:(t=o,x.globals.animationEnded=!0);var T,A=x.config.stroke.dashArray;T=Array.isArray(A)?A[i]:x.config.stroke.dashArray;var P=this.drawPath({d:t,stroke:n,strokeWidth:r,fill:c,fillOpacity:1,classes:p,strokeLinecap:l,strokeDashArray:T});P.attr("index",i),f&&("bar"===m&&!x.globals.isHorizontal||x.globals.comboCharts?P.attr({"clip-path":"url(#gridRectBarMask".concat(x.globals.cuid,")")}):P.attr({"clip-path":"url(#gridRectMask".concat(x.globals.cuid,")")})),x.config.chart.dropShadow.enabled&&v&&S.dropShadow(P,x.config.chart.dropShadow,i),y&&(P.node.addEventListener("mouseenter",this.pathMouseEnter.bind(this,P)),P.node.addEventListener("mouseleave",this.pathMouseLeave.bind(this,P)),P.node.addEventListener("mousedown",this.pathMouseDown.bind(this,P))),P.attr({pathTo:o,pathFrom:s});var R={el:P,j:a,realIndex:i,pathFrom:s,pathTo:o,fill:c,strokeWidth:r,delay:h};return!k||x.globals.resized||x.globals.dataChanged?!x.globals.resized&&x.globals.dataChanged||_.showDelayedElements():_.animatePathsGradually(Uc(Uc({},R),{},{speed:d})),x.globals.dataChanged&&C&&E&&_.animatePathsGradually(Uc(Uc({},R),{},{speed:u})),P}},{key:"drawPattern",value:function(e,t,a){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"#a8a8a8",s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return this.w.globals.dom.Paper.pattern(t,a,function(o){"horizontalLines"===e?o.line(0,0,a,0).stroke({color:i,width:s+1}):"verticalLines"===e?o.line(0,0,0,t).stroke({color:i,width:s+1}):"slantedLines"===e?o.line(0,0,t,a).stroke({color:i,width:s}):"squares"===e?o.rect(t,a).fill("none").stroke({color:i,width:s}):"circles"===e&&o.circle(t).fill("none").stroke({color:i,width:s})})}},{key:"drawGradient",value:function(e,t,a,i,s){var o,n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:[],c=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,h=this.w;t.length<9&&0===t.indexOf("#")&&(t=Xc.hexToRgba(t,i)),a.length<9&&0===a.indexOf("#")&&(a=Xc.hexToRgba(a,s));var d=0,u=1,p=1,m=null;null!==r&&(d=void 0!==r[0]?r[0]/100:0,u=void 0!==r[1]?r[1]/100:1,p=void 0!==r[2]?r[2]/100:1,m=void 0!==r[3]?r[3]/100:null);var g=!("donut"!==h.config.chart.type&&"pie"!==h.config.chart.type&&"polarArea"!==h.config.chart.type&&"bubble"!==h.config.chart.type);if(o=l&&0!==l.length?h.globals.dom.Paper.gradient(g?"radial":"linear",function(e){(Array.isArray(l[c])?l[c]:l).forEach(function(t){e.stop(t.offset/100,t.color,t.opacity)})}):h.globals.dom.Paper.gradient(g?"radial":"linear",function(e){e.stop(d,t,i),e.stop(u,a,s),e.stop(p,a,s),null!==m&&e.stop(m,t,i)}),g){var f=h.globals.gridWidth/2,b=h.globals.gridHeight/2;"bubble"!==h.config.chart.type?o.attr({gradientUnits:"userSpaceOnUse",cx:f,cy:b,r:n}):o.attr({cx:.5,cy:.5,r:.8,fx:.2,fy:.2})}else"vertical"===e?o.from(0,0).to(0,1):"diagonal"===e?o.from(0,0).to(1,1):"horizontal"===e?o.from(0,1).to(1,1):"diagonal2"===e&&o.from(1,0).to(0,1);return o}},{key:"getTextBasedOnMaxWidth",value:function(e){var t=e.text,a=e.maxWidth,i=e.fontSize,s=e.fontFamily,o=this.getTextRects(t,i,s),n=o.width/t.length,r=Math.floor(a/n);return a<o.width?t.slice(0,r-3)+"...":t}},{key:"drawText",value:function(e){var t=this,a=e.x,i=e.y,s=e.text,o=e.textAnchor,n=e.fontSize,r=e.fontFamily,l=e.fontWeight,c=e.foreColor,h=e.opacity,d=e.maxWidth,u=e.cssClass,p=void 0===u?"":u,m=e.isPlainText,g=void 0===m||m,f=e.dominantBaseline,b=void 0===f?"auto":f,y=this.w;void 0===s&&(s="");var w=s;o||(o="start"),c&&c.length||(c=y.config.chart.foreColor),r=r||y.config.chart.fontFamily,l=l||"regular";var v,x={maxWidth:d,fontSize:n=n||"11px",fontFamily:r};return Array.isArray(s)?v=y.globals.dom.Paper.text(function(e){for(var a=0;a<s.length;a++)w=s[a],d&&(w=t.getTextBasedOnMaxWidth(Uc({text:s[a]},x))),0===a?e.tspan(w):e.tspan(w).newLine()}):(d&&(w=this.getTextBasedOnMaxWidth(Uc({text:s},x))),v=g?y.globals.dom.Paper.plain(s):y.globals.dom.Paper.text(function(e){return e.tspan(w)})),v.attr({x:a,y:i,"text-anchor":o,"dominant-baseline":b,"font-size":n,"font-family":r,"font-weight":l,fill:c,class:"apexcharts-text "+p}),v.node.style.fontFamily=r,v.node.style.opacity=h,v}},{key:"getMarkerPath",value:function(e,t,a,i){var s="";switch(a){case"cross":s="M ".concat(e-(i/=1.4)," ").concat(t-i," L ").concat(e+i," ").concat(t+i,"  M ").concat(e-i," ").concat(t+i," L ").concat(e+i," ").concat(t-i);break;case"plus":s="M ".concat(e-(i/=1.12)," ").concat(t," L ").concat(e+i," ").concat(t,"  M ").concat(e," ").concat(t-i," L ").concat(e," ").concat(t+i);break;case"star":case"sparkle":var o=5;i*=1.15,"sparkle"===a&&(i/=1.1,o=4);for(var n=Math.PI/o,r=0;r<=2*o;r++){var l=r*n,c=r%2==0?i:i/2;s+=(0===r?"M":"L")+(e+c*Math.sin(l))+","+(t-c*Math.cos(l))}s+="Z";break;case"triangle":s="M ".concat(e," ").concat(t-i," \n             L ").concat(e+i," ").concat(t+i," \n             L ").concat(e-i," ").concat(t+i," \n             Z");break;case"square":case"rect":s="M ".concat(e-(i/=1.125)," ").concat(t-i," \n           L ").concat(e+i," ").concat(t-i," \n           L ").concat(e+i," ").concat(t+i," \n           L ").concat(e-i," ").concat(t+i," \n           Z");break;case"diamond":i*=1.05,s="M ".concat(e," ").concat(t-i," \n             L ").concat(e+i," ").concat(t," \n             L ").concat(e," ").concat(t+i," \n             L ").concat(e-i," ").concat(t," \n            Z");break;case"line":s="M ".concat(e-(i/=1.1)," ").concat(t," \n           L ").concat(e+i," ").concat(t);break;default:i*=2,s="M ".concat(e,", ").concat(t," \n           m -").concat(i/2,", 0 \n           a ").concat(i/2,",").concat(i/2," 0 1,0 ").concat(i,",0 \n           a ").concat(i/2,",").concat(i/2," 0 1,0 -").concat(i,",0")}return s}},{key:"drawMarkerShape",value:function(e,t,a,i,s){var o=this.drawPath({d:this.getMarkerPath(e,t,a,i,s),stroke:s.pointStrokeColor,strokeDashArray:s.pointStrokeDashArray,strokeWidth:s.pointStrokeWidth,fill:s.pointFillColor,fillOpacity:s.pointFillOpacity,strokeOpacity:s.pointStrokeOpacity});return o.attr({cx:e,cy:t,shape:s.shape,class:s.class?s.class:""}),o}},{key:"drawMarker",value:function(e,t,a){e=e||0;var i=a.pSize||0;return Xc.isNumber(t)||(i=0,t=0),this.drawMarkerShape(e,t,null==a?void 0:a.shape,i,Uc(Uc({},a),"line"===a.shape||"plus"===a.shape||"cross"===a.shape?{pointStrokeColor:a.pointFillColor,pointStrokeOpacity:a.pointFillOpacity}:{}))}},{key:"pathMouseEnter",value:function(e,t){var a=this.w,i=new Zu(this.ctx),s=parseInt(e.node.getAttribute("index"),10),o=parseInt(e.node.getAttribute("j"),10);if("function"==typeof a.config.chart.events.dataPointMouseEnter&&a.config.chart.events.dataPointMouseEnter(t,this.ctx,{seriesIndex:s,dataPointIndex:o,w:a}),this.ctx.events.fireEvent("dataPointMouseEnter",[t,this.ctx,{seriesIndex:s,dataPointIndex:o,w:a}]),("none"===a.config.states.active.filter.type||"true"!==e.node.getAttribute("selected"))&&"none"!==a.config.states.hover.filter.type&&!a.globals.isTouchDevice){var n=a.config.states.hover.filter;i.applyFilter(e,s,n.type)}}},{key:"pathMouseLeave",value:function(e,t){var a=this.w,i=new Zu(this.ctx),s=parseInt(e.node.getAttribute("index"),10),o=parseInt(e.node.getAttribute("j"),10);"function"==typeof a.config.chart.events.dataPointMouseLeave&&a.config.chart.events.dataPointMouseLeave(t,this.ctx,{seriesIndex:s,dataPointIndex:o,w:a}),this.ctx.events.fireEvent("dataPointMouseLeave",[t,this.ctx,{seriesIndex:s,dataPointIndex:o,w:a}]),"none"!==a.config.states.active.filter.type&&"true"===e.node.getAttribute("selected")||"none"!==a.config.states.hover.filter.type&&i.getDefaultFilter(e,s)}},{key:"pathMouseDown",value:function(e,t){var a=this.w,i=new Zu(this.ctx),s=parseInt(e.node.getAttribute("index"),10),o=parseInt(e.node.getAttribute("j"),10),n="false";if("true"===e.node.getAttribute("selected")){if(e.node.setAttribute("selected","false"),a.globals.selectedDataPoints[s].indexOf(o)>-1){var r=a.globals.selectedDataPoints[s].indexOf(o);a.globals.selectedDataPoints[s].splice(r,1)}}else{if(!a.config.states.active.allowMultipleDataPointsSelection&&a.globals.selectedDataPoints.length>0){a.globals.selectedDataPoints=[];var l=a.globals.dom.Paper.find(".apexcharts-series path:not(.apexcharts-decoration-element)"),c=a.globals.dom.Paper.find(".apexcharts-series circle:not(.apexcharts-decoration-element), .apexcharts-series rect:not(.apexcharts-decoration-element)"),h=function(e){Array.prototype.forEach.call(e,function(e){e.node.setAttribute("selected","false"),i.getDefaultFilter(e,s)})};h(l),h(c)}e.node.setAttribute("selected","true"),n="true",void 0===a.globals.selectedDataPoints[s]&&(a.globals.selectedDataPoints[s]=[]),a.globals.selectedDataPoints[s].push(o)}if("true"===n){var d=a.config.states.active.filter;if("none"!==d)i.applyFilter(e,s,d.type);else if("none"!==a.config.states.hover.filter&&!a.globals.isTouchDevice){var u=a.config.states.hover.filter;i.applyFilter(e,s,u.type)}}else"none"!==a.config.states.active.filter.type&&("none"===a.config.states.hover.filter.type||a.globals.isTouchDevice?i.getDefaultFilter(e,s):(u=a.config.states.hover.filter,i.applyFilter(e,s,u.type)));"function"==typeof a.config.chart.events.dataPointSelection&&a.config.chart.events.dataPointSelection(t,this.ctx,{selectedDataPoints:a.globals.selectedDataPoints,seriesIndex:s,dataPointIndex:o,w:a}),t&&this.ctx.events.fireEvent("dataPointSelection",[t,this.ctx,{selectedDataPoints:a.globals.selectedDataPoints,seriesIndex:s,dataPointIndex:o,w:a}])}},{key:"rotateAroundCenter",value:function(e){var t={};return e&&"function"==typeof e.getBBox&&(t=e.getBBox()),{x:t.x+t.width/2,y:t.y+t.height/2}}},{key:"getTextRects",value:function(e,t,a,i){var s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=this.w,n=this.drawText({x:-200,y:-200,text:e,textAnchor:"start",fontSize:t,fontFamily:a,foreColor:"#fff",opacity:0});i&&n.attr("transform",i),o.globals.dom.Paper.add(n);var r=n.bbox();return s||(r=n.node.getBoundingClientRect()),n.remove(),{width:r.width,height:r.height}}},{key:"placeTextWithEllipsis",value:function(e,t,a){if("function"==typeof e.getComputedTextLength&&(e.textContent=t,t.length>0&&e.getComputedTextLength()>=a/1.1)){for(var i=t.length-3;i>0;i-=3)if(e.getSubStringLength(0,i)<=a/1.1)return void(e.textContent=t.substring(0,i)+"...");e.textContent="."}}}],[{key:"setAttrs",value:function(e,t){for(var a in t)t.hasOwnProperty(a)&&e.setAttribute(a,t[a])}}]),e}(),Ju=function(){function e(t){Rc(this,e),this.ctx=t,this.w=t.w}return Mc(e,[{key:"getStackedSeriesTotals",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.w,a=[];if(0===t.globals.series.length)return a;for(var i=0;i<t.globals.series[t.globals.maxValsInArrayIndex].length;i++){for(var s=0,o=0;o<t.globals.series.length;o++)void 0!==t.globals.series[o][i]&&-1===e.indexOf(o)&&(s+=t.globals.series[o][i]);a.push(s)}return a}},{key:"getSeriesTotalByIndex",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null===e?this.w.config.series.reduce(function(e,t){return e+t},0):this.w.globals.series[e].reduce(function(e,t){return e+t},0)}},{key:"getStackedSeriesTotalsByGroups",value:function(){var e=this,t=this.w,a=[];return t.globals.seriesGroups.forEach(function(i){var s=[];t.config.series.forEach(function(e,a){i.indexOf(t.globals.seriesNames[a])>-1&&s.push(a)});var o=t.globals.series.map(function(e,t){return-1===s.indexOf(t)?t:-1}).filter(function(e){return-1!==e});a.push(e.getStackedSeriesTotals(o))}),a}},{key:"setSeriesYAxisMappings",value:function(){var e=this.w.globals,t=this.w.config,a=[],i=[],s=[],o=e.series.length>t.yaxis.length||t.yaxis.some(function(e){return Array.isArray(e.seriesName)});t.series.forEach(function(e,t){s.push(t),i.push(null)}),t.yaxis.forEach(function(e,t){a[t]=[]});var n=[];t.yaxis.forEach(function(e,i){var r=!1;if(e.seriesName){var l=[];Array.isArray(e.seriesName)?l=e.seriesName:l.push(e.seriesName),l.forEach(function(e){t.series.forEach(function(t,n){if(t.name===e){var l=n;i===n||o?!o||s.indexOf(n)>-1?a[i].push([i,n]):console.warn("Series '"+t.name+"' referenced more than once in what looks like the new style. That is, when using either seriesName: [], or when there are more series than yaxes."):(a[n].push([n,i]),l=i),r=!0,-1!==(l=s.indexOf(l))&&s.splice(l,1)}})})}r||n.push(i)}),a=a.map(function(e,t){var a=[];return e.forEach(function(e){i[e[1]]=e[0],a.push(e[1])}),a});for(var r=t.yaxis.length-1,l=0;l<n.length&&(r=n[l],a[r]=[],s);l++){var c=s[0];s.shift(),a[r].push(c),i[c]=r}s.forEach(function(e){a[r].push(e),i[e]=r}),e.seriesYAxisMap=a.map(function(e){return e}),e.seriesYAxisReverseMap=i.map(function(e){return e}),e.seriesYAxisMap.forEach(function(e,a){e.forEach(function(e){t.series[e]&&void 0===t.series[e].group&&(t.series[e].group="apexcharts-axis-".concat(a.toString()))})})}},{key:"isSeriesNull",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return 0===(null===e?this.w.config.series.filter(function(e){return null!==e}):this.w.config.series[e].data.filter(function(e){return null!==e})).length}},{key:"seriesHaveSameValues",value:function(e){return this.w.globals.series[e].every(function(e,t,a){return e===a[0]})}},{key:"getCategoryLabels",value:function(e){var t=this.w,a=e.slice();return t.config.xaxis.convertedCatToNumeric&&(a=e.map(function(e,a){return t.config.xaxis.labels.formatter(e-t.globals.minX+1)})),a}},{key:"getLargestSeries",value:function(){var e=this.w;e.globals.maxValsInArrayIndex=e.globals.series.map(function(e){return e.length}).indexOf(Math.max.apply(Math,e.globals.series.map(function(e){return e.length})))}},{key:"getLargestMarkerSize",value:function(){var e=this.w,t=0;return e.globals.markers.size.forEach(function(e){t=Math.max(t,e)}),e.config.markers.discrete&&e.config.markers.discrete.length&&e.config.markers.discrete.forEach(function(e){t=Math.max(t,e.size)}),t>0&&(e.config.markers.hover.size>0?t=e.config.markers.hover.size:t+=e.config.markers.hover.sizeOffset),e.globals.markers.largestSize=t,t}},{key:"getSeriesTotals",value:function(){var e=this.w;e.globals.seriesTotals=e.globals.series.map(function(e,t){var a=0;if(Array.isArray(e))for(var i=0;i<e.length;i++)a+=e[i];else a+=e;return a})}},{key:"getSeriesTotalsXRange",value:function(e,t){var a=this.w;return a.globals.series.map(function(i,s){for(var o=0,n=0;n<i.length;n++)a.globals.seriesX[s][n]>e&&a.globals.seriesX[s][n]<t&&(o+=i[n]);return o})}},{key:"getPercentSeries",value:function(){var e=this.w;e.globals.seriesPercent=e.globals.series.map(function(t,a){var i=[];if(Array.isArray(t))for(var s=0;s<t.length;s++){var o=e.globals.stackedSeriesTotals[s],n=0;o&&(n=100*t[s]/o),i.push(n)}else{var r=100*t/e.globals.seriesTotals.reduce(function(e,t){return e+t},0);i.push(r)}return i})}},{key:"getCalculatedRatios",value:function(){var e,t,a,i=this,s=this.w,o=s.globals,n=[],r=0,l=[],c=.1,h=0;if(o.yRange=[],o.isMultipleYAxis)for(var d=0;d<o.minYArr.length;d++)o.yRange.push(Math.abs(o.minYArr[d]-o.maxYArr[d])),l.push(0);else o.yRange.push(Math.abs(o.minY-o.maxY));o.xRange=Math.abs(o.maxX-o.minX),o.zRange=Math.abs(o.maxZ-o.minZ);for(var u=0;u<o.yRange.length;u++)n.push(o.yRange[u]/o.gridHeight);if(t=o.xRange/o.gridWidth,e=o.yRange/o.gridWidth,a=o.xRange/o.gridHeight,(r=o.zRange/o.gridHeight*16)||(r=1),o.minY!==Number.MIN_VALUE&&0!==Math.abs(o.minY)&&(o.hasNegs=!0),s.globals.seriesYAxisReverseMap.length>0){var p=function(e,t){var a=s.config.yaxis[s.globals.seriesYAxisReverseMap[t]],o=e<0?-1:1;return e=Math.abs(e),a.logarithmic&&(e=i.getBaseLog(a.logBase,e)),-o*e/n[t]};if(o.isMultipleYAxis){l=[];for(var m=0;m<n.length;m++)l.push(p(o.minYArr[m],m))}else(l=[]).push(p(o.minY,0)),o.minY!==Number.MIN_VALUE&&0!==Math.abs(o.minY)&&(c=-o.minY/e,h=o.minX/t)}else(l=[]).push(0),c=0,h=0;return{yRatio:n,invertedYRatio:e,zRatio:r,xRatio:t,invertedXRatio:a,baseLineInvertedY:c,baseLineY:l,baseLineX:h}}},{key:"getLogSeries",value:function(e){var t=this,a=this.w;return a.globals.seriesLog=e.map(function(e,i){var s=a.globals.seriesYAxisReverseMap[i];return a.config.yaxis[s]&&a.config.yaxis[s].logarithmic?e.map(function(e){return null===e?null:t.getLogVal(a.config.yaxis[s].logBase,e,i)}):e}),a.globals.invalidLogScale?e:a.globals.seriesLog}},{key:"getLogValAtSeriesIndex",value:function(e,t){if(null===e)return null;var a=this.w,i=a.globals.seriesYAxisReverseMap[t];return a.config.yaxis[i]&&a.config.yaxis[i].logarithmic?this.getLogVal(a.config.yaxis[i].logBase,e,t):e}},{key:"getBaseLog",value:function(e,t){return Math.log(t)/Math.log(e)}},{key:"getLogVal",value:function(e,t,a){if(t<=0)return 0;var i=this.w,s=0===i.globals.minYArr[a]?-1:this.getBaseLog(e,i.globals.minYArr[a]),o=(0===i.globals.maxYArr[a]?0:this.getBaseLog(e,i.globals.maxYArr[a]))-s;return t<1?t/o:(this.getBaseLog(e,t)-s)/o}},{key:"getLogYRatios",value:function(e){var t=this,a=this.w,i=this.w.globals;return i.yLogRatio=e.slice(),i.logYRange=i.yRange.map(function(e,s){var o=a.globals.seriesYAxisReverseMap[s];if(a.config.yaxis[o]&&t.w.config.yaxis[o].logarithmic){var n,r=-Number.MAX_VALUE,l=Number.MIN_VALUE;return i.seriesLog.forEach(function(e,t){e.forEach(function(e){a.config.yaxis[t]&&a.config.yaxis[t].logarithmic&&(r=Math.max(e,r),l=Math.min(e,l))})}),n=Math.pow(i.yRange[s],Math.abs(l-r)/i.yRange[s]),i.yLogRatio[s]=n/i.gridHeight,n}}),i.invalidLogScale?e.slice():i.yLogRatio}},{key:"drawSeriesByGroup",value:function(e,t,a,i){var s=this.w,o=[];return e.series.length>0&&t.forEach(function(t){var n=[],r=[];e.i.forEach(function(a,i){s.config.series[a].group===t&&(n.push(e.series[i]),r.push(a))}),n.length>0&&o.push(i.draw(n,a,r))}),o}}],[{key:"checkComboSeries",value:function(e,t){var a=!1,i=0,s=0;return void 0===t&&(t="line"),e.length&&void 0!==e[0].type&&e.forEach(function(e){"bar"!==e.type&&"column"!==e.type&&"candlestick"!==e.type&&"boxPlot"!==e.type||i++,void 0!==e.type&&e.type!==t&&s++}),s>0&&(a=!0),{comboBarCount:i,comboCharts:a}}},{key:"extendArrayProps",value:function(e,t,a){var i,s,o,n,r,l;return null!==(i=t)&&void 0!==i&&i.yaxis&&(t=e.extendYAxis(t,a)),null!==(s=t)&&void 0!==s&&s.annotations&&(t.annotations.yaxis&&(t=e.extendYAxisAnnotations(t)),null!==(o=t)&&void 0!==o&&null!==(n=o.annotations)&&void 0!==n&&n.xaxis&&(t=e.extendXAxisAnnotations(t)),null!==(r=t)&&void 0!==r&&null!==(l=r.annotations)&&void 0!==l&&l.points&&(t=e.extendPointAnnotations(t))),t}}]),e}(),Qu=function(){function e(t){Rc(this,e),this.w=t.w,this.annoCtx=t}return Mc(e,[{key:"setOrientations",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=this.w;if("vertical"===e.label.orientation){var i=null!==t?t:0,s=a.globals.dom.baseEl.querySelector(".apexcharts-xaxis-annotations .apexcharts-xaxis-annotation-label[rel='".concat(i,"']"));if(null!==s){var o=s.getBoundingClientRect();s.setAttribute("x",parseFloat(s.getAttribute("x"))-o.height+4);var n="top"===e.label.position?o.width:-o.width;s.setAttribute("y",parseFloat(s.getAttribute("y"))+n);var r=this.annoCtx.graphics.rotateAroundCenter(s),l=r.x,c=r.y;s.setAttribute("transform","rotate(-90 ".concat(l," ").concat(c,")"))}}}},{key:"addBackgroundToAnno",value:function(e,t){var a=this.w;if(!e||!t.label.text||!String(t.label.text).trim())return null;var i=a.globals.dom.baseEl.querySelector(".apexcharts-grid").getBoundingClientRect(),s=e.getBoundingClientRect(),o=t.label.style.padding,n=o.left,r=o.right,l=o.top,c=o.bottom;if("vertical"===t.label.orientation){var h=[n,r,l,c];l=h[0],c=h[1],n=h[2],r=h[3]}var d=s.left-i.left-n,u=s.top-i.top-l,p=this.annoCtx.graphics.drawRect(d-a.globals.barPadForNumericAxis,u,s.width+n+r,s.height+l+c,t.label.borderRadius,t.label.style.background,1,t.label.borderWidth,t.label.borderColor,0);return t.id&&p.node.classList.add(t.id),p}},{key:"annotationsBackground",value:function(){var e=this,t=this.w,a=function(a,i,s){var o=t.globals.dom.baseEl.querySelector(".apexcharts-".concat(s,"-annotations .apexcharts-").concat(s,"-annotation-label[rel='").concat(i,"']"));if(o){var n=o.parentNode,r=e.addBackgroundToAnno(o,a);r&&(n.insertBefore(r.node,o),a.label.mouseEnter&&r.node.addEventListener("mouseenter",a.label.mouseEnter.bind(e,a)),a.label.mouseLeave&&r.node.addEventListener("mouseleave",a.label.mouseLeave.bind(e,a)),a.label.click&&r.node.addEventListener("click",a.label.click.bind(e,a)))}};t.config.annotations.xaxis.forEach(function(e,t){return a(e,t,"xaxis")}),t.config.annotations.yaxis.forEach(function(e,t){return a(e,t,"yaxis")}),t.config.annotations.points.forEach(function(e,t){return a(e,t,"point")})}},{key:"getY1Y2",value:function(e,t){var a,i=this.w,s="y1"===e?t.y:t.y2,o=!1;if(this.annoCtx.invertAxis){var n=i.config.xaxis.convertedCatToNumeric?i.globals.categoryLabels:i.globals.labels,r=n.indexOf(s),l=i.globals.dom.baseEl.querySelector(".apexcharts-yaxis-texts-g text:nth-child(".concat(r+1,")"));a=l?parseFloat(l.getAttribute("y")):(i.globals.gridHeight/n.length-1)*(r+1)-i.globals.barHeight,void 0!==t.seriesIndex&&i.globals.barHeight&&(a-=i.globals.barHeight/2*(i.globals.series.length-1)-i.globals.barHeight*t.seriesIndex)}else{var c,h=i.globals.seriesYAxisMap[t.yAxisIndex][0],d=i.config.yaxis[t.yAxisIndex].logarithmic?new Ju(this.annoCtx.ctx).getLogVal(i.config.yaxis[t.yAxisIndex].logBase,s,h)/i.globals.yLogRatio[h]:(s-i.globals.minYArr[h])/(i.globals.yRange[h]/i.globals.gridHeight);a=i.globals.gridHeight-Math.min(Math.max(d,0),i.globals.gridHeight),o=d>i.globals.gridHeight||d<0,!t.marker||void 0!==t.y&&null!==t.y||(a=0),null!==(c=i.config.yaxis[t.yAxisIndex])&&void 0!==c&&c.reversed&&(a=d)}return"string"==typeof s&&s.includes("px")&&(a=parseFloat(s)),{yP:a,clipped:o}}},{key:"getX1X2",value:function(e,t){var a=this.w,i="x1"===e?t.x:t.x2,s=this.annoCtx.invertAxis?a.globals.minY:a.globals.minX,o=this.annoCtx.invertAxis?a.globals.maxY:a.globals.maxX,n=this.annoCtx.invertAxis?a.globals.yRange[0]:a.globals.xRange,r=!1,l=this.annoCtx.inversedReversedAxis?(o-i)/(n/a.globals.gridWidth):(i-s)/(n/a.globals.gridWidth);return"category"!==a.config.xaxis.type&&!a.config.xaxis.convertedCatToNumeric||this.annoCtx.invertAxis||a.globals.dataFormatXNumeric||a.config.chart.sparkline.enabled||(l=this.getStringX(i)),"string"==typeof i&&i.includes("px")&&(l=parseFloat(i)),null==i&&t.marker&&(l=a.globals.gridWidth),void 0!==t.seriesIndex&&a.globals.barWidth&&!this.annoCtx.invertAxis&&(l-=a.globals.barWidth/2*(a.globals.series.length-1)-a.globals.barWidth*t.seriesIndex),"number"!=typeof l&&(l=0,r=!0),parseFloat(l.toFixed(10))>parseFloat(a.globals.gridWidth.toFixed(10))?(l=a.globals.gridWidth,r=!0):l<0&&(l=0,r=!0),{x:l,clipped:r}}},{key:"getStringX",value:function(e){var t=this.w,a=e;t.config.xaxis.convertedCatToNumeric&&t.globals.categoryLabels.length&&(e=t.globals.categoryLabels.indexOf(e)+1);var i=t.globals.labels.map(function(e){return Array.isArray(e)?e.join(" "):e}).indexOf(e),s=t.globals.dom.baseEl.querySelector(".apexcharts-xaxis-texts-g text:nth-child(".concat(i+1,")"));return s&&(a=parseFloat(s.getAttribute("x"))),a}}]),e}(),ep=function(){function e(t){Rc(this,e),this.w=t.w,this.annoCtx=t,this.invertAxis=this.annoCtx.invertAxis,this.helpers=new Qu(this.annoCtx)}return Mc(e,[{key:"addXaxisAnnotation",value:function(e,t,a){var i,s=this.w,o=this.helpers.getX1X2("x1",e),n=o.x,r=o.clipped,l=!0,c=e.label.text,h=e.strokeDashArray;if(Xc.isNumber(n)){if(null===e.x2||void 0===e.x2){if(!r){var d=this.annoCtx.graphics.drawLine(n+e.offsetX,0+e.offsetY,n+e.offsetX,s.globals.gridHeight+e.offsetY,e.borderColor,h,e.borderWidth);t.appendChild(d.node),e.id&&d.node.classList.add(e.id)}}else{var u=this.helpers.getX1X2("x2",e);if(i=u.x,l=u.clipped,i<n){var p=n;n=i,i=p}var m=this.annoCtx.graphics.drawRect(n+e.offsetX,0+e.offsetY,i-n,s.globals.gridHeight+e.offsetY,0,e.fillColor,e.opacity,1,e.borderColor,h);m.node.classList.add("apexcharts-annotation-rect"),m.attr("clip-path","url(#gridRectMask".concat(s.globals.cuid,")")),t.appendChild(m.node),e.id&&m.node.classList.add(e.id)}if(!r||!l){var g=this.annoCtx.graphics.getTextRects(c,parseFloat(e.label.style.fontSize)),f="top"===e.label.position?4:"center"===e.label.position?s.globals.gridHeight/2+("vertical"===e.label.orientation?g.width/2:0):s.globals.gridHeight,b=this.annoCtx.graphics.drawText({x:n+e.label.offsetX,y:f+e.label.offsetY-("vertical"===e.label.orientation?"top"===e.label.position?g.width/2-12:-g.width/2:0),text:c,textAnchor:e.label.textAnchor,fontSize:e.label.style.fontSize,fontFamily:e.label.style.fontFamily,fontWeight:e.label.style.fontWeight,foreColor:e.label.style.color,cssClass:"apexcharts-xaxis-annotation-label ".concat(e.label.style.cssClass," ").concat(e.id?e.id:"")});b.attr({rel:a}),t.appendChild(b.node),this.annoCtx.helpers.setOrientations(e,a)}}}},{key:"drawXAxisAnnotations",value:function(){var e=this,t=this.w,a=this.annoCtx.graphics.group({class:"apexcharts-xaxis-annotations"});return t.config.annotations.xaxis.map(function(t,i){e.addXaxisAnnotation(t,a.node,i)}),a}}]),e}(),tp=function(){function e(t){Rc(this,e),this.ctx=t,this.w=t.w,this.months31=[1,3,5,7,8,10,12],this.months30=[2,4,6,9,11],this.daysCntOfYear=[0,31,59,90,120,151,181,212,243,273,304,334]}return Mc(e,[{key:"isValidDate",value:function(e){return"number"!=typeof e&&!isNaN(this.parseDate(e))}},{key:"getTimeStamp",value:function(e){return Date.parse(e)?this.w.config.xaxis.labels.datetimeUTC?new Date(new Date(e).toISOString().substr(0,25)).getTime():new Date(e).getTime():e}},{key:"getDate",value:function(e){return this.w.config.xaxis.labels.datetimeUTC?new Date(new Date(e).toUTCString()):new Date(e)}},{key:"parseDate",value:function(e){var t=Date.parse(e);if(!isNaN(t))return this.getTimeStamp(e);var a=Date.parse(e.replace(/-/g,"/").replace(/[a-z]+/gi," "));return this.getTimeStamp(a)}},{key:"parseDateWithTimezone",value:function(e){return Date.parse(e.replace(/-/g,"/").replace(/[a-z]+/gi," "))}},{key:"formatDate",value:function(e,t){var a=this.w.globals.locale,i=this.w.config.xaxis.labels.datetimeUTC,s=["\0"].concat(Vc(a.months)),o=[""].concat(Vc(a.shortMonths)),n=[""].concat(Vc(a.days)),r=[""].concat(Vc(a.shortDays));function l(e,t){var a=e+"";for(t=t||2;a.length<t;)a="0"+a;return a}var c=i?e.getUTCFullYear():e.getFullYear();t=(t=(t=t.replace(/(^|[^\\])yyyy+/g,"$1"+c)).replace(/(^|[^\\])yy/g,"$1"+c.toString().substr(2,2))).replace(/(^|[^\\])y/g,"$1"+c);var h=(i?e.getUTCMonth():e.getMonth())+1;t=(t=(t=(t=t.replace(/(^|[^\\])MMMM+/g,"$1"+s[0])).replace(/(^|[^\\])MMM/g,"$1"+o[0])).replace(/(^|[^\\])MM/g,"$1"+l(h))).replace(/(^|[^\\])M/g,"$1"+h);var d=i?e.getUTCDate():e.getDate();t=(t=(t=(t=t.replace(/(^|[^\\])dddd+/g,"$1"+n[0])).replace(/(^|[^\\])ddd/g,"$1"+r[0])).replace(/(^|[^\\])dd/g,"$1"+l(d))).replace(/(^|[^\\])d/g,"$1"+d);var u=i?e.getUTCHours():e.getHours(),p=u>12?u-12:0===u?12:u;t=(t=(t=(t=t.replace(/(^|[^\\])HH+/g,"$1"+l(u))).replace(/(^|[^\\])H/g,"$1"+u)).replace(/(^|[^\\])hh+/g,"$1"+l(p))).replace(/(^|[^\\])h/g,"$1"+p);var m=i?e.getUTCMinutes():e.getMinutes();t=(t=t.replace(/(^|[^\\])mm+/g,"$1"+l(m))).replace(/(^|[^\\])m/g,"$1"+m);var g=i?e.getUTCSeconds():e.getSeconds();t=(t=t.replace(/(^|[^\\])ss+/g,"$1"+l(g))).replace(/(^|[^\\])s/g,"$1"+g);var f=i?e.getUTCMilliseconds():e.getMilliseconds();t=t.replace(/(^|[^\\])fff+/g,"$1"+l(f,3)),f=Math.round(f/10),t=t.replace(/(^|[^\\])ff/g,"$1"+l(f)),f=Math.round(f/10);var b=u<12?"AM":"PM";t=(t=(t=t.replace(/(^|[^\\])f/g,"$1"+f)).replace(/(^|[^\\])TT+/g,"$1"+b)).replace(/(^|[^\\])T/g,"$1"+b.charAt(0));var y=b.toLowerCase();t=(t=t.replace(/(^|[^\\])tt+/g,"$1"+y)).replace(/(^|[^\\])t/g,"$1"+y.charAt(0));var w=-e.getTimezoneOffset(),v=i||!w?"Z":w>0?"+":"-";if(!i){var x=(w=Math.abs(w))%60;v+=l(Math.floor(w/60))+":"+l(x)}t=t.replace(/(^|[^\\])K/g,"$1"+v);var S=(i?e.getUTCDay():e.getDay())+1;return(t=(t=(t=(t=t.replace(new RegExp(n[0],"g"),n[S])).replace(new RegExp(r[0],"g"),r[S])).replace(new RegExp(s[0],"g"),s[h])).replace(new RegExp(o[0],"g"),o[h])).replace(/\\(.)/g,"$1")}},{key:"getTimeUnitsfromTimestamp",value:function(e,t,a){var i=this.w;void 0!==i.config.xaxis.min&&(e=i.config.xaxis.min),void 0!==i.config.xaxis.max&&(t=i.config.xaxis.max);var s=this.getDate(e),o=this.getDate(t),n=this.formatDate(s,"yyyy MM dd HH mm ss fff").split(" "),r=this.formatDate(o,"yyyy MM dd HH mm ss fff").split(" ");return{minMillisecond:parseInt(n[6],10),maxMillisecond:parseInt(r[6],10),minSecond:parseInt(n[5],10),maxSecond:parseInt(r[5],10),minMinute:parseInt(n[4],10),maxMinute:parseInt(r[4],10),minHour:parseInt(n[3],10),maxHour:parseInt(r[3],10),minDate:parseInt(n[2],10),maxDate:parseInt(r[2],10),minMonth:parseInt(n[1],10)-1,maxMonth:parseInt(r[1],10)-1,minYear:parseInt(n[0],10),maxYear:parseInt(r[0],10)}}},{key:"isLeapYear",value:function(e){return e%4==0&&e%100!=0||e%400==0}},{key:"calculcateLastDaysOfMonth",value:function(e,t,a){return this.determineDaysOfMonths(e,t)-a}},{key:"determineDaysOfYear",value:function(e){var t=365;return this.isLeapYear(e)&&(t=366),t}},{key:"determineRemainingDaysOfYear",value:function(e,t,a){var i=this.daysCntOfYear[t]+a;return t>1&&this.isLeapYear()&&i++,i}},{key:"determineDaysOfMonths",value:function(e,t){var a=30;switch(e=Xc.monthMod(e),!0){case this.months30.indexOf(e)>-1:2===e&&(a=this.isLeapYear(t)?29:28);break;case this.months31.indexOf(e)>-1:default:a=31}return a}}]),e}(),ap=function(){function e(t){Rc(this,e),this.ctx=t,this.w=t.w,this.tooltipKeyFormat="dd MMM"}return Mc(e,[{key:"xLabelFormat",value:function(e,t,a,i){var s=this.w;if("datetime"===s.config.xaxis.type&&void 0===s.config.xaxis.labels.formatter&&void 0===s.config.tooltip.x.formatter){var o=new tp(this.ctx);return o.formatDate(o.getDate(t),s.config.tooltip.x.format)}return e(t,a,i)}},{key:"defaultGeneralFormatter",value:function(e){return Array.isArray(e)?e.map(function(e){return e}):e}},{key:"defaultYFormatter",value:function(e,t,a){var i=this.w;if(Xc.isNumber(e))if(0!==i.globals.yValueDecimal)e=e.toFixed(void 0!==t.decimalsInFloat?t.decimalsInFloat:i.globals.yValueDecimal);else{var s=e.toFixed(0);e=e==s?s:e.toFixed(1)}return e}},{key:"setLabelFormatters",value:function(){var e=this,t=this.w;return t.globals.xaxisTooltipFormatter=function(t){return e.defaultGeneralFormatter(t)},t.globals.ttKeyFormatter=function(t){return e.defaultGeneralFormatter(t)},t.globals.ttZFormatter=function(e){return e},t.globals.legendFormatter=function(t){return e.defaultGeneralFormatter(t)},void 0!==t.config.xaxis.labels.formatter?t.globals.xLabelFormatter=t.config.xaxis.labels.formatter:t.globals.xLabelFormatter=function(e){if(Xc.isNumber(e)){if(!t.config.xaxis.convertedCatToNumeric&&"numeric"===t.config.xaxis.type){if(Xc.isNumber(t.config.xaxis.decimalsInFloat))return e.toFixed(t.config.xaxis.decimalsInFloat);var a=t.globals.maxX-t.globals.minX;return a>0&&a<100?e.toFixed(1):e.toFixed(0)}return t.globals.isBarHorizontal&&t.globals.maxY-t.globals.minYArr<4?e.toFixed(1):e.toFixed(0)}return e},"function"==typeof t.config.tooltip.x.formatter?t.globals.ttKeyFormatter=t.config.tooltip.x.formatter:t.globals.ttKeyFormatter=t.globals.xLabelFormatter,"function"==typeof t.config.xaxis.tooltip.formatter&&(t.globals.xaxisTooltipFormatter=t.config.xaxis.tooltip.formatter),(Array.isArray(t.config.tooltip.y)||void 0!==t.config.tooltip.y.formatter)&&(t.globals.ttVal=t.config.tooltip.y),void 0!==t.config.tooltip.z.formatter&&(t.globals.ttZFormatter=t.config.tooltip.z.formatter),void 0!==t.config.legend.formatter&&(t.globals.legendFormatter=t.config.legend.formatter),t.config.yaxis.forEach(function(a,i){void 0!==a.labels.formatter?t.globals.yLabelFormatters[i]=a.labels.formatter:t.globals.yLabelFormatters[i]=function(s){return t.globals.xyCharts?Array.isArray(s)?s.map(function(t){return e.defaultYFormatter(t,a,i)}):e.defaultYFormatter(s,a,i):s}}),t.globals}},{key:"heatmapLabelFormatters",value:function(){var e=this.w;if("heatmap"===e.config.chart.type){e.globals.yAxisScale[0].result=e.globals.seriesNames.slice();var t=e.globals.seriesNames.reduce(function(e,t){return e.length>t.length?e:t},0);e.globals.yAxisScale[0].niceMax=t,e.globals.yAxisScale[0].niceMin=t}}}]),e}(),ip=function(){function e(t){Rc(this,e),this.ctx=t,this.w=t.w}return Mc(e,[{key:"getLabel",value:function(e,t,a,i){var s,o,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"12px",l=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],c=this.w,h=void 0===e[i]?"":e[i],d=h,u=c.globals.xLabelFormatter,p=c.config.xaxis.labels.formatter,m=!1,g=new ap(this.ctx),f=h;l&&(d=g.xLabelFormat(u,h,f,{i:i,dateFormatter:new tp(this.ctx).formatDate,w:c}),void 0!==p&&(d=p(h,e[i],{i:i,dateFormatter:new tp(this.ctx).formatDate,w:c}))),t.length>0?(s=t[i].unit,o=null,t.forEach(function(e){"month"===e.unit?o="year":"day"===e.unit?o="month":"hour"===e.unit?o="day":"minute"===e.unit&&(o="hour")}),m=o===s,a=t[i].position,d=t[i].value):"datetime"===c.config.xaxis.type&&void 0===p&&(d=""),void 0===d&&(d=""),d=Array.isArray(d)?d:d.toString();var b,y=new Ku(this.ctx);b=c.globals.rotateXLabels&&l?y.getTextRects(d,parseInt(r,10),null,"rotate(".concat(c.config.xaxis.labels.rotate," 0 0)"),!1):y.getTextRects(d,parseInt(r,10));var w=!c.config.xaxis.labels.showDuplicates&&this.ctx.timeScale;return!Array.isArray(d)&&("NaN"===String(d)||n.indexOf(d)>=0&&w)&&(d=""),{x:a,text:d,textRect:b,isBold:m}}},{key:"checkLabelBasedOnTickamount",value:function(e,t,a){var i=this.w,s=i.config.xaxis.tickAmount;return"dataPoints"===s&&(s=Math.round(i.globals.gridWidth/120)),s>a||e%Math.round(a/(s+1))==0||(t.text=""),t}},{key:"checkForOverflowingLabels",value:function(e,t,a,i,s){var o=this.w;if(0===e&&o.globals.skipFirstTimelinelabel&&(t.text=""),e===a-1&&o.globals.skipLastTimelinelabel&&(t.text=""),o.config.xaxis.labels.hideOverlappingLabels&&i.length>0){var n=s[s.length-1];t.x<n.textRect.width/(o.globals.rotateXLabels?Math.abs(o.config.xaxis.labels.rotate)/12:1.01)+n.x&&(t.text="")}return t}},{key:"checkForReversedLabels",value:function(e,t){var a=this.w;return a.config.yaxis[e]&&a.config.yaxis[e].reversed&&t.reverse(),t}},{key:"yAxisAllSeriesCollapsed",value:function(e){var t=this.w.globals;return!t.seriesYAxisMap[e].some(function(e){return-1===t.collapsedSeriesIndices.indexOf(e)})}},{key:"translateYAxisIndex",value:function(e){var t=this.w,a=t.globals,i=t.config.yaxis;return a.series.length>i.length||i.some(function(e){return Array.isArray(e.seriesName)})?e:a.seriesYAxisReverseMap[e]}},{key:"isYAxisHidden",value:function(e){var t=this.w,a=t.config.yaxis[e];if(!a.show||this.yAxisAllSeriesCollapsed(e))return!0;if(!a.showForNullSeries){var i=t.globals.seriesYAxisMap[e],s=new Ju(this.ctx);return i.every(function(e){return s.isSeriesNull(e)})}return!1}},{key:"getYAxisForeColor",value:function(e,t){var a=this.w;return Array.isArray(e)&&a.globals.yAxisScale[t]&&this.ctx.theme.pushExtraColors(e,a.globals.yAxisScale[t].result.length,!1),e}},{key:"drawYAxisTicks",value:function(e,t,a,i,s,o,n){var r=this.w,l=new Ku(this.ctx),c=r.globals.translateY+r.config.yaxis[s].labels.offsetY;if(r.globals.isBarHorizontal?c=0:"heatmap"===r.config.chart.type&&(c+=o/2),i.show&&t>0){!0===r.config.yaxis[s].opposite&&(e+=i.width);for(var h=t;h>=0;h--){var d=l.drawLine(e+a.offsetX-i.width+i.offsetX,c+i.offsetY,e+a.offsetX+i.offsetX,c+i.offsetY,i.color);n.add(d),c+=o}}}}]),e}(),sp=function(){function e(t){Rc(this,e),this.w=t.w,this.annoCtx=t,this.helpers=new Qu(this.annoCtx),this.axesUtils=new ip(this.annoCtx)}return Mc(e,[{key:"addYaxisAnnotation",value:function(e,t,a){var i,s=this.w,o=e.strokeDashArray,n=this.helpers.getY1Y2("y1",e),r=n.yP,l=n.clipped,c=!0,h=!1,d=e.label.text;if(null===e.y2||void 0===e.y2){if(!l){h=!0;var u=this.annoCtx.graphics.drawLine(0+e.offsetX,r+e.offsetY,this._getYAxisAnnotationWidth(e),r+e.offsetY,e.borderColor,o,e.borderWidth);t.appendChild(u.node),e.id&&u.node.classList.add(e.id)}}else{if(i=(n=this.helpers.getY1Y2("y2",e)).yP,c=n.clipped,i>r){var p=r;r=i,i=p}if(!l||!c){h=!0;var m=this.annoCtx.graphics.drawRect(0+e.offsetX,i+e.offsetY,this._getYAxisAnnotationWidth(e),r-i,0,e.fillColor,e.opacity,1,e.borderColor,o);m.node.classList.add("apexcharts-annotation-rect"),m.attr("clip-path","url(#gridRectMask".concat(s.globals.cuid,")")),t.appendChild(m.node),e.id&&m.node.classList.add(e.id)}}if(h){var g="right"===e.label.position?s.globals.gridWidth:"center"===e.label.position?s.globals.gridWidth/2:0,f=this.annoCtx.graphics.drawText({x:g+e.label.offsetX,y:(null!=i?i:r)+e.label.offsetY-3,text:d,textAnchor:e.label.textAnchor,fontSize:e.label.style.fontSize,fontFamily:e.label.style.fontFamily,fontWeight:e.label.style.fontWeight,foreColor:e.label.style.color,cssClass:"apexcharts-yaxis-annotation-label ".concat(e.label.style.cssClass," ").concat(e.id?e.id:"")});f.attr({rel:a}),t.appendChild(f.node)}}},{key:"_getYAxisAnnotationWidth",value:function(e){var t=this.w;return t.globals.gridWidth,(e.width.indexOf("%")>-1?t.globals.gridWidth*parseInt(e.width,10)/100:parseInt(e.width,10))+e.offsetX}},{key:"drawYAxisAnnotations",value:function(){var e=this,t=this.w,a=this.annoCtx.graphics.group({class:"apexcharts-yaxis-annotations"});return t.config.annotations.yaxis.forEach(function(t,i){t.yAxisIndex=e.axesUtils.translateYAxisIndex(t.yAxisIndex),e.axesUtils.isYAxisHidden(t.yAxisIndex)&&e.axesUtils.yAxisAllSeriesCollapsed(t.yAxisIndex)||e.addYaxisAnnotation(t,a.node,i)}),a}}]),e}(),op=function(){function e(t){Rc(this,e),this.w=t.w,this.annoCtx=t,this.helpers=new Qu(this.annoCtx)}return Mc(e,[{key:"addPointAnnotation",value:function(e,t,a){if(!(this.w.globals.collapsedSeriesIndices.indexOf(e.seriesIndex)>-1)){var i=this.helpers.getX1X2("x1",e),s=i.x,o=i.clipped,n=(i=this.helpers.getY1Y2("y1",e)).yP,r=i.clipped;if(Xc.isNumber(s)&&!r&&!o){var l={pSize:e.marker.size,pointStrokeWidth:e.marker.strokeWidth,pointFillColor:e.marker.fillColor,pointStrokeColor:e.marker.strokeColor,shape:e.marker.shape,pRadius:e.marker.radius,class:"apexcharts-point-annotation-marker ".concat(e.marker.cssClass," ").concat(e.id?e.id:"")},c=this.annoCtx.graphics.drawMarker(s+e.marker.offsetX,n+e.marker.offsetY,l);t.appendChild(c.node);var h=e.label.text?e.label.text:"",d=this.annoCtx.graphics.drawText({x:s+e.label.offsetX,y:n+e.label.offsetY-e.marker.size-parseFloat(e.label.style.fontSize)/1.6,text:h,textAnchor:e.label.textAnchor,fontSize:e.label.style.fontSize,fontFamily:e.label.style.fontFamily,fontWeight:e.label.style.fontWeight,foreColor:e.label.style.color,cssClass:"apexcharts-point-annotation-label ".concat(e.label.style.cssClass," ").concat(e.id?e.id:"")});if(d.attr({rel:a}),t.appendChild(d.node),e.customSVG.SVG){var u=this.annoCtx.graphics.group({class:"apexcharts-point-annotations-custom-svg "+e.customSVG.cssClass});u.attr({transform:"translate(".concat(s+e.customSVG.offsetX,", ").concat(n+e.customSVG.offsetY,")")}),u.node.innerHTML=e.customSVG.SVG,t.appendChild(u.node)}if(e.image.path){var p=e.image.width?e.image.width:20,m=e.image.height?e.image.height:20;c=this.annoCtx.addImage({x:s+e.image.offsetX-p/2,y:n+e.image.offsetY-m/2,width:p,height:m,path:e.image.path,appendTo:".apexcharts-point-annotations"})}e.mouseEnter&&c.node.addEventListener("mouseenter",e.mouseEnter.bind(this,e)),e.mouseLeave&&c.node.addEventListener("mouseleave",e.mouseLeave.bind(this,e)),e.click&&c.node.addEventListener("click",e.click.bind(this,e))}}}},{key:"drawPointAnnotations",value:function(){var e=this,t=this.w,a=this.annoCtx.graphics.group({class:"apexcharts-point-annotations"});return t.config.annotations.points.map(function(t,i){e.addPointAnnotation(t,a.node,i)}),a}}]),e}(),np={name:"en",options:{months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],toolbar:{exportToSVG:"Download SVG",exportToPNG:"Download PNG",exportToCSV:"Download CSV",menu:"Menu",selection:"Selection",selectionZoom:"Selection Zoom",zoomIn:"Zoom In",zoomOut:"Zoom Out",pan:"Panning",reset:"Reset Zoom"}}},rp=function(){function e(){Rc(this,e),this.yAxis={show:!0,showAlways:!1,showForNullSeries:!0,seriesName:void 0,opposite:!1,reversed:!1,logarithmic:!1,logBase:10,tickAmount:void 0,stepSize:void 0,forceNiceScale:!1,max:void 0,min:void 0,floating:!1,decimalsInFloat:void 0,labels:{show:!0,showDuplicates:!1,minWidth:0,maxWidth:160,offsetX:0,offsetY:0,align:void 0,rotate:0,padding:20,style:{colors:[],fontSize:"11px",fontWeight:400,fontFamily:void 0,cssClass:""},formatter:void 0},axisBorder:{show:!1,color:"#e0e0e0",width:1,offsetX:0,offsetY:0},axisTicks:{show:!1,color:"#e0e0e0",width:6,offsetX:0,offsetY:0},title:{text:void 0,rotate:-90,offsetY:0,offsetX:0,style:{color:void 0,fontSize:"11px",fontWeight:900,fontFamily:void 0,cssClass:""}},tooltip:{enabled:!1,offsetX:0},crosshairs:{show:!0,position:"front",stroke:{color:"#b6b6b6",width:1,dashArray:0}}},this.pointAnnotation={id:void 0,x:0,y:null,yAxisIndex:0,seriesIndex:void 0,mouseEnter:void 0,mouseLeave:void 0,click:void 0,marker:{size:4,fillColor:"#fff",strokeWidth:2,strokeColor:"#333",shape:"circle",offsetX:0,offsetY:0,cssClass:""},label:{borderColor:"#c2c2c2",borderWidth:1,borderRadius:2,text:void 0,textAnchor:"middle",offsetX:0,offsetY:0,mouseEnter:void 0,mouseLeave:void 0,click:void 0,style:{background:"#fff",color:void 0,fontSize:"11px",fontFamily:void 0,fontWeight:400,cssClass:"",padding:{left:5,right:5,top:2,bottom:2}}},customSVG:{SVG:void 0,cssClass:void 0,offsetX:0,offsetY:0},image:{path:void 0,width:20,height:20,offsetX:0,offsetY:0}},this.yAxisAnnotation={id:void 0,y:0,y2:null,strokeDashArray:1,fillColor:"#c2c2c2",borderColor:"#c2c2c2",borderWidth:1,opacity:.3,offsetX:0,offsetY:0,width:"100%",yAxisIndex:0,label:{borderColor:"#c2c2c2",borderWidth:1,borderRadius:2,text:void 0,textAnchor:"end",position:"right",offsetX:0,offsetY:-3,mouseEnter:void 0,mouseLeave:void 0,click:void 0,style:{background:"#fff",color:void 0,fontSize:"11px",fontFamily:void 0,fontWeight:400,cssClass:"",padding:{left:5,right:5,top:2,bottom:2}}}},this.xAxisAnnotation={id:void 0,x:0,x2:null,strokeDashArray:1,fillColor:"#c2c2c2",borderColor:"#c2c2c2",borderWidth:1,opacity:.3,offsetX:0,offsetY:0,label:{borderColor:"#c2c2c2",borderWidth:1,borderRadius:2,text:void 0,textAnchor:"middle",orientation:"vertical",position:"top",offsetX:0,offsetY:0,mouseEnter:void 0,mouseLeave:void 0,click:void 0,style:{background:"#fff",color:void 0,fontSize:"11px",fontFamily:void 0,fontWeight:400,cssClass:"",padding:{left:5,right:5,top:2,bottom:2}}}},this.text={x:0,y:0,text:"",textAnchor:"start",foreColor:void 0,fontSize:"13px",fontFamily:void 0,fontWeight:400,appendTo:".apexcharts-annotations",backgroundColor:"transparent",borderColor:"#c2c2c2",borderRadius:0,borderWidth:0,paddingLeft:4,paddingRight:4,paddingTop:2,paddingBottom:2}}return Mc(e,[{key:"init",value:function(){return{annotations:{yaxis:[this.yAxisAnnotation],xaxis:[this.xAxisAnnotation],points:[this.pointAnnotation],texts:[],images:[],shapes:[]},chart:{animations:{enabled:!0,speed:800,animateGradually:{delay:150,enabled:!0},dynamicAnimation:{enabled:!0,speed:350}},background:"",locales:[np],defaultLocale:"en",dropShadow:{enabled:!1,enabledOnSeries:void 0,top:2,left:2,blur:4,color:"#000",opacity:.7},events:{animationEnd:void 0,beforeMount:void 0,mounted:void 0,updated:void 0,click:void 0,mouseMove:void 0,mouseLeave:void 0,xAxisLabelClick:void 0,legendClick:void 0,markerClick:void 0,selection:void 0,dataPointSelection:void 0,dataPointMouseEnter:void 0,dataPointMouseLeave:void 0,beforeZoom:void 0,beforeResetZoom:void 0,zoomed:void 0,scrolled:void 0,brushScrolled:void 0},foreColor:"#373d3f",fontFamily:"Helvetica, Arial, sans-serif",height:"auto",parentHeightOffset:15,redrawOnParentResize:!0,redrawOnWindowResize:!0,id:void 0,group:void 0,nonce:void 0,offsetX:0,offsetY:0,selection:{enabled:!1,type:"x",fill:{color:"#24292e",opacity:.1},stroke:{width:1,color:"#24292e",opacity:.4,dashArray:3},xaxis:{min:void 0,max:void 0},yaxis:{min:void 0,max:void 0}},sparkline:{enabled:!1},brush:{enabled:!1,autoScaleYaxis:!0,target:void 0,targets:void 0},stacked:!1,stackOnlyBar:!0,stackType:"normal",toolbar:{show:!0,offsetX:0,offsetY:0,tools:{download:!0,selection:!0,zoom:!0,zoomin:!0,zoomout:!0,pan:!0,reset:!0,customIcons:[]},export:{csv:{filename:void 0,columnDelimiter:",",headerCategory:"category",headerValue:"value",categoryFormatter:void 0,valueFormatter:void 0},png:{filename:void 0},svg:{filename:void 0},scale:void 0,width:void 0},autoSelected:"zoom"},type:"line",width:"100%",zoom:{enabled:!0,type:"x",autoScaleYaxis:!1,allowMouseWheelZoom:!0,zoomedArea:{fill:{color:"#90CAF9",opacity:.4},stroke:{color:"#0D47A1",opacity:.4,width:1}}}},plotOptions:{line:{isSlopeChart:!1,colors:{threshold:0,colorAboveThreshold:void 0,colorBelowThreshold:void 0}},area:{fillTo:"origin"},bar:{horizontal:!1,columnWidth:"70%",barHeight:"70%",distributed:!1,borderRadius:0,borderRadiusApplication:"around",borderRadiusWhenStacked:"last",rangeBarOverlap:!0,rangeBarGroupRows:!1,hideZeroBarsWhenGrouped:!1,isDumbbell:!1,dumbbellColors:void 0,isFunnel:!1,isFunnel3d:!0,colors:{ranges:[],backgroundBarColors:[],backgroundBarOpacity:1,backgroundBarRadius:0},dataLabels:{position:"top",maxItems:100,hideOverflowingLabels:!0,orientation:"horizontal",total:{enabled:!1,formatter:void 0,offsetX:0,offsetY:0,style:{color:"#373d3f",fontSize:"12px",fontFamily:void 0,fontWeight:600}}}},bubble:{zScaling:!0,minBubbleRadius:void 0,maxBubbleRadius:void 0},candlestick:{colors:{upward:"#00B746",downward:"#EF403C"},wick:{useFillColor:!0}},boxPlot:{colors:{upper:"#00E396",lower:"#008FFB"}},heatmap:{radius:2,enableShades:!0,shadeIntensity:.5,reverseNegativeShade:!1,distributed:!1,useFillColorAsStroke:!1,colorScale:{inverse:!1,ranges:[],min:void 0,max:void 0}},treemap:{enableShades:!0,shadeIntensity:.5,distributed:!1,reverseNegativeShade:!1,useFillColorAsStroke:!1,borderRadius:4,dataLabels:{format:"scale"},colorScale:{inverse:!1,ranges:[],min:void 0,max:void 0},seriesTitle:{show:!0,offsetY:1,offsetX:1,borderColor:"#000",borderWidth:1,borderRadius:2,style:{background:"rgba(0, 0, 0, 0.6)",color:"#fff",fontSize:"12px",fontFamily:void 0,fontWeight:400,cssClass:"",padding:{left:6,right:6,top:2,bottom:2}}}},radialBar:{inverseOrder:!1,startAngle:0,endAngle:360,offsetX:0,offsetY:0,hollow:{margin:5,size:"50%",background:"transparent",image:void 0,imageWidth:150,imageHeight:150,imageOffsetX:0,imageOffsetY:0,imageClipped:!0,position:"front",dropShadow:{enabled:!1,top:0,left:0,blur:3,color:"#000",opacity:.5}},track:{show:!0,startAngle:void 0,endAngle:void 0,background:"#f2f2f2",strokeWidth:"97%",opacity:1,margin:5,dropShadow:{enabled:!1,top:0,left:0,blur:3,color:"#000",opacity:.5}},dataLabels:{show:!0,name:{show:!0,fontSize:"16px",fontFamily:void 0,fontWeight:600,color:void 0,offsetY:0,formatter:function(e){return e}},value:{show:!0,fontSize:"14px",fontFamily:void 0,fontWeight:400,color:void 0,offsetY:16,formatter:function(e){return e+"%"}},total:{show:!1,label:"Total",fontSize:"16px",fontWeight:600,fontFamily:void 0,color:void 0,formatter:function(e){return e.globals.seriesTotals.reduce(function(e,t){return e+t},0)/e.globals.series.length+"%"}}},barLabels:{enabled:!1,offsetX:0,offsetY:0,useSeriesColors:!0,fontFamily:void 0,fontWeight:600,fontSize:"16px",formatter:function(e){return e},onClick:void 0}},pie:{customScale:1,offsetX:0,offsetY:0,startAngle:0,endAngle:360,expandOnClick:!0,dataLabels:{offset:0,minAngleToShowLabel:10},donut:{size:"65%",background:"transparent",labels:{show:!1,name:{show:!0,fontSize:"16px",fontFamily:void 0,fontWeight:600,color:void 0,offsetY:-10,formatter:function(e){return e}},value:{show:!0,fontSize:"20px",fontFamily:void 0,fontWeight:400,color:void 0,offsetY:10,formatter:function(e){return e}},total:{show:!1,showAlways:!1,label:"Total",fontSize:"16px",fontWeight:400,fontFamily:void 0,color:void 0,formatter:function(e){return e.globals.seriesTotals.reduce(function(e,t){return e+t},0)}}}}},polarArea:{rings:{strokeWidth:1,strokeColor:"#e8e8e8"},spokes:{strokeWidth:1,connectorColors:"#e8e8e8"}},radar:{size:void 0,offsetX:0,offsetY:0,polygons:{strokeWidth:1,strokeColors:"#e8e8e8",connectorColors:"#e8e8e8",fill:{colors:void 0}}}},colors:void 0,dataLabels:{enabled:!0,enabledOnSeries:void 0,formatter:function(e){return null!==e?e:""},textAnchor:"middle",distributed:!1,offsetX:0,offsetY:0,style:{fontSize:"12px",fontFamily:void 0,fontWeight:600,colors:void 0},background:{enabled:!0,foreColor:"#fff",backgroundColor:void 0,borderRadius:2,padding:4,opacity:.9,borderWidth:1,borderColor:"#fff",dropShadow:{enabled:!1,top:1,left:1,blur:1,color:"#000",opacity:.8}},dropShadow:{enabled:!1,top:1,left:1,blur:1,color:"#000",opacity:.8}},fill:{type:"solid",colors:void 0,opacity:.85,gradient:{shade:"dark",type:"horizontal",shadeIntensity:.5,gradientToColors:void 0,inverseColors:!0,opacityFrom:1,opacityTo:1,stops:[0,50,100],colorStops:[]},image:{src:[],width:void 0,height:void 0},pattern:{style:"squares",width:6,height:6,strokeWidth:2}},forecastDataPoints:{count:0,fillOpacity:.5,strokeWidth:void 0,dashArray:4},grid:{show:!0,borderColor:"#e0e0e0",strokeDashArray:0,position:"back",xaxis:{lines:{show:!1}},yaxis:{lines:{show:!0}},row:{colors:void 0,opacity:.5},column:{colors:void 0,opacity:.5},padding:{top:0,right:10,bottom:0,left:12}},labels:[],legend:{show:!0,showForSingleSeries:!1,showForNullSeries:!0,showForZeroSeries:!0,floating:!1,position:"bottom",horizontalAlign:"center",inverseOrder:!1,fontSize:"12px",fontFamily:void 0,fontWeight:400,width:void 0,height:void 0,formatter:void 0,tooltipHoverFormatter:void 0,offsetX:-20,offsetY:4,customLegendItems:[],clusterGroupedSeries:!0,clusterGroupedSeriesOrientation:"vertical",labels:{colors:void 0,useSeriesColors:!1},markers:{size:7,fillColors:void 0,strokeWidth:1,shape:void 0,offsetX:0,offsetY:0,customHTML:void 0,onClick:void 0},itemMargin:{horizontal:5,vertical:4},onItemClick:{toggleDataSeries:!0},onItemHover:{highlightDataSeries:!0}},markers:{discrete:[],size:0,colors:void 0,strokeColors:"#fff",strokeWidth:2,strokeOpacity:.9,strokeDashArray:0,fillOpacity:1,shape:"circle",offsetX:0,offsetY:0,showNullDataPoints:!0,onClick:void 0,onDblClick:void 0,hover:{size:void 0,sizeOffset:3}},noData:{text:void 0,align:"center",verticalAlign:"middle",offsetX:0,offsetY:0,style:{color:void 0,fontSize:"14px",fontFamily:void 0}},responsive:[],series:void 0,states:{hover:{filter:{type:"lighten"}},active:{allowMultipleDataPointsSelection:!1,filter:{type:"darken"}}},title:{text:void 0,align:"left",margin:5,offsetX:0,offsetY:0,floating:!1,style:{fontSize:"14px",fontWeight:900,fontFamily:void 0,color:void 0}},subtitle:{text:void 0,align:"left",margin:5,offsetX:0,offsetY:30,floating:!1,style:{fontSize:"12px",fontWeight:400,fontFamily:void 0,color:void 0}},stroke:{show:!0,curve:"smooth",lineCap:"butt",width:2,colors:void 0,dashArray:0,fill:{type:"solid",colors:void 0,opacity:.85,gradient:{shade:"dark",type:"horizontal",shadeIntensity:.5,gradientToColors:void 0,inverseColors:!0,opacityFrom:1,opacityTo:1,stops:[0,50,100],colorStops:[]}}},tooltip:{enabled:!0,enabledOnSeries:void 0,shared:!0,hideEmptySeries:!1,followCursor:!1,intersect:!1,inverseOrder:!1,custom:void 0,fillSeriesColor:!1,theme:"light",cssClass:"",style:{fontSize:"12px",fontFamily:void 0},onDatasetHover:{highlightDataSeries:!1},x:{show:!0,format:"dd MMM",formatter:void 0},y:{formatter:void 0,title:{formatter:function(e){return e?e+": ":""}}},z:{formatter:void 0,title:"Size: "},marker:{show:!0,fillColors:void 0},items:{display:"flex"},fixed:{enabled:!1,position:"topRight",offsetX:0,offsetY:0}},xaxis:{type:"category",categories:[],convertedCatToNumeric:!1,offsetX:0,offsetY:0,overwriteCategories:void 0,labels:{show:!0,rotate:-45,rotateAlways:!1,hideOverlappingLabels:!0,trim:!1,minHeight:void 0,maxHeight:120,showDuplicates:!0,style:{colors:[],fontSize:"12px",fontWeight:400,fontFamily:void 0,cssClass:""},offsetX:0,offsetY:0,format:void 0,formatter:void 0,datetimeUTC:!0,datetimeFormatter:{year:"yyyy",month:"MMM 'yy",day:"dd MMM",hour:"HH:mm",minute:"HH:mm:ss",second:"HH:mm:ss"}},group:{groups:[],style:{colors:[],fontSize:"12px",fontWeight:400,fontFamily:void 0,cssClass:""}},axisBorder:{show:!0,color:"#e0e0e0",width:"100%",height:1,offsetX:0,offsetY:0},axisTicks:{show:!0,color:"#e0e0e0",height:6,offsetX:0,offsetY:0},stepSize:void 0,tickAmount:void 0,tickPlacement:"on",min:void 0,max:void 0,range:void 0,floating:!1,decimalsInFloat:void 0,position:"bottom",title:{text:void 0,offsetX:0,offsetY:0,style:{color:void 0,fontSize:"12px",fontWeight:900,fontFamily:void 0,cssClass:""}},crosshairs:{show:!0,width:1,position:"back",opacity:.9,stroke:{color:"#b6b6b6",width:1,dashArray:3},fill:{type:"solid",color:"#B1B9C4",gradient:{colorFrom:"#D8E3F0",colorTo:"#BED1E6",stops:[0,100],opacityFrom:.4,opacityTo:.5}},dropShadow:{enabled:!1,left:0,top:0,blur:1,opacity:.8}},tooltip:{enabled:!0,offsetY:0,formatter:void 0,style:{fontSize:"12px",fontFamily:void 0}}},yaxis:this.yAxis,theme:{mode:"",palette:"palette1",monochrome:{enabled:!1,color:"#008FFB",shadeTo:"light",shadeIntensity:.65}}}}}]),e}(),lp=function(){function e(t){Rc(this,e),this.ctx=t,this.w=t.w,this.graphics=new Ku(this.ctx),this.w.globals.isBarHorizontal&&(this.invertAxis=!0),this.helpers=new Qu(this),this.xAxisAnnotations=new ep(this),this.yAxisAnnotations=new sp(this),this.pointsAnnotations=new op(this),this.w.globals.isBarHorizontal&&this.w.config.yaxis[0].reversed&&(this.inversedReversedAxis=!0),this.xDivision=this.w.globals.gridWidth/this.w.globals.dataPoints}return Mc(e,[{key:"drawAxesAnnotations",value:function(){var e=this.w;if(e.globals.axisCharts&&e.globals.dataPoints){for(var t=this.yAxisAnnotations.drawYAxisAnnotations(),a=this.xAxisAnnotations.drawXAxisAnnotations(),i=this.pointsAnnotations.drawPointAnnotations(),s=e.config.chart.animations.enabled,o=[t,a,i],n=[a.node,t.node,i.node],r=0;r<3;r++)e.globals.dom.elGraphical.add(o[r]),!s||e.globals.resized||e.globals.dataChanged||"scatter"!==e.config.chart.type&&"bubble"!==e.config.chart.type&&e.globals.dataPoints>1&&n[r].classList.add("apexcharts-element-hidden"),e.globals.delayedElements.push({el:n[r],index:0});this.helpers.annotationsBackground()}}},{key:"drawImageAnnos",value:function(){var e=this;this.w.config.annotations.images.map(function(t,a){e.addImage(t,a)})}},{key:"drawTextAnnos",value:function(){var e=this;this.w.config.annotations.texts.map(function(t,a){e.addText(t,a)})}},{key:"addXaxisAnnotation",value:function(e,t,a){this.xAxisAnnotations.addXaxisAnnotation(e,t,a)}},{key:"addYaxisAnnotation",value:function(e,t,a){this.yAxisAnnotations.addYaxisAnnotation(e,t,a)}},{key:"addPointAnnotation",value:function(e,t,a){this.pointsAnnotations.addPointAnnotation(e,t,a)}},{key:"addText",value:function(e,t){var a=e.x,i=e.y,s=e.text,o=e.textAnchor,n=e.foreColor,r=e.fontSize,l=e.fontFamily,c=e.fontWeight,h=e.cssClass,d=e.backgroundColor,u=e.borderWidth,p=e.strokeDashArray,m=e.borderRadius,g=e.borderColor,f=e.appendTo,b=void 0===f?".apexcharts-svg":f,y=e.paddingLeft,w=void 0===y?4:y,v=e.paddingRight,x=void 0===v?4:v,S=e.paddingBottom,_=void 0===S?2:S,k=e.paddingTop,C=void 0===k?2:k,I=this.w,E=this.graphics.drawText({x:a,y:i,text:s,textAnchor:o||"start",fontSize:r||"12px",fontWeight:c||"regular",fontFamily:l||I.config.chart.fontFamily,foreColor:n||I.config.chart.foreColor,cssClass:h}),T=I.globals.dom.baseEl.querySelector(b);T&&T.appendChild(E.node);var A=E.bbox();if(s){var P=this.graphics.drawRect(A.x-w,A.y-C,A.width+w+x,A.height+_+C,m,d||"transparent",1,u,g,p);T.insertBefore(P.node,E.node)}}},{key:"addImage",value:function(e,t){var a=this.w,i=e.path,s=e.x,o=void 0===s?0:s,n=e.y,r=void 0===n?0:n,l=e.width,c=void 0===l?20:l,h=e.height,d=void 0===h?20:h,u=e.appendTo,p=void 0===u?".apexcharts-svg":u,m=a.globals.dom.Paper.image(i);m.size(c,d).move(o,r);var g=a.globals.dom.baseEl.querySelector(p);return g&&g.appendChild(m.node),m}},{key:"addXaxisAnnotationExternal",value:function(e,t,a){return this.addAnnotationExternal({params:e,pushToMemory:t,context:a,type:"xaxis",contextMethod:a.addXaxisAnnotation}),a}},{key:"addYaxisAnnotationExternal",value:function(e,t,a){return this.addAnnotationExternal({params:e,pushToMemory:t,context:a,type:"yaxis",contextMethod:a.addYaxisAnnotation}),a}},{key:"addPointAnnotationExternal",value:function(e,t,a){return void 0===this.invertAxis&&(this.invertAxis=a.w.globals.isBarHorizontal),this.addAnnotationExternal({params:e,pushToMemory:t,context:a,type:"point",contextMethod:a.addPointAnnotation}),a}},{key:"addAnnotationExternal",value:function(e){var t=e.params,a=e.pushToMemory,i=e.context,s=e.type,o=e.contextMethod,n=i,r=n.w,l=r.globals.dom.baseEl.querySelector(".apexcharts-".concat(s,"-annotations")),c=l.childNodes.length+1,h=new rp,d=Object.assign({},"xaxis"===s?h.xAxisAnnotation:"yaxis"===s?h.yAxisAnnotation:h.pointAnnotation),u=Xc.extend(d,t);switch(s){case"xaxis":this.addXaxisAnnotation(u,l,c);break;case"yaxis":this.addYaxisAnnotation(u,l,c);break;case"point":this.addPointAnnotation(u,l,c)}var p=r.globals.dom.baseEl.querySelector(".apexcharts-".concat(s,"-annotations .apexcharts-").concat(s,"-annotation-label[rel='").concat(c,"']")),m=this.helpers.addBackgroundToAnno(p,u);return m&&l.insertBefore(m.node,p),a&&r.globals.memory.methodsToExec.push({context:n,id:u.id?u.id:Xc.randomId(),method:o,label:"addAnnotation",params:t}),i}},{key:"clearAnnotations",value:function(e){for(var t=e.w,a=t.globals.dom.baseEl.querySelectorAll(".apexcharts-yaxis-annotations, .apexcharts-xaxis-annotations, .apexcharts-point-annotations"),i=t.globals.memory.methodsToExec.length-1;i>=0;i--)"addText"!==t.globals.memory.methodsToExec[i].label&&"addAnnotation"!==t.globals.memory.methodsToExec[i].label||t.globals.memory.methodsToExec.splice(i,1);a=Xc.listToArray(a),Array.prototype.forEach.call(a,function(e){for(;e.firstChild;)e.removeChild(e.firstChild)})}},{key:"removeAnnotation",value:function(e,t){var a=e.w,i=a.globals.dom.baseEl.querySelectorAll(".".concat(t));i&&(a.globals.memory.methodsToExec.map(function(e,i){e.id===t&&a.globals.memory.methodsToExec.splice(i,1)}),Object.keys(a.config.annotations).forEach(function(e){var i=a.config.annotations[e];Array.isArray(i)&&(a.config.annotations[e]=i.filter(function(e){return e.id!==t}))}),Array.prototype.forEach.call(i,function(e){e.parentElement.removeChild(e)}))}}]),e}(),cp=function(e){var t,a=e.isTimeline,i=e.ctx,s=e.seriesIndex,o=e.dataPointIndex,n=e.y1,r=e.y2,l=e.w,c=l.globals.seriesRangeStart[s][o],h=l.globals.seriesRangeEnd[s][o],d=l.globals.labels[o],u=l.config.series[s].name?l.config.series[s].name:"",p=l.globals.ttKeyFormatter,m=l.config.tooltip.y.title.formatter,g={w:l,seriesIndex:s,dataPointIndex:o,start:c,end:h};"function"==typeof m&&(u=m(u,g)),null!==(t=l.config.series[s].data[o])&&void 0!==t&&t.x&&(d=l.config.series[s].data[o].x),a||"datetime"===l.config.xaxis.type&&(d=new ap(i).xLabelFormat(l.globals.ttKeyFormatter,d,d,{i:void 0,dateFormatter:new tp(i).formatDate,w:l})),"function"==typeof p&&(d=p(d,g)),Number.isFinite(n)&&Number.isFinite(r)&&(c=n,h=r);var f="",b="",y=l.globals.colors[s];if(void 0===l.config.tooltip.x.formatter)if("datetime"===l.config.xaxis.type){var w=new tp(i);f=w.formatDate(w.getDate(c),l.config.tooltip.x.format),b=w.formatDate(w.getDate(h),l.config.tooltip.x.format)}else f=c,b=h;else f=l.config.tooltip.x.formatter(c),b=l.config.tooltip.x.formatter(h);return{start:c,end:h,startVal:f,endVal:b,ylabel:d,color:y,seriesName:u}},hp=function(e){var t=e.color,a=e.seriesName,i=e.ylabel,s=e.start,o=e.end,n=e.seriesIndex,r=e.dataPointIndex,l=e.ctx.tooltip.tooltipLabels.getFormatters(n);s=l.yLbFormatter(s),o=l.yLbFormatter(o);var c=l.yLbFormatter(e.w.globals.series[n][r]),h='<span class="value start-value">\n  '.concat(s,'\n  </span> <span class="separator">-</span> <span class="value end-value">\n  ').concat(o,"\n  </span>");return'<div class="apexcharts-tooltip-rangebar"><div> <span class="series-name" style="color: '+t+'">'+(a||"")+'</span></div><div> <span class="category">'+i+": </span> "+(e.w.globals.comboCharts?"rangeArea"===e.w.config.series[n].type||"rangeBar"===e.w.config.series[n].type?h:"<span>".concat(c,"</span>"):h)+" </div></div>"},dp=function(){function e(t){Rc(this,e),this.opts=t}return Mc(e,[{key:"hideYAxis",value:function(){this.opts.yaxis[0].show=!1,this.opts.yaxis[0].title.text="",this.opts.yaxis[0].axisBorder.show=!1,this.opts.yaxis[0].axisTicks.show=!1,this.opts.yaxis[0].floating=!0}},{key:"line",value:function(){return{dataLabels:{enabled:!1},stroke:{width:5,curve:"straight"},markers:{size:0,hover:{sizeOffset:6}},xaxis:{crosshairs:{width:1}}}}},{key:"sparkline",value:function(e){return this.hideYAxis(),Xc.extend(e,{grid:{show:!1,padding:{left:0,right:0,top:0,bottom:0}},legend:{show:!1},xaxis:{labels:{show:!1},tooltip:{enabled:!1},axisBorder:{show:!1},axisTicks:{show:!1}},chart:{toolbar:{show:!1},zoom:{enabled:!1}},dataLabels:{enabled:!1}})}},{key:"slope",value:function(){return this.hideYAxis(),{chart:{toolbar:{show:!1},zoom:{enabled:!1}},dataLabels:{enabled:!0,formatter:function(e,t){var a=t.w.config.series[t.seriesIndex].name;return null!==e?a+": "+e:""},background:{enabled:!1},offsetX:-5},grid:{xaxis:{lines:{show:!0}},yaxis:{lines:{show:!1}}},xaxis:{position:"top",labels:{style:{fontSize:14,fontWeight:900}},tooltip:{enabled:!1},crosshairs:{show:!1}},markers:{size:8,hover:{sizeOffset:1}},legend:{show:!1},tooltip:{shared:!1,intersect:!0,followCursor:!0},stroke:{width:5,curve:"straight"}}}},{key:"bar",value:function(){return{chart:{stacked:!1},plotOptions:{bar:{dataLabels:{position:"center"}}},dataLabels:{style:{colors:["#fff"]},background:{enabled:!1}},stroke:{width:0,lineCap:"square"},fill:{opacity:.85},legend:{markers:{shape:"square"}},tooltip:{shared:!1,intersect:!0},xaxis:{tooltip:{enabled:!1},tickPlacement:"between",crosshairs:{width:"barWidth",position:"back",fill:{type:"gradient"},dropShadow:{enabled:!1},stroke:{width:0}}}}}},{key:"funnel",value:function(){return this.hideYAxis(),Uc(Uc({},this.bar()),{},{chart:{animations:{speed:800,animateGradually:{enabled:!1}}},plotOptions:{bar:{horizontal:!0,borderRadiusApplication:"around",borderRadius:0,dataLabels:{position:"center"}}},grid:{show:!1,padding:{left:0,right:0}},xaxis:{labels:{show:!1},tooltip:{enabled:!1},axisBorder:{show:!1},axisTicks:{show:!1}}})}},{key:"candlestick",value:function(){var e=this;return{stroke:{width:1},fill:{opacity:1},dataLabels:{enabled:!1},tooltip:{shared:!0,custom:function(t){var a=t.seriesIndex,i=t.dataPointIndex,s=t.w;return e._getBoxTooltip(s,a,i,["Open","High","","Low","Close"],"candlestick")}},states:{active:{filter:{type:"none"}}},xaxis:{crosshairs:{width:1}}}}},{key:"boxPlot",value:function(){var e=this;return{chart:{animations:{dynamicAnimation:{enabled:!1}}},stroke:{width:1,colors:["#24292e"]},dataLabels:{enabled:!1},tooltip:{shared:!0,custom:function(t){var a=t.seriesIndex,i=t.dataPointIndex,s=t.w;return e._getBoxTooltip(s,a,i,["Minimum","Q1","Median","Q3","Maximum"],"boxPlot")}},markers:{size:7,strokeWidth:1,strokeColors:"#111"},xaxis:{crosshairs:{width:1}}}}},{key:"rangeBar",value:function(){return{chart:{animations:{animateGradually:!1}},stroke:{width:0,lineCap:"square"},plotOptions:{bar:{borderRadius:0,dataLabels:{position:"center"}}},dataLabels:{enabled:!1,formatter:function(e,t){t.ctx;var a=t.seriesIndex,i=t.dataPointIndex,s=t.w,o=function(){var e=s.globals.seriesRangeStart[a][i];return s.globals.seriesRangeEnd[a][i]-e};return s.globals.comboCharts?"rangeBar"===s.config.series[a].type||"rangeArea"===s.config.series[a].type?o():e:o()},background:{enabled:!1},style:{colors:["#fff"]}},markers:{size:10},tooltip:{shared:!1,followCursor:!0,custom:function(e){return e.w.config.plotOptions&&e.w.config.plotOptions.bar&&e.w.config.plotOptions.bar.horizontal?(a=cp(Uc(Uc({},t=e),{},{isTimeline:!0})),i=a.color,s=a.seriesName,o=a.ylabel,n=a.startVal,r=a.endVal,hp(Uc(Uc({},t),{},{color:i,seriesName:s,ylabel:o,start:n,end:r}))):function(e){var t=cp(e),a=t.color,i=t.seriesName,s=t.ylabel,o=t.start,n=t.end;return hp(Uc(Uc({},e),{},{color:a,seriesName:i,ylabel:s,start:o,end:n}))}(e);var t,a,i,s,o,n,r}},xaxis:{tickPlacement:"between",tooltip:{enabled:!1},crosshairs:{stroke:{width:0}}}}}},{key:"dumbbell",value:function(e){var t,a;return null!==(t=e.plotOptions.bar)&&void 0!==t&&t.barHeight||(e.plotOptions.bar.barHeight=2),null!==(a=e.plotOptions.bar)&&void 0!==a&&a.columnWidth||(e.plotOptions.bar.columnWidth=2),e}},{key:"area",value:function(){return{stroke:{width:4,fill:{type:"solid",gradient:{inverseColors:!1,shade:"light",type:"vertical",opacityFrom:.65,opacityTo:.5,stops:[0,100,100]}}},fill:{type:"gradient",gradient:{inverseColors:!1,shade:"light",type:"vertical",opacityFrom:.65,opacityTo:.5,stops:[0,100,100]}},markers:{size:0,hover:{sizeOffset:6}},tooltip:{followCursor:!1}}}},{key:"rangeArea",value:function(){return{stroke:{curve:"straight",width:0},fill:{type:"solid",opacity:.6},markers:{size:0},states:{hover:{filter:{type:"none"}},active:{filter:{type:"none"}}},tooltip:{intersect:!1,shared:!0,followCursor:!0,custom:function(e){return a=cp(t=e),i=a.color,s=a.seriesName,o=a.ylabel,n=a.start,r=a.end,hp(Uc(Uc({},t),{},{color:i,seriesName:s,ylabel:o,start:n,end:r}));var t,a,i,s,o,n,r}}}}},{key:"brush",value:function(e){return Xc.extend(e,{chart:{toolbar:{autoSelected:"selection",show:!1},zoom:{enabled:!1}},dataLabels:{enabled:!1},stroke:{width:1},tooltip:{enabled:!1},xaxis:{tooltip:{enabled:!1}}})}},{key:"stacked100",value:function(e){e.dataLabels=e.dataLabels||{},e.dataLabels.formatter=e.dataLabels.formatter||void 0;var t=e.dataLabels.formatter;return e.yaxis.forEach(function(t,a){e.yaxis[a].min=0,e.yaxis[a].max=100}),"bar"===e.chart.type&&(e.dataLabels.formatter=t||function(e){return"number"==typeof e&&e?e.toFixed(0)+"%":e}),e}},{key:"stackedBars",value:function(){var e=this.bar();return Uc(Uc({},e),{},{plotOptions:Uc(Uc({},e.plotOptions),{},{bar:Uc(Uc({},e.plotOptions.bar),{},{borderRadiusApplication:"end",borderRadiusWhenStacked:"last"})})})}},{key:"convertCatToNumeric",value:function(e){return e.xaxis.convertedCatToNumeric=!0,e}},{key:"convertCatToNumericXaxis",value:function(e,t,a){e.xaxis.type="numeric",e.xaxis.labels=e.xaxis.labels||{},e.xaxis.labels.formatter=e.xaxis.labels.formatter||function(e){return Xc.isNumber(e)?Math.floor(e):e};var i=e.xaxis.labels.formatter,s=e.xaxis.categories&&e.xaxis.categories.length?e.xaxis.categories:e.labels;return a&&a.length&&(s=a.map(function(e){return Array.isArray(e)?e:String(e)})),s&&s.length&&(e.xaxis.labels.formatter=function(e){return Xc.isNumber(e)?i(s[Math.floor(e)-1]):i(e)}),e.xaxis.categories=[],e.labels=[],e.xaxis.tickAmount=e.xaxis.tickAmount||"dataPoints",e}},{key:"bubble",value:function(){return{dataLabels:{style:{colors:["#fff"]}},tooltip:{shared:!1,intersect:!0},xaxis:{crosshairs:{width:0}},fill:{type:"solid",gradient:{shade:"light",inverse:!0,shadeIntensity:.55,opacityFrom:.4,opacityTo:.8}}}}},{key:"scatter",value:function(){return{dataLabels:{enabled:!1},tooltip:{shared:!1,intersect:!0},markers:{size:6,strokeWidth:1,hover:{sizeOffset:2}}}}},{key:"heatmap",value:function(){return{chart:{stacked:!1},fill:{opacity:1},dataLabels:{style:{colors:["#fff"]}},stroke:{colors:["#fff"]},tooltip:{followCursor:!0,marker:{show:!1},x:{show:!1}},legend:{position:"top",markers:{shape:"square"}},grid:{padding:{right:20}}}}},{key:"treemap",value:function(){return{chart:{zoom:{enabled:!1}},dataLabels:{style:{fontSize:14,fontWeight:600,colors:["#fff"]}},stroke:{show:!0,width:2,colors:["#fff"]},legend:{show:!1},fill:{opacity:1,gradient:{stops:[0,100]}},tooltip:{followCursor:!0,x:{show:!1}},grid:{padding:{left:0,right:0}},xaxis:{crosshairs:{show:!1},tooltip:{enabled:!1}}}}},{key:"pie",value:function(){return{chart:{toolbar:{show:!1}},plotOptions:{pie:{donut:{labels:{show:!1}}}},dataLabels:{formatter:function(e){return e.toFixed(1)+"%"},style:{colors:["#fff"]},background:{enabled:!1},dropShadow:{enabled:!0}},stroke:{colors:["#fff"]},fill:{opacity:1,gradient:{shade:"light",stops:[0,100]}},tooltip:{theme:"dark",fillSeriesColor:!0},legend:{position:"right"},grid:{padding:{left:0,right:0,top:0,bottom:0}}}}},{key:"donut",value:function(){return{chart:{toolbar:{show:!1}},dataLabels:{formatter:function(e){return e.toFixed(1)+"%"},style:{colors:["#fff"]},background:{enabled:!1},dropShadow:{enabled:!0}},stroke:{colors:["#fff"]},fill:{opacity:1,gradient:{shade:"light",shadeIntensity:.35,stops:[80,100],opacityFrom:1,opacityTo:1}},tooltip:{theme:"dark",fillSeriesColor:!0},legend:{position:"right"},grid:{padding:{left:0,right:0,top:0,bottom:0}}}}},{key:"polarArea",value:function(){return{chart:{toolbar:{show:!1}},dataLabels:{formatter:function(e){return e.toFixed(1)+"%"},enabled:!1},stroke:{show:!0,width:2},fill:{opacity:.7},tooltip:{theme:"dark",fillSeriesColor:!0},legend:{position:"right"},grid:{padding:{left:0,right:0,top:0,bottom:0}}}}},{key:"radar",value:function(){return this.opts.yaxis[0].labels.offsetY=this.opts.yaxis[0].labels.offsetY?this.opts.yaxis[0].labels.offsetY:6,{dataLabels:{enabled:!1,style:{fontSize:"11px"}},stroke:{width:2},markers:{size:5,strokeWidth:1,strokeOpacity:1},fill:{opacity:.2},tooltip:{shared:!1,intersect:!0,followCursor:!0},grid:{show:!1,padding:{left:0,right:0,top:0,bottom:0}},xaxis:{labels:{formatter:function(e){return e},style:{colors:["#a8a8a8"],fontSize:"11px"}},tooltip:{enabled:!1},crosshairs:{show:!1}}}}},{key:"radialBar",value:function(){return{chart:{animations:{dynamicAnimation:{enabled:!0,speed:800}},toolbar:{show:!1}},fill:{gradient:{shade:"dark",shadeIntensity:.4,inverseColors:!1,type:"diagonal2",opacityFrom:1,opacityTo:1,stops:[70,98,100]}},legend:{show:!1,position:"right"},tooltip:{enabled:!1,fillSeriesColor:!0},grid:{padding:{left:0,right:0,top:0,bottom:0}}}}},{key:"_getBoxTooltip",value:function(e,t,a,i,s){var o=e.globals.seriesCandleO[t][a],n=e.globals.seriesCandleH[t][a],r=e.globals.seriesCandleM[t][a],l=e.globals.seriesCandleL[t][a],c=e.globals.seriesCandleC[t][a];return e.config.series[t].type&&e.config.series[t].type!==s?'<div class="apexcharts-custom-tooltip">\n          '.concat(e.config.series[t].name?e.config.series[t].name:"series-"+(t+1),": <strong>").concat(e.globals.series[t][a],"</strong>\n        </div>"):'<div class="apexcharts-tooltip-box apexcharts-tooltip-'.concat(e.config.chart.type,'">')+"<div>".concat(i[0],': <span class="value">')+o+"</span></div>"+"<div>".concat(i[1],': <span class="value">')+n+"</span></div>"+(r?"<div>".concat(i[2],': <span class="value">')+r+"</span></div>":"")+"<div>".concat(i[3],': <span class="value">')+l+"</span></div>"+"<div>".concat(i[4],': <span class="value">')+c+"</span></div></div>"}}]),e}(),up=function(){function e(t){Rc(this,e),this.opts=t}return Mc(e,[{key:"init",value:function(e){var t=e.responsiveOverride,a=this.opts,i=new rp,s=new dp(a);this.chartType=a.chart.type,a=this.extendYAxis(a),a=this.extendAnnotations(a);var o=i.init(),n={};if(a&&"object"===Yc(a)){var r,l,c,h,d,u,p,m,g,f,b={};b=-1!==["line","area","bar","candlestick","boxPlot","rangeBar","rangeArea","bubble","scatter","heatmap","treemap","pie","polarArea","donut","radar","radialBar"].indexOf(a.chart.type)?s[a.chart.type]():s.line(),null!==(r=a.plotOptions)&&void 0!==r&&null!==(l=r.bar)&&void 0!==l&&l.isFunnel&&(b=s.funnel()),a.chart.stacked&&"bar"===a.chart.type&&(b=s.stackedBars()),null!==(c=a.chart.brush)&&void 0!==c&&c.enabled&&(b=s.brush(b)),null!==(h=a.plotOptions)&&void 0!==h&&null!==(d=h.line)&&void 0!==d&&d.isSlopeChart&&(b=s.slope()),a.chart.stacked&&"100%"===a.chart.stackType&&(a=s.stacked100(a)),null!==(u=a.plotOptions)&&void 0!==u&&null!==(p=u.bar)&&void 0!==p&&p.isDumbbell&&(a=s.dumbbell(a)),this.checkForDarkTheme(window.Apex),this.checkForDarkTheme(a),a.xaxis=a.xaxis||window.Apex.xaxis||{},t||(a.xaxis.convertedCatToNumeric=!1),(null!==(m=(a=this.checkForCatToNumericXAxis(this.chartType,b,a)).chart.sparkline)&&void 0!==m&&m.enabled||null!==(g=window.Apex.chart)&&void 0!==g&&null!==(f=g.sparkline)&&void 0!==f&&f.enabled)&&(b=s.sparkline(b)),n=Xc.extend(o,b)}var y=Xc.extend(n,window.Apex);return o=Xc.extend(y,a),this.handleUserInputErrors(o)}},{key:"checkForCatToNumericXAxis",value:function(e,t,a){var i,s,o=new dp(a),n=("bar"===e||"boxPlot"===e)&&(null===(i=a.plotOptions)||void 0===i||null===(s=i.bar)||void 0===s?void 0:s.horizontal),r="pie"===e||"polarArea"===e||"donut"===e||"radar"===e||"radialBar"===e||"heatmap"===e,l="datetime"!==a.xaxis.type&&"numeric"!==a.xaxis.type,c=a.xaxis.tickPlacement?a.xaxis.tickPlacement:t.xaxis&&t.xaxis.tickPlacement;return n||r||!l||"between"===c||(a=o.convertCatToNumeric(a)),a}},{key:"extendYAxis",value:function(e,t){var a=new rp;(void 0===e.yaxis||!e.yaxis||Array.isArray(e.yaxis)&&0===e.yaxis.length)&&(e.yaxis={}),e.yaxis.constructor!==Array&&window.Apex.yaxis&&window.Apex.yaxis.constructor!==Array&&(e.yaxis=Xc.extend(e.yaxis,window.Apex.yaxis)),e.yaxis.constructor!==Array?e.yaxis=[Xc.extend(a.yAxis,e.yaxis)]:e.yaxis=Xc.extendArray(e.yaxis,a.yAxis);var i=!1;e.yaxis.forEach(function(e){e.logarithmic&&(i=!0)});var s=e.series;return t&&!s&&(s=t.config.series),i&&s.length!==e.yaxis.length&&s.length&&(e.yaxis=s.map(function(t,i){if(t.name||(s[i].name="series-".concat(i+1)),e.yaxis[i])return e.yaxis[i].seriesName=s[i].name,e.yaxis[i];var o=Xc.extend(a.yAxis,e.yaxis[0]);return o.show=!1,o})),i&&s.length>1&&s.length!==e.yaxis.length&&console.warn("A multi-series logarithmic chart should have equal number of series and y-axes"),e}},{key:"extendAnnotations",value:function(e){return void 0===e.annotations&&(e.annotations={},e.annotations.yaxis=[],e.annotations.xaxis=[],e.annotations.points=[]),e=this.extendYAxisAnnotations(e),e=this.extendXAxisAnnotations(e),this.extendPointAnnotations(e)}},{key:"extendYAxisAnnotations",value:function(e){var t=new rp;return e.annotations.yaxis=Xc.extendArray(void 0!==e.annotations.yaxis?e.annotations.yaxis:[],t.yAxisAnnotation),e}},{key:"extendXAxisAnnotations",value:function(e){var t=new rp;return e.annotations.xaxis=Xc.extendArray(void 0!==e.annotations.xaxis?e.annotations.xaxis:[],t.xAxisAnnotation),e}},{key:"extendPointAnnotations",value:function(e){var t=new rp;return e.annotations.points=Xc.extendArray(void 0!==e.annotations.points?e.annotations.points:[],t.pointAnnotation),e}},{key:"checkForDarkTheme",value:function(e){e.theme&&"dark"===e.theme.mode&&(e.tooltip||(e.tooltip={}),"light"!==e.tooltip.theme&&(e.tooltip.theme="dark"),e.chart.foreColor||(e.chart.foreColor="#f6f7f8"),e.theme.palette||(e.theme.palette="palette4"))}},{key:"handleUserInputErrors",value:function(e){var t=e;if(t.tooltip.shared&&t.tooltip.intersect)throw new Error("tooltip.shared cannot be enabled when tooltip.intersect is true. Turn off any other option by setting it to false.");if("bar"===t.chart.type&&t.plotOptions.bar.horizontal){if(t.yaxis.length>1)throw new Error("Multiple Y Axis for bars are not supported. Switch to column chart by setting plotOptions.bar.horizontal=false");t.yaxis[0].reversed&&(t.yaxis[0].opposite=!0),t.xaxis.tooltip.enabled=!1,t.yaxis[0].tooltip.enabled=!1,t.chart.zoom.enabled=!1}return"bar"!==t.chart.type&&"rangeBar"!==t.chart.type||t.tooltip.shared&&"barWidth"===t.xaxis.crosshairs.width&&t.series.length>1&&(t.xaxis.crosshairs.width="tickWidth"),"candlestick"!==t.chart.type&&"boxPlot"!==t.chart.type||t.yaxis[0].reversed&&(console.warn("Reversed y-axis in ".concat(t.chart.type," chart is not supported.")),t.yaxis[0].reversed=!1),t}}]),e}(),pp=function(){function e(){Rc(this,e)}return Mc(e,[{key:"initGlobalVars",value:function(e){e.series=[],e.seriesCandleO=[],e.seriesCandleH=[],e.seriesCandleM=[],e.seriesCandleL=[],e.seriesCandleC=[],e.seriesRangeStart=[],e.seriesRangeEnd=[],e.seriesRange=[],e.seriesPercent=[],e.seriesGoals=[],e.seriesX=[],e.seriesZ=[],e.seriesNames=[],e.seriesTotals=[],e.seriesLog=[],e.seriesColors=[],e.stackedSeriesTotals=[],e.seriesXvalues=[],e.seriesYvalues=[],e.labels=[],e.hasXaxisGroups=!1,e.groups=[],e.barGroups=[],e.lineGroups=[],e.areaGroups=[],e.hasSeriesGroups=!1,e.seriesGroups=[],e.categoryLabels=[],e.timescaleLabels=[],e.noLabelsProvided=!1,e.resizeTimer=null,e.selectionResizeTimer=null,e.lastWheelExecution=0,e.delayedElements=[],e.pointsArray=[],e.dataLabelsRects=[],e.isXNumeric=!1,e.skipLastTimelinelabel=!1,e.skipFirstTimelinelabel=!1,e.isDataXYZ=!1,e.isMultiLineX=!1,e.isMultipleYAxis=!1,e.maxY=-Number.MAX_VALUE,e.minY=Number.MIN_VALUE,e.minYArr=[],e.maxYArr=[],e.maxX=-Number.MAX_VALUE,e.minX=Number.MAX_VALUE,e.initialMaxX=-Number.MAX_VALUE,e.initialMinX=Number.MAX_VALUE,e.maxDate=0,e.minDate=Number.MAX_VALUE,e.minZ=Number.MAX_VALUE,e.maxZ=-Number.MAX_VALUE,e.minXDiff=Number.MAX_VALUE,e.yAxisScale=[],e.xAxisScale=null,e.xAxisTicksPositions=[],e.yLabelsCoords=[],e.yTitleCoords=[],e.barPadForNumericAxis=0,e.padHorizontal=0,e.xRange=0,e.yRange=[],e.zRange=0,e.dataPoints=0,e.xTickAmount=0,e.multiAxisTickAmount=0}},{key:"globalVars",value:function(e){return{chartID:null,cuid:null,events:{beforeMount:[],mounted:[],updated:[],clicked:[],selection:[],dataPointSelection:[],zoomed:[],scrolled:[]},colors:[],clientX:null,clientY:null,fill:{colors:[]},stroke:{colors:[]},dataLabels:{style:{colors:[]}},radarPolygons:{fill:{colors:[]}},markers:{colors:[],size:e.markers.size,largestSize:0},animationEnded:!1,isTouchDevice:"ontouchstart"in window||navigator.msMaxTouchPoints,isDirty:!1,isExecCalled:!1,initialConfig:null,initialSeries:[],lastXAxis:[],lastYAxis:[],columnSeries:null,labels:[],timescaleLabels:[],noLabelsProvided:!1,allSeriesCollapsed:!1,collapsedSeries:[],collapsedSeriesIndices:[],ancillaryCollapsedSeries:[],ancillaryCollapsedSeriesIndices:[],risingSeries:[],dataFormatXNumeric:!1,capturedSeriesIndex:-1,capturedDataPointIndex:-1,selectedDataPoints:[],invalidLogScale:!1,ignoreYAxisIndexes:[],maxValsInArrayIndex:0,radialSize:0,selection:void 0,zoomEnabled:"zoom"===e.chart.toolbar.autoSelected&&e.chart.toolbar.tools.zoom&&e.chart.zoom.enabled,panEnabled:"pan"===e.chart.toolbar.autoSelected&&e.chart.toolbar.tools.pan,selectionEnabled:"selection"===e.chart.toolbar.autoSelected&&e.chart.toolbar.tools.selection,yaxis:null,mousedown:!1,lastClientPosition:{},visibleXRange:void 0,yValueDecimal:0,total:0,SVGNS:"http://www.w3.org/2000/svg",svgWidth:0,svgHeight:0,noData:!1,locale:{},dom:{},memory:{methodsToExec:[]},shouldAnimate:!0,skipLastTimelinelabel:!1,skipFirstTimelinelabel:!1,delayedElements:[],axisCharts:!0,isDataXYZ:!1,isSlopeChart:e.plotOptions.line.isSlopeChart,resized:!1,resizeTimer:null,comboCharts:!1,dataChanged:!1,previousPaths:[],allSeriesHasEqualX:!0,pointsArray:[],dataLabelsRects:[],lastDrawnDataLabelsIndexes:[],hasNullValues:!1,zoomed:!1,gridWidth:0,gridHeight:0,rotateXLabels:!1,defaultLabels:!1,xLabelFormatter:void 0,yLabelFormatters:[],xaxisTooltipFormatter:void 0,ttKeyFormatter:void 0,ttVal:void 0,ttZFormatter:void 0,LINE_HEIGHT_RATIO:1.618,xAxisLabelsHeight:0,xAxisGroupLabelsHeight:0,xAxisLabelsWidth:0,yAxisLabelsWidth:0,scaleX:1,scaleY:1,translateX:0,translateY:0,translateYAxisX:[],yAxisWidths:[],translateXAxisY:0,translateXAxisX:0,tooltip:null,niceScaleAllowedMagMsd:[[1,1,2,5,5,5,10,10,10,10,10],[1,1,2,5,5,5,10,10,10,10,10]],niceScaleDefaultTicks:[1,2,4,4,6,6,6,6,6,6,6,6,6,6,6,6,6,6,12,12,12,12,12,12,12,12,12,24],seriesYAxisMap:[],seriesYAxisReverseMap:[]}}},{key:"init",value:function(e){var t=this.globalVars(e);return this.initGlobalVars(t),t.initialConfig=Xc.extend({},e),t.initialSeries=Xc.clone(e.series),t.lastXAxis=Xc.clone(t.initialConfig.xaxis),t.lastYAxis=Xc.clone(t.initialConfig.yaxis),t}}]),e}(),mp=function(){function e(t){Rc(this,e),this.opts=t}return Mc(e,[{key:"init",value:function(){var e=new up(this.opts).init({responsiveOverride:!1});return{config:e,globals:(new pp).init(e)}}}]),e}(),gp=function(){function e(t){Rc(this,e),this.ctx=t,this.w=t.w,this.opts=null,this.seriesIndex=0,this.patternIDs=[]}return Mc(e,[{key:"clippedImgArea",value:function(e){var t=this.w,a=t.config,i=parseInt(t.globals.gridWidth,10),s=parseInt(t.globals.gridHeight,10),o=i>s?i:s,n=e.image,r=0,l=0;void 0===e.width&&void 0===e.height?void 0!==a.fill.image.width&&void 0!==a.fill.image.height?(r=a.fill.image.width+1,l=a.fill.image.height):(r=o+1,l=o):(r=e.width,l=e.height);var c=document.createElementNS(t.globals.SVGNS,"pattern");Ku.setAttrs(c,{id:e.patternID,patternUnits:e.patternUnits?e.patternUnits:"userSpaceOnUse",width:r+"px",height:l+"px"});var h=document.createElementNS(t.globals.SVGNS,"image");c.appendChild(h),h.setAttributeNS(window.SVG.xlink,"href",n),Ku.setAttrs(h,{x:0,y:0,preserveAspectRatio:"none",width:r+"px",height:l+"px"}),h.style.opacity=e.opacity,t.globals.dom.elDefs.node.appendChild(c)}},{key:"getSeriesIndex",value:function(e){var t=this.w,a=t.config.chart.type;return("bar"===a||"rangeBar"===a)&&t.config.plotOptions.bar.distributed||"heatmap"===a||"treemap"===a?this.seriesIndex=e.seriesNumber:this.seriesIndex=e.seriesNumber%t.globals.series.length,this.seriesIndex}},{key:"computeColorStops",value:function(e,t){var a,i=this.w,s=null,o=null,n=Lc(e);try{for(n.s();!(a=n.n()).done;){var r=a.value;r>=t.threshold?(null===s||r>s)&&(s=r):(null===o||r<o)&&(o=r)}}catch(h){n.e(h)}finally{n.f()}null===s&&(s=t.threshold),null===o&&(o=t.threshold);var l=s-t.threshold+(t.threshold-o);0===l&&(l=1);var c=100-(t.threshold-o)/l*100;return[{offset:c=Math.max(0,Math.min(c,100)),color:t.colorAboveThreshold,opacity:i.config.fill.opacity},{offset:0,color:t.colorBelowThreshold,opacity:i.config.fill.opacity}]}},{key:"fillPath",value:function(e){var t,a,i,s=this.w;this.opts=e;var o,n,r,l=this.w.config;this.seriesIndex=this.getSeriesIndex(e);var c=l.plotOptions.line.colors.colorAboveThreshold&&l.plotOptions.line.colors.colorBelowThreshold,h=this.getFillColors()[this.seriesIndex];void 0!==s.globals.seriesColors[this.seriesIndex]&&(h=s.globals.seriesColors[this.seriesIndex]),"function"==typeof h&&(h=h({seriesIndex:this.seriesIndex,dataPointIndex:e.dataPointIndex,value:e.value,w:s}));var d,u,p,m=e.fillType?e.fillType:this.getFillType(this.seriesIndex),g=Array.isArray(l.fill.opacity)?l.fill.opacity[this.seriesIndex]:l.fill.opacity,f="gradient"===m||c;e.color&&(h=e.color),null!==(t=s.config.series[this.seriesIndex])&&void 0!==t&&null!==(a=t.data)&&void 0!==a&&null!==(i=a[e.dataPointIndex])&&void 0!==i&&i.fillColor&&(h=null===(d=s.config.series[this.seriesIndex])||void 0===d||null===(u=d.data)||void 0===u||null===(p=u[e.dataPointIndex])||void 0===p?void 0:p.fillColor),h||(h="#fff",console.warn("undefined color - ApexCharts"));var b=h;if(-1===h.indexOf("rgb")?-1===h.indexOf("#")?b=h:h.length<9&&(b=Xc.hexToRgba(h,g)):h.indexOf("rgba")>-1?g=Xc.getOpacityFromRGBA(h):b=Xc.hexToRgba(Xc.rgb2hex(h),g),e.opacity&&(g=e.opacity),"pattern"===m&&(n=this.handlePatternFill({fillConfig:e.fillConfig,patternFill:n,fillColor:h,fillOpacity:g,defaultColor:b})),f){var y=Vc(l.fill.gradient.colorStops)||[],w=l.fill.gradient.type;c&&(y[this.seriesIndex]=this.computeColorStops(s.globals.series[this.seriesIndex],l.plotOptions.line.colors),w="vertical"),r=this.handleGradientFill({type:w,fillConfig:e.fillConfig,fillColor:h,fillOpacity:g,colorStops:y,i:this.seriesIndex})}if("image"===m){var v=l.fill.image.src,x=e.patternID?e.patternID:"",S="pattern".concat(s.globals.cuid).concat(e.seriesNumber+1).concat(x);-1===this.patternIDs.indexOf(S)&&(this.clippedImgArea({opacity:g,image:Array.isArray(v)?e.seriesNumber<v.length?v[e.seriesNumber]:v[0]:v,width:e.width?e.width:void 0,height:e.height?e.height:void 0,patternUnits:e.patternUnits,patternID:S}),this.patternIDs.push(S)),o="url(#".concat(S,")")}else o=f?r:"pattern"===m?n:b;return e.solid&&(o=b),o}},{key:"getFillType",value:function(e){var t=this.w;return Array.isArray(t.config.fill.type)?t.config.fill.type[e]:t.config.fill.type}},{key:"getFillColors",value:function(){var e=this.w,t=e.config,a=this.opts,i=[];return e.globals.comboCharts?"line"===e.config.series[this.seriesIndex].type?Array.isArray(e.globals.stroke.colors)?i=e.globals.stroke.colors:i.push(e.globals.stroke.colors):Array.isArray(e.globals.fill.colors)?i=e.globals.fill.colors:i.push(e.globals.fill.colors):"line"===t.chart.type?Array.isArray(e.globals.stroke.colors)?i=e.globals.stroke.colors:i.push(e.globals.stroke.colors):Array.isArray(e.globals.fill.colors)?i=e.globals.fill.colors:i.push(e.globals.fill.colors),void 0!==a.fillColors&&(i=[],Array.isArray(a.fillColors)?i=a.fillColors.slice():i.push(a.fillColors)),i}},{key:"handlePatternFill",value:function(e){var t=e.fillConfig,a=(e.patternFill,e.fillColor),i=e.fillOpacity,s=e.defaultColor,o=this.w.config.fill;t&&(o=t);var n=this.opts,r=new Ku(this.ctx),l=Array.isArray(o.pattern.strokeWidth)?o.pattern.strokeWidth[this.seriesIndex]:o.pattern.strokeWidth,c=a;return Array.isArray(o.pattern.style)?void 0!==o.pattern.style[n.seriesNumber]?r.drawPattern(o.pattern.style[n.seriesNumber],o.pattern.width,o.pattern.height,c,l,i):s:r.drawPattern(o.pattern.style,o.pattern.width,o.pattern.height,c,l,i)}},{key:"handleGradientFill",value:function(e){var t=e.type,a=e.fillColor,i=e.fillOpacity,s=e.fillConfig,o=e.colorStops,n=e.i,r=this.w.config.fill;s&&(r=Uc(Uc({},r),s));var l=this.opts,c=new Ku(this.ctx),h=new Xc;t=t||r.gradient.type;var d,u=a,p=void 0===r.gradient.opacityFrom?i:Array.isArray(r.gradient.opacityFrom)?r.gradient.opacityFrom[n]:r.gradient.opacityFrom;u.indexOf("rgba")>-1&&(p=Xc.getOpacityFromRGBA(u));var m=void 0===r.gradient.opacityTo?i:Array.isArray(r.gradient.opacityTo)?r.gradient.opacityTo[n]:r.gradient.opacityTo;if(void 0===r.gradient.gradientToColors||0===r.gradient.gradientToColors.length)d="dark"===r.gradient.shade?h.shadeColor(-1*parseFloat(r.gradient.shadeIntensity),a.indexOf("rgb")>-1?Xc.rgb2hex(a):a):h.shadeColor(parseFloat(r.gradient.shadeIntensity),a.indexOf("rgb")>-1?Xc.rgb2hex(a):a);else if(r.gradient.gradientToColors[l.seriesNumber]){var g=r.gradient.gradientToColors[l.seriesNumber];d=g,g.indexOf("rgba")>-1&&(m=Xc.getOpacityFromRGBA(g))}else d=a;if(r.gradient.gradientFrom&&(u=r.gradient.gradientFrom),r.gradient.gradientTo&&(d=r.gradient.gradientTo),r.gradient.inverseColors){var f=u;u=d,d=f}return u.indexOf("rgb")>-1&&(u=Xc.rgb2hex(u)),d.indexOf("rgb")>-1&&(d=Xc.rgb2hex(d)),c.drawGradient(t,u,d,p,m,l.size,r.gradient.stops,o,n)}}]),e}(),fp=function(){function e(t,a){Rc(this,e),this.ctx=t,this.w=t.w}return Mc(e,[{key:"setGlobalMarkerSize",value:function(){var e=this.w;if(e.globals.markers.size=Array.isArray(e.config.markers.size)?e.config.markers.size:[e.config.markers.size],e.globals.markers.size.length>0){if(e.globals.markers.size.length<e.globals.series.length+1)for(var t=0;t<=e.globals.series.length;t++)void 0===e.globals.markers.size[t]&&e.globals.markers.size.push(e.globals.markers.size[0])}else e.globals.markers.size=e.config.series.map(function(t){return e.config.markers.size})}},{key:"plotChartMarkers",value:function(e){var t=e.pointsPos,a=e.seriesIndex,i=e.j,s=e.pSize,o=e.alwaysDrawMarker,n=void 0!==o&&o,r=e.isVirtualPoint,l=void 0!==r&&r,c=this.w,h=a,d=t,u=null,p=new Ku(this.ctx),m=c.config.markers.discrete&&c.config.markers.discrete.length;if(Array.isArray(d.x))for(var g=0;g<d.x.length;g++){var f=void 0,b=i,y=!Xc.isNumber(d.y[g]);0===c.globals.markers.largestSize&&c.globals.hasNullValues&&null!==c.globals.series[h][i+1]&&!l&&(y=!0),1===i&&0===g&&(b=0),1===i&&1===g&&(b=1);var w="apexcharts-marker";if("line"!==c.config.chart.type&&"area"!==c.config.chart.type||c.globals.comboCharts||c.config.tooltip.intersect||(w+=" no-pointer-events"),(Array.isArray(c.config.markers.size)?c.globals.markers.size[a]>0:c.config.markers.size>0)||n||m){y||(w+=" w".concat(Xc.randomId()));var v=this.getMarkerConfig({cssClass:w,seriesIndex:a,dataPointIndex:b});c.config.series[h].data[b]&&(c.config.series[h].data[b].fillColor&&(v.pointFillColor=c.config.series[h].data[b].fillColor),c.config.series[h].data[b].strokeColor&&(v.pointStrokeColor=c.config.series[h].data[b].strokeColor)),void 0!==s&&(v.pSize=s),(d.x[g]<-c.globals.markers.largestSize||d.x[g]>c.globals.gridWidth+c.globals.markers.largestSize||d.y[g]<-c.globals.markers.largestSize||d.y[g]>c.globals.gridHeight+c.globals.markers.largestSize)&&(v.pSize=0),y||((c.globals.markers.size[a]>0||n||m)&&!u&&(u=p.group({class:n||m?"":"apexcharts-series-markers"})).attr("clip-path","url(#gridRectMarkerMask".concat(c.globals.cuid,")")),(f=p.drawMarker(d.x[g],d.y[g],v)).attr("rel",b),f.attr("j",b),f.attr("index",a),f.node.setAttribute("default-marker-size",v.pSize),new Zu(this.ctx).setSelectionFilter(f,a,b),this.addEvents(f),u&&u.add(f))}else void 0===c.globals.pointsArray[a]&&(c.globals.pointsArray[a]=[]),c.globals.pointsArray[a].push([d.x[g],d.y[g]])}return u}},{key:"getMarkerConfig",value:function(e){var t=e.cssClass,a=e.seriesIndex,i=e.dataPointIndex,s=void 0===i?null:i,o=e.radius,n=void 0===o?null:o,r=e.size,l=void 0===r?null:r,c=e.strokeWidth,h=void 0===c?null:c,d=this.w,u=this.getMarkerStyle(a),p=null===l?d.globals.markers.size[a]:l,m=d.config.markers;return null!==s&&m.discrete.length&&m.discrete.map(function(e){e.seriesIndex===a&&e.dataPointIndex===s&&(u.pointStrokeColor=e.strokeColor,u.pointFillColor=e.fillColor,p=e.size,u.pointShape=e.shape)}),{pSize:null===n?p:n,pRadius:null!==n?n:m.radius,pointStrokeWidth:null!==h?h:Array.isArray(m.strokeWidth)?m.strokeWidth[a]:m.strokeWidth,pointStrokeColor:u.pointStrokeColor,pointFillColor:u.pointFillColor,shape:u.pointShape||(Array.isArray(m.shape)?m.shape[a]:m.shape),class:t,pointStrokeOpacity:Array.isArray(m.strokeOpacity)?m.strokeOpacity[a]:m.strokeOpacity,pointStrokeDashArray:Array.isArray(m.strokeDashArray)?m.strokeDashArray[a]:m.strokeDashArray,pointFillOpacity:Array.isArray(m.fillOpacity)?m.fillOpacity[a]:m.fillOpacity,seriesIndex:a}}},{key:"addEvents",value:function(e){var t=this.w,a=new Ku(this.ctx);e.node.addEventListener("mouseenter",a.pathMouseEnter.bind(this.ctx,e)),e.node.addEventListener("mouseleave",a.pathMouseLeave.bind(this.ctx,e)),e.node.addEventListener("mousedown",a.pathMouseDown.bind(this.ctx,e)),e.node.addEventListener("click",t.config.markers.onClick),e.node.addEventListener("dblclick",t.config.markers.onDblClick),e.node.addEventListener("touchstart",a.pathMouseDown.bind(this.ctx,e),{passive:!0})}},{key:"getMarkerStyle",value:function(e){var t=this.w,a=t.globals.markers.colors,i=t.config.markers.strokeColor||t.config.markers.strokeColors;return{pointStrokeColor:Array.isArray(i)?i[e]:i,pointFillColor:Array.isArray(a)?a[e]:a}}}]),e}(),bp=function(){function e(t){Rc(this,e),this.ctx=t,this.w=t.w,this.initialAnim=this.w.config.chart.animations.enabled}return Mc(e,[{key:"draw",value:function(e,t,a){var i=this.w,s=new Ku(this.ctx),o=a.realIndex,n=a.pointsPos,r=a.zRatio,l=a.elParent,c=s.group({class:"apexcharts-series-markers apexcharts-series-".concat(i.config.chart.type)});if(c.attr("clip-path","url(#gridRectMarkerMask".concat(i.globals.cuid,")")),Array.isArray(n.x))for(var h=0;h<n.x.length;h++){var d=t+1,u=!0;0===t&&0===h&&(d=0),0===t&&1===h&&(d=1);var p=i.globals.markers.size[o];if(r!==1/0){var m=i.config.plotOptions.bubble;p=i.globals.seriesZ[o][d],m.zScaling&&(p/=r),m.minBubbleRadius&&p<m.minBubbleRadius&&(p=m.minBubbleRadius),m.maxBubbleRadius&&p>m.maxBubbleRadius&&(p=m.maxBubbleRadius)}var g=n.x[h],f=n.y[h];if(p=p||0,null!==f&&void 0!==i.globals.series[o][d]||(u=!1),u){var b=this.drawPoint(g,f,p,o,d,t);c.add(b)}l.add(c)}}},{key:"drawPoint",value:function(e,t,a,i,s,o){var n=this.w,r=i,l=new $c(this.ctx),c=new Zu(this.ctx),h=new gp(this.ctx),d=new fp(this.ctx),u=new Ku(this.ctx),p=d.getMarkerConfig({cssClass:"apexcharts-marker",seriesIndex:r,dataPointIndex:s,radius:"bubble"===n.config.chart.type||n.globals.comboCharts&&n.config.series[i]&&"bubble"===n.config.series[i].type?a:null}),m=h.fillPath({seriesNumber:i,dataPointIndex:s,color:p.pointFillColor,patternUnits:"objectBoundingBox",value:n.globals.series[i][o]}),g=u.drawMarker(e,t,p);if(n.config.series[r].data[s]&&n.config.series[r].data[s].fillColor&&(m=n.config.series[r].data[s].fillColor),g.attr({fill:m}),n.config.chart.dropShadow.enabled){var f=n.config.chart.dropShadow;c.dropShadow(g,f,i)}if(!this.initialAnim||n.globals.dataChanged||n.globals.resized)n.globals.animationEnded=!0;else{var b=n.config.chart.animations.speed;l.animateMarker(g,b,n.globals.easing,function(){window.setTimeout(function(){l.animationCompleted(g)},100)})}return g.attr({rel:s,j:s,index:i,"default-marker-size":p.pSize}),c.setSelectionFilter(g,i,s),d.addEvents(g),g.node.classList.add("apexcharts-marker"),g}},{key:"centerTextInBubble",value:function(e){var t=this.w;return{y:e+=parseInt(t.config.dataLabels.style.fontSize,10)/4}}}]),e}(),yp=function(){function e(t){Rc(this,e),this.ctx=t,this.w=t.w}return Mc(e,[{key:"dataLabelsCorrection",value:function(e,t,a,i,s,o,n){var r=this.w,l=!1,c=new Ku(this.ctx).getTextRects(a,n),h=c.width,d=c.height;t<0&&(t=0),t>r.globals.gridHeight+d&&(t=r.globals.gridHeight+d/2),void 0===r.globals.dataLabelsRects[i]&&(r.globals.dataLabelsRects[i]=[]),r.globals.dataLabelsRects[i].push({x:e,y:t,width:h,height:d});var u=r.globals.dataLabelsRects[i].length-2,p=void 0!==r.globals.lastDrawnDataLabelsIndexes[i]?r.globals.lastDrawnDataLabelsIndexes[i][r.globals.lastDrawnDataLabelsIndexes[i].length-1]:0;if(void 0!==r.globals.dataLabelsRects[i][u]){var m=r.globals.dataLabelsRects[i][p];(e>m.x+m.width||t>m.y+m.height||t+d<m.y||e+h<m.x)&&(l=!0)}return(0===s||o)&&(l=!0),{x:e,y:t,textRects:c,drawnextLabel:l}}},{key:"drawDataLabel",value:function(e){var t=this,a=e.type,i=e.pos,s=e.i,o=e.j,n=e.isRangeStart,r=e.strokeWidth,l=void 0===r?2:r,c=this.w,h=new Ku(this.ctx),d=c.config.dataLabels,u=0,p=0,m=o,g=null;if(-1!==c.globals.collapsedSeriesIndices.indexOf(s)||!d.enabled||!Array.isArray(i.x))return g;g=h.group({class:"apexcharts-data-labels"});for(var f=0;f<i.x.length;f++)if(u=i.x[f]+d.offsetX,p=i.y[f]+d.offsetY+l,!isNaN(u)){1===o&&0===f&&(m=0),1===o&&1===f&&(m=1);var b=c.globals.series[s][m];"rangeArea"===a&&(b=n?c.globals.seriesRangeStart[s][m]:c.globals.seriesRangeEnd[s][m]);var y="",w=function(e){return c.config.dataLabels.formatter(e,{ctx:t.ctx,seriesIndex:s,dataPointIndex:m,w:c})};"bubble"===c.config.chart.type?(y=w(b=c.globals.seriesZ[s][m]),p=i.y[f],p=new bp(this.ctx).centerTextInBubble(p,s,m).y):void 0!==b&&(y=w(b));var v=c.config.dataLabels.textAnchor;c.globals.isSlopeChart&&(v=0===m?"end":m===c.config.series[s].data.length-1?"start":"middle"),this.plotDataLabelsText({x:u,y:p,text:y,i:s,j:m,parent:g,offsetCorrection:!0,dataLabelsConfig:c.config.dataLabels,textAnchor:v})}return g}},{key:"plotDataLabelsText",value:function(e){var t=this.w,a=new Ku(this.ctx),i=e.x,s=e.y,o=e.i,n=e.j,r=e.text,l=e.textAnchor,c=e.fontSize,h=e.parent,d=e.dataLabelsConfig,u=e.color,p=e.alwaysDrawDataLabel,m=e.offsetCorrection,g=e.className,f=null;if(Array.isArray(t.config.dataLabels.enabledOnSeries)&&t.config.dataLabels.enabledOnSeries.indexOf(o)<0)return f;var b={x:i,y:s,drawnextLabel:!0,textRects:null};m&&(b=this.dataLabelsCorrection(i,s,r,o,n,p,parseInt(d.style.fontSize,10))),t.globals.zoomed||(i=b.x,s=b.y),b.textRects&&(i<-20-b.textRects.width||i>t.globals.gridWidth+b.textRects.width+30)&&(r="");var y=t.globals.dataLabels.style.colors[o];(("bar"===t.config.chart.type||"rangeBar"===t.config.chart.type)&&t.config.plotOptions.bar.distributed||t.config.dataLabels.distributed)&&(y=t.globals.dataLabels.style.colors[n]),"function"==typeof y&&(y=y({series:t.globals.series,seriesIndex:o,dataPointIndex:n,w:t})),u&&(y=u);var w=d.offsetX,v=d.offsetY;if("bar"!==t.config.chart.type&&"rangeBar"!==t.config.chart.type||(w=0,v=0),t.globals.isSlopeChart&&(0!==n&&(w=-2*d.offsetX+5),0!==n&&n!==t.config.series[o].data.length-1&&(w=0)),b.drawnextLabel){if((f=a.drawText({width:100,height:parseInt(d.style.fontSize,10),x:i+w,y:s+v,foreColor:y,textAnchor:l||d.textAnchor,text:r,fontSize:c||d.style.fontSize,fontFamily:d.style.fontFamily,fontWeight:d.style.fontWeight||"normal"})).attr({class:g||"apexcharts-datalabel",cx:i,cy:s}),d.dropShadow.enabled){var x=d.dropShadow;new Zu(this.ctx).dropShadow(f,x)}h.add(f),void 0===t.globals.lastDrawnDataLabelsIndexes[o]&&(t.globals.lastDrawnDataLabelsIndexes[o]=[]),t.globals.lastDrawnDataLabelsIndexes[o].push(n)}return f}},{key:"addBackgroundToDataLabel",value:function(e,t){var a=this.w,i=a.config.dataLabels.background,s=i.padding,o=i.padding/2,n=t.width,r=t.height,l=new Ku(this.ctx).drawRect(t.x-s,t.y-o/2,n+2*s,r+o,i.borderRadius,"transparent"!==a.config.chart.background&&a.config.chart.background?a.config.chart.background:"#fff",i.opacity,i.borderWidth,i.borderColor);return i.dropShadow.enabled&&new Zu(this.ctx).dropShadow(l,i.dropShadow),l}},{key:"dataLabelsBackground",value:function(){var e=this.w;if("bubble"!==e.config.chart.type)for(var t=e.globals.dom.baseEl.querySelectorAll(".apexcharts-datalabels text"),a=0;a<t.length;a++){var i=t[a],s=i.getBBox(),o=null;if(s.width&&s.height&&(o=this.addBackgroundToDataLabel(i,s)),o){i.parentNode.insertBefore(o.node,i);var n=e.config.dataLabels.background.backgroundColor||i.getAttribute("fill");!e.config.chart.animations.enabled||e.globals.resized||e.globals.dataChanged?o.attr({fill:n}):o.animate().attr({fill:n}),i.setAttribute("fill",e.config.dataLabels.background.foreColor)}}}},{key:"bringForward",value:function(){for(var e=this.w,t=e.globals.dom.baseEl.querySelectorAll(".apexcharts-datalabels"),a=e.globals.dom.baseEl.querySelector(".apexcharts-plot-series:last-child"),i=0;i<t.length;i++)a&&a.insertBefore(t[i],a.nextSibling)}}]),e}(),wp=function(){function e(t){Rc(this,e),this.ctx=t,this.w=t.w,this.legendInactiveClass="legend-mouseover-inactive"}return Mc(e,[{key:"getAllSeriesEls",value:function(){return this.w.globals.dom.baseEl.getElementsByClassName("apexcharts-series")}},{key:"getSeriesByName",value:function(e){return this.w.globals.dom.baseEl.querySelector(".apexcharts-inner .apexcharts-series[seriesName='".concat(Xc.escapeString(e),"']"))}},{key:"isSeriesHidden",value:function(e){var t=this.getSeriesByName(e),a=parseInt(t.getAttribute("data:realIndex"),10);return{isHidden:t.classList.contains("apexcharts-series-collapsed"),realIndex:a}}},{key:"addCollapsedClassToSeries",value:function(e,t){var a=this.w;function i(a){for(var i=0;i<a.length;i++)a[i].index===t&&e.node.classList.add("apexcharts-series-collapsed")}i(a.globals.collapsedSeries),i(a.globals.ancillaryCollapsedSeries)}},{key:"toggleSeries",value:function(e){var t=this.isSeriesHidden(e);return this.ctx.legend.legendHelpers.toggleDataSeries(t.realIndex,t.isHidden),t.isHidden}},{key:"showSeries",value:function(e){var t=this.isSeriesHidden(e);t.isHidden&&this.ctx.legend.legendHelpers.toggleDataSeries(t.realIndex,!0)}},{key:"hideSeries",value:function(e){var t=this.isSeriesHidden(e);t.isHidden||this.ctx.legend.legendHelpers.toggleDataSeries(t.realIndex,!1)}},{key:"resetSeries",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this.w,s=Xc.clone(i.globals.initialSeries);i.globals.previousPaths=[],a?(i.globals.collapsedSeries=[],i.globals.ancillaryCollapsedSeries=[],i.globals.collapsedSeriesIndices=[],i.globals.ancillaryCollapsedSeriesIndices=[]):s=this.emptyCollapsedSeries(s),i.config.series=s,e&&(t&&(i.globals.zoomed=!1,this.ctx.updateHelpers.revertDefaultAxisMinMax()),this.ctx.updateHelpers._updateSeries(s,i.config.chart.animations.dynamicAnimation.enabled))}},{key:"emptyCollapsedSeries",value:function(e){for(var t=this.w,a=0;a<e.length;a++)t.globals.collapsedSeriesIndices.indexOf(a)>-1&&(e[a].data=[]);return e}},{key:"highlightSeries",value:function(e){var t=this.w,a=this.getSeriesByName(e),i=parseInt(null==a?void 0:a.getAttribute("data:realIndex"),10),s=t.globals.dom.baseEl.querySelectorAll(".apexcharts-series, .apexcharts-datalabels, .apexcharts-yaxis"),o=null,n=null,r=null;if(t.globals.axisCharts||"radialBar"===t.config.chart.type)if(t.globals.axisCharts){o=t.globals.dom.baseEl.querySelector(".apexcharts-series[data\\:realIndex='".concat(i,"']")),n=t.globals.dom.baseEl.querySelector(".apexcharts-datalabels[data\\:realIndex='".concat(i,"']"));var l=t.globals.seriesYAxisReverseMap[i];r=t.globals.dom.baseEl.querySelector(".apexcharts-yaxis[rel='".concat(l,"']"))}else o=t.globals.dom.baseEl.querySelector(".apexcharts-series[rel='".concat(i+1,"']"));else o=t.globals.dom.baseEl.querySelector(".apexcharts-series[rel='".concat(i+1,"'] path"));for(var c=0;c<s.length;c++)s[c].classList.add(this.legendInactiveClass);if(o)t.globals.axisCharts||o.parentNode.classList.remove(this.legendInactiveClass),o.classList.remove(this.legendInactiveClass),null!==n&&n.classList.remove(this.legendInactiveClass),null!==r&&r.classList.remove(this.legendInactiveClass);else for(var h=0;h<s.length;h++)s[h].classList.remove(this.legendInactiveClass)}},{key:"toggleSeriesOnHover",value:function(e,t){var a=this.w;t||(t=e.target);var i=a.globals.dom.baseEl.querySelectorAll(".apexcharts-series, .apexcharts-datalabels, .apexcharts-yaxis");if("mousemove"===e.type){var s=parseInt(t.getAttribute("rel"),10)-1;this.highlightSeries(a.globals.seriesNames[s])}else if("mouseout"===e.type)for(var o=0;o<i.length;o++)i[o].classList.remove(this.legendInactiveClass)}},{key:"highlightRangeInSeries",value:function(e,t){var a=this,i=this.w,s=i.globals.dom.baseEl.getElementsByClassName("apexcharts-heatmap-rect"),o=function(e){for(var t=0;t<s.length;t++)s[t].classList[e](a.legendInactiveClass)};if("mousemove"===e.type){var n=parseInt(t.getAttribute("rel"),10)-1;o("add");var r=i.config.plotOptions.heatmap.colorScale.ranges;!function(e,t){for(var i=0;i<s.length;i++){var o=Number(s[i].getAttribute("val"));o>=e.from&&(o<e.to||e.to===t&&o===t)&&s[i].classList.remove(a.legendInactiveClass)}}(r[n],r.reduce(function(e,t){return Math.max(e,t.to)},0))}else"mouseout"===e.type&&o("remove")}},{key:"getActiveConfigSeriesIndex",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"asc",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=this.w,i=0;if(a.config.series.length>1)for(var s=a.config.series.map(function(e,i){return e.data&&e.data.length>0&&-1===a.globals.collapsedSeriesIndices.indexOf(i)&&(!a.globals.comboCharts||0===t.length||t.length&&t.indexOf(a.config.series[i].type)>-1)?i:-1}),o="asc"===e?0:s.length-1;"asc"===e?o<s.length:o>=0;"asc"===e?o++:o--)if(-1!==s[o]){i=s[o];break}return i}},{key:"getBarSeriesIndices",value:function(){return this.w.globals.comboCharts?this.w.config.series.map(function(e,t){return"bar"===e.type||"column"===e.type?t:-1}).filter(function(e){return-1!==e}):this.w.config.series.map(function(e,t){return t})}},{key:"getPreviousPaths",value:function(){var e=this.w;function t(t,a,i){for(var s=t[a].childNodes,o={type:i,paths:[],realIndex:t[a].getAttribute("data:realIndex")},n=0;n<s.length;n++)if(s[n].hasAttribute("pathTo")){var r=s[n].getAttribute("pathTo");o.paths.push({d:r})}e.globals.previousPaths.push(o)}e.globals.previousPaths=[],["line","area","bar","rangebar","rangeArea","candlestick","radar"].forEach(function(a){for(var i,s=(i=a,e.globals.dom.baseEl.querySelectorAll(".apexcharts-".concat(i,"-series .apexcharts-series"))),o=0;o<s.length;o++)t(s,o,a)});var a=e.globals.dom.baseEl.querySelectorAll(".apexcharts-".concat(e.config.chart.type," .apexcharts-series"));if(a.length>0)for(var i=function(t){for(var a=e.globals.dom.baseEl.querySelectorAll(".apexcharts-".concat(e.config.chart.type," .apexcharts-series[data\\:realIndex='").concat(t,"'] rect")),i=[],s=function(e){var t=function(t){return a[e].getAttribute(t)},s={x:parseFloat(t("x")),y:parseFloat(t("y")),width:parseFloat(t("width")),height:parseFloat(t("height"))};i.push({rect:s,color:a[e].getAttribute("color")})},o=0;o<a.length;o++)s(o);e.globals.previousPaths.push(i)},s=0;s<a.length;s++)i(s);e.globals.axisCharts||(e.globals.previousPaths=e.globals.series)}},{key:"clearPreviousPaths",value:function(){var e=this.w;e.globals.previousPaths=[],e.globals.allSeriesCollapsed=!1}},{key:"handleNoData",value:function(){var e=this.w,t=e.config.noData,a=new Ku(this.ctx),i=e.globals.svgWidth/2,s=e.globals.svgHeight/2,o="middle";if(e.globals.noData=!0,e.globals.animationEnded=!0,"left"===t.align?(i=10,o="start"):"right"===t.align&&(i=e.globals.svgWidth-10,o="end"),"top"===t.verticalAlign?s=50:"bottom"===t.verticalAlign&&(s=e.globals.svgHeight-50),i+=t.offsetX,s=s+parseInt(t.style.fontSize,10)+2+t.offsetY,void 0!==t.text&&""!==t.text){var n=a.drawText({x:i,y:s,text:t.text,textAnchor:o,fontSize:t.style.fontSize,fontFamily:t.style.fontFamily,foreColor:t.style.color,opacity:1,class:"apexcharts-text-nodata"});e.globals.dom.Paper.add(n)}}},{key:"setNullSeriesToZeroValues",value:function(e){for(var t=this.w,a=0;a<e.length;a++)if(0===e[a].length)for(var i=0;i<e[t.globals.maxValsInArrayIndex].length;i++)e[a].push(0);return e}},{key:"hasAllSeriesEqualX",value:function(){for(var e=!0,t=this.w,a=this.filteredSeriesX(),i=0;i<a.length-1;i++)if(a[i][0]!==a[i+1][0]){e=!1;break}return t.globals.allSeriesHasEqualX=e,e}},{key:"filteredSeriesX",value:function(){return this.w.globals.seriesX.map(function(e){return e.length>0?e:[]})}}]),e}(),vp=function(){function e(t){Rc(this,e),this.ctx=t,this.w=t.w,this.twoDSeries=[],this.threeDSeries=[],this.twoDSeriesX=[],this.seriesGoals=[],this.coreUtils=new Ju(this.ctx)}return Mc(e,[{key:"isMultiFormat",value:function(){return this.isFormatXY()||this.isFormat2DArray()}},{key:"isFormatXY",value:function(){var e=this.w.config.series.slice(),t=new wp(this.ctx);if(this.activeSeriesIndex=t.getActiveConfigSeriesIndex(),void 0!==e[this.activeSeriesIndex].data&&e[this.activeSeriesIndex].data.length>0&&null!==e[this.activeSeriesIndex].data[0]&&void 0!==e[this.activeSeriesIndex].data[0].x&&null!==e[this.activeSeriesIndex].data[0])return!0}},{key:"isFormat2DArray",value:function(){var e=this.w.config.series.slice(),t=new wp(this.ctx);if(this.activeSeriesIndex=t.getActiveConfigSeriesIndex(),void 0!==e[this.activeSeriesIndex].data&&e[this.activeSeriesIndex].data.length>0&&void 0!==e[this.activeSeriesIndex].data[0]&&null!==e[this.activeSeriesIndex].data[0]&&e[this.activeSeriesIndex].data[0].constructor===Array)return!0}},{key:"handleFormat2DArray",value:function(e,t){for(var a=this.w.config,i=this.w.globals,s="boxPlot"===a.chart.type||"boxPlot"===a.series[t].type,o=0;o<e[t].data.length;o++)if(void 0!==e[t].data[o][1]&&(Array.isArray(e[t].data[o][1])&&4===e[t].data[o][1].length&&!s?this.twoDSeries.push(Xc.parseNumber(e[t].data[o][1][3])):e[t].data[o].length>=5?this.twoDSeries.push(Xc.parseNumber(e[t].data[o][4])):this.twoDSeries.push(Xc.parseNumber(e[t].data[o][1])),i.dataFormatXNumeric=!0),"datetime"===a.xaxis.type){var n=new Date(e[t].data[o][0]);n=new Date(n).getTime(),this.twoDSeriesX.push(n)}else this.twoDSeriesX.push(e[t].data[o][0]);for(var r=0;r<e[t].data.length;r++)void 0!==e[t].data[r][2]&&(this.threeDSeries.push(e[t].data[r][2]),i.isDataXYZ=!0)}},{key:"handleFormatXY",value:function(e,t){var a=this.w.config,i=this.w.globals,s=new tp(this.ctx),o=t;i.collapsedSeriesIndices.indexOf(t)>-1&&(o=this.activeSeriesIndex);for(var n=0;n<e[t].data.length;n++)void 0!==e[t].data[n].y&&(Array.isArray(e[t].data[n].y)?this.twoDSeries.push(Xc.parseNumber(e[t].data[n].y[e[t].data[n].y.length-1])):this.twoDSeries.push(Xc.parseNumber(e[t].data[n].y))),void 0!==e[t].data[n].goals&&Array.isArray(e[t].data[n].goals)?(void 0===this.seriesGoals[t]&&(this.seriesGoals[t]=[]),this.seriesGoals[t].push(e[t].data[n].goals)):(void 0===this.seriesGoals[t]&&(this.seriesGoals[t]=[]),this.seriesGoals[t].push(null));for(var r=0;r<e[o].data.length;r++){var l="string"==typeof e[o].data[r].x,c=Array.isArray(e[o].data[r].x),h=!c&&!!s.isValidDate(e[o].data[r].x);if(l||h)if(l||a.xaxis.convertedCatToNumeric){var d=i.isBarHorizontal&&i.isRangeData;"datetime"!==a.xaxis.type||d?(this.fallbackToCategory=!0,this.twoDSeriesX.push(e[o].data[r].x),isNaN(e[o].data[r].x)||"category"===this.w.config.xaxis.type||"string"==typeof e[o].data[r].x||(i.isXNumeric=!0)):this.twoDSeriesX.push(s.parseDate(e[o].data[r].x))}else"datetime"===a.xaxis.type?this.twoDSeriesX.push(s.parseDate(e[o].data[r].x.toString())):(i.dataFormatXNumeric=!0,i.isXNumeric=!0,this.twoDSeriesX.push(parseFloat(e[o].data[r].x)));else c?(this.fallbackToCategory=!0,this.twoDSeriesX.push(e[o].data[r].x)):(i.isXNumeric=!0,i.dataFormatXNumeric=!0,this.twoDSeriesX.push(e[o].data[r].x))}if(e[t].data[0]&&void 0!==e[t].data[0].z){for(var u=0;u<e[t].data.length;u++)this.threeDSeries.push(e[t].data[u].z);i.isDataXYZ=!0}}},{key:"handleRangeData",value:function(e,t){var a=this.w.globals,i={};return this.isFormat2DArray()?i=this.handleRangeDataFormat("array",e,t):this.isFormatXY()&&(i=this.handleRangeDataFormat("xy",e,t)),a.seriesRangeStart[t]=void 0===i.start?[]:i.start,a.seriesRangeEnd[t]=void 0===i.end?[]:i.end,a.seriesRange[t]=i.rangeUniques,a.seriesRange.forEach(function(e,t){e&&e.forEach(function(e,t){e.y.forEach(function(t,a){for(var i=0;i<e.y.length;i++)if(a!==i){var s=t.y1,o=t.y2,n=e.y[i].y1;s<=e.y[i].y2&&n<=o&&(e.overlaps.indexOf(t.rangeName)<0&&e.overlaps.push(t.rangeName),e.overlaps.indexOf(e.y[i].rangeName)<0&&e.overlaps.push(e.y[i].rangeName))}})})}),i}},{key:"handleCandleStickBoxData",value:function(e,t){var a=this.w.globals,i={};return this.isFormat2DArray()?i=this.handleCandleStickBoxDataFormat("array",e,t):this.isFormatXY()&&(i=this.handleCandleStickBoxDataFormat("xy",e,t)),a.seriesCandleO[t]=i.o,a.seriesCandleH[t]=i.h,a.seriesCandleM[t]=i.m,a.seriesCandleL[t]=i.l,a.seriesCandleC[t]=i.c,i}},{key:"handleRangeDataFormat",value:function(e,t,a){var i=[],s=[],o=t[a].data.filter(function(e,t,a){return t===a.findIndex(function(t){return t.x===e.x})}).map(function(e,t){return{x:e.x,overlaps:[],y:[]}});if("array"===e)for(var n=0;n<t[a].data.length;n++)Array.isArray(t[a].data[n])?(i.push(t[a].data[n][1][0]),s.push(t[a].data[n][1][1])):(i.push(t[a].data[n]),s.push(t[a].data[n]));else if("xy"===e)for(var r=function(e){var n=Array.isArray(t[a].data[e].y),r=Xc.randomId(),l=t[a].data[e].x,c={y1:n?t[a].data[e].y[0]:t[a].data[e].y,y2:n?t[a].data[e].y[1]:t[a].data[e].y,rangeName:r};t[a].data[e].rangeName=r;var h=o.findIndex(function(e){return e.x===l});o[h].y.push(c),i.push(c.y1),s.push(c.y2)},l=0;l<t[a].data.length;l++)r(l);return{start:i,end:s,rangeUniques:o}}},{key:"handleCandleStickBoxDataFormat",value:function(e,t,a){var i=this.w,s="boxPlot"===i.config.chart.type||"boxPlot"===i.config.series[a].type,o=[],n=[],r=[],l=[],c=[];if("array"===e)if(s&&6===t[a].data[0].length||!s&&5===t[a].data[0].length)for(var h=0;h<t[a].data.length;h++)o.push(t[a].data[h][1]),n.push(t[a].data[h][2]),s?(r.push(t[a].data[h][3]),l.push(t[a].data[h][4]),c.push(t[a].data[h][5])):(l.push(t[a].data[h][3]),c.push(t[a].data[h][4]));else for(var d=0;d<t[a].data.length;d++)Array.isArray(t[a].data[d][1])&&(o.push(t[a].data[d][1][0]),n.push(t[a].data[d][1][1]),s?(r.push(t[a].data[d][1][2]),l.push(t[a].data[d][1][3]),c.push(t[a].data[d][1][4])):(l.push(t[a].data[d][1][2]),c.push(t[a].data[d][1][3])));else if("xy"===e)for(var u=0;u<t[a].data.length;u++)Array.isArray(t[a].data[u].y)&&(o.push(t[a].data[u].y[0]),n.push(t[a].data[u].y[1]),s?(r.push(t[a].data[u].y[2]),l.push(t[a].data[u].y[3]),c.push(t[a].data[u].y[4])):(l.push(t[a].data[u].y[2]),c.push(t[a].data[u].y[3])));return{o:o,h:n,m:r,l:l,c:c}}},{key:"parseDataAxisCharts",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.ctx,i=this.w.config,s=this.w.globals,o=new tp(a),n=i.labels.length>0?i.labels.slice():i.xaxis.categories.slice();s.isRangeBar="rangeBar"===i.chart.type&&s.isBarHorizontal,s.hasXaxisGroups="category"===i.xaxis.type&&i.xaxis.group.groups.length>0,s.hasXaxisGroups&&(s.groups=i.xaxis.group.groups),e.forEach(function(e,t){void 0!==e.name?s.seriesNames.push(e.name):s.seriesNames.push("series-"+parseInt(t+1,10))}),this.coreUtils.setSeriesYAxisMappings();var r=[],l=Vc(new Set(i.series.map(function(e){return e.group})));i.series.forEach(function(e,t){var a=l.indexOf(e.group);r[a]||(r[a]=[]),r[a].push(s.seriesNames[t])}),s.seriesGroups=r;for(var c=function(){for(var e=0;e<n.length;e++)if("string"==typeof n[e]){if(!o.isValidDate(n[e]))throw new Error("You have provided invalid Date format. Please provide a valid JavaScript Date");t.twoDSeriesX.push(o.parseDate(n[e]))}else t.twoDSeriesX.push(n[e])},h=0;h<e.length;h++){if(this.twoDSeries=[],this.twoDSeriesX=[],this.threeDSeries=[],void 0===e[h].data)return void console.error("It is a possibility that you may have not included 'data' property in series.");if("rangeBar"!==i.chart.type&&"rangeArea"!==i.chart.type&&"rangeBar"!==e[h].type&&"rangeArea"!==e[h].type||(s.isRangeData=!0,this.handleRangeData(e,h)),this.isMultiFormat())this.isFormat2DArray()?this.handleFormat2DArray(e,h):this.isFormatXY()&&this.handleFormatXY(e,h),"candlestick"!==i.chart.type&&"candlestick"!==e[h].type&&"boxPlot"!==i.chart.type&&"boxPlot"!==e[h].type||this.handleCandleStickBoxData(e,h),s.series.push(this.twoDSeries),s.labels.push(this.twoDSeriesX),s.seriesX.push(this.twoDSeriesX),s.seriesGoals=this.seriesGoals,h!==this.activeSeriesIndex||this.fallbackToCategory||(s.isXNumeric=!0);else{"datetime"===i.xaxis.type?(s.isXNumeric=!0,c(),s.seriesX.push(this.twoDSeriesX)):"numeric"===i.xaxis.type&&(s.isXNumeric=!0,n.length>0&&(this.twoDSeriesX=n,s.seriesX.push(this.twoDSeriesX))),s.labels.push(this.twoDSeriesX);var d=e[h].data.map(function(e){return Xc.parseNumber(e)});s.series.push(d)}s.seriesZ.push(this.threeDSeries),void 0!==e[h].color?s.seriesColors.push(e[h].color):s.seriesColors.push(void 0)}return this.w}},{key:"parseDataNonAxisCharts",value:function(e){var t=this.w.globals,a=this.w.config;t.series=e.slice(),t.seriesNames=a.labels.slice();for(var i=0;i<t.series.length;i++)void 0===t.seriesNames[i]&&t.seriesNames.push("series-"+(i+1));return this.w}},{key:"handleExternalLabelsData",value:function(e){var t=this.w.config,a=this.w.globals;t.xaxis.categories.length>0?a.labels=t.xaxis.categories:t.labels.length>0?a.labels=t.labels.slice():this.fallbackToCategory?(a.labels=a.labels[0],a.seriesRange.length&&(a.seriesRange.map(function(e){e.forEach(function(e){a.labels.indexOf(e.x)<0&&e.x&&a.labels.push(e.x)})}),a.labels=Array.from(new Set(a.labels.map(JSON.stringify)),JSON.parse)),t.xaxis.convertedCatToNumeric&&(new dp(t).convertCatToNumericXaxis(t,this.ctx,a.seriesX[0]),this._generateExternalLabels(e))):this._generateExternalLabels(e)}},{key:"_generateExternalLabels",value:function(e){var t=this.w.globals,a=this.w.config,i=[];if(t.axisCharts){if(t.series.length>0)if(this.isFormatXY())for(var s=a.series.map(function(e,t){return e.data.filter(function(e,t,a){return a.findIndex(function(t){return t.x===e.x})===t})}),o=s.reduce(function(e,t,a,i){return i[e].length>t.length?e:a},0),n=0;n<s[o].length;n++)i.push(n+1);else for(var r=0;r<t.series[t.maxValsInArrayIndex].length;r++)i.push(r+1);t.seriesX=[];for(var l=0;l<e.length;l++)t.seriesX.push(i);this.w.globals.isBarHorizontal||(t.isXNumeric=!0)}if(0===i.length){i=t.axisCharts?[]:t.series.map(function(e,t){return t+1});for(var c=0;c<e.length;c++)t.seriesX.push(i)}t.labels=i,a.xaxis.convertedCatToNumeric&&(t.categoryLabels=i.map(function(e){return a.xaxis.labels.formatter(e)})),t.noLabelsProvided=!0}},{key:"parseData",value:function(e){var t=this.w,a=t.config,i=t.globals;if(this.excludeCollapsedSeriesInYAxis(),this.fallbackToCategory=!1,this.ctx.core.resetGlobals(),this.ctx.core.isMultipleY(),i.axisCharts?(this.parseDataAxisCharts(e),this.coreUtils.getLargestSeries()):this.parseDataNonAxisCharts(e),a.chart.stacked){var s=new wp(this.ctx);i.series=s.setNullSeriesToZeroValues(i.series)}this.coreUtils.getSeriesTotals(),i.axisCharts&&(i.stackedSeriesTotals=this.coreUtils.getStackedSeriesTotals(),i.stackedSeriesTotalsByGroups=this.coreUtils.getStackedSeriesTotalsByGroups()),this.coreUtils.getPercentSeries(),i.dataFormatXNumeric||i.isXNumeric&&("numeric"!==a.xaxis.type||0!==a.labels.length||0!==a.xaxis.categories.length)||this.handleExternalLabelsData(e);for(var o=this.coreUtils.getCategoryLabels(i.labels),n=0;n<o.length;n++)if(Array.isArray(o[n])){i.isMultiLineX=!0;break}}},{key:"excludeCollapsedSeriesInYAxis",value:function(){var e=this.w,t=[];e.globals.seriesYAxisMap.forEach(function(a,i){var s=0;a.forEach(function(t){-1!==e.globals.collapsedSeriesIndices.indexOf(t)&&s++}),s>0&&s==a.length&&t.push(i)}),e.globals.ignoreYAxisIndexes=t.map(function(e){return e})}}]),e}(),xp=function(){function e(t){Rc(this,e),this.ctx=t,this.w=t.w}return Mc(e,[{key:"svgStringToNode",value:function(e){return(new DOMParser).parseFromString(e,"image/svg+xml").documentElement}},{key:"scaleSvgNode",value:function(e,t){var a=parseFloat(e.getAttributeNS(null,"width")),i=parseFloat(e.getAttributeNS(null,"height"));e.setAttributeNS(null,"width",a*t),e.setAttributeNS(null,"height",i*t),e.setAttributeNS(null,"viewBox","0 0 "+a+" "+i)}},{key:"getSvgString",value:function(e){var t=this;return new Promise(function(a){var i=t.w,s=e||i.config.chart.toolbar.export.scale||i.config.chart.toolbar.export.width/i.globals.svgWidth;s||(s=1);var o=i.globals.svgWidth*s,n=i.globals.svgHeight*s,r=i.globals.dom.elWrap.cloneNode(!0);r.style.width=o+"px",r.style.height=n+"px";var l=(new XMLSerializer).serializeToString(r),c='\n        <svg xmlns="http://www.w3.org/2000/svg"\n          version="1.1"\n          xmlns:xlink="http://www.w3.org/1999/xlink"\n          class="apexcharts-svg"\n          xmlns:data="ApexChartsNS"\n          transform="translate(0, 0)"\n          width="'.concat(i.globals.svgWidth,'px" height="').concat(i.globals.svgHeight,'px">\n          <foreignObject width="100%" height="100%">\n            <div xmlns="http://www.w3.org/1999/xhtml" style="width:').concat(o,"px; height:").concat(n,'px;">\n            <style type="text/css">\n              .apexcharts-tooltip, .apexcharts-toolbar, .apexcharts-xaxistooltip, .apexcharts-yaxistooltip, .apexcharts-xcrosshairs, .apexcharts-ycrosshairs, .apexcharts-zoom-rect, .apexcharts-selection-rect {\n                display: none;\n              }\n            </style>\n              ').concat(l,"\n            </div>\n          </foreignObject>\n        </svg>\n      "),h=t.svgStringToNode(c);1!==s&&t.scaleSvgNode(h,s),t.convertImagesToBase64(h).then(function(){c=(new XMLSerializer).serializeToString(h),a(c.replace(/&nbsp;/g,"&#160;"))})})}},{key:"convertImagesToBase64",value:function(e){var t=this,a=e.getElementsByTagName("image"),i=Array.from(a).map(function(e){var a=e.getAttributeNS("http://www.w3.org/1999/xlink","href");return a&&!a.startsWith("data:")?t.getBase64FromUrl(a).then(function(t){e.setAttributeNS("http://www.w3.org/1999/xlink","href",t)}).catch(function(e){console.error("Error converting image to base64:",e)}):Promise.resolve()});return Promise.all(i)}},{key:"getBase64FromUrl",value:function(e){return new Promise(function(t,a){var i=new Image;i.crossOrigin="Anonymous",i.onload=function(){var e=document.createElement("canvas");e.width=i.width,e.height=i.height,e.getContext("2d").drawImage(i,0,0),t(e.toDataURL())},i.onerror=a,i.src=e})}},{key:"svgUrl",value:function(){var e=this;return new Promise(function(t){e.getSvgString().then(function(e){var a=new Blob([e],{type:"image/svg+xml;charset=utf-8"});t(URL.createObjectURL(a))})})}},{key:"dataURI",value:function(e){var t=this;return new Promise(function(a){var i=t.w,s=e?e.scale||e.width/i.globals.svgWidth:1,o=document.createElement("canvas");o.width=i.globals.svgWidth*s,o.height=parseInt(i.globals.dom.elWrap.style.height,10)*s;var n="transparent"!==i.config.chart.background&&i.config.chart.background?i.config.chart.background:"#fff",r=o.getContext("2d");r.fillStyle=n,r.fillRect(0,0,o.width*s,o.height*s),t.getSvgString(s).then(function(e){var t="data:image/svg+xml,"+encodeURIComponent(e),i=new Image;i.crossOrigin="anonymous",i.onload=function(){if(r.drawImage(i,0,0),o.msToBlob){var e=o.msToBlob();a({blob:e})}else{var t=o.toDataURL("image/png");a({imgURI:t})}},i.src=t})})}},{key:"exportToSVG",value:function(){var e=this;this.svgUrl().then(function(t){e.triggerDownload(t,e.w.config.chart.toolbar.export.svg.filename,".svg")})}},{key:"exportToPng",value:function(){var e=this,t=this.w.config.chart.toolbar.export.scale,a=this.w.config.chart.toolbar.export.width,i=t?{scale:t}:a?{width:a}:void 0;this.dataURI(i).then(function(t){var a=t.imgURI,i=t.blob;i?navigator.msSaveOrOpenBlob(i,e.w.globals.chartID+".png"):e.triggerDownload(a,e.w.config.chart.toolbar.export.png.filename,".png")})}},{key:"exportToCSV",value:function(e){var t=this,a=e.series,i=e.fileName,s=e.columnDelimiter,o=void 0===s?",":s,n=e.lineDelimiter,r=void 0===n?"\n":n,l=this.w;a||(a=l.config.series);var c,h,d=[],u=[],p="",m=l.globals.series.map(function(e,t){return-1===l.globals.collapsedSeriesIndices.indexOf(t)?e:[]}),g=function(e){return"function"==typeof l.config.chart.toolbar.export.csv.categoryFormatter?l.config.chart.toolbar.export.csv.categoryFormatter(e):"datetime"===l.config.xaxis.type&&String(e).length>=10?new Date(e).toDateString():Xc.isNumber(e)?e:e.split(o).join("")},f=function(e){return"function"==typeof l.config.chart.toolbar.export.csv.valueFormatter?l.config.chart.toolbar.export.csv.valueFormatter(e):e},b=Math.max.apply(Math,Vc(a.map(function(e){return e.data?e.data.length:0}))),y=new vp(this.ctx),w=new ip(this.ctx),v=function(e){var a="";if(l.globals.axisCharts){if("category"===l.config.xaxis.type||l.config.xaxis.convertedCatToNumeric)if(l.globals.isBarHorizontal){var i=l.globals.yLabelFormatters[0],s=new wp(t.ctx).getActiveConfigSeriesIndex();a=i(l.globals.labels[e],{seriesIndex:s,dataPointIndex:e,w:l})}else a=w.getLabel(l.globals.labels,l.globals.timescaleLabels,0,e).text;"datetime"===l.config.xaxis.type&&(l.config.xaxis.categories.length?a=l.config.xaxis.categories[e]:l.config.labels.length&&(a=l.config.labels[e]))}else a=l.config.labels[e];return null===a?"nullvalue":(Array.isArray(a)&&(a=a.join(" ")),Xc.isNumber(a)?a:a.split(o).join(""))};d.push(l.config.chart.toolbar.export.csv.headerCategory),"boxPlot"===l.config.chart.type?(d.push("minimum"),d.push("q1"),d.push("median"),d.push("q3"),d.push("maximum")):"candlestick"===l.config.chart.type?(d.push("open"),d.push("high"),d.push("low"),d.push("close")):"rangeBar"===l.config.chart.type?(d.push("minimum"),d.push("maximum")):a.map(function(e,t){var a=(e.name?e.name:"series-".concat(t))+"";l.globals.axisCharts&&d.push(a.split(o).join("")?a.split(o).join(""):"series-".concat(t))}),l.globals.axisCharts||(d.push(l.config.chart.toolbar.export.csv.headerValue),u.push(d.join(o))),l.globals.allSeriesHasEqualX||!l.globals.axisCharts||l.config.xaxis.categories.length||l.config.labels.length?a.map(function(e,t){l.globals.axisCharts?function(e,t){if(d.length&&0===t&&u.push(d.join(o)),e.data){e.data=e.data.length&&e.data||Vc(Array(b)).map(function(){return""});for(var i=0;i<e.data.length;i++){d=[];var s=v(i);if("nullvalue"!==s){if(s||(y.isFormatXY()?s=a[t].data[i].x:y.isFormat2DArray()&&(s=a[t].data[i]?a[t].data[i][0]:"")),0===t){d.push(g(s));for(var n=0;n<l.globals.series.length;n++){var r,c=y.isFormatXY()?null===(r=a[n].data[i])||void 0===r?void 0:r.y:m[n][i];d.push(f(c))}}("candlestick"===l.config.chart.type||e.type&&"candlestick"===e.type)&&(d.pop(),d.push(l.globals.seriesCandleO[t][i]),d.push(l.globals.seriesCandleH[t][i]),d.push(l.globals.seriesCandleL[t][i]),d.push(l.globals.seriesCandleC[t][i])),("boxPlot"===l.config.chart.type||e.type&&"boxPlot"===e.type)&&(d.pop(),d.push(l.globals.seriesCandleO[t][i]),d.push(l.globals.seriesCandleH[t][i]),d.push(l.globals.seriesCandleM[t][i]),d.push(l.globals.seriesCandleL[t][i]),d.push(l.globals.seriesCandleC[t][i])),"rangeBar"===l.config.chart.type&&(d.pop(),d.push(l.globals.seriesRangeStart[t][i]),d.push(l.globals.seriesRangeEnd[t][i])),d.length&&u.push(d.join(o))}}}}(e,t):((d=[]).push(g(l.globals.labels[t])),d.push(f(m[t])),u.push(d.join(o)))}):(c=new Set,h={},a.forEach(function(e,t){null==e||e.data.forEach(function(e){var i,s;if(y.isFormatXY())i=e.x,s=e.y;else{if(!y.isFormat2DArray())return;i=e[0],s=e[1]}h[i]||(h[i]=Array(a.length).fill("")),h[i][t]=f(s),c.add(i)})}),d.length&&u.push(d.join(o)),Array.from(c).sort().forEach(function(e){u.push([g(e),h[e].join(o)])})),p+=u.join(r),this.triggerDownload("data:text/csv; charset=utf-8,"+encodeURIComponent("\ufeff"+p),i||l.config.chart.toolbar.export.csv.filename,".csv")}},{key:"triggerDownload",value:function(e,t,a){var i=document.createElement("a");i.href=e,i.download=(t||this.w.globals.chartID)+a,document.body.appendChild(i),i.click(),document.body.removeChild(i)}}]),e}(),Sp=function(){function e(t,a){Rc(this,e),this.ctx=t,this.elgrid=a,this.w=t.w;var i=this.w;this.axesUtils=new ip(t),this.xaxisLabels=i.globals.labels.slice(),i.globals.timescaleLabels.length>0&&!i.globals.isBarHorizontal&&(this.xaxisLabels=i.globals.timescaleLabels.slice()),i.config.xaxis.overwriteCategories&&(this.xaxisLabels=i.config.xaxis.overwriteCategories),this.drawnLabels=[],this.drawnLabelsRects=[],"top"===i.config.xaxis.position?this.offY=0:this.offY=i.globals.gridHeight,this.offY=this.offY+i.config.xaxis.axisBorder.offsetY,this.isCategoryBarHorizontal="bar"===i.config.chart.type&&i.config.plotOptions.bar.horizontal,this.xaxisFontSize=i.config.xaxis.labels.style.fontSize,this.xaxisFontFamily=i.config.xaxis.labels.style.fontFamily,this.xaxisForeColors=i.config.xaxis.labels.style.colors,this.xaxisBorderWidth=i.config.xaxis.axisBorder.width,this.isCategoryBarHorizontal&&(this.xaxisBorderWidth=i.config.yaxis[0].axisBorder.width.toString()),this.xaxisBorderWidth.indexOf("%")>-1?this.xaxisBorderWidth=i.globals.gridWidth*parseInt(this.xaxisBorderWidth,10)/100:this.xaxisBorderWidth=parseInt(this.xaxisBorderWidth,10),this.xaxisBorderHeight=i.config.xaxis.axisBorder.height,this.yaxis=i.config.yaxis[0]}return Mc(e,[{key:"drawXaxis",value:function(){var e=this.w,t=new Ku(this.ctx),a=t.group({class:"apexcharts-xaxis",transform:"translate(".concat(e.config.xaxis.offsetX,", ").concat(e.config.xaxis.offsetY,")")}),i=t.group({class:"apexcharts-xaxis-texts-g",transform:"translate(".concat(e.globals.translateXAxisX,", ").concat(e.globals.translateXAxisY,")")});a.add(i);for(var s=[],o=0;o<this.xaxisLabels.length;o++)s.push(this.xaxisLabels[o]);if(this.drawXAxisLabelAndGroup(!0,t,i,s,e.globals.isXNumeric,function(e,t){return t}),e.globals.hasXaxisGroups){var n=e.globals.groups;s=[];for(var r=0;r<n.length;r++)s.push(n[r].title);var l={};e.config.xaxis.group.style&&(l.xaxisFontSize=e.config.xaxis.group.style.fontSize,l.xaxisFontFamily=e.config.xaxis.group.style.fontFamily,l.xaxisForeColors=e.config.xaxis.group.style.colors,l.fontWeight=e.config.xaxis.group.style.fontWeight,l.cssClass=e.config.xaxis.group.style.cssClass),this.drawXAxisLabelAndGroup(!1,t,i,s,!1,function(e,t){return n[e].cols*t},l)}if(void 0!==e.config.xaxis.title.text){var c=t.group({class:"apexcharts-xaxis-title"}),h=t.drawText({x:e.globals.gridWidth/2+e.config.xaxis.title.offsetX,y:this.offY+parseFloat(this.xaxisFontSize)+("bottom"===e.config.xaxis.position?e.globals.xAxisLabelsHeight:-e.globals.xAxisLabelsHeight-10)+e.config.xaxis.title.offsetY,text:e.config.xaxis.title.text,textAnchor:"middle",fontSize:e.config.xaxis.title.style.fontSize,fontFamily:e.config.xaxis.title.style.fontFamily,fontWeight:e.config.xaxis.title.style.fontWeight,foreColor:e.config.xaxis.title.style.color,cssClass:"apexcharts-xaxis-title-text "+e.config.xaxis.title.style.cssClass});c.add(h),a.add(c)}if(e.config.xaxis.axisBorder.show){var d=e.globals.barPadForNumericAxis,u=t.drawLine(e.globals.padHorizontal+e.config.xaxis.axisBorder.offsetX-d,this.offY,this.xaxisBorderWidth+d,this.offY,e.config.xaxis.axisBorder.color,0,this.xaxisBorderHeight);this.elgrid&&this.elgrid.elGridBorders&&e.config.grid.show?this.elgrid.elGridBorders.add(u):a.add(u)}return a}},{key:"drawXAxisLabelAndGroup",value:function(e,t,a,i,s,o){var n,r=this,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},c=[],h=[],d=this.w,u=l.xaxisFontSize||this.xaxisFontSize,p=l.xaxisFontFamily||this.xaxisFontFamily,m=l.xaxisForeColors||this.xaxisForeColors,g=l.fontWeight||d.config.xaxis.labels.style.fontWeight,f=l.cssClass||d.config.xaxis.labels.style.cssClass,b=d.globals.padHorizontal,y=i.length,w="category"===d.config.xaxis.type?d.globals.dataPoints:y;if(0===w&&y>w&&(w=y),s){var v=Math.max(Number(d.config.xaxis.tickAmount)||1,w>1?w-1:w);n=d.globals.gridWidth/Math.min(v,y-1),b=b+o(0,n)/2+d.config.xaxis.labels.offsetX}else n=d.globals.gridWidth/w,b=b+o(0,n)+d.config.xaxis.labels.offsetX;for(var x=function(s){var l=b-o(s,n)/2+d.config.xaxis.labels.offsetX;0===s&&1===y&&n/2===b&&1===w&&(l=d.globals.gridWidth/2);var v=r.axesUtils.getLabel(i,d.globals.timescaleLabels,l,s,c,u,e),x=28;if(d.globals.rotateXLabels&&e&&(x=22),d.config.xaxis.title.text&&"top"===d.config.xaxis.position&&(x+=parseFloat(d.config.xaxis.title.style.fontSize)+2),e||(x=x+parseFloat(u)+(d.globals.xAxisLabelsHeight-d.globals.xAxisGroupLabelsHeight)+(d.globals.rotateXLabels?10:0)),v=void 0!==d.config.xaxis.tickAmount&&"dataPoints"!==d.config.xaxis.tickAmount&&"datetime"!==d.config.xaxis.type?r.axesUtils.checkLabelBasedOnTickamount(s,v,y):r.axesUtils.checkForOverflowingLabels(s,v,y,c,h),d.config.xaxis.labels.show){var S=t.drawText({x:v.x,y:r.offY+d.config.xaxis.labels.offsetY+x-("top"===d.config.xaxis.position?d.globals.xAxisHeight+d.config.xaxis.axisTicks.height-2:0),text:v.text,textAnchor:"middle",fontWeight:v.isBold?600:g,fontSize:u,fontFamily:p,foreColor:Array.isArray(m)?e&&d.config.xaxis.convertedCatToNumeric?m[d.globals.minX+s-1]:m[s]:m,isPlainText:!1,cssClass:(e?"apexcharts-xaxis-label ":"apexcharts-xaxis-group-label ")+f});if(a.add(S),S.on("click",function(e){if("function"==typeof d.config.chart.events.xAxisLabelClick){var t=Object.assign({},d,{labelIndex:s});d.config.chart.events.xAxisLabelClick(e,r.ctx,t)}}),e){var _=document.createElementNS(d.globals.SVGNS,"title");_.textContent=Array.isArray(v.text)?v.text.join(" "):v.text,S.node.appendChild(_),""!==v.text&&(c.push(v.text),h.push(v))}}s<y-1&&(b+=o(s+1,n))},S=0;S<=y-1;S++)x(S)}},{key:"drawXaxisInversed",value:function(e){var t,a,i=this,s=this.w,o=new Ku(this.ctx),n=s.config.yaxis[0].opposite?s.globals.translateYAxisX[e]:0,r=o.group({class:"apexcharts-yaxis apexcharts-xaxis-inversed",rel:e}),l=o.group({class:"apexcharts-yaxis-texts-g apexcharts-xaxis-inversed-texts-g",transform:"translate("+n+", 0)"});r.add(l);var c=[];if(s.config.yaxis[e].show)for(var h=0;h<this.xaxisLabels.length;h++)c.push(this.xaxisLabels[h]);t=s.globals.gridHeight/c.length,a=-t/2.2;var d=s.globals.yLabelFormatters[0],u=s.config.yaxis[0].labels;if(u.show)for(var p=function(n){var r=void 0===c[n]?"":c[n];r=d(r,{seriesIndex:e,dataPointIndex:n,w:s});var h=i.axesUtils.getYAxisForeColor(u.style.colors,e),p=0;Array.isArray(r)&&(p=r.length/2*parseInt(u.style.fontSize,10));var m=u.offsetX-15,g="end";i.yaxis.opposite&&(g="start"),"left"===s.config.yaxis[0].labels.align?(m=u.offsetX,g="start"):"center"===s.config.yaxis[0].labels.align?(m=u.offsetX,g="middle"):"right"===s.config.yaxis[0].labels.align&&(g="end");var f=o.drawText({x:m,y:a+t+u.offsetY-p,text:r,textAnchor:g,foreColor:Array.isArray(h)?h[n]:h,fontSize:u.style.fontSize,fontFamily:u.style.fontFamily,fontWeight:u.style.fontWeight,isPlainText:!1,cssClass:"apexcharts-yaxis-label "+u.style.cssClass,maxWidth:u.maxWidth});l.add(f),f.on("click",function(e){if("function"==typeof s.config.chart.events.xAxisLabelClick){var t=Object.assign({},s,{labelIndex:n});s.config.chart.events.xAxisLabelClick(e,i.ctx,t)}});var b=document.createElementNS(s.globals.SVGNS,"title");if(b.textContent=Array.isArray(r)?r.join(" "):r,f.node.appendChild(b),0!==s.config.yaxis[e].labels.rotate){var y=o.rotateAroundCenter(f.node);f.node.setAttribute("transform","rotate(".concat(s.config.yaxis[e].labels.rotate," 0 ").concat(y.y,")"))}a+=t},m=0;m<=c.length-1;m++)p(m);if(void 0!==s.config.yaxis[0].title.text){var g=o.group({class:"apexcharts-yaxis-title apexcharts-xaxis-title-inversed",transform:"translate("+n+", 0)"}),f=o.drawText({x:s.config.yaxis[0].title.offsetX,y:s.globals.gridHeight/2+s.config.yaxis[0].title.offsetY,text:s.config.yaxis[0].title.text,textAnchor:"middle",foreColor:s.config.yaxis[0].title.style.color,fontSize:s.config.yaxis[0].title.style.fontSize,fontWeight:s.config.yaxis[0].title.style.fontWeight,fontFamily:s.config.yaxis[0].title.style.fontFamily,cssClass:"apexcharts-yaxis-title-text "+s.config.yaxis[0].title.style.cssClass});g.add(f),r.add(g)}var b=0;this.isCategoryBarHorizontal&&s.config.yaxis[0].opposite&&(b=s.globals.gridWidth);var y=s.config.xaxis.axisBorder;if(y.show){var w=o.drawLine(s.globals.padHorizontal+y.offsetX+b,1+y.offsetY,s.globals.padHorizontal+y.offsetX+b,s.globals.gridHeight+y.offsetY,y.color,0);this.elgrid&&this.elgrid.elGridBorders&&s.config.grid.show?this.elgrid.elGridBorders.add(w):r.add(w)}return s.config.yaxis[0].axisTicks.show&&this.axesUtils.drawYAxisTicks(b,c.length,s.config.yaxis[0].axisBorder,s.config.yaxis[0].axisTicks,0,t,r),r}},{key:"drawXaxisTicks",value:function(e,t,a){var i=this.w,s=e;if(!(e<0||e-2>i.globals.gridWidth)){var o=this.offY+i.config.xaxis.axisTicks.offsetY;if(t=t+o+i.config.xaxis.axisTicks.height,"top"===i.config.xaxis.position&&(t=o-i.config.xaxis.axisTicks.height),i.config.xaxis.axisTicks.show){var n=new Ku(this.ctx).drawLine(e+i.config.xaxis.axisTicks.offsetX,o+i.config.xaxis.offsetY,s+i.config.xaxis.axisTicks.offsetX,t+i.config.xaxis.offsetY,i.config.xaxis.axisTicks.color);a.add(n),n.node.classList.add("apexcharts-xaxis-tick")}}}},{key:"getXAxisTicksPositions",value:function(){var e=this.w,t=[],a=this.xaxisLabels.length,i=e.globals.padHorizontal;if(e.globals.timescaleLabels.length>0)for(var s=0;s<a;s++)i=this.xaxisLabels[s].position,t.push(i);else for(var o=a,n=0;n<o;n++){var r=o;e.globals.isXNumeric&&"bar"!==e.config.chart.type&&(r-=1),i+=e.globals.gridWidth/r,t.push(i)}return t}},{key:"xAxisLabelCorrections",value:function(){var e=this.w,t=new Ku(this.ctx),a=e.globals.dom.baseEl.querySelector(".apexcharts-xaxis-texts-g"),i=e.globals.dom.baseEl.querySelectorAll(".apexcharts-xaxis-texts-g text:not(.apexcharts-xaxis-group-label)"),s=e.globals.dom.baseEl.querySelectorAll(".apexcharts-yaxis-inversed text"),o=e.globals.dom.baseEl.querySelectorAll(".apexcharts-xaxis-inversed-texts-g text tspan");if(e.globals.rotateXLabels||e.config.xaxis.labels.rotateAlways)for(var n=0;n<i.length;n++){var r=t.rotateAroundCenter(i[n]);r.y=r.y-1,r.x=r.x+1,i[n].setAttribute("transform","rotate(".concat(e.config.xaxis.labels.rotate," ").concat(r.x," ").concat(r.y,")")),i[n].setAttribute("text-anchor","end"),a.setAttribute("transform","translate(0, ".concat(-10,")"));var l=i[n].childNodes;e.config.xaxis.labels.trim&&Array.prototype.forEach.call(l,function(a){t.placeTextWithEllipsis(a,a.textContent,e.globals.xAxisLabelsHeight-("bottom"===e.config.legend.position?20:10))})}else!function(){for(var a=e.globals.gridWidth/(e.globals.labels.length+1),s=0;s<i.length;s++){var o=i[s].childNodes;e.config.xaxis.labels.trim&&"datetime"!==e.config.xaxis.type&&Array.prototype.forEach.call(o,function(e){t.placeTextWithEllipsis(e,e.textContent,a)})}}();if(s.length>0){var c=s[s.length-1].getBBox(),h=s[0].getBBox();c.x<-20&&s[s.length-1].parentNode.removeChild(s[s.length-1]),h.x+h.width>e.globals.gridWidth&&!e.globals.isBarHorizontal&&s[0].parentNode.removeChild(s[0]);for(var d=0;d<o.length;d++)t.placeTextWithEllipsis(o[d],o[d].textContent,e.config.yaxis[0].labels.maxWidth-(e.config.yaxis[0].title.text?2*parseFloat(e.config.yaxis[0].title.style.fontSize):0)-15)}}}]),e}(),_p=function(){function e(t){Rc(this,e),this.ctx=t,this.w=t.w;var a=this.w;this.xaxisLabels=a.globals.labels.slice(),this.axesUtils=new ip(t),this.isRangeBar=a.globals.seriesRange.length&&a.globals.isBarHorizontal,a.globals.timescaleLabels.length>0&&(this.xaxisLabels=a.globals.timescaleLabels.slice())}return Mc(e,[{key:"drawGridArea",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.w,a=new Ku(this.ctx);e||(e=a.group({class:"apexcharts-grid"}));var i=a.drawLine(t.globals.padHorizontal,1,t.globals.padHorizontal,t.globals.gridHeight,"transparent"),s=a.drawLine(t.globals.padHorizontal,t.globals.gridHeight,t.globals.gridWidth,t.globals.gridHeight,"transparent");return e.add(s),e.add(i),e}},{key:"drawGrid",value:function(){if(this.w.globals.axisCharts){var e=this.renderGrid();return this.drawGridArea(e.el),e}return null}},{key:"createGridMask",value:function(){var e=this.w,t=e.globals,a=new Ku(this.ctx),i=Array.isArray(e.config.stroke.width)?Math.max.apply(Math,Vc(e.config.stroke.width)):e.config.stroke.width,s=function(e){var a=document.createElementNS(t.SVGNS,"clipPath");return a.setAttribute("id",e),a};t.dom.elGridRectMask=s("gridRectMask".concat(t.cuid)),t.dom.elGridRectBarMask=s("gridRectBarMask".concat(t.cuid)),t.dom.elGridRectMarkerMask=s("gridRectMarkerMask".concat(t.cuid)),t.dom.elForecastMask=s("forecastMask".concat(t.cuid)),t.dom.elNonForecastMask=s("nonForecastMask".concat(t.cuid));var o=0,n=0;(["bar","rangeBar","candlestick","boxPlot"].includes(e.config.chart.type)||e.globals.comboBarCount>0)&&e.globals.isXNumeric&&!e.globals.isBarHorizontal&&(o=Math.max(e.config.grid.padding.left,t.barPadForNumericAxis),n=Math.max(e.config.grid.padding.right,t.barPadForNumericAxis)),t.dom.elGridRect=a.drawRect(-i/2-2,-i/2-2,t.gridWidth+i+4,t.gridHeight+i+4,0,"#fff"),t.dom.elGridRectBar=a.drawRect(-i/2-o-2,-i/2-2,t.gridWidth+i+n+o+4,t.gridHeight+i+4,0,"#fff");var r=e.globals.markers.largestSize;t.dom.elGridRectMarker=a.drawRect(-r,-r,t.gridWidth+2*r,t.gridHeight+2*r,0,"#fff"),t.dom.elGridRectMask.appendChild(t.dom.elGridRect.node),t.dom.elGridRectBarMask.appendChild(t.dom.elGridRectBar.node),t.dom.elGridRectMarkerMask.appendChild(t.dom.elGridRectMarker.node);var l=t.dom.baseEl.querySelector("defs");l.appendChild(t.dom.elGridRectMask),l.appendChild(t.dom.elGridRectBarMask),l.appendChild(t.dom.elGridRectMarkerMask),l.appendChild(t.dom.elForecastMask),l.appendChild(t.dom.elNonForecastMask)}},{key:"_drawGridLines",value:function(e){var t=e.i,a=e.x1,i=e.y1,s=e.x2,o=e.y2,n=e.xCount,r=e.parent,l=this.w;if(!(0===t&&l.globals.skipFirstTimelinelabel||t===n-1&&l.globals.skipLastTimelinelabel&&!l.config.xaxis.labels.formatter||"radar"===l.config.chart.type)){l.config.grid.xaxis.lines.show&&this._drawGridLine({i:t,x1:a,y1:i,x2:s,y2:o,xCount:n,parent:r});var c=0;if(l.globals.hasXaxisGroups&&"between"===l.config.xaxis.tickPlacement){var h=l.globals.groups;if(h){for(var d=0,u=0;d<t&&u<h.length;u++)d+=h[u].cols;d===t&&(c=.6*l.globals.xAxisLabelsHeight)}}new Sp(this.ctx).drawXaxisTicks(a,c,l.globals.dom.elGraphical)}}},{key:"_drawGridLine",value:function(e){var t=e.i,a=e.x1,i=e.y1,s=e.x2,o=e.y2,n=e.xCount,r=e.parent,l=this.w,c=r.node.classList.contains("apexcharts-gridlines-horizontal"),h=l.globals.barPadForNumericAxis,d=0===i&&0===o||0===a&&0===s||i===l.globals.gridHeight&&o===l.globals.gridHeight||l.globals.isBarHorizontal&&(0===t||t===n-1),u=new Ku(this).drawLine(a-(c?h:0),i,s+(c?h:0),o,l.config.grid.borderColor,l.config.grid.strokeDashArray);u.node.classList.add("apexcharts-gridline"),d&&l.config.grid.show?this.elGridBorders.add(u):r.add(u)}},{key:"_drawGridBandRect",value:function(e){var t=e.c,a=e.x1,i=e.y1,s=e.x2,o=e.y2,n=e.type,r=this.w,l=new Ku(this.ctx),c=r.globals.barPadForNumericAxis,h=r.config.grid[n].colors[t],d=l.drawRect(a-("row"===n?c:0),i,s+("row"===n?2*c:0),o,0,h,r.config.grid[n].opacity);this.elg.add(d),d.attr("clip-path","url(#gridRectMask".concat(r.globals.cuid,")")),d.node.classList.add("apexcharts-grid-".concat(n))}},{key:"_drawXYLines",value:function(e){var t=this,a=e.xCount,i=e.tickAmount,s=this.w;if(s.config.grid.xaxis.lines.show||s.config.xaxis.axisTicks.show){var o,n=s.globals.padHorizontal,r=s.globals.gridHeight;s.globals.timescaleLabels.length?function(e){for(var i=e.xC,s=e.x1,o=e.y1,n=e.x2,r=e.y2,l=0;l<i;l++)s=t.xaxisLabels[l].position,n=t.xaxisLabels[l].position,t._drawGridLines({i:l,x1:s,y1:o,x2:n,y2:r,xCount:a,parent:t.elgridLinesV})}({xC:a,x1:n,y1:0,x2:o,y2:r}):(s.globals.isXNumeric&&(a=s.globals.xAxisScale.result.length),function(e){for(var i=e.xC,o=e.x1,n=e.y1,r=e.x2,l=e.y2,c=0;c<i+(s.globals.isXNumeric?0:1);c++)0===c&&1===i&&1===s.globals.dataPoints&&(r=o=s.globals.gridWidth/2),t._drawGridLines({i:c,x1:o,y1:n,x2:r,y2:l,xCount:a,parent:t.elgridLinesV}),r=o+=s.globals.gridWidth/(s.globals.isXNumeric?i-1:i)}({xC:a,x1:n,y1:0,x2:o,y2:r}))}if(s.config.grid.yaxis.lines.show){var l=0,c=0,h=s.globals.gridWidth,d=i+1;this.isRangeBar&&(d=s.globals.labels.length);for(var u=0;u<d+(this.isRangeBar?1:0);u++)this._drawGridLine({i:u,xCount:d+(this.isRangeBar?1:0),x1:0,y1:l,x2:h,y2:c,parent:this.elgridLinesH}),c=l+=s.globals.gridHeight/(this.isRangeBar?d:i)}}},{key:"_drawInvertedXYLines",value:function(e){var t=e.xCount,a=this.w;if(a.config.grid.xaxis.lines.show||a.config.xaxis.axisTicks.show)for(var i,s=a.globals.padHorizontal,o=a.globals.gridHeight,n=0;n<t+1;n++)a.config.grid.xaxis.lines.show&&this._drawGridLine({i:n,xCount:t+1,x1:s,y1:0,x2:i,y2:o,parent:this.elgridLinesV}),new Sp(this.ctx).drawXaxisTicks(s,0,a.globals.dom.elGraphical),i=s+=a.globals.gridWidth/t;if(a.config.grid.yaxis.lines.show)for(var r=0,l=0,c=a.globals.gridWidth,h=0;h<a.globals.dataPoints+1;h++)this._drawGridLine({i:h,xCount:a.globals.dataPoints+1,x1:0,y1:r,x2:c,y2:l,parent:this.elgridLinesH}),l=r+=a.globals.gridHeight/a.globals.dataPoints}},{key:"renderGrid",value:function(){var e=this.w,t=e.globals,a=new Ku(this.ctx);this.elg=a.group({class:"apexcharts-grid"}),this.elgridLinesH=a.group({class:"apexcharts-gridlines-horizontal"}),this.elgridLinesV=a.group({class:"apexcharts-gridlines-vertical"}),this.elGridBorders=a.group({class:"apexcharts-grid-borders"}),this.elg.add(this.elgridLinesH),this.elg.add(this.elgridLinesV),e.config.grid.show||(this.elgridLinesV.hide(),this.elgridLinesH.hide(),this.elGridBorders.hide());for(var i=0;i<t.seriesYAxisMap.length&&t.ignoreYAxisIndexes.includes(i);)i++;i===t.seriesYAxisMap.length&&(i=0);var s,o,n,r,l=t.yAxisScale[i].result.length-1;!t.isBarHorizontal||this.isRangeBar?(s=this.xaxisLabels.length,this.isRangeBar&&(l=t.labels.length,e.config.xaxis.tickAmount&&e.config.xaxis.labels.formatter&&(s=e.config.xaxis.tickAmount),(null===(o=t.yAxisScale)||void 0===o||null===(n=o[i])||void 0===n||null===(r=n.result)||void 0===r?void 0:r.length)>0&&"datetime"!==e.config.xaxis.type&&(s=t.yAxisScale[i].result.length-1)),this._drawXYLines({xCount:s,tickAmount:l})):(s=l,l=t.xTickAmount,this._drawInvertedXYLines({xCount:s,tickAmount:l}));return this.drawGridBands(s,l),{el:this.elg,elGridBorders:this.elGridBorders,xAxisTickWidth:t.gridWidth/s}}},{key:"drawGridBands",value:function(e,t){var a,i,s=this,o=this.w;if((null===(a=o.config.grid.row.colors)||void 0===a?void 0:a.length)>0&&function(e,a,i,n,r,l){for(var c=0,h=0;c<a;c++,h++)h>=o.config.grid.row.colors.length&&(h=0),s._drawGridBandRect({c:h,x1:0,y1:n,x2:r,y2:l,type:"row"}),n+=o.globals.gridHeight/t}(0,t,0,0,o.globals.gridWidth,o.globals.gridHeight/t),(null===(i=o.config.grid.column.colors)||void 0===i?void 0:i.length)>0){var n=o.globals.isBarHorizontal||"on"!==o.config.xaxis.tickPlacement||"category"!==o.config.xaxis.type&&!o.config.xaxis.convertedCatToNumeric?e:e-1;o.globals.isXNumeric&&(n=o.globals.xAxisScale.result.length-1);for(var r=o.globals.padHorizontal,l=o.globals.padHorizontal+o.globals.gridWidth/n,c=o.globals.gridHeight,h=0,d=0;h<e;h++,d++){var u;d>=o.config.grid.column.colors.length&&(d=0),"datetime"===o.config.xaxis.type&&(r=this.xaxisLabels[h].position,l=((null===(u=this.xaxisLabels[h+1])||void 0===u?void 0:u.position)||o.globals.gridWidth)-this.xaxisLabels[h].position),this._drawGridBandRect({c:d,x1:r,y1:0,x2:l,y2:c,type:"column"}),r+=o.globals.gridWidth/n}}}}]),e}(),kp=function(){function e(t){Rc(this,e),this.ctx=t,this.w=t.w,this.coreUtils=new Ju(this.ctx)}return Mc(e,[{key:"niceScale",value:function(e,t){var a,i,s,o,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=1e-11,l=this.w,c=l.globals;c.isBarHorizontal?(a=l.config.xaxis,i=Math.max((c.svgWidth-100)/25,2)):(a=l.config.yaxis[n],i=Math.max((c.svgHeight-100)/15,2)),Xc.isNumber(i)||(i=10),s=void 0!==a.min&&null!==a.min,o=void 0!==a.max&&null!==a.min;var h=void 0!==a.stepSize&&null!==a.stepSize,d=void 0!==a.tickAmount&&null!==a.tickAmount,u=d?a.tickAmount:c.niceScaleDefaultTicks[Math.min(Math.round(i/2),c.niceScaleDefaultTicks.length-1)];if(c.isMultipleYAxis&&!d&&c.multiAxisTickAmount>0&&(u=c.multiAxisTickAmount,d=!0),u="dataPoints"===u?c.dataPoints-1:Math.abs(Math.round(u)),(e===Number.MIN_VALUE&&0===t||!Xc.isNumber(e)&&!Xc.isNumber(t)||e===Number.MIN_VALUE&&t===-Number.MAX_VALUE)&&(e=Xc.isNumber(a.min)?a.min:0,t=Xc.isNumber(a.max)?a.max:e+u,c.allSeriesCollapsed=!1),e>t){console.warn("axis.min cannot be greater than axis.max: swapping min and max");var p=t;t=e,e=p}else e===t&&(e=0===e?0:e-1,t=0===t?2:t+1);var m=[];u<1&&(u=1);var g=u,f=Math.abs(t-e);!s&&e>0&&e/f<.15&&(e=0,s=!0),!o&&t<0&&-t/f<.15&&(t=0,o=!0);var b=(f=Math.abs(t-e))/g,y=b,w=Math.floor(Math.log10(y)),v=Math.pow(10,w),x=Math.ceil(y/v);if(b=y=(x=c.niceScaleAllowedMagMsd[0===c.yValueDecimal?0:1][x])*v,c.isBarHorizontal&&a.stepSize&&"datetime"!==a.type?(b=a.stepSize,h=!0):h&&(b=a.stepSize),h&&a.forceNiceScale){var S=Math.floor(Math.log10(b));b*=Math.pow(10,w-S)}if(s&&o){var _=f/g;if(d)if(h)if(0!=Xc.mod(f,b)){var k=Xc.getGCD(b,_);b=_/k<10?k:_}else 0==Xc.mod(b,_)?b=_:(_=b,d=!1);else b=_;else if(h)0==Xc.mod(f,b)?_=b:b=_;else if(0==Xc.mod(f,b))_=b;else{_=f/(g=Math.ceil(f/b));var C=Xc.getGCD(f,b);f/C<i&&(_=C),b=_}g=Math.round(f/b)}else{if(s||o){if(o)if(d)e=t-b*g;else{var I=e;e=b*Math.floor(e/b),Math.abs(t-e)/Xc.getGCD(f,b)>i&&(e=t-b*u,e+=b*Math.floor((I-e)/b))}else if(s)if(d)t=e+b*g;else{var E=t;t=b*Math.ceil(t/b),Math.abs(t-e)/Xc.getGCD(f,b)>i&&(t=e+b*u,t+=b*Math.ceil((E-t)/b))}}else if(c.isMultipleYAxis&&d){var T=b*Math.floor(e/b),A=T+b*g;A<t&&(b*=2),A=t,t=(e=T)+b*g,f=Math.abs(t-e),e>0&&e<Math.abs(A-t)&&(e=0,t=b*g),t<0&&-t<Math.abs(T-e)&&(t=0,e=-b*g)}else e=b*Math.floor(e/b),t=b*Math.ceil(t/b);f=Math.abs(t-e),b=Xc.getGCD(f,b),g=Math.round(f/b)}if(d||s||o||(g=Math.ceil((f-r)/(b+r)))>16&&Xc.getPrimeFactors(g).length<2&&g++,!d&&a.forceNiceScale&&0===c.yValueDecimal&&g>f&&(g=f,b=Math.round(f/g)),g>i&&(!d&&!h||a.forceNiceScale)){var P=Xc.getPrimeFactors(g),R=P.length-1,D=g;e:for(var M=0;M<R;M++)for(var L=0;L<=R-M;L++){for(var N=Math.min(L+M,R),O=D,G=1,z=L;z<=N;z++)G*=P[z];if((O/=G)<i){D=O;break e}}b=D===g?f:f/D,g=Math.round(f/b)}c.isMultipleYAxis&&0==c.multiAxisTickAmount&&c.ignoreYAxisIndexes.indexOf(n)<0&&(c.multiAxisTickAmount=g);var F=e-b,H=b*r;do{F+=b,m.push(Xc.stripNumber(F,7))}while(t-F>H);return{result:m,niceMin:m[0],niceMax:m[m.length-1]}}},{key:"linearScale",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,o=Math.abs(t-e),n=[];if(e===t)return{result:n=[e],niceMin:n[0],niceMax:n[n.length-1]};"dataPoints"===(a=this._adjustTicksForSmallRange(a,i,o))&&(a=this.w.globals.dataPoints-1),s||(s=o/a),s=Math.round(100*(s+Number.EPSILON))/100,a===Number.MAX_VALUE&&(a=5,s=1);for(var r=e;a>=0;)n.push(r),r=Xc.preciseAddition(r,s),a-=1;return{result:n,niceMin:n[0],niceMax:n[n.length-1]}}},{key:"logarithmicScaleNice",value:function(e,t,a){t<=0&&(t=Math.max(e,a)),e<=0&&(e=Math.min(t,a));for(var i=[],s=Math.ceil(Math.log(t)/Math.log(a)+1),o=Math.floor(Math.log(e)/Math.log(a));o<s;o++)i.push(Math.pow(a,o));return{result:i,niceMin:i[0],niceMax:i[i.length-1]}}},{key:"logarithmicScale",value:function(e,t,a){t<=0&&(t=Math.max(e,a)),e<=0&&(e=Math.min(t,a));for(var i=[],s=Math.log(t)/Math.log(a),o=Math.log(e)/Math.log(a),n=s-o,r=Math.round(n),l=n/r,c=0,h=o;c<r;c++,h+=l)i.push(Math.pow(a,h));return i.push(Math.pow(a,s)),{result:i,niceMin:e,niceMax:t}}},{key:"_adjustTicksForSmallRange",value:function(e,t,a){var i=e;if(void 0!==t&&this.w.config.yaxis[t].labels.formatter&&void 0===this.w.config.yaxis[t].tickAmount){var s=Number(this.w.config.yaxis[t].labels.formatter(1));Xc.isNumber(s)&&0===this.w.globals.yValueDecimal&&(i=Math.ceil(a))}return i<e?i:e}},{key:"setYScaleForIndex",value:function(e,t,a){var i=this.w.globals,s=this.w.config,o=i.isBarHorizontal?s.xaxis:s.yaxis[e];void 0===i.yAxisScale[e]&&(i.yAxisScale[e]=[]);var n=Math.abs(a-t);o.logarithmic&&n<=5&&(i.invalidLogScale=!0),o.logarithmic&&n>5?(i.allSeriesCollapsed=!1,i.yAxisScale[e]=o.forceNiceScale?this.logarithmicScaleNice(t,a,o.logBase):this.logarithmicScale(t,a,o.logBase)):a!==-Number.MAX_VALUE&&Xc.isNumber(a)&&t!==Number.MAX_VALUE&&Xc.isNumber(t)?(i.allSeriesCollapsed=!1,i.yAxisScale[e]=this.niceScale(t,a,e)):i.yAxisScale[e]=this.niceScale(Number.MIN_VALUE,0,e)}},{key:"setXScale",value:function(e,t){var a=this.w,i=a.globals;if(t!==-Number.MAX_VALUE&&Xc.isNumber(t)){var s=i.xTickAmount;i.xAxisScale=this.linearScale(e,t,s,0,a.config.xaxis.stepSize)}else i.xAxisScale=this.linearScale(0,10,10);return i.xAxisScale}},{key:"scaleMultipleYAxes",value:function(){var e=this,t=this.w.config,a=this.w.globals;this.coreUtils.setSeriesYAxisMappings();var i=a.seriesYAxisMap,s=a.minYArr,o=a.maxYArr;a.allSeriesCollapsed=!0,a.barGroups=[],i.forEach(function(i,n){var r=[];i.forEach(function(e){var a,i=null===(a=t.series[e])||void 0===a?void 0:a.group;r.indexOf(i)<0&&r.push(i)}),i.length>0?function(){var l,c,h=Number.MAX_VALUE,d=-Number.MAX_VALUE,u=h,p=d;if(t.chart.stacked)!function(){var e=new Array(a.dataPoints).fill(0),s=[],o=[],m=[];r.forEach(function(){s.push(e.map(function(){return Number.MIN_VALUE})),o.push(e.map(function(){return Number.MIN_VALUE})),m.push(e.map(function(){return Number.MIN_VALUE}))});for(var g=function(e){!l&&t.series[i[e]].type&&(l=t.series[i[e]].type);var h=i[e];c=t.series[h].group?t.series[h].group:"axis-".concat(n),!(a.collapsedSeriesIndices.indexOf(h)<0&&a.ancillaryCollapsedSeriesIndices.indexOf(h)<0)||(a.allSeriesCollapsed=!1,r.forEach(function(e,i){if(t.series[h].group===e)for(var n=0;n<a.series[h].length;n++){var r=a.series[h][n];r>=0?o[i][n]+=r:m[i][n]+=r,s[i][n]+=r,u=Math.min(u,r),p=Math.max(p,r)}})),"bar"!==l&&"column"!==l||a.barGroups.push(c)},f=0;f<i.length;f++)g(f);l||(l=t.chart.type),"bar"===l||"column"===l?r.forEach(function(e,t){h=Math.min(h,Math.min.apply(null,m[t])),d=Math.max(d,Math.max.apply(null,o[t]))}):(r.forEach(function(e,t){u=Math.min(u,Math.min.apply(null,s[t])),p=Math.max(p,Math.max.apply(null,s[t]))}),h=u,d=p),h===Number.MIN_VALUE&&d===Number.MIN_VALUE&&(d=-Number.MAX_VALUE)}();else for(var m=0;m<i.length;m++){var g=i[m];h=Math.min(h,s[g]),d=Math.max(d,o[g]),!(a.collapsedSeriesIndices.indexOf(g)<0&&a.ancillaryCollapsedSeriesIndices.indexOf(g)<0)||(a.allSeriesCollapsed=!1)}void 0!==t.yaxis[n].min&&(h="function"==typeof t.yaxis[n].min?t.yaxis[n].min(h):t.yaxis[n].min),void 0!==t.yaxis[n].max&&(d="function"==typeof t.yaxis[n].max?t.yaxis[n].max(d):t.yaxis[n].max),a.barGroups=a.barGroups.filter(function(e,t,a){return a.indexOf(e)===t}),e.setYScaleForIndex(n,h,d),i.forEach(function(e){s[e]=a.yAxisScale[n].niceMin,o[e]=a.yAxisScale[n].niceMax})}():e.setYScaleForIndex(n,0,-Number.MAX_VALUE)})}}]),e}(),Cp=function(){function e(t){Rc(this,e),this.ctx=t,this.w=t.w,this.scales=new kp(t)}return Mc(e,[{key:"init",value:function(){this.setYRange(),this.setXRange(),this.setZRange()}},{key:"getMinYMaxY",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.MAX_VALUE,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-Number.MAX_VALUE,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=this.w.config,o=this.w.globals,n=-Number.MAX_VALUE,r=Number.MIN_VALUE;null===i&&(i=e+1);var l=o.series,c=l,h=l;"candlestick"===s.chart.type?(c=o.seriesCandleL,h=o.seriesCandleH):"boxPlot"===s.chart.type?(c=o.seriesCandleO,h=o.seriesCandleC):o.isRangeData&&(c=o.seriesRangeStart,h=o.seriesRangeEnd);var d=!1;if(o.seriesX.length>=i){var u,p=null===(u=o.brushSource)||void 0===u?void 0:u.w.config.chart.brush;(s.chart.zoom.enabled&&s.chart.zoom.autoScaleYaxis||null!=p&&p.enabled&&null!=p&&p.autoScaleYaxis)&&(d=!0)}for(var m=e;m<i;m++){o.dataPoints=Math.max(o.dataPoints,l[m].length);var g=s.series[m].type;o.categoryLabels.length&&(o.dataPoints=o.categoryLabels.filter(function(e){return void 0!==e}).length),o.labels.length&&"datetime"!==s.xaxis.type&&0!==o.series.reduce(function(e,t){return e+t.length},0)&&(o.dataPoints=Math.max(o.dataPoints,o.labels.length));var f=0,b=l[m].length-1;if(d){if(s.xaxis.min)for(;f<b&&o.seriesX[m][f]<s.xaxis.min;f++);if(s.xaxis.max)for(;b>f&&o.seriesX[m][b]>s.xaxis.max;b--);}for(var y=f;y<=b&&y<o.series[m].length;y++){var w=l[m][y];if(null!==w&&Xc.isNumber(w)){var v,x,S,_;switch(void 0!==(null===(v=h[m])||void 0===v?void 0:v[y])&&(n=Math.max(n,h[m][y]),t=Math.min(t,h[m][y])),void 0!==(null===(x=c[m])||void 0===x?void 0:x[y])&&(t=Math.min(t,c[m][y]),a=Math.max(a,c[m][y])),g){case"candlestick":void 0!==o.seriesCandleC[m][y]&&(n=Math.max(n,o.seriesCandleH[m][y]),t=Math.min(t,o.seriesCandleL[m][y]));break;case"boxPlot":void 0!==o.seriesCandleC[m][y]&&(n=Math.max(n,o.seriesCandleC[m][y]),t=Math.min(t,o.seriesCandleO[m][y]))}g&&"candlestick"!==g&&"boxPlot"!==g&&"rangeArea"!==g&&"rangeBar"!==g&&(n=Math.max(n,o.series[m][y]),t=Math.min(t,o.series[m][y])),o.seriesGoals[m]&&o.seriesGoals[m][y]&&Array.isArray(o.seriesGoals[m][y])&&o.seriesGoals[m][y].forEach(function(e){n=Math.max(n,e.value),t=Math.min(t,e.value)}),a=n,w=Xc.noExponents(w),Xc.isFloat(w)&&(o.yValueDecimal=Math.max(o.yValueDecimal,w.toString().split(".")[1].length)),r>(null===(S=c[m])||void 0===S?void 0:S[y])&&(null===(_=c[m])||void 0===_?void 0:_[y])<0&&(r=c[m][y])}else o.hasNullValues=!0}"bar"!==g&&"column"!==g||(r<0&&n<0&&(n=0,a=Math.max(a,0)),r===Number.MIN_VALUE&&(r=0,t=Math.min(t,0)))}return"rangeBar"===s.chart.type&&o.seriesRangeStart.length&&o.isBarHorizontal&&(r=t),"bar"===s.chart.type&&(r<0&&n<0&&(n=0),r===Number.MIN_VALUE&&(r=0)),{minY:r,maxY:n,lowestY:t,highestY:a}}},{key:"setYRange",value:function(){var e=this.w.globals,t=this.w.config;e.maxY=-Number.MAX_VALUE,e.minY=Number.MIN_VALUE;var a,i=Number.MAX_VALUE;if(e.isMultipleYAxis){i=Number.MAX_VALUE;for(var s=0;s<e.series.length;s++)a=this.getMinYMaxY(s),e.minYArr[s]=a.lowestY,e.maxYArr[s]=a.highestY,i=Math.min(i,a.lowestY)}return a=this.getMinYMaxY(0,i,null,e.series.length),"bar"===t.chart.type?(e.minY=a.minY,e.maxY=a.maxY):(e.minY=a.lowestY,e.maxY=a.highestY),i=a.lowestY,t.chart.stacked&&this._setStackedMinMax(),"line"===t.chart.type||"area"===t.chart.type||"scatter"===t.chart.type||"candlestick"===t.chart.type||"boxPlot"===t.chart.type||"rangeBar"===t.chart.type&&!e.isBarHorizontal?e.minY===Number.MIN_VALUE&&i!==-Number.MAX_VALUE&&i!==e.maxY&&(e.minY=i):e.minY=e.minY!==Number.MIN_VALUE?Math.min(a.minY,e.minY):a.minY,t.yaxis.forEach(function(t,a){void 0!==t.max&&("number"==typeof t.max?e.maxYArr[a]=t.max:"function"==typeof t.max&&(e.maxYArr[a]=t.max(e.isMultipleYAxis?e.maxYArr[a]:e.maxY)),e.maxY=e.maxYArr[a]),void 0!==t.min&&("number"==typeof t.min?e.minYArr[a]=t.min:"function"==typeof t.min&&(e.minYArr[a]=t.min(e.isMultipleYAxis?e.minYArr[a]===Number.MIN_VALUE?0:e.minYArr[a]:e.minY)),e.minY=e.minYArr[a])}),e.isBarHorizontal&&["min","max"].forEach(function(a){void 0!==t.xaxis[a]&&"number"==typeof t.xaxis[a]&&("min"===a?e.minY=t.xaxis[a]:e.maxY=t.xaxis[a])}),e.isMultipleYAxis?(this.scales.scaleMultipleYAxes(),e.minY=i):(this.scales.setYScaleForIndex(0,e.minY,e.maxY),e.minY=e.yAxisScale[0].niceMin,e.maxY=e.yAxisScale[0].niceMax,e.minYArr[0]=e.minY,e.maxYArr[0]=e.maxY),e.barGroups=[],e.lineGroups=[],e.areaGroups=[],t.series.forEach(function(a){switch(a.type||t.chart.type){case"bar":case"column":e.barGroups.push(a.group);break;case"line":e.lineGroups.push(a.group);break;case"area":e.areaGroups.push(a.group)}}),e.barGroups=e.barGroups.filter(function(e,t,a){return a.indexOf(e)===t}),e.lineGroups=e.lineGroups.filter(function(e,t,a){return a.indexOf(e)===t}),e.areaGroups=e.areaGroups.filter(function(e,t,a){return a.indexOf(e)===t}),{minY:e.minY,maxY:e.maxY,minYArr:e.minYArr,maxYArr:e.maxYArr,yAxisScale:e.yAxisScale}}},{key:"setXRange",value:function(){var e=this.w.globals,t=this.w.config,a="numeric"===t.xaxis.type||"datetime"===t.xaxis.type||"category"===t.xaxis.type&&!e.noLabelsProvided||e.noLabelsProvided||e.isXNumeric;if(e.isXNumeric&&function(){for(var t=0;t<e.series.length;t++)if(e.labels[t])for(var a=0;a<e.labels[t].length;a++)null!==e.labels[t][a]&&Xc.isNumber(e.labels[t][a])&&(e.maxX=Math.max(e.maxX,e.labels[t][a]),e.initialMaxX=Math.max(e.maxX,e.labels[t][a]),e.minX=Math.min(e.minX,e.labels[t][a]),e.initialMinX=Math.min(e.minX,e.labels[t][a]))}(),e.noLabelsProvided&&0===t.xaxis.categories.length&&(e.maxX=e.labels[e.labels.length-1],e.initialMaxX=e.labels[e.labels.length-1],e.minX=1,e.initialMinX=1),e.isXNumeric||e.noLabelsProvided||e.dataFormatXNumeric){var i=10;if(void 0===t.xaxis.tickAmount)i=Math.round(e.svgWidth/150),"numeric"===t.xaxis.type&&e.dataPoints<30&&(i=e.dataPoints-1),i>e.dataPoints&&0!==e.dataPoints&&(i=e.dataPoints-1);else if("dataPoints"===t.xaxis.tickAmount){if(e.series.length>1&&(i=e.series[e.maxValsInArrayIndex].length-1),e.isXNumeric){var s=Math.round(e.maxX-e.minX);s<30&&(i=s-1)}}else i=t.xaxis.tickAmount;if(e.xTickAmount=i,void 0!==t.xaxis.max&&"number"==typeof t.xaxis.max&&(e.maxX=t.xaxis.max),void 0!==t.xaxis.min&&"number"==typeof t.xaxis.min&&(e.minX=t.xaxis.min),void 0!==t.xaxis.range&&(e.minX=e.maxX-t.xaxis.range),e.minX!==Number.MAX_VALUE&&e.maxX!==-Number.MAX_VALUE)if(t.xaxis.convertedCatToNumeric&&!e.dataFormatXNumeric){for(var o=[],n=e.minX-1;n<e.maxX;n++)o.push(n+1);e.xAxisScale={result:o,niceMin:o[0],niceMax:o[o.length-1]}}else e.xAxisScale=this.scales.setXScale(e.minX,e.maxX);else e.xAxisScale=this.scales.linearScale(0,i,i,0,t.xaxis.stepSize),e.noLabelsProvided&&e.labels.length>0&&(e.xAxisScale=this.scales.linearScale(1,e.labels.length,i-1,0,t.xaxis.stepSize),e.seriesX=e.labels.slice());a&&(e.labels=e.xAxisScale.result.slice())}return e.isBarHorizontal&&e.labels.length&&(e.xTickAmount=e.labels.length),this._handleSingleDataPoint(),this._getMinXDiff(),{minX:e.minX,maxX:e.maxX}}},{key:"setZRange",value:function(){var e=this.w.globals;if(e.isDataXYZ)for(var t=0;t<e.series.length;t++)if(void 0!==e.seriesZ[t])for(var a=0;a<e.seriesZ[t].length;a++)null!==e.seriesZ[t][a]&&Xc.isNumber(e.seriesZ[t][a])&&(e.maxZ=Math.max(e.maxZ,e.seriesZ[t][a]),e.minZ=Math.min(e.minZ,e.seriesZ[t][a]))}},{key:"_handleSingleDataPoint",value:function(){var e=this.w.globals,t=this.w.config;if(e.minX===e.maxX){var a=new tp(this.ctx);if("datetime"===t.xaxis.type){var i=a.getDate(e.minX);t.xaxis.labels.datetimeUTC?i.setUTCDate(i.getUTCDate()-2):i.setDate(i.getDate()-2),e.minX=new Date(i).getTime();var s=a.getDate(e.maxX);t.xaxis.labels.datetimeUTC?s.setUTCDate(s.getUTCDate()+2):s.setDate(s.getDate()+2),e.maxX=new Date(s).getTime()}else("numeric"===t.xaxis.type||"category"===t.xaxis.type&&!e.noLabelsProvided)&&(e.minX=e.minX-2,e.initialMinX=e.minX,e.maxX=e.maxX+2,e.initialMaxX=e.maxX)}}},{key:"_getMinXDiff",value:function(){var e=this.w.globals;e.isXNumeric&&e.seriesX.forEach(function(t,a){if(t.length){1===t.length&&t.push(e.seriesX[e.maxValsInArrayIndex][e.seriesX[e.maxValsInArrayIndex].length-1]);var i=t.slice();i.sort(function(e,t){return e-t}),i.forEach(function(t,a){if(a>0){var s=t-i[a-1];s>0&&(e.minXDiff=Math.min(s,e.minXDiff))}}),1!==e.dataPoints&&e.minXDiff!==Number.MAX_VALUE||(e.minXDiff=.5)}})}},{key:"_setStackedMinMax",value:function(){var e=this,t=this.w.globals;if(t.series.length){var a=t.seriesGroups;a.length||(a=[this.w.globals.seriesNames.map(function(e){return e})]);var i={},s={};a.forEach(function(a){i[a]=[],s[a]=[],e.w.config.series.map(function(e,i){return a.indexOf(t.seriesNames[i])>-1?i:null}).filter(function(e){return null!==e}).forEach(function(o){for(var n=0;n<t.series[t.maxValsInArrayIndex].length;n++){var r,l,c,h;void 0===i[a][n]&&(i[a][n]=0,s[a][n]=0),(e.w.config.chart.stacked&&!t.comboCharts||e.w.config.chart.stacked&&t.comboCharts&&(!e.w.config.chart.stackOnlyBar||"bar"===(null===(r=e.w.config.series)||void 0===r||null===(l=r[o])||void 0===l?void 0:l.type)||"column"===(null===(c=e.w.config.series)||void 0===c||null===(h=c[o])||void 0===h?void 0:h.type)))&&null!==t.series[o][n]&&Xc.isNumber(t.series[o][n])&&(t.series[o][n]>0?i[a][n]+=parseFloat(t.series[o][n])+1e-4:s[a][n]+=parseFloat(t.series[o][n]))}})}),Object.entries(i).forEach(function(e){var a=Wc(e,1)[0];i[a].forEach(function(e,o){t.maxY=Math.max(t.maxY,i[a][o]),t.minY=Math.min(t.minY,s[a][o])})})}}}]),e}(),Ip=function(){function e(t,a){Rc(this,e),this.ctx=t,this.elgrid=a,this.w=t.w;var i=this.w;this.xaxisFontSize=i.config.xaxis.labels.style.fontSize,this.axisFontFamily=i.config.xaxis.labels.style.fontFamily,this.xaxisForeColors=i.config.xaxis.labels.style.colors,this.isCategoryBarHorizontal="bar"===i.config.chart.type&&i.config.plotOptions.bar.horizontal,this.xAxisoffX="bottom"===i.config.xaxis.position?i.globals.gridHeight:0,this.drawnLabels=[],this.axesUtils=new ip(t)}return Mc(e,[{key:"drawYaxis",value:function(e){var t=this.w,a=new Ku(this.ctx),i=t.config.yaxis[e].labels.style,s=i.fontSize,o=i.fontFamily,n=i.fontWeight,r=a.group({class:"apexcharts-yaxis",rel:e,transform:"translate(".concat(t.globals.translateYAxisX[e],", 0)")});if(this.axesUtils.isYAxisHidden(e))return r;var l=a.group({class:"apexcharts-yaxis-texts-g"});r.add(l);var c=t.globals.yAxisScale[e].result.length-1,h=t.globals.gridHeight/c,d=t.globals.yLabelFormatters[e],u=this.axesUtils.checkForReversedLabels(e,t.globals.yAxisScale[e].result.slice());if(t.config.yaxis[e].labels.show){var p=t.globals.translateY+t.config.yaxis[e].labels.offsetY;t.globals.isBarHorizontal?p=0:"heatmap"===t.config.chart.type&&(p-=h/2),p+=parseInt(s,10)/3;for(var m=c;m>=0;m--){var g=d(u[m],m,t),f=t.config.yaxis[e].labels.padding;t.config.yaxis[e].opposite&&0!==t.config.yaxis.length&&(f*=-1);var b=this.getTextAnchor(t.config.yaxis[e].labels.align,t.config.yaxis[e].opposite),y=this.axesUtils.getYAxisForeColor(i.colors,e),w=Array.isArray(y)?y[m]:y,v=Xc.listToArray(t.globals.dom.baseEl.querySelectorAll(".apexcharts-yaxis[rel='".concat(e,"'] .apexcharts-yaxis-label tspan"))).map(function(e){return e.textContent}),x=a.drawText({x:f,y:p,text:v.includes(g)&&!t.config.yaxis[e].labels.showDuplicates?"":g,textAnchor:b,fontSize:s,fontFamily:o,fontWeight:n,maxWidth:t.config.yaxis[e].labels.maxWidth,foreColor:w,isPlainText:!1,cssClass:"apexcharts-yaxis-label ".concat(i.cssClass)});l.add(x),this.addTooltip(x,g),0!==t.config.yaxis[e].labels.rotate&&this.rotateLabel(a,x,firstLabel,t.config.yaxis[e].labels.rotate),p+=h}}return this.addYAxisTitle(a,r,e),this.addAxisBorder(a,r,e,c,h),r}},{key:"getTextAnchor",value:function(e,t){return"left"===e?"start":"center"===e?"middle":"right"===e?"end":t?"start":"end"}},{key:"addTooltip",value:function(e,t){var a=document.createElementNS(this.w.globals.SVGNS,"title");a.textContent=Array.isArray(t)?t.join(" "):t,e.node.appendChild(a)}},{key:"rotateLabel",value:function(e,t,a,i){var s=e.rotateAroundCenter(a.node),o=e.rotateAroundCenter(t.node);t.node.setAttribute("transform","rotate(".concat(i," ").concat(s.x," ").concat(o.y,")"))}},{key:"addYAxisTitle",value:function(e,t,a){var i=this.w;if(void 0!==i.config.yaxis[a].title.text){var s=e.group({class:"apexcharts-yaxis-title"}),o=i.config.yaxis[a].opposite?i.globals.translateYAxisX[a]:0,n=e.drawText({x:o,y:i.globals.gridHeight/2+i.globals.translateY+i.config.yaxis[a].title.offsetY,text:i.config.yaxis[a].title.text,textAnchor:"end",foreColor:i.config.yaxis[a].title.style.color,fontSize:i.config.yaxis[a].title.style.fontSize,fontWeight:i.config.yaxis[a].title.style.fontWeight,fontFamily:i.config.yaxis[a].title.style.fontFamily,cssClass:"apexcharts-yaxis-title-text ".concat(i.config.yaxis[a].title.style.cssClass)});s.add(n),t.add(s)}}},{key:"addAxisBorder",value:function(e,t,a,i,s){var o=this.w,n=o.config.yaxis[a].axisBorder,r=31+n.offsetX;if(o.config.yaxis[a].opposite&&(r=-31-n.offsetX),n.show){var l=e.drawLine(r,o.globals.translateY+n.offsetY-2,r,o.globals.gridHeight+o.globals.translateY+n.offsetY+2,n.color,0,n.width);t.add(l)}o.config.yaxis[a].axisTicks.show&&this.axesUtils.drawYAxisTicks(r,i,n,o.config.yaxis[a].axisTicks,a,s,t)}},{key:"drawYaxisInversed",value:function(e){var t=this.w,a=new Ku(this.ctx),i=a.group({class:"apexcharts-xaxis apexcharts-yaxis-inversed"}),s=a.group({class:"apexcharts-xaxis-texts-g",transform:"translate(".concat(t.globals.translateXAxisX,", ").concat(t.globals.translateXAxisY,")")});i.add(s);var o=t.globals.yAxisScale[e].result.length-1,n=t.globals.gridWidth/o+.1,r=n+t.config.xaxis.labels.offsetX,l=t.globals.xLabelFormatter,c=this.axesUtils.checkForReversedLabels(e,t.globals.yAxisScale[e].result.slice()),h=t.globals.timescaleLabels;if(h.length>0&&(this.xaxisLabels=h.slice(),o=(c=h.slice()).length),t.config.xaxis.labels.show)for(var d=h.length?0:o;h.length?d<h.length:d>=0;h.length?d++:d--){var u=l(c[d],d,t),p=t.globals.gridWidth+t.globals.padHorizontal-(r-n+t.config.xaxis.labels.offsetX);if(h.length){var m=this.axesUtils.getLabel(c,h,p,d,this.drawnLabels,this.xaxisFontSize);p=m.x,u=m.text,this.drawnLabels.push(m.text),0===d&&t.globals.skipFirstTimelinelabel&&(u=""),d===c.length-1&&t.globals.skipLastTimelinelabel&&(u="")}var g=a.drawText({x:p,y:this.xAxisoffX+t.config.xaxis.labels.offsetY+30-("top"===t.config.xaxis.position?t.globals.xAxisHeight+t.config.xaxis.axisTicks.height-2:0),text:u,textAnchor:"middle",foreColor:Array.isArray(this.xaxisForeColors)?this.xaxisForeColors[e]:this.xaxisForeColors,fontSize:this.xaxisFontSize,fontFamily:this.xaxisFontFamily,fontWeight:t.config.xaxis.labels.style.fontWeight,isPlainText:!1,cssClass:"apexcharts-xaxis-label ".concat(t.config.xaxis.labels.style.cssClass)});s.add(g),g.tspan(u),this.addTooltip(g,u),r+=n}return this.inversedYAxisTitleText(i),this.inversedYAxisBorder(i),i}},{key:"inversedYAxisBorder",value:function(e){var t=this.w,a=new Ku(this.ctx),i=t.config.xaxis.axisBorder;if(i.show){var s=0;"bar"===t.config.chart.type&&t.globals.isXNumeric&&(s-=15);var o=a.drawLine(t.globals.padHorizontal+s+i.offsetX,this.xAxisoffX,t.globals.gridWidth,this.xAxisoffX,i.color,0,i.height);this.elgrid&&this.elgrid.elGridBorders&&t.config.grid.show?this.elgrid.elGridBorders.add(o):e.add(o)}}},{key:"inversedYAxisTitleText",value:function(e){var t=this.w,a=new Ku(this.ctx);if(void 0!==t.config.xaxis.title.text){var i=a.group({class:"apexcharts-xaxis-title apexcharts-yaxis-title-inversed"}),s=a.drawText({x:t.globals.gridWidth/2+t.config.xaxis.title.offsetX,y:this.xAxisoffX+parseFloat(this.xaxisFontSize)+parseFloat(t.config.xaxis.title.style.fontSize)+t.config.xaxis.title.offsetY+20,text:t.config.xaxis.title.text,textAnchor:"middle",fontSize:t.config.xaxis.title.style.fontSize,fontFamily:t.config.xaxis.title.style.fontFamily,fontWeight:t.config.xaxis.title.style.fontWeight,foreColor:t.config.xaxis.title.style.color,cssClass:"apexcharts-xaxis-title-text ".concat(t.config.xaxis.title.style.cssClass)});i.add(s),e.add(i)}}},{key:"yAxisTitleRotate",value:function(e,t){var a=this.w,i=new Ku(this.ctx),s=a.globals.dom.baseEl.querySelector(".apexcharts-yaxis[rel='".concat(e,"'] .apexcharts-yaxis-texts-g")),o=s?s.getBoundingClientRect():{width:0,height:0},n=a.globals.dom.baseEl.querySelector(".apexcharts-yaxis[rel='".concat(e,"'] .apexcharts-yaxis-title text")),r=n?n.getBoundingClientRect():{width:0,height:0};if(n){var l=this.xPaddingForYAxisTitle(e,o,r,t);n.setAttribute("x",l.xPos-(t?10:0));var c=i.rotateAroundCenter(n);n.setAttribute("transform","rotate(".concat(t?-1*a.config.yaxis[e].title.rotate:a.config.yaxis[e].title.rotate," ").concat(c.x," ").concat(c.y,")"))}}},{key:"xPaddingForYAxisTitle",value:function(e,t,a,i){var s=this.w,o=0,n=10;return void 0===s.config.yaxis[e].title.text||e<0?{xPos:o,padd:0}:(i?o=t.width+s.config.yaxis[e].title.offsetX+a.width/2+n/2:(o=-1*t.width+s.config.yaxis[e].title.offsetX+n/2+a.width/2,s.globals.isBarHorizontal&&(n=25,o=-1*t.width-s.config.yaxis[e].title.offsetX-n)),{xPos:o,padd:n})}},{key:"setYAxisXPosition",value:function(e,t){var a=this.w,i=0,s=0,o=18,n=1;a.config.yaxis.length>1&&(this.multipleYs=!0),a.config.yaxis.forEach(function(r,l){var c=a.globals.ignoreYAxisIndexes.includes(l)||!r.show||r.floating||0===e[l].width,h=e[l].width+t[l].width;r.opposite?a.globals.isBarHorizontal?(s=a.globals.gridWidth+a.globals.translateX-1,a.globals.translateYAxisX[l]=s-r.labels.offsetX):(s=a.globals.gridWidth+a.globals.translateX+n,c||(n+=h+20),a.globals.translateYAxisX[l]=s-r.labels.offsetX+20):(i=a.globals.translateX-o,c||(o+=h+20),a.globals.translateYAxisX[l]=i+r.labels.offsetX)})}},{key:"setYAxisTextAlignments",value:function(){var e=this.w;Xc.listToArray(e.globals.dom.baseEl.getElementsByClassName("apexcharts-yaxis")).forEach(function(t,a){var i=e.config.yaxis[a];if(i&&!i.floating&&void 0!==i.labels.align){var s=e.globals.dom.baseEl.querySelector(".apexcharts-yaxis[rel='".concat(a,"'] .apexcharts-yaxis-texts-g")),o=Xc.listToArray(e.globals.dom.baseEl.querySelectorAll(".apexcharts-yaxis[rel='".concat(a,"'] .apexcharts-yaxis-label"))),n=s.getBoundingClientRect();o.forEach(function(e){e.setAttribute("text-anchor",i.labels.align)}),"left"!==i.labels.align||i.opposite?"center"===i.labels.align?s.setAttribute("transform","translate(".concat(n.width/2*(i.opposite?1:-1),", 0)")):"right"===i.labels.align&&i.opposite&&s.setAttribute("transform","translate(".concat(n.width,", 0)")):s.setAttribute("transform","translate(-".concat(n.width,", 0)"))}})}}]),e}(),Ep=function(){function e(t){Rc(this,e),this.ctx=t,this.w=t.w,this.documentEvent=Xc.bind(this.documentEvent,this)}return Mc(e,[{key:"addEventListener",value:function(e,t){var a=this.w;a.globals.events.hasOwnProperty(e)?a.globals.events[e].push(t):a.globals.events[e]=[t]}},{key:"removeEventListener",value:function(e,t){var a=this.w;if(a.globals.events.hasOwnProperty(e)){var i=a.globals.events[e].indexOf(t);-1!==i&&a.globals.events[e].splice(i,1)}}},{key:"fireEvent",value:function(e,t){var a=this.w;if(a.globals.events.hasOwnProperty(e)){t&&t.length||(t=[]);for(var i=a.globals.events[e],s=i.length,o=0;o<s;o++)i[o].apply(null,t)}}},{key:"setupEventHandlers",value:function(){var e=this,t=this.w,a=this.ctx,i=t.globals.dom.baseEl.querySelector(t.globals.chartClass);this.ctx.eventList.forEach(function(e){i.addEventListener(e,function(e){var i=null===e.target.getAttribute("i")&&-1!==t.globals.capturedSeriesIndex?t.globals.capturedSeriesIndex:e.target.getAttribute("i"),s=null===e.target.getAttribute("j")&&-1!==t.globals.capturedDataPointIndex?t.globals.capturedDataPointIndex:e.target.getAttribute("j"),o=Object.assign({},t,{seriesIndex:t.globals.axisCharts?i:0,dataPointIndex:s});"mousemove"===e.type||"touchmove"===e.type?"function"==typeof t.config.chart.events.mouseMove&&t.config.chart.events.mouseMove(e,a,o):"mouseleave"===e.type||"touchleave"===e.type?"function"==typeof t.config.chart.events.mouseLeave&&t.config.chart.events.mouseLeave(e,a,o):("mouseup"===e.type&&1===e.which||"touchend"===e.type)&&("function"==typeof t.config.chart.events.click&&t.config.chart.events.click(e,a,o),a.ctx.events.fireEvent("click",[e,a,o]))},{capture:!1,passive:!0})}),this.ctx.eventList.forEach(function(a){t.globals.dom.baseEl.addEventListener(a,e.documentEvent,{passive:!0})}),this.ctx.core.setupBrushHandler()}},{key:"documentEvent",value:function(e){var t=this.w,a=e.target.className;if("click"===e.type){var i=t.globals.dom.baseEl.querySelector(".apexcharts-menu");i&&i.classList.contains("apexcharts-menu-open")&&"apexcharts-menu-icon"!==a&&i.classList.remove("apexcharts-menu-open")}t.globals.clientX="touchmove"===e.type?e.touches[0].clientX:e.clientX,t.globals.clientY="touchmove"===e.type?e.touches[0].clientY:e.clientY}}]),e}(),Tp=function(){function e(t){Rc(this,e),this.ctx=t,this.w=t.w}return Mc(e,[{key:"setCurrentLocaleValues",value:function(e){var t=this.w.config.chart.locales;window.Apex.chart&&window.Apex.chart.locales&&window.Apex.chart.locales.length>0&&(t=this.w.config.chart.locales.concat(window.Apex.chart.locales));var a=t.filter(function(t){return t.name===e})[0];if(!a)throw new Error("Wrong locale name provided. Please make sure you set the correct locale name in options");var i=Xc.extend(np,a);this.w.globals.locale=i.options}}]),e}(),Ap=function(){function e(t){Rc(this,e),this.ctx=t,this.w=t.w}return Mc(e,[{key:"drawAxis",value:function(e,t){var a,i,s=this,o=this.w.globals,n=this.w.config,r=new Sp(this.ctx,t),l=new Ip(this.ctx,t);o.axisCharts&&"radar"!==e&&(o.isBarHorizontal?(i=l.drawYaxisInversed(0),a=r.drawXaxisInversed(0),o.dom.elGraphical.add(a),o.dom.elGraphical.add(i)):(a=r.drawXaxis(),o.dom.elGraphical.add(a),n.yaxis.map(function(e,t){if(-1===o.ignoreYAxisIndexes.indexOf(t)&&(i=l.drawYaxis(t),o.dom.Paper.add(i),"back"===s.w.config.grid.position)){var a=o.dom.Paper.children()[1];a.remove(),o.dom.Paper.add(a)}})))}}]),e}(),Pp=function(){function e(t){Rc(this,e),this.ctx=t,this.w=t.w}return Mc(e,[{key:"drawXCrosshairs",value:function(){var e=this.w,t=new Ku(this.ctx),a=new Zu(this.ctx),i=e.config.xaxis.crosshairs.fill.gradient,s=e.config.xaxis.crosshairs.dropShadow,o=e.config.xaxis.crosshairs.fill.type,n=i.colorFrom,r=i.colorTo,l=i.opacityFrom,c=i.opacityTo,h=i.stops,d=s.enabled,u=s.left,p=s.top,m=s.blur,g=s.color,f=s.opacity,b=e.config.xaxis.crosshairs.fill.color;if(e.config.xaxis.crosshairs.show){"gradient"===o&&(b=t.drawGradient("vertical",n,r,l,c,null,h,null));var y=t.drawRect();1===e.config.xaxis.crosshairs.width&&(y=t.drawLine());var w=e.globals.gridHeight;(!Xc.isNumber(w)||w<0)&&(w=0);var v=e.config.xaxis.crosshairs.width;(!Xc.isNumber(v)||v<0)&&(v=0),y.attr({class:"apexcharts-xcrosshairs",x:0,y:0,y2:w,width:v,height:w,fill:b,filter:"none","fill-opacity":e.config.xaxis.crosshairs.opacity,stroke:e.config.xaxis.crosshairs.stroke.color,"stroke-width":e.config.xaxis.crosshairs.stroke.width,"stroke-dasharray":e.config.xaxis.crosshairs.stroke.dashArray}),d&&(y=a.dropShadow(y,{left:u,top:p,blur:m,color:g,opacity:f})),e.globals.dom.elGraphical.add(y)}}},{key:"drawYCrosshairs",value:function(){var e=this.w,t=new Ku(this.ctx),a=e.config.yaxis[0].crosshairs,i=e.globals.barPadForNumericAxis;if(e.config.yaxis[0].crosshairs.show){var s=t.drawLine(-i,0,e.globals.gridWidth+i,0,a.stroke.color,a.stroke.dashArray,a.stroke.width);s.attr({class:"apexcharts-ycrosshairs"}),e.globals.dom.elGraphical.add(s)}var o=t.drawLine(-i,0,e.globals.gridWidth+i,0,a.stroke.color,0,0);o.attr({class:"apexcharts-ycrosshairs-hidden"}),e.globals.dom.elGraphical.add(o)}}]),e}(),Rp=function(){function e(t){Rc(this,e),this.ctx=t,this.w=t.w}return Mc(e,[{key:"checkResponsiveConfig",value:function(e){var t=this,a=this.w,i=a.config;if(0!==i.responsive.length){var s=i.responsive.slice();s.sort(function(e,t){return e.breakpoint>t.breakpoint?1:t.breakpoint>e.breakpoint?-1:0}).reverse();var o=new up({}),n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=s[0].breakpoint,n=window.innerWidth>0?window.innerWidth:screen.width;if(n>i){var r=Xc.clone(a.globals.initialConfig);r.series=Xc.clone(a.config.series);var l=Ju.extendArrayProps(o,r,a);e=Xc.extend(l,e),e=Xc.extend(a.config,e),t.overrideResponsiveOptions(e)}else for(var c=0;c<s.length;c++)n<s[c].breakpoint&&(e=Ju.extendArrayProps(o,s[c].options,a),e=Xc.extend(a.config,e),t.overrideResponsiveOptions(e))};if(e){var r=Ju.extendArrayProps(o,e,a);r=Xc.extend(a.config,r),n(r=Xc.extend(r,e))}else n({})}}},{key:"overrideResponsiveOptions",value:function(e){var t=new up(e).init({responsiveOverride:!0});this.w.config=t}}]),e}(),Dp=function(){function e(t){Rc(this,e),this.ctx=t,this.w=t.w,this.colors=[],this.isColorFn=!1,this.isHeatmapDistributed=this.checkHeatmapDistributed(),this.isBarDistributed=this.checkBarDistributed()}return Mc(e,[{key:"checkHeatmapDistributed",value:function(){var e=this.w.config,t=e.chart,a=e.plotOptions;return"treemap"===t.type&&a.treemap&&a.treemap.distributed||"heatmap"===t.type&&a.heatmap&&a.heatmap.distributed}},{key:"checkBarDistributed",value:function(){var e=this.w.config,t=e.chart,a=e.plotOptions;return a.bar&&a.bar.distributed&&("bar"===t.type||"rangeBar"===t.type)}},{key:"init",value:function(){this.setDefaultColors()}},{key:"setDefaultColors",value:function(){var e=this.w,t=new Xc;e.globals.dom.elWrap.classList.add("apexcharts-theme-".concat(e.config.theme.mode||"light"));var a=Vc(e.config.colors||e.config.fill.colors||[]);e.globals.colors=this.getColors(a),this.applySeriesColors(e.globals.seriesColors,e.globals.colors),e.config.theme.monochrome.enabled&&(e.globals.colors=this.getMonochromeColors(e.config.theme.monochrome,e.globals.series,t));var i=e.globals.colors.slice();this.pushExtraColors(e.globals.colors),this.applyColorTypes(["fill","stroke"],i),this.applyDataLabelsColors(i),this.applyRadarPolygonsColors(),this.applyMarkersColors(i)}},{key:"getColors",value:function(e){var t=this,a=this.w;return e&&0!==e.length?Array.isArray(e)&&e.length>0&&"function"==typeof e[0]?(this.isColorFn=!0,a.config.series.map(function(i,s){var o=e[s]||e[0];return"function"==typeof o?o({value:a.globals.axisCharts?a.globals.series[s][0]||0:a.globals.series[s],seriesIndex:s,dataPointIndex:s,w:t.w}):o})):e:this.predefined()}},{key:"applySeriesColors",value:function(e,t){e.forEach(function(e,a){e&&(t[a]=e)})}},{key:"getMonochromeColors",value:function(e,t,a){var i=e.color,s=e.shadeIntensity,o=e.shadeTo,n=this.isBarDistributed||this.isHeatmapDistributed?t[0].length*t.length:t.length,r=1/(n/s),l=0;return Array.from({length:n},function(){var e="dark"===o?a.shadeColor(-1*l,i):a.shadeColor(l,i);return l+=r,e})}},{key:"applyColorTypes",value:function(e,t){var a=this,i=this.w;e.forEach(function(e){i.globals[e].colors=void 0===i.config[e].colors?a.isColorFn?i.config.colors:t:i.config[e].colors.slice(),a.pushExtraColors(i.globals[e].colors)})}},{key:"applyDataLabelsColors",value:function(e){var t=this.w;t.globals.dataLabels.style.colors=void 0===t.config.dataLabels.style.colors?e:t.config.dataLabels.style.colors.slice(),this.pushExtraColors(t.globals.dataLabels.style.colors,50)}},{key:"applyRadarPolygonsColors",value:function(){var e=this.w;e.globals.radarPolygons.fill.colors=void 0===e.config.plotOptions.radar.polygons.fill.colors?["dark"===e.config.theme.mode?"#343A3F":"none"]:e.config.plotOptions.radar.polygons.fill.colors.slice(),this.pushExtraColors(e.globals.radarPolygons.fill.colors,20)}},{key:"applyMarkersColors",value:function(e){var t=this.w;t.globals.markers.colors=void 0===t.config.markers.colors?e:t.config.markers.colors.slice(),this.pushExtraColors(t.globals.markers.colors)}},{key:"pushExtraColors",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=this.w,s=t||i.globals.series.length;if(null===a&&(a=this.isBarDistributed||this.isHeatmapDistributed||"heatmap"===i.config.chart.type&&i.config.plotOptions.heatmap&&i.config.plotOptions.heatmap.colorScale.inverse),a&&i.globals.series.length&&(s=i.globals.series[i.globals.maxValsInArrayIndex].length*i.globals.series.length),e.length<s)for(var o=s-e.length,n=0;n<o;n++)e.push(e[n])}},{key:"updateThemeOptions",value:function(e){e.chart=e.chart||{},e.tooltip=e.tooltip||{};var t=e.theme.mode,a="dark"===t?"palette4":"light"===t?"palette1":e.theme.palette||"palette1",i="dark"===t?"#f6f7f8":"light"===t?"#373d3f":e.chart.foreColor||"#373d3f";return e.tooltip.theme=t||"light",e.chart.foreColor=i,e.theme.palette=a,e}},{key:"predefined",value:function(){var e={palette1:["#008FFB","#00E396","#FEB019","#FF4560","#775DD0"],palette2:["#3f51b5","#03a9f4","#4caf50","#f9ce1d","#FF9800"],palette3:["#33b2df","#546E7A","#d4526e","#13d8aa","#A5978B"],palette4:["#4ecdc4","#c7f464","#81D4FA","#fd6a6a","#546E7A"],palette5:["#2b908f","#f9a3a4","#90ee7e","#fa4443","#69d2e7"],palette6:["#449DD1","#F86624","#EA3546","#662E9B","#C5D86D"],palette7:["#D7263D","#1B998B","#2E294E","#F46036","#E2C044"],palette8:["#662E9B","#F86624","#F9C80E","#EA3546","#43BCCD"],palette9:["#5C4742","#A5978B","#8D5B4C","#5A2A27","#C4BBAF"],palette10:["#A300D6","#7D02EB","#5653FE","#2983FF","#00B1F2"],default:["#008FFB","#00E396","#FEB019","#FF4560","#775DD0"]};return e[this.w.config.theme.palette]||e.default}}]),e}(),Mp=function(){function e(t){Rc(this,e),this.ctx=t,this.w=t.w}return Mc(e,[{key:"draw",value:function(){this.drawTitleSubtitle("title"),this.drawTitleSubtitle("subtitle")}},{key:"drawTitleSubtitle",value:function(e){var t=this.w,a="title"===e?t.config.title:t.config.subtitle,i=t.globals.svgWidth/2,s=a.offsetY,o="middle";if("left"===a.align?(i=10,o="start"):"right"===a.align&&(i=t.globals.svgWidth-10,o="end"),i+=a.offsetX,s=s+parseInt(a.style.fontSize,10)+a.margin/2,void 0!==a.text){var n=new Ku(this.ctx).drawText({x:i,y:s,text:a.text,textAnchor:o,fontSize:a.style.fontSize,fontFamily:a.style.fontFamily,fontWeight:a.style.fontWeight,foreColor:a.style.color,opacity:1});n.node.setAttribute("class","apexcharts-".concat(e,"-text")),t.globals.dom.Paper.add(n)}}}]),e}(),Lp=function(){function e(t){Rc(this,e),this.w=t.w,this.dCtx=t}return Mc(e,[{key:"getTitleSubtitleCoords",value:function(e){var t=this.w,a=0,i=0,s="title"===e?t.config.title.floating:t.config.subtitle.floating,o=t.globals.dom.baseEl.querySelector(".apexcharts-".concat(e,"-text"));if(null!==o&&!s){var n=o.getBoundingClientRect();a=n.width,i=t.globals.axisCharts?n.height+5:n.height}return{width:a,height:i}}},{key:"getLegendsRect",value:function(){var e=this.w,t=e.globals.dom.elLegendWrap;e.config.legend.height||"top"!==e.config.legend.position&&"bottom"!==e.config.legend.position||(t.style.maxHeight=e.globals.svgHeight/2+"px");var a=Object.assign({},Xc.getBoundingClientRect(t));return null!==t&&!e.config.legend.floating&&e.config.legend.show?this.dCtx.lgRect={x:a.x,y:a.y,height:a.height,width:0===a.height?0:a.width}:this.dCtx.lgRect={x:0,y:0,height:0,width:0},"left"!==e.config.legend.position&&"right"!==e.config.legend.position||1.5*this.dCtx.lgRect.width>e.globals.svgWidth&&(this.dCtx.lgRect.width=e.globals.svgWidth/1.5),this.dCtx.lgRect}},{key:"getDatalabelsRect",value:function(){var e=this,t=this.w,a=[];t.config.series.forEach(function(s,o){s.data.forEach(function(s,n){var r;r=t.globals.series[o][n],i=t.config.dataLabels.formatter(r,{ctx:e.dCtx.ctx,seriesIndex:o,dataPointIndex:n,w:t}),a.push(i)})});var i=Xc.getLargestStringFromArr(a),s=new Ku(this.dCtx.ctx),o=t.config.dataLabels.style,n=s.getTextRects(i,parseInt(o.fontSize),o.fontFamily);return{width:1.05*n.width,height:n.height}}},{key:"getLargestStringFromMultiArr",value:function(e,t){var a=e;if(this.w.globals.isMultiLineX){var i=t.map(function(e,t){return Array.isArray(e)?e.length:1}),s=Math.max.apply(Math,Vc(i));a=t[i.indexOf(s)]}return a}}]),e}(),Np=function(){function e(t){Rc(this,e),this.w=t.w,this.dCtx=t}return Mc(e,[{key:"getxAxisLabelsCoords",value:function(){var e,t=this.w,a=t.globals.labels.slice();if(t.config.xaxis.convertedCatToNumeric&&0===a.length&&(a=t.globals.categoryLabels),t.globals.timescaleLabels.length>0){var i=this.getxAxisTimeScaleLabelsCoords();e={width:i.width,height:i.height},t.globals.rotateXLabels=!1}else{this.dCtx.lgWidthForSideLegends="left"!==t.config.legend.position&&"right"!==t.config.legend.position||t.config.legend.floating?0:this.dCtx.lgRect.width;var s=t.globals.xLabelFormatter,o=Xc.getLargestStringFromArr(a),n=this.dCtx.dimHelpers.getLargestStringFromMultiArr(o,a);t.globals.isBarHorizontal&&(n=o=t.globals.yAxisScale[0].result.reduce(function(e,t){return e.length>t.length?e:t},0));var r=new ap(this.dCtx.ctx),l=o;o=r.xLabelFormat(s,o,l,{i:void 0,dateFormatter:new tp(this.dCtx.ctx).formatDate,w:t}),n=r.xLabelFormat(s,n,l,{i:void 0,dateFormatter:new tp(this.dCtx.ctx).formatDate,w:t}),(t.config.xaxis.convertedCatToNumeric&&void 0===o||""===String(o).trim())&&(n=o="1");var c=new Ku(this.dCtx.ctx),h=c.getTextRects(o,t.config.xaxis.labels.style.fontSize),d=h;if(o!==n&&(d=c.getTextRects(n,t.config.xaxis.labels.style.fontSize)),(e={width:h.width>=d.width?h.width:d.width,height:h.height>=d.height?h.height:d.height}).width*a.length>t.globals.svgWidth-this.dCtx.lgWidthForSideLegends-this.dCtx.yAxisWidth-this.dCtx.gridPad.left-this.dCtx.gridPad.right&&0!==t.config.xaxis.labels.rotate||t.config.xaxis.labels.rotateAlways){if(!t.globals.isBarHorizontal){t.globals.rotateXLabels=!0;var u=function(e){return c.getTextRects(e,t.config.xaxis.labels.style.fontSize,t.config.xaxis.labels.style.fontFamily,"rotate(".concat(t.config.xaxis.labels.rotate," 0 0)"),!1)};h=u(o),o!==n&&(d=u(n)),e.height=(h.height>d.height?h.height:d.height)/1.5,e.width=h.width>d.width?h.width:d.width}}else t.globals.rotateXLabels=!1}return t.config.xaxis.labels.show||(e={width:0,height:0}),{width:e.width,height:e.height}}},{key:"getxAxisGroupLabelsCoords",value:function(){var e,t=this.w;if(!t.globals.hasXaxisGroups)return{width:0,height:0};var a,i=(null===(e=t.config.xaxis.group.style)||void 0===e?void 0:e.fontSize)||t.config.xaxis.labels.style.fontSize,s=t.globals.groups.map(function(e){return e.title}),o=Xc.getLargestStringFromArr(s),n=this.dCtx.dimHelpers.getLargestStringFromMultiArr(o,s),r=new Ku(this.dCtx.ctx),l=r.getTextRects(o,i),c=l;return o!==n&&(c=r.getTextRects(n,i)),a={width:l.width>=c.width?l.width:c.width,height:l.height>=c.height?l.height:c.height},t.config.xaxis.labels.show||(a={width:0,height:0}),{width:a.width,height:a.height}}},{key:"getxAxisTitleCoords",value:function(){var e=this.w,t=0,a=0;if(void 0!==e.config.xaxis.title.text){var i=new Ku(this.dCtx.ctx).getTextRects(e.config.xaxis.title.text,e.config.xaxis.title.style.fontSize);t=i.width,a=i.height}return{width:t,height:a}}},{key:"getxAxisTimeScaleLabelsCoords",value:function(){var e,t=this.w;this.dCtx.timescaleLabels=t.globals.timescaleLabels.slice();var a=this.dCtx.timescaleLabels.map(function(e){return e.value}),i=a.reduce(function(e,t){return void 0===e?(console.error("You have possibly supplied invalid Date format. Please supply a valid JavaScript Date"),0):e.length>t.length?e:t},0);return 1.05*(e=new Ku(this.dCtx.ctx).getTextRects(i,t.config.xaxis.labels.style.fontSize)).width*a.length>t.globals.gridWidth&&0!==t.config.xaxis.labels.rotate&&(t.globals.overlappingXLabels=!0),e}},{key:"additionalPaddingXLabels",value:function(e){var t=this,a=this.w,i=a.globals,s=a.config,o=s.xaxis.type,n=e.width;i.skipLastTimelinelabel=!1,i.skipFirstTimelinelabel=!1;var r=a.config.yaxis[0].opposite&&a.globals.isBarHorizontal;s.yaxis.forEach(function(e,l){r?(t.dCtx.gridPad.left<n&&(t.dCtx.xPadLeft=n/2+1),t.dCtx.xPadRight=n/2+1):function(e,r){var l;s.yaxis.length>1&&(l=r,-1!==i.collapsedSeriesIndices.indexOf(l))||function(e){if(t.dCtx.timescaleLabels&&t.dCtx.timescaleLabels.length){var r=t.dCtx.timescaleLabels[0],l=t.dCtx.timescaleLabels[t.dCtx.timescaleLabels.length-1].position+n/1.75-t.dCtx.yAxisWidthRight,c=r.position-n/1.75+t.dCtx.yAxisWidthLeft,h="right"===a.config.legend.position&&t.dCtx.lgRect.width>0?t.dCtx.lgRect.width:0;l>i.svgWidth-i.translateX-h&&(i.skipLastTimelinelabel=!0),c<-(e.show&&!e.floating||"bar"!==s.chart.type&&"candlestick"!==s.chart.type&&"rangeBar"!==s.chart.type&&"boxPlot"!==s.chart.type?10:n/1.75)&&(i.skipFirstTimelinelabel=!0)}else"datetime"===o?t.dCtx.gridPad.right<n&&!i.rotateXLabels&&(i.skipLastTimelinelabel=!0):"datetime"!==o&&t.dCtx.gridPad.right<n/2-t.dCtx.yAxisWidthRight&&!i.rotateXLabels&&!a.config.xaxis.labels.trim&&(t.dCtx.xPadRight=n/2+1)}(e)}(e,l)})}}]),e}(),Op=function(){function e(t){Rc(this,e),this.w=t.w,this.dCtx=t}return Mc(e,[{key:"getyAxisLabelsCoords",value:function(){var e=this,t=this.w,a=[],i=10,s=new ip(this.dCtx.ctx);return t.config.yaxis.map(function(o,n){var r={seriesIndex:n,dataPointIndex:-1,w:t},l=t.globals.yAxisScale[n],c=0;if(!s.isYAxisHidden(n)&&o.labels.show&&void 0!==o.labels.minWidth&&(c=o.labels.minWidth),!s.isYAxisHidden(n)&&o.labels.show&&l.result.length){var h=t.globals.yLabelFormatters[n],d=l.niceMin===Number.MIN_VALUE?0:l.niceMin,u=l.result.reduce(function(e,t){var a,i;return(null===(a=String(h(e,r)))||void 0===a?void 0:a.length)>(null===(i=String(h(t,r)))||void 0===i?void 0:i.length)?e:t},d),p=u=h(u,r);if(void 0!==u&&0!==u.length||(u=l.niceMax),t.globals.isBarHorizontal){i=0;var m=t.globals.labels.slice();u=Xc.getLargestStringFromArr(m),u=h(u,{seriesIndex:n,dataPointIndex:-1,w:t}),p=e.dCtx.dimHelpers.getLargestStringFromMultiArr(u,m)}var g=new Ku(e.dCtx.ctx),f="rotate(".concat(o.labels.rotate," 0 0)"),b=g.getTextRects(u,o.labels.style.fontSize,o.labels.style.fontFamily,f,!1),y=b;u!==p&&(y=g.getTextRects(p,o.labels.style.fontSize,o.labels.style.fontFamily,f,!1)),a.push({width:(c>y.width||c>b.width?c:y.width>b.width?y.width:b.width)+i,height:y.height>b.height?y.height:b.height})}else a.push({width:0,height:0})}),a}},{key:"getyAxisTitleCoords",value:function(){var e=this,t=this.w,a=[];return t.config.yaxis.map(function(t,i){if(t.show&&void 0!==t.title.text){var s=new Ku(e.dCtx.ctx),o="rotate(".concat(t.title.rotate," 0 0)"),n=s.getTextRects(t.title.text,t.title.style.fontSize,t.title.style.fontFamily,o,!1);a.push({width:n.width,height:n.height})}else a.push({width:0,height:0})}),a}},{key:"getTotalYAxisWidth",value:function(){var e=this.w,t=0,a=0,i=0,s=e.globals.yAxisScale.length>1?10:0,o=new ip(this.dCtx.ctx),n=function(n,r){var l,c=e.config.yaxis[r].floating,h=0;n.width>0&&!c?(h=n.width+s,l=r,e.globals.ignoreYAxisIndexes.indexOf(l)>-1&&(h=h-n.width-s)):h=c||o.isYAxisHidden(r)?0:5,e.config.yaxis[r].opposite?i+=h:a+=h,t+=h};return e.globals.yLabelsCoords.map(function(e,t){n(e,t)}),e.globals.yTitleCoords.map(function(e,t){n(e,t)}),e.globals.isBarHorizontal&&!e.config.yaxis[0].floating&&(t=e.globals.yLabelsCoords[0].width+e.globals.yTitleCoords[0].width+15),this.dCtx.yAxisWidthLeft=a,this.dCtx.yAxisWidthRight=i,t}}]),e}(),Gp=function(){function e(t){Rc(this,e),this.w=t.w,this.dCtx=t}return Mc(e,[{key:"gridPadForColumnsInNumericAxis",value:function(e){var t=this.w,a=t.config,i=t.globals;if(i.noData||i.collapsedSeries.length+i.ancillaryCollapsedSeries.length===a.series.length)return 0;var s=function(e){return["bar","rangeBar","candlestick","boxPlot"].includes(e)},o=a.chart.type,n=0,r=s(o)?a.series.length:1;i.comboBarCount>0&&(r=i.comboBarCount),i.collapsedSeries.forEach(function(e){s(e.type)&&(r-=1)}),a.chart.stacked&&(r=1);var l=s(o)||i.comboBarCount>0,c=Math.abs(i.initialMaxX-i.initialMinX);if(l&&i.isXNumeric&&!i.isBarHorizontal&&r>0&&0!==c){c<=3&&(c=i.dataPoints);var h=c/e,d=i.minXDiff&&i.minXDiff/h>0?i.minXDiff/h:0;d>e/2&&(d/=2),(n=d*parseInt(a.plotOptions.bar.columnWidth,10)/100)<1&&(n=1),i.barPadForNumericAxis=n}return n}},{key:"gridPadFortitleSubtitle",value:function(){var e=this,t=this.w,a=t.globals,i=this.dCtx.isSparkline||!a.axisCharts?0:10;["title","subtitle"].forEach(function(s){void 0!==t.config[s].text?i+=t.config[s].margin:i+=e.dCtx.isSparkline||!a.axisCharts?0:5}),!t.config.legend.show||"bottom"!==t.config.legend.position||t.config.legend.floating||a.axisCharts||(i+=10);var s=this.dCtx.dimHelpers.getTitleSubtitleCoords("title"),o=this.dCtx.dimHelpers.getTitleSubtitleCoords("subtitle");a.gridHeight-=s.height+o.height+i,a.translateY+=s.height+o.height+i}},{key:"setGridXPosForDualYAxis",value:function(e,t){var a=this.w,i=new ip(this.dCtx.ctx);a.config.yaxis.forEach(function(s,o){-1!==a.globals.ignoreYAxisIndexes.indexOf(o)||s.floating||i.isYAxisHidden(o)||(s.opposite&&(a.globals.translateX-=t[o].width+e[o].width+parseInt(s.labels.style.fontSize,10)/1.2+12),a.globals.translateX<2&&(a.globals.translateX=2))})}}]),e}(),zp=function(){function e(t){Rc(this,e),this.ctx=t,this.w=t.w,this.lgRect={},this.yAxisWidth=0,this.yAxisWidthLeft=0,this.yAxisWidthRight=0,this.xAxisHeight=0,this.isSparkline=this.w.config.chart.sparkline.enabled,this.dimHelpers=new Lp(this),this.dimYAxis=new Op(this),this.dimXAxis=new Np(this),this.dimGrid=new Gp(this),this.lgWidthForSideLegends=0,this.gridPad=this.w.config.grid.padding,this.xPadRight=0,this.xPadLeft=0}return Mc(e,[{key:"plotCoords",value:function(){var e=this,t=this.w,a=t.globals;this.lgRect=this.dimHelpers.getLegendsRect(),this.datalabelsCoords={width:0,height:0};var i=Array.isArray(t.config.stroke.width)?Math.max.apply(Math,Vc(t.config.stroke.width)):t.config.stroke.width;this.isSparkline&&((t.config.markers.discrete.length>0||t.config.markers.size>0)&&Object.entries(this.gridPad).forEach(function(t){var a=Wc(t,2),i=a[0],s=a[1];e.gridPad[i]=Math.max(s,e.w.globals.markers.largestSize/1.5)}),this.gridPad.top=Math.max(i/2,this.gridPad.top),this.gridPad.bottom=Math.max(i/2,this.gridPad.bottom)),a.axisCharts?this.setDimensionsForAxisCharts():this.setDimensionsForNonAxisCharts(),this.dimGrid.gridPadFortitleSubtitle(),a.gridHeight=a.gridHeight-this.gridPad.top-this.gridPad.bottom,a.gridWidth=a.gridWidth-this.gridPad.left-this.gridPad.right-this.xPadRight-this.xPadLeft;var s=this.dimGrid.gridPadForColumnsInNumericAxis(a.gridWidth);a.gridWidth=a.gridWidth-2*s,a.translateX=a.translateX+this.gridPad.left+this.xPadLeft+(s>0?s:0),a.translateY=a.translateY+this.gridPad.top}},{key:"setDimensionsForAxisCharts",value:function(){var e=this,t=this.w,a=t.globals,i=this.dimYAxis.getyAxisLabelsCoords(),s=this.dimYAxis.getyAxisTitleCoords();a.isSlopeChart&&(this.datalabelsCoords=this.dimHelpers.getDatalabelsRect()),t.globals.yLabelsCoords=[],t.globals.yTitleCoords=[],t.config.yaxis.map(function(e,a){t.globals.yLabelsCoords.push({width:i[a].width,index:a}),t.globals.yTitleCoords.push({width:s[a].width,index:a})}),this.yAxisWidth=this.dimYAxis.getTotalYAxisWidth();var o=this.dimXAxis.getxAxisLabelsCoords(),n=this.dimXAxis.getxAxisGroupLabelsCoords(),r=this.dimXAxis.getxAxisTitleCoords();this.conditionalChecksForAxisCoords(o,r,n),a.translateXAxisY=t.globals.rotateXLabels?this.xAxisHeight/8:-4,a.translateXAxisX=t.globals.rotateXLabels&&t.globals.isXNumeric&&t.config.xaxis.labels.rotate<=-45?-this.xAxisWidth/4:0,t.globals.isBarHorizontal&&(a.rotateXLabels=!1,a.translateXAxisY=parseInt(t.config.xaxis.labels.style.fontSize,10)/1.5*-1),a.translateXAxisY=a.translateXAxisY+t.config.xaxis.labels.offsetY,a.translateXAxisX=a.translateXAxisX+t.config.xaxis.labels.offsetX;var l=this.yAxisWidth,c=this.xAxisHeight;a.xAxisLabelsHeight=this.xAxisHeight-r.height,a.xAxisGroupLabelsHeight=a.xAxisLabelsHeight-o.height,a.xAxisLabelsWidth=this.xAxisWidth,a.xAxisHeight=this.xAxisHeight;var h=10;("radar"===t.config.chart.type||this.isSparkline)&&(l=0,c=0),this.isSparkline&&(this.lgRect={height:0,width:0}),(this.isSparkline||"treemap"===t.config.chart.type)&&(l=0,c=0,h=0),this.isSparkline||"treemap"===t.config.chart.type||this.dimXAxis.additionalPaddingXLabels(o);var d=function(){a.translateX=l+e.datalabelsCoords.width,a.gridHeight=a.svgHeight-e.lgRect.height-c-(e.isSparkline||"treemap"===t.config.chart.type?0:t.globals.rotateXLabels?10:15),a.gridWidth=a.svgWidth-l-2*e.datalabelsCoords.width};switch("top"===t.config.xaxis.position&&(h=a.xAxisHeight-t.config.xaxis.axisTicks.height-5),t.config.legend.position){case"bottom":a.translateY=h,d();break;case"top":a.translateY=this.lgRect.height+h,d();break;case"left":a.translateY=h,a.translateX=this.lgRect.width+l+this.datalabelsCoords.width,a.gridHeight=a.svgHeight-c-12,a.gridWidth=a.svgWidth-this.lgRect.width-l-2*this.datalabelsCoords.width;break;case"right":a.translateY=h,a.translateX=l+this.datalabelsCoords.width,a.gridHeight=a.svgHeight-c-12,a.gridWidth=a.svgWidth-this.lgRect.width-l-2*this.datalabelsCoords.width-5;break;default:throw new Error("Legend position not supported")}this.dimGrid.setGridXPosForDualYAxis(s,i),new Ip(this.ctx).setYAxisXPosition(i,s)}},{key:"setDimensionsForNonAxisCharts",value:function(){var e=this.w,t=e.globals,a=e.config,i=0;e.config.legend.show&&!e.config.legend.floating&&(i=20);var s="pie"===a.chart.type||"polarArea"===a.chart.type||"donut"===a.chart.type?"pie":"radialBar",o=a.plotOptions[s].offsetY,n=a.plotOptions[s].offsetX;if(!a.legend.show||a.legend.floating){t.gridHeight=t.svgHeight;var r=t.dom.elWrap.getBoundingClientRect().width;return t.gridWidth=Math.min(r,t.gridHeight),t.translateY=o,void(t.translateX=n+(t.svgWidth-t.gridWidth)/2)}switch(a.legend.position){case"bottom":t.gridHeight=t.svgHeight-this.lgRect.height,t.gridWidth=t.svgWidth,t.translateY=o-10,t.translateX=n+(t.svgWidth-t.gridWidth)/2;break;case"top":t.gridHeight=t.svgHeight-this.lgRect.height,t.gridWidth=t.svgWidth,t.translateY=this.lgRect.height+o+10,t.translateX=n+(t.svgWidth-t.gridWidth)/2;break;case"left":t.gridWidth=t.svgWidth-this.lgRect.width-i,t.gridHeight="auto"!==a.chart.height?t.svgHeight:t.gridWidth,t.translateY=o,t.translateX=n+this.lgRect.width+i;break;case"right":t.gridWidth=t.svgWidth-this.lgRect.width-i-5,t.gridHeight="auto"!==a.chart.height?t.svgHeight:t.gridWidth,t.translateY=o,t.translateX=n+10;break;default:throw new Error("Legend position not supported")}}},{key:"conditionalChecksForAxisCoords",value:function(e,t,a){var i=this.w,s=i.globals.hasXaxisGroups?2:1,o=a.height+e.height+t.height,n=i.globals.isMultiLineX?1.2:i.globals.LINE_HEIGHT_RATIO,r=i.globals.rotateXLabels?22:10,l=i.globals.rotateXLabels&&"bottom"===i.config.legend.position?10:0;this.xAxisHeight=o*n+s*r+l,this.xAxisWidth=e.width,this.xAxisHeight-t.height>i.config.xaxis.labels.maxHeight&&(this.xAxisHeight=i.config.xaxis.labels.maxHeight),i.config.xaxis.labels.minHeight&&this.xAxisHeight<i.config.xaxis.labels.minHeight&&(this.xAxisHeight=i.config.xaxis.labels.minHeight),i.config.xaxis.floating&&(this.xAxisHeight=0);var c=0,h=0;i.config.yaxis.forEach(function(e){c+=e.labels.minWidth,h+=e.labels.maxWidth}),this.yAxisWidth<c&&(this.yAxisWidth=c),this.yAxisWidth>h&&(this.yAxisWidth=h)}}]),e}(),Fp=function(){function e(t){Rc(this,e),this.w=t.w,this.lgCtx=t}return Mc(e,[{key:"getLegendStyles",value:function(){var e,t,a,i=document.createElement("style");i.setAttribute("type","text/css");var s=(null===(e=this.lgCtx.ctx)||void 0===e||null===(t=e.opts)||void 0===t||null===(a=t.chart)||void 0===a?void 0:a.nonce)||this.w.config.chart.nonce;s&&i.setAttribute("nonce",s);var o=document.createTextNode("\n      .apexcharts-flip-y {\n        transform: scaleY(-1) translateY(-100%);\n        transform-origin: top;\n        transform-box: fill-box;\n      }\n      .apexcharts-flip-x {\n        transform: scaleX(-1);\n        transform-origin: center;\n        transform-box: fill-box;\n      }\n      .apexcharts-legend {\n        display: flex;\n        overflow: auto;\n        padding: 0 10px;\n      }\n      .apexcharts-legend.apexcharts-legend-group-horizontal {\n        flex-direction: column;\n      }\n      .apexcharts-legend-group {\n        display: flex;\n      }\n      .apexcharts-legend-group-vertical {\n        flex-direction: column-reverse;\n      }\n      .apexcharts-legend.apx-legend-position-bottom, .apexcharts-legend.apx-legend-position-top {\n        flex-wrap: wrap\n      }\n      .apexcharts-legend.apx-legend-position-right, .apexcharts-legend.apx-legend-position-left {\n        flex-direction: column;\n        bottom: 0;\n      }\n      .apexcharts-legend.apx-legend-position-bottom.apexcharts-align-left, .apexcharts-legend.apx-legend-position-top.apexcharts-align-left, .apexcharts-legend.apx-legend-position-right, .apexcharts-legend.apx-legend-position-left {\n        justify-content: flex-start;\n        align-items: flex-start;\n      }\n      .apexcharts-legend.apx-legend-position-bottom.apexcharts-align-center, .apexcharts-legend.apx-legend-position-top.apexcharts-align-center {\n        justify-content: center;\n        align-items: center;\n      }\n      .apexcharts-legend.apx-legend-position-bottom.apexcharts-align-right, .apexcharts-legend.apx-legend-position-top.apexcharts-align-right {\n        justify-content: flex-end;\n        align-items: flex-end;\n      }\n      .apexcharts-legend-series {\n        cursor: pointer;\n        line-height: normal;\n        display: flex;\n        align-items: center;\n      }\n      .apexcharts-legend-text {\n        position: relative;\n        font-size: 14px;\n      }\n      .apexcharts-legend-text *, .apexcharts-legend-marker * {\n        pointer-events: none;\n      }\n      .apexcharts-legend-marker {\n        position: relative;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        cursor: pointer;\n        margin-right: 1px;\n      }\n\n      .apexcharts-legend-series.apexcharts-no-click {\n        cursor: auto;\n      }\n      .apexcharts-legend .apexcharts-hidden-zero-series, .apexcharts-legend .apexcharts-hidden-null-series {\n        display: none !important;\n      }\n      .apexcharts-inactive-legend {\n        opacity: 0.45;\n      }\n\n    ");return i.appendChild(o),i}},{key:"getLegendDimensions",value:function(){var e=this.w.globals.dom.baseEl.querySelector(".apexcharts-legend").getBoundingClientRect(),t=e.width;return{clwh:e.height,clww:t}}},{key:"appendToForeignObject",value:function(){this.w.globals.dom.elLegendForeign.appendChild(this.getLegendStyles())}},{key:"toggleDataSeries",value:function(e,t){var a=this,i=this.w;if(i.globals.axisCharts||"radialBar"===i.config.chart.type){i.globals.resized=!0;var s=null,o=null;i.globals.risingSeries=[],i.globals.axisCharts?(s=i.globals.dom.baseEl.querySelector(".apexcharts-series[data\\:realIndex='".concat(e,"']")),o=parseInt(s.getAttribute("data:realIndex"),10)):(s=i.globals.dom.baseEl.querySelector(".apexcharts-series[rel='".concat(e+1,"']")),o=parseInt(s.getAttribute("rel"),10)-1),t?[{cs:i.globals.collapsedSeries,csi:i.globals.collapsedSeriesIndices},{cs:i.globals.ancillaryCollapsedSeries,csi:i.globals.ancillaryCollapsedSeriesIndices}].forEach(function(e){a.riseCollapsedSeries(e.cs,e.csi,o)}):this.hideSeries({seriesEl:s,realIndex:o})}else{var n=i.globals.dom.Paper.findOne(" .apexcharts-series[rel='".concat(e+1,"'] path")),r=i.config.chart.type;if("pie"===r||"polarArea"===r||"donut"===r){var l=i.config.plotOptions.pie.donut.labels;new Ku(this.lgCtx.ctx).pathMouseDown(n,null),this.lgCtx.ctx.pie.printDataLabelsInner(n.node,l)}n.fire("click")}}},{key:"getSeriesAfterCollapsing",value:function(e){var t=e.realIndex,a=this.w,i=a.globals,s=Xc.clone(a.config.series);if(i.axisCharts){var o=a.config.yaxis[i.seriesYAxisReverseMap[t]],n={index:t,data:s[t].data.slice(),type:s[t].type||a.config.chart.type};if(o&&o.show&&o.showAlways)i.ancillaryCollapsedSeriesIndices.indexOf(t)<0&&(i.ancillaryCollapsedSeries.push(n),i.ancillaryCollapsedSeriesIndices.push(t));else if(i.collapsedSeriesIndices.indexOf(t)<0){i.collapsedSeries.push(n),i.collapsedSeriesIndices.push(t);var r=i.risingSeries.indexOf(t);i.risingSeries.splice(r,1)}}else i.collapsedSeries.push({index:t,data:s[t]}),i.collapsedSeriesIndices.push(t);return i.allSeriesCollapsed=i.collapsedSeries.length+i.ancillaryCollapsedSeries.length===a.config.series.length,this._getSeriesBasedOnCollapsedState(s)}},{key:"hideSeries",value:function(e){for(var t=e.seriesEl,a=e.realIndex,i=this.w,s=this.getSeriesAfterCollapsing({realIndex:a}),o=t.childNodes,n=0;n<o.length;n++)o[n].classList.contains("apexcharts-series-markers-wrap")&&(o[n].classList.contains("apexcharts-hide")?o[n].classList.remove("apexcharts-hide"):o[n].classList.add("apexcharts-hide"));this.lgCtx.ctx.updateHelpers._updateSeries(s,i.config.chart.animations.dynamicAnimation.enabled)}},{key:"riseCollapsedSeries",value:function(e,t,a){var i=this.w,s=Xc.clone(i.config.series);if(e.length>0){for(var o=0;o<e.length;o++)e[o].index===a&&(i.globals.axisCharts?s[a].data=e[o].data.slice():s[a]=e[o].data,"number"!=typeof s[a]&&(s[a].hidden=!1),e.splice(o,1),t.splice(o,1),i.globals.risingSeries.push(a));s=this._getSeriesBasedOnCollapsedState(s),this.lgCtx.ctx.updateHelpers._updateSeries(s,i.config.chart.animations.dynamicAnimation.enabled)}}},{key:"_getSeriesBasedOnCollapsedState",value:function(e){var t=this.w,a=0;return t.globals.axisCharts?e.forEach(function(i,s){t.globals.collapsedSeriesIndices.indexOf(s)<0&&t.globals.ancillaryCollapsedSeriesIndices.indexOf(s)<0||(e[s].data=[],a++)}):e.forEach(function(i,s){!t.globals.collapsedSeriesIndices.indexOf(s)<0&&(e[s]=0,a++)}),t.globals.allSeriesCollapsed=a===e.length,e}}]),e}(),Hp=function(){function e(t){Rc(this,e),this.ctx=t,this.w=t.w,this.onLegendClick=this.onLegendClick.bind(this),this.onLegendHovered=this.onLegendHovered.bind(this),this.isBarsDistributed="bar"===this.w.config.chart.type&&this.w.config.plotOptions.bar.distributed&&1===this.w.config.series.length,this.legendHelpers=new Fp(this)}return Mc(e,[{key:"init",value:function(){var e=this.w,t=e.globals,a=e.config,i=a.legend.showForSingleSeries&&1===t.series.length||this.isBarsDistributed||t.series.length>1;if(this.legendHelpers.appendToForeignObject(),(i||!t.axisCharts)&&a.legend.show){for(;t.dom.elLegendWrap.firstChild;)t.dom.elLegendWrap.removeChild(t.dom.elLegendWrap.firstChild);this.drawLegends(),"bottom"===a.legend.position||"top"===a.legend.position?this.legendAlignHorizontal():"right"!==a.legend.position&&"left"!==a.legend.position||this.legendAlignVertical()}}},{key:"createLegendMarker",value:function(e){var t=e.i,a=e.fillcolor,i=this.w,s=document.createElement("span");s.classList.add("apexcharts-legend-marker");var o=i.config.legend.markers.shape||i.config.markers.shape,n=o;Array.isArray(o)&&(n=o[t]);var r=Array.isArray(i.config.legend.markers.size)?parseFloat(i.config.legend.markers.size[t]):parseFloat(i.config.legend.markers.size),l=Array.isArray(i.config.legend.markers.offsetX)?parseFloat(i.config.legend.markers.offsetX[t]):parseFloat(i.config.legend.markers.offsetX),c=Array.isArray(i.config.legend.markers.offsetY)?parseFloat(i.config.legend.markers.offsetY[t]):parseFloat(i.config.legend.markers.offsetY),h=Array.isArray(i.config.legend.markers.strokeWidth)?parseFloat(i.config.legend.markers.strokeWidth[t]):parseFloat(i.config.legend.markers.strokeWidth),d=s.style;if(d.height=2*(r+h)+"px",d.width=2*(r+h)+"px",d.left=l+"px",d.top=c+"px",i.config.legend.markers.customHTML)d.background="transparent",d.color=a[t],Array.isArray(i.config.legend.markers.customHTML)?i.config.legend.markers.customHTML[t]&&(s.innerHTML=i.config.legend.markers.customHTML[t]()):s.innerHTML=i.config.legend.markers.customHTML();else{var u=new fp(this.ctx).getMarkerConfig({cssClass:"apexcharts-legend-marker apexcharts-marker apexcharts-marker-".concat(n),seriesIndex:t,strokeWidth:h,size:r}),p=window.SVG().addTo(s).size("100%","100%"),m=new Ku(this.ctx).drawMarker(0,0,Uc(Uc({},u),{},{pointFillColor:Array.isArray(a)?a[t]:u.pointFillColor,shape:n}));i.globals.dom.Paper.find(".apexcharts-legend-marker.apexcharts-marker").forEach(function(e){e.node.classList.contains("apexcharts-marker-triangle")?e.node.style.transform="translate(50%, 45%)":e.node.style.transform="translate(50%, 50%)"}),p.add(m)}return s}},{key:"drawLegends",value:function(){var e=this,t=this,a=this.w,i=a.config.legend.fontFamily,s=a.globals.seriesNames,o=a.config.legend.markers.fillColors?a.config.legend.markers.fillColors.slice():a.globals.colors.slice();if("heatmap"===a.config.chart.type){var n=a.config.plotOptions.heatmap.colorScale.ranges;s=n.map(function(e){return e.name?e.name:e.from+" - "+e.to}),o=n.map(function(e){return e.color})}else this.isBarsDistributed&&(s=a.globals.labels.slice());a.config.legend.customLegendItems.length&&(s=a.config.legend.customLegendItems);var r=a.globals.legendFormatter,l=a.config.legend.inverseOrder,c=[];a.globals.seriesGroups.length>1&&a.config.legend.clusterGroupedSeries&&a.globals.seriesGroups.forEach(function(e,t){c[t]=document.createElement("div"),c[t].classList.add("apexcharts-legend-group","apexcharts-legend-group-".concat(t)),"horizontal"===a.config.legend.clusterGroupedSeriesOrientation?a.globals.dom.elLegendWrap.classList.add("apexcharts-legend-group-horizontal"):c[t].classList.add("apexcharts-legend-group-vertical")});for(var h=function(t){var n,l=r(s[t],{seriesIndex:t,w:a}),h=!1,d=!1;if(a.globals.collapsedSeries.length>0)for(var u=0;u<a.globals.collapsedSeries.length;u++)a.globals.collapsedSeries[u].index===t&&(h=!0);if(a.globals.ancillaryCollapsedSeriesIndices.length>0)for(var p=0;p<a.globals.ancillaryCollapsedSeriesIndices.length;p++)a.globals.ancillaryCollapsedSeriesIndices[p]===t&&(d=!0);var m=e.createLegendMarker({i:t,fillcolor:o});Ku.setAttrs(m,{rel:t+1,"data:collapsed":h||d}),(h||d)&&m.classList.add("apexcharts-inactive-legend");var g=document.createElement("div"),f=document.createElement("span");f.classList.add("apexcharts-legend-text"),f.innerHTML=Array.isArray(l)?l.join(" "):l;var b=a.config.legend.labels.useSeriesColors?a.globals.colors[t]:Array.isArray(a.config.legend.labels.colors)?null===(n=a.config.legend.labels.colors)||void 0===n?void 0:n[t]:a.config.legend.labels.colors;b||(b=a.config.chart.foreColor),f.style.color=b,f.style.fontSize=parseFloat(a.config.legend.fontSize)+"px",f.style.fontWeight=a.config.legend.fontWeight,f.style.fontFamily=i||a.config.chart.fontFamily,Ku.setAttrs(f,{rel:t+1,i:t,"data:default-text":encodeURIComponent(l),"data:collapsed":h||d}),g.appendChild(m),g.appendChild(f);var y=new Ju(e.ctx);a.config.legend.showForZeroSeries||0===y.getSeriesTotalByIndex(t)&&y.seriesHaveSameValues(t)&&!y.isSeriesNull(t)&&-1===a.globals.collapsedSeriesIndices.indexOf(t)&&-1===a.globals.ancillaryCollapsedSeriesIndices.indexOf(t)&&g.classList.add("apexcharts-hidden-zero-series"),a.config.legend.showForNullSeries||y.isSeriesNull(t)&&-1===a.globals.collapsedSeriesIndices.indexOf(t)&&-1===a.globals.ancillaryCollapsedSeriesIndices.indexOf(t)&&g.classList.add("apexcharts-hidden-null-series"),c.length?a.globals.seriesGroups.forEach(function(e,i){var s;e.includes(null===(s=a.config.series[t])||void 0===s?void 0:s.name)&&(a.globals.dom.elLegendWrap.appendChild(c[i]),c[i].appendChild(g))}):a.globals.dom.elLegendWrap.appendChild(g),a.globals.dom.elLegendWrap.classList.add("apexcharts-align-".concat(a.config.legend.horizontalAlign)),a.globals.dom.elLegendWrap.classList.add("apx-legend-position-"+a.config.legend.position),g.classList.add("apexcharts-legend-series"),g.style.margin="".concat(a.config.legend.itemMargin.vertical,"px ").concat(a.config.legend.itemMargin.horizontal,"px"),a.globals.dom.elLegendWrap.style.width=a.config.legend.width?a.config.legend.width+"px":"",a.globals.dom.elLegendWrap.style.height=a.config.legend.height?a.config.legend.height+"px":"",Ku.setAttrs(g,{rel:t+1,seriesName:Xc.escapeString(s[t]),"data:collapsed":h||d}),(h||d)&&g.classList.add("apexcharts-inactive-legend"),a.config.legend.onItemClick.toggleDataSeries||g.classList.add("apexcharts-no-click")},d=l?s.length-1:0;l?d>=0:d<=s.length-1;l?d--:d++)h(d);a.globals.dom.elWrap.addEventListener("click",t.onLegendClick,!0),a.config.legend.onItemHover.highlightDataSeries&&0===a.config.legend.customLegendItems.length&&(a.globals.dom.elWrap.addEventListener("mousemove",t.onLegendHovered,!0),a.globals.dom.elWrap.addEventListener("mouseout",t.onLegendHovered,!0))}},{key:"setLegendWrapXY",value:function(e,t){var a=this.w,i=a.globals.dom.elLegendWrap,s=i.clientHeight,o=0,n=0;if("bottom"===a.config.legend.position)n=a.globals.svgHeight-Math.min(s,a.globals.svgHeight/2)-5;else if("top"===a.config.legend.position){var r=new zp(this.ctx),l=r.dimHelpers.getTitleSubtitleCoords("title").height,c=r.dimHelpers.getTitleSubtitleCoords("subtitle").height;n=(l>0?l-10:0)+(c>0?c-10:0)}i.style.position="absolute",o=o+e+a.config.legend.offsetX,n=n+t+a.config.legend.offsetY,i.style.left=o+"px",i.style.top=n+"px","right"===a.config.legend.position&&(i.style.left="auto",i.style.right=25+a.config.legend.offsetX+"px"),["width","height"].forEach(function(e){i.style[e]&&(i.style[e]=parseInt(a.config.legend[e],10)+"px")})}},{key:"legendAlignHorizontal",value:function(){var e=this.w;e.globals.dom.elLegendWrap.style.right=0;var t=new zp(this.ctx),a=t.dimHelpers.getTitleSubtitleCoords("title"),i=t.dimHelpers.getTitleSubtitleCoords("subtitle"),s=0;"top"===e.config.legend.position&&(s=a.height+i.height+e.config.title.margin+e.config.subtitle.margin-10),this.setLegendWrapXY(20,s)}},{key:"legendAlignVertical",value:function(){var e=this.w,t=this.legendHelpers.getLegendDimensions(),a=0;"left"===e.config.legend.position&&(a=20),"right"===e.config.legend.position&&(a=e.globals.svgWidth-t.clww-10),this.setLegendWrapXY(a,20)}},{key:"onLegendHovered",value:function(e){var t=this.w,a=e.target.classList.contains("apexcharts-legend-series")||e.target.classList.contains("apexcharts-legend-text")||e.target.classList.contains("apexcharts-legend-marker");if("heatmap"===t.config.chart.type||this.isBarsDistributed){if(a){var i=parseInt(e.target.getAttribute("rel"),10)-1;this.ctx.events.fireEvent("legendHover",[this.ctx,i,this.w]),new wp(this.ctx).highlightRangeInSeries(e,e.target)}}else!e.target.classList.contains("apexcharts-inactive-legend")&&a&&new wp(this.ctx).toggleSeriesOnHover(e,e.target)}},{key:"onLegendClick",value:function(e){var t=this.w;if(!t.config.legend.customLegendItems.length&&(e.target.classList.contains("apexcharts-legend-series")||e.target.classList.contains("apexcharts-legend-text")||e.target.classList.contains("apexcharts-legend-marker"))){var a=parseInt(e.target.getAttribute("rel"),10)-1,i="true"===e.target.getAttribute("data:collapsed"),s=this.w.config.chart.events.legendClick;"function"==typeof s&&s(this.ctx,a,this.w),this.ctx.events.fireEvent("legendClick",[this.ctx,a,this.w]);var o=this.w.config.legend.markers.onClick;"function"==typeof o&&e.target.classList.contains("apexcharts-legend-marker")&&(o(this.ctx,a,this.w),this.ctx.events.fireEvent("legendMarkerClick",[this.ctx,a,this.w])),"treemap"!==t.config.chart.type&&"heatmap"!==t.config.chart.type&&!this.isBarsDistributed&&t.config.legend.onItemClick.toggleDataSeries&&this.legendHelpers.toggleDataSeries(a,i)}}}]),e}(),Up=function(){function e(t){Rc(this,e),this.ctx=t,this.w=t.w;var a=this.w;this.ev=this.w.config.chart.events,this.selectedClass="apexcharts-selected",this.localeValues=this.w.globals.locale.toolbar,this.minX=a.globals.minX,this.maxX=a.globals.maxX}return Mc(e,[{key:"createToolbar",value:function(){var e=this,t=this.w,a=function(){return document.createElement("div")},i=a();if(i.setAttribute("class","apexcharts-toolbar"),i.style.top=t.config.chart.toolbar.offsetY+"px",i.style.right=3-t.config.chart.toolbar.offsetX+"px",t.globals.dom.elWrap.appendChild(i),this.elZoom=a(),this.elZoomIn=a(),this.elZoomOut=a(),this.elPan=a(),this.elSelection=a(),this.elZoomReset=a(),this.elMenuIcon=a(),this.elMenu=a(),this.elCustomIcons=[],this.t=t.config.chart.toolbar.tools,Array.isArray(this.t.customIcons))for(var s=0;s<this.t.customIcons.length;s++)this.elCustomIcons.push(a());var o=[],n=function(a,i,s){var n=a.toLowerCase();e.t[n]&&t.config.chart.zoom.enabled&&o.push({el:i,icon:"string"==typeof e.t[n]?e.t[n]:s,title:e.localeValues[a],class:"apexcharts-".concat(n,"-icon")})};n("zoomIn",this.elZoomIn,'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">\n    <path d="M0 0h24v24H0z" fill="none"/>\n    <path d="M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4V7zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/>\n</svg>\n'),n("zoomOut",this.elZoomOut,'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">\n    <path d="M0 0h24v24H0z" fill="none"/>\n    <path d="M7 11v2h10v-2H7zm5-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/>\n</svg>\n');var r=function(a){e.t[a]&&t.config.chart[a].enabled&&o.push({el:"zoom"===a?e.elZoom:e.elSelection,icon:"string"==typeof e.t[a]?e.t[a]:"zoom"===a?'<svg xmlns="http://www.w3.org/2000/svg" fill="#000000" height="24" viewBox="0 0 24 24" width="24">\n    <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>\n    <path d="M0 0h24v24H0V0z" fill="none"/>\n    <path d="M12 10h-2v2H9v-2H7V9h2V7h1v2h2v1z"/>\n</svg>':'<svg fill="#6E8192" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">\n    <path d="M0 0h24v24H0z" fill="none"/>\n    <path d="M3 5h2V3c-1.1 0-2 .9-2 2zm0 8h2v-2H3v2zm4 8h2v-2H7v2zM3 9h2V7H3v2zm10-6h-2v2h2V3zm6 0v2h2c0-1.1-.9-2-2-2zM5 21v-2H3c0 1.1.9 2 2 2zm-2-4h2v-2H3v2zM9 3H7v2h2V3zm2 18h2v-2h-2v2zm8-8h2v-2h-2v2zm0 8c1.1 0 2-.9 2-2h-2v2zm0-12h2V7h-2v2zm0 8h2v-2h-2v2zm-4 4h2v-2h-2v2zm0-16h2V3h-2v2z"/>\n</svg>',title:e.localeValues["zoom"===a?"selectionZoom":"selection"],class:t.globals.isTouchDevice?"apexcharts-element-hidden":"apexcharts-".concat(a,"-icon")})};r("zoom"),r("selection"),this.t.pan&&t.config.chart.zoom.enabled&&o.push({el:this.elPan,icon:"string"==typeof this.t.pan?this.t.pan:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000000" height="24" viewBox="0 0 24 24" width="24">\n    <defs>\n        <path d="M0 0h24v24H0z" id="a"/>\n    </defs>\n    <clipPath id="b">\n        <use overflow="visible" xlink:href="#a"/>\n    </clipPath>\n    <path clip-path="url(#b)" d="M23 5.5V20c0 2.2-1.8 4-4 4h-7.3c-1.08 0-2.1-.43-2.85-1.19L1 14.83s1.26-1.23 1.3-1.25c.22-.19.49-.29.79-.29.22 0 .42.06.6.16.04.01 4.31 2.46 4.31 2.46V4c0-.83.67-1.5 1.5-1.5S11 3.17 11 4v7h1V1.5c0-.83.67-1.5 1.5-1.5S15 .67 15 1.5V11h1V2.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5V11h1V5.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5z"/>\n</svg>',title:this.localeValues.pan,class:t.globals.isTouchDevice?"apexcharts-element-hidden":"apexcharts-pan-icon"}),n("reset",this.elZoomReset,'<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">\n    <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>\n    <path d="M0 0h24v24H0z" fill="none"/>\n</svg>'),this.t.download&&o.push({el:this.elMenuIcon,icon:"string"==typeof this.t.download?this.t.download:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg>',title:this.localeValues.menu,class:"apexcharts-menu-icon"});for(var l=0;l<this.elCustomIcons.length;l++)o.push({el:this.elCustomIcons[l],icon:this.t.customIcons[l].icon,title:this.t.customIcons[l].title,index:this.t.customIcons[l].index,class:"apexcharts-toolbar-custom-icon "+this.t.customIcons[l].class});o.forEach(function(e,t){e.index&&Xc.moveIndexInArray(o,t,e.index)});for(var c=0;c<o.length;c++)Ku.setAttrs(o[c].el,{class:o[c].class,title:o[c].title}),o[c].el.innerHTML=o[c].icon,i.appendChild(o[c].el);this._createHamburgerMenu(i),t.globals.zoomEnabled?this.elZoom.classList.add(this.selectedClass):t.globals.panEnabled?this.elPan.classList.add(this.selectedClass):t.globals.selectionEnabled&&this.elSelection.classList.add(this.selectedClass),this.addToolbarEventListeners()}},{key:"_createHamburgerMenu",value:function(e){this.elMenuItems=[],e.appendChild(this.elMenu),Ku.setAttrs(this.elMenu,{class:"apexcharts-menu"});for(var t=[{name:"exportSVG",title:this.localeValues.exportToSVG},{name:"exportPNG",title:this.localeValues.exportToPNG},{name:"exportCSV",title:this.localeValues.exportToCSV}],a=0;a<t.length;a++)this.elMenuItems.push(document.createElement("div")),this.elMenuItems[a].innerHTML=t[a].title,Ku.setAttrs(this.elMenuItems[a],{class:"apexcharts-menu-item ".concat(t[a].name),title:t[a].title}),this.elMenu.appendChild(this.elMenuItems[a])}},{key:"addToolbarEventListeners",value:function(){var e=this;this.elZoomReset.addEventListener("click",this.handleZoomReset.bind(this)),this.elSelection.addEventListener("click",this.toggleZoomSelection.bind(this,"selection")),this.elZoom.addEventListener("click",this.toggleZoomSelection.bind(this,"zoom")),this.elZoomIn.addEventListener("click",this.handleZoomIn.bind(this)),this.elZoomOut.addEventListener("click",this.handleZoomOut.bind(this)),this.elPan.addEventListener("click",this.togglePanning.bind(this)),this.elMenuIcon.addEventListener("click",this.toggleMenu.bind(this)),this.elMenuItems.forEach(function(t){t.classList.contains("exportSVG")?t.addEventListener("click",e.handleDownload.bind(e,"svg")):t.classList.contains("exportPNG")?t.addEventListener("click",e.handleDownload.bind(e,"png")):t.classList.contains("exportCSV")&&t.addEventListener("click",e.handleDownload.bind(e,"csv"))});for(var t=0;t<this.t.customIcons.length;t++)this.elCustomIcons[t].addEventListener("click",this.t.customIcons[t].click.bind(this,this.ctx,this.ctx.w))}},{key:"toggleZoomSelection",value:function(e){this.ctx.getSyncedCharts().forEach(function(t){t.ctx.toolbar.toggleOtherControls();var a="selection"===e?t.ctx.toolbar.elSelection:t.ctx.toolbar.elZoom,i="selection"===e?"selectionEnabled":"zoomEnabled";t.w.globals[i]=!t.w.globals[i],a.classList.contains(t.ctx.toolbar.selectedClass)?a.classList.remove(t.ctx.toolbar.selectedClass):a.classList.add(t.ctx.toolbar.selectedClass)})}},{key:"getToolbarIconsReference",value:function(){var e=this.w;this.elZoom||(this.elZoom=e.globals.dom.baseEl.querySelector(".apexcharts-zoom-icon")),this.elPan||(this.elPan=e.globals.dom.baseEl.querySelector(".apexcharts-pan-icon")),this.elSelection||(this.elSelection=e.globals.dom.baseEl.querySelector(".apexcharts-selection-icon"))}},{key:"enableZoomPanFromToolbar",value:function(e){this.toggleOtherControls(),"pan"===e?this.w.globals.panEnabled=!0:this.w.globals.zoomEnabled=!0;var t="pan"===e?this.elPan:this.elZoom,a="pan"===e?this.elZoom:this.elPan;t&&t.classList.add(this.selectedClass),a&&a.classList.remove(this.selectedClass)}},{key:"togglePanning",value:function(){this.ctx.getSyncedCharts().forEach(function(e){e.ctx.toolbar.toggleOtherControls(),e.w.globals.panEnabled=!e.w.globals.panEnabled,e.ctx.toolbar.elPan.classList.contains(e.ctx.toolbar.selectedClass)?e.ctx.toolbar.elPan.classList.remove(e.ctx.toolbar.selectedClass):e.ctx.toolbar.elPan.classList.add(e.ctx.toolbar.selectedClass)})}},{key:"toggleOtherControls",value:function(){var e=this,t=this.w;t.globals.panEnabled=!1,t.globals.zoomEnabled=!1,t.globals.selectionEnabled=!1,this.getToolbarIconsReference(),[this.elPan,this.elSelection,this.elZoom].forEach(function(t){t&&t.classList.remove(e.selectedClass)})}},{key:"handleZoomIn",value:function(){var e=this.w;e.globals.isRangeBar&&(this.minX=e.globals.minY,this.maxX=e.globals.maxY);var t=(this.minX+this.maxX)/2,a=(this.minX+t)/2,i=(this.maxX+t)/2,s=this._getNewMinXMaxX(a,i);e.globals.disableZoomIn||this.zoomUpdateOptions(s.minX,s.maxX)}},{key:"handleZoomOut",value:function(){var e=this.w;if(e.globals.isRangeBar&&(this.minX=e.globals.minY,this.maxX=e.globals.maxY),!("datetime"===e.config.xaxis.type&&new Date(this.minX).getUTCFullYear()<1e3)){var t=(this.minX+this.maxX)/2,a=this.minX-(t-this.minX),i=this.maxX-(t-this.maxX),s=this._getNewMinXMaxX(a,i);e.globals.disableZoomOut||this.zoomUpdateOptions(s.minX,s.maxX)}}},{key:"_getNewMinXMaxX",value:function(e,t){var a=this.w.config.xaxis.convertedCatToNumeric;return{minX:a?Math.floor(e):e,maxX:a?Math.floor(t):t}}},{key:"zoomUpdateOptions",value:function(e,t){var a=this.w;if(void 0!==e||void 0!==t){if(!(a.config.xaxis.convertedCatToNumeric&&(e<1&&(e=1,t=a.globals.dataPoints),t-e<2))){var i={min:e,max:t},s=this.getBeforeZoomRange(i);s&&(i=s.xaxis);var o={xaxis:i},n=Xc.clone(a.globals.initialConfig.yaxis);a.config.chart.group||(o.yaxis=n),this.w.globals.zoomed=!0,this.ctx.updateHelpers._updateOptions(o,!1,this.w.config.chart.animations.dynamicAnimation.enabled),this.zoomCallback(i,n)}}else this.handleZoomReset()}},{key:"zoomCallback",value:function(e,t){"function"==typeof this.ev.zoomed&&(this.ev.zoomed(this.ctx,{xaxis:e,yaxis:t}),this.ctx.events.fireEvent("zoomed",{xaxis:e,yaxis:t}))}},{key:"getBeforeZoomRange",value:function(e,t){var a=null;return"function"==typeof this.ev.beforeZoom&&(a=this.ev.beforeZoom(this,{xaxis:e,yaxis:t})),a}},{key:"toggleMenu",value:function(){var e=this;window.setTimeout(function(){e.elMenu.classList.contains("apexcharts-menu-open")?e.elMenu.classList.remove("apexcharts-menu-open"):e.elMenu.classList.add("apexcharts-menu-open")},0)}},{key:"handleDownload",value:function(e){var t=this.w,a=new xp(this.ctx);switch(e){case"svg":a.exportToSVG(this.ctx);break;case"png":a.exportToPng(this.ctx);break;case"csv":a.exportToCSV({series:t.config.series,columnDelimiter:t.config.chart.toolbar.export.csv.columnDelimiter})}}},{key:"handleZoomReset",value:function(e){this.ctx.getSyncedCharts().forEach(function(e){var t=e.w;if(t.globals.lastXAxis.min=t.globals.initialConfig.xaxis.min,t.globals.lastXAxis.max=t.globals.initialConfig.xaxis.max,e.updateHelpers.revertDefaultAxisMinMax(),"function"==typeof t.config.chart.events.beforeResetZoom){var a=t.config.chart.events.beforeResetZoom(e,t);a&&e.updateHelpers.revertDefaultAxisMinMax(a)}"function"==typeof t.config.chart.events.zoomed&&e.ctx.toolbar.zoomCallback({min:t.config.xaxis.min,max:t.config.xaxis.max}),t.globals.zoomed=!1;var i=e.ctx.series.emptyCollapsedSeries(Xc.clone(t.globals.initialSeries));e.updateHelpers._updateSeries(i,t.config.chart.animations.dynamicAnimation.enabled)})}},{key:"destroy",value:function(){this.elZoom=null,this.elZoomIn=null,this.elZoomOut=null,this.elPan=null,this.elSelection=null,this.elZoomReset=null,this.elMenuIcon=null}}]),e}(),Bp=function(){zc(t,Up);var e=Nc(t);function t(a){var i;return Rc(this,t),(i=e.call(this,a)).ctx=a,i.w=a.w,i.dragged=!1,i.graphics=new Ku(i.ctx),i.eventList=["mousedown","mouseleave","mousemove","touchstart","touchmove","mouseup","touchend","wheel"],i.clientX=0,i.clientY=0,i.startX=0,i.endX=0,i.dragX=0,i.startY=0,i.endY=0,i.dragY=0,i.moveDirection="none",i.debounceTimer=null,i.debounceDelay=100,i.wheelDelay=400,i}return Mc(t,[{key:"init",value:function(e){var t=this,a=e.xyRatios,i=this.w,s=this;this.xyRatios=a,this.zoomRect=this.graphics.drawRect(0,0,0,0),this.selectionRect=this.graphics.drawRect(0,0,0,0),this.gridRect=i.globals.dom.baseEl.querySelector(".apexcharts-grid"),this.constraints=new Zh(0,0,i.globals.gridWidth,i.globals.gridHeight),this.zoomRect.node.classList.add("apexcharts-zoom-rect"),this.selectionRect.node.classList.add("apexcharts-selection-rect"),i.globals.dom.Paper.add(this.zoomRect),i.globals.dom.Paper.add(this.selectionRect),"x"===i.config.chart.selection.type?this.slDraggableRect=this.selectionRect.draggable({minX:0,minY:0,maxX:i.globals.gridWidth,maxY:i.globals.gridHeight}).on("dragmove.namespace",this.selectionDragging.bind(this,"dragging")):"y"===i.config.chart.selection.type?this.slDraggableRect=this.selectionRect.draggable({minX:0,maxX:i.globals.gridWidth}).on("dragmove.namespace",this.selectionDragging.bind(this,"dragging")):this.slDraggableRect=this.selectionRect.draggable().on("dragmove.namespace",this.selectionDragging.bind(this,"dragging")),this.preselectedSelection(),this.hoverArea=i.globals.dom.baseEl.querySelector("".concat(i.globals.chartClass," .apexcharts-svg")),this.hoverArea.classList.add("apexcharts-zoomable"),this.eventList.forEach(function(e){t.hoverArea.addEventListener(e,s.svgMouseEvents.bind(s,a),{capture:!1,passive:!0})}),i.config.chart.zoom.enabled&&i.config.chart.zoom.allowMouseWheelZoom&&this.hoverArea.addEventListener("wheel",s.mouseWheelEvent.bind(s),{capture:!1,passive:!1})}},{key:"destroy",value:function(){this.slDraggableRect&&(this.slDraggableRect.draggable(!1),this.slDraggableRect.off(),this.selectionRect.off()),this.selectionRect=null,this.zoomRect=null,this.gridRect=null}},{key:"svgMouseEvents",value:function(e,t){var a=this.w,i=this.ctx.toolbar,s=a.globals.zoomEnabled?a.config.chart.zoom.type:a.config.chart.selection.type,o=a.config.chart.toolbar.autoSelected;if(t.shiftKey?(this.shiftWasPressed=!0,i.enableZoomPanFromToolbar("pan"===o?"zoom":"pan")):this.shiftWasPressed&&(i.enableZoomPanFromToolbar(o),this.shiftWasPressed=!1),t.target){var n,r=t.target.classList;if(t.target.parentNode&&null!==t.target.parentNode&&(n=t.target.parentNode.classList),!(r.contains("apexcharts-legend-marker")||r.contains("apexcharts-legend-text")||n&&n.contains("apexcharts-toolbar"))){if(this.clientX="touchmove"===t.type||"touchstart"===t.type?t.touches[0].clientX:"touchend"===t.type?t.changedTouches[0].clientX:t.clientX,this.clientY="touchmove"===t.type||"touchstart"===t.type?t.touches[0].clientY:"touchend"===t.type?t.changedTouches[0].clientY:t.clientY,"mousedown"===t.type&&1===t.which||"touchstart"===t.type){var l=this.gridRect.getBoundingClientRect();this.startX=this.clientX-l.left-a.globals.barPadForNumericAxis,this.startY=this.clientY-l.top,this.dragged=!1,this.w.globals.mousedown=!0}("mousemove"===t.type&&1===t.which||"touchmove"===t.type)&&(this.dragged=!0,a.globals.panEnabled?(a.globals.selection=null,this.w.globals.mousedown&&this.panDragging({context:this,zoomtype:s,xyRatios:e})):(this.w.globals.mousedown&&a.globals.zoomEnabled||this.w.globals.mousedown&&a.globals.selectionEnabled)&&(this.selection=this.selectionDrawing({context:this,zoomtype:s}))),"mouseup"!==t.type&&"touchend"!==t.type&&"mouseleave"!==t.type||this.handleMouseUp({zoomtype:s}),this.makeSelectionRectDraggable()}}}},{key:"handleMouseUp",value:function(e){var t,a=e.zoomtype,i=e.isResized,s=this.w,o=null===(t=this.gridRect)||void 0===t?void 0:t.getBoundingClientRect();o&&(this.w.globals.mousedown||i)&&(this.endX=this.clientX-o.left-s.globals.barPadForNumericAxis,this.endY=this.clientY-o.top,this.dragX=Math.abs(this.endX-this.startX),this.dragY=Math.abs(this.endY-this.startY),(s.globals.zoomEnabled||s.globals.selectionEnabled)&&this.selectionDrawn({context:this,zoomtype:a})),s.globals.zoomEnabled&&this.hideSelectionRect(this.selectionRect),this.dragged=!1,this.w.globals.mousedown=!1}},{key:"mouseWheelEvent",value:function(e){var t=this,a=this.w;e.preventDefault();var i=Date.now();i-a.globals.lastWheelExecution>this.wheelDelay&&(this.executeMouseWheelZoom(e),a.globals.lastWheelExecution=i),this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(function(){i-a.globals.lastWheelExecution>t.wheelDelay&&(t.executeMouseWheelZoom(e),a.globals.lastWheelExecution=i)},this.debounceDelay)}},{key:"executeMouseWheelZoom",value:function(e){var t,a=this.w;this.minX=a.globals.isRangeBar?a.globals.minY:a.globals.minX,this.maxX=a.globals.isRangeBar?a.globals.maxY:a.globals.maxX;var i=null===(t=this.gridRect)||void 0===t?void 0:t.getBoundingClientRect();if(i){var s,o,n,r=(e.clientX-i.left)/i.width,l=this.minX,c=this.maxX,h=c-l;if(e.deltaY<0){var d=l+r*h;o=d-(s=.5*h)/2,n=d+s/2}else o=l-(s=1.5*h)/2,n=c+s/2;if(!a.globals.isRangeBar){o=Math.max(o,a.globals.initialMinX),n=Math.min(n,a.globals.initialMaxX);var u=.01*(a.globals.initialMaxX-a.globals.initialMinX);if(n-o<u){var p=(o+n)/2;o=p-u/2,n=p+u/2}}var m=this._getNewMinXMaxX(o,n);isNaN(m.minX)||isNaN(m.maxX)||this.zoomUpdateOptions(m.minX,m.maxX)}}},{key:"makeSelectionRectDraggable",value:function(){var e=this,t=this.w;if(this.selectionRect){var a=this.selectionRect.node.getBoundingClientRect();a.width>0&&a.height>0&&(this.selectionRect.select(!1).resize(!1),this.selectionRect.select({createRot:function(){},updateRot:function(){},createHandle:function(e,t,a,i,s){return"l"===s||"r"===s?e.circle(8).css({"stroke-width":1,stroke:"#333",fill:"#fff"}):e.circle(0)},updateHandle:function(e,t){return e.center(t[0],t[1])}}).resize().on("resize",function(){var a=t.globals.zoomEnabled?t.config.chart.zoom.type:t.config.chart.selection.type;e.handleMouseUp({zoomtype:a,isResized:!0})}))}}},{key:"preselectedSelection",value:function(){var e=this.w,t=this.xyRatios;if(!e.globals.zoomEnabled)if(void 0!==e.globals.selection&&null!==e.globals.selection)this.drawSelectionRect(Uc(Uc({},e.globals.selection),{},{translateX:e.globals.translateX,translateY:e.globals.translateY}));else if(void 0!==e.config.chart.selection.xaxis.min&&void 0!==e.config.chart.selection.xaxis.max){var a=(e.config.chart.selection.xaxis.min-e.globals.minX)/t.xRatio,i=e.globals.gridWidth-(e.globals.maxX-e.config.chart.selection.xaxis.max)/t.xRatio-a;e.globals.isRangeBar&&(a=(e.config.chart.selection.xaxis.min-e.globals.yAxisScale[0].niceMin)/t.invertedYRatio,i=(e.config.chart.selection.xaxis.max-e.config.chart.selection.xaxis.min)/t.invertedYRatio);var s={x:a,y:0,width:i,height:e.globals.gridHeight,translateX:e.globals.translateX,translateY:e.globals.translateY,selectionEnabled:!0};this.drawSelectionRect(s),this.makeSelectionRectDraggable(),"function"==typeof e.config.chart.events.selection&&e.config.chart.events.selection(this.ctx,{xaxis:{min:e.config.chart.selection.xaxis.min,max:e.config.chart.selection.xaxis.max},yaxis:{}})}}},{key:"drawSelectionRect",value:function(e){var t=e.x,a=e.y,i=e.width,s=e.height,o=e.translateX,n=void 0===o?0:o,r=e.translateY,l=void 0===r?0:r,c=this.w,h=this.zoomRect,d=this.selectionRect;if(this.dragged||null!==c.globals.selection){var u={transform:"translate("+n+", "+l+")"};c.globals.zoomEnabled&&this.dragged&&(i<0&&(i=1),h.attr({x:t,y:a,width:i,height:s,fill:c.config.chart.zoom.zoomedArea.fill.color,"fill-opacity":c.config.chart.zoom.zoomedArea.fill.opacity,stroke:c.config.chart.zoom.zoomedArea.stroke.color,"stroke-width":c.config.chart.zoom.zoomedArea.stroke.width,"stroke-opacity":c.config.chart.zoom.zoomedArea.stroke.opacity}),Ku.setAttrs(h.node,u)),c.globals.selectionEnabled&&(d.attr({x:t,y:a,width:i>0?i:0,height:s>0?s:0,fill:c.config.chart.selection.fill.color,"fill-opacity":c.config.chart.selection.fill.opacity,stroke:c.config.chart.selection.stroke.color,"stroke-width":c.config.chart.selection.stroke.width,"stroke-dasharray":c.config.chart.selection.stroke.dashArray,"stroke-opacity":c.config.chart.selection.stroke.opacity}),Ku.setAttrs(d.node,u))}}},{key:"hideSelectionRect",value:function(e){e&&e.attr({x:0,y:0,width:0,height:0})}},{key:"selectionDrawing",value:function(e){var t=e.context,a=e.zoomtype,i=this.w,s=t,o=this.gridRect.getBoundingClientRect(),n=s.startX-1,r=s.startY,l=!1,c=!1,h=s.clientX-o.left-i.globals.barPadForNumericAxis,d=s.clientY-o.top,u=h-n,p=d-r,m={translateX:i.globals.translateX,translateY:i.globals.translateY};return Math.abs(u+n)>i.globals.gridWidth?u=i.globals.gridWidth-n:h<0&&(u=n),n>h&&(l=!0,u=Math.abs(u)),r>d&&(c=!0,p=Math.abs(p)),m=Uc(Uc({},m="x"===a?{x:l?n-u:n,y:0,width:u,height:i.globals.gridHeight}:"y"===a?{x:0,y:c?r-p:r,width:i.globals.gridWidth,height:p}:{x:l?n-u:n,y:c?r-p:r,width:u,height:p}),{},{translateX:i.globals.translateX,translateY:i.globals.translateY}),s.drawSelectionRect(m),s.selectionDragging("resizing"),m}},{key:"selectionDragging",value:function(e,t){var a=this,i=this.w;if(t){t.preventDefault();var s=t.detail,o=s.handler,n=s.box,r=n.x,l=n.y;r<this.constraints.x&&(r=this.constraints.x),l<this.constraints.y&&(l=this.constraints.y),n.x2>this.constraints.x2&&(r=this.constraints.x2-n.w),n.y2>this.constraints.y2&&(l=this.constraints.y2-n.h),o.move(r,l);var c=this.xyRatios,h=this.selectionRect,d=0;"resizing"===e&&(d=30);var u=function(e){return parseFloat(h.node.getAttribute(e))},p={x:u("x"),y:u("y"),width:u("width"),height:u("height")};i.globals.selection=p,"function"==typeof i.config.chart.events.selection&&i.globals.selectionEnabled&&(clearTimeout(this.w.globals.selectionResizeTimer),this.w.globals.selectionResizeTimer=window.setTimeout(function(){var e,t,s,o,n=a.gridRect.getBoundingClientRect(),r=h.node.getBoundingClientRect();i.globals.isRangeBar?(e=i.globals.yAxisScale[0].niceMin+(r.left-n.left)*c.invertedYRatio,t=i.globals.yAxisScale[0].niceMin+(r.right-n.left)*c.invertedYRatio,s=0,o=1):(e=i.globals.xAxisScale.niceMin+(r.left-n.left)*c.xRatio,t=i.globals.xAxisScale.niceMin+(r.right-n.left)*c.xRatio,s=i.globals.yAxisScale[0].niceMin+(n.bottom-r.bottom)*c.yRatio[0],o=i.globals.yAxisScale[0].niceMax-(r.top-n.top)*c.yRatio[0]);var l={xaxis:{min:e,max:t},yaxis:{min:s,max:o}};i.config.chart.events.selection(a.ctx,l),i.config.chart.brush.enabled&&void 0!==i.config.chart.events.brushScrolled&&i.config.chart.events.brushScrolled(a.ctx,l)},d))}}},{key:"selectionDrawn",value:function(e){var t,a,i=e.context,s=e.zoomtype,o=this.w,n=i,r=this.xyRatios,l=this.ctx.toolbar,c=o.globals.zoomEnabled?n.zoomRect.node.getBoundingClientRect():n.selectionRect.node.getBoundingClientRect(),h=n.gridRect.getBoundingClientRect(),d=c.left-h.left-o.globals.barPadForNumericAxis,u=c.right-h.left-o.globals.barPadForNumericAxis,p=c.top-h.top,m=c.bottom-h.top;o.globals.isRangeBar?(t=o.globals.yAxisScale[0].niceMin+d*r.invertedYRatio,a=o.globals.yAxisScale[0].niceMin+u*r.invertedYRatio):(t=o.globals.xAxisScale.niceMin+d*r.xRatio,a=o.globals.xAxisScale.niceMin+u*r.xRatio);var g=[],f=[];if(o.config.yaxis.forEach(function(e,t){var a=o.globals.seriesYAxisMap[t][0],i=o.globals.yAxisScale[t].niceMax-r.yRatio[a]*p,s=o.globals.yAxisScale[t].niceMax-r.yRatio[a]*m;g.push(i),f.push(s)}),n.dragged&&(n.dragX>10||n.dragY>10)&&t!==a)if(o.globals.zoomEnabled){var b=Xc.clone(o.globals.initialConfig.yaxis),y=Xc.clone(o.globals.initialConfig.xaxis);if(o.globals.zoomed=!0,o.config.xaxis.convertedCatToNumeric&&(t=Math.floor(t),a=Math.floor(a),t<1&&(t=1,a=o.globals.dataPoints),a-t<2&&(a=t+1)),"xy"!==s&&"x"!==s||(y={min:t,max:a}),"xy"!==s&&"y"!==s||b.forEach(function(e,t){b[t].min=f[t],b[t].max=g[t]}),l){var w=l.getBeforeZoomRange(y,b);w&&(y=w.xaxis?w.xaxis:y,b=w.yaxis?w.yaxis:b)}var v={xaxis:y};o.config.chart.group||(v.yaxis=b),n.ctx.updateHelpers._updateOptions(v,!1,n.w.config.chart.animations.dynamicAnimation.enabled),"function"==typeof o.config.chart.events.zoomed&&l.zoomCallback(y,b)}else if(o.globals.selectionEnabled){var x,S=null;x={min:t,max:a},"xy"!==s&&"y"!==s||(S=Xc.clone(o.config.yaxis)).forEach(function(e,t){S[t].min=f[t],S[t].max=g[t]}),o.globals.selection=n.selection,"function"==typeof o.config.chart.events.selection&&o.config.chart.events.selection(n.ctx,{xaxis:x,yaxis:S})}}},{key:"panDragging",value:function(e){var t=e.context,a=this.w,i=t;if(void 0!==a.globals.lastClientPosition.x){var s=a.globals.lastClientPosition.x-i.clientX,o=a.globals.lastClientPosition.y-i.clientY;Math.abs(s)>Math.abs(o)&&s>0?this.moveDirection="left":Math.abs(s)>Math.abs(o)&&s<0?this.moveDirection="right":Math.abs(o)>Math.abs(s)&&o>0?this.moveDirection="up":Math.abs(o)>Math.abs(s)&&o<0&&(this.moveDirection="down")}a.globals.lastClientPosition={x:i.clientX,y:i.clientY};var n=a.globals.isRangeBar?a.globals.minY:a.globals.minX,r=a.globals.isRangeBar?a.globals.maxY:a.globals.maxX;i.panScrolled(n,r)}},{key:"panScrolled",value:function(e,t){var a=this.w,i=this.xyRatios,s=Xc.clone(a.globals.initialConfig.yaxis),o=i.xRatio,n=a.globals.minX,r=a.globals.maxX;a.globals.isRangeBar&&(o=i.invertedYRatio,n=a.globals.minY,r=a.globals.maxY),"left"===this.moveDirection?(e=n+a.globals.gridWidth/15*o,t=r+a.globals.gridWidth/15*o):"right"===this.moveDirection&&(e=n-a.globals.gridWidth/15*o,t=r-a.globals.gridWidth/15*o),a.globals.isRangeBar||(e<a.globals.initialMinX||t>a.globals.initialMaxX)&&(e=n,t=r);var l={xaxis:{min:e,max:t}};a.config.chart.group||(l.yaxis=s),this.updateScrolledChart(l,e,t)}},{key:"updateScrolledChart",value:function(e,t,a){var i=this.w;if(this.ctx.updateHelpers._updateOptions(e,!1,!1),"function"==typeof i.config.chart.events.scrolled){var s={xaxis:{min:t,max:a}};i.config.chart.events.scrolled(this.ctx,s),this.ctx.events.fireEvent("scrolled",s)}}}]),t}(),Wp=function(){function e(t){Rc(this,e),this.w=t.w,this.ttCtx=t,this.ctx=t.ctx}return Mc(e,[{key:"getNearestValues",value:function(e){var t=e.hoverArea,a=e.elGrid,i=e.clientX,s=e.clientY,o=this.w,n=a.getBoundingClientRect(),r=n.width,l=n.height,c=r/(o.globals.dataPoints-1),h=l/o.globals.dataPoints,d=this.hasBars();!o.globals.comboCharts&&!d||o.config.xaxis.convertedCatToNumeric||(c=r/o.globals.dataPoints);var u=i-n.left-o.globals.barPadForNumericAxis,p=s-n.top;u<0||p<0||u>r||p>l?(t.classList.remove("hovering-zoom"),t.classList.remove("hovering-pan")):o.globals.zoomEnabled?(t.classList.remove("hovering-pan"),t.classList.add("hovering-zoom")):o.globals.panEnabled&&(t.classList.remove("hovering-zoom"),t.classList.add("hovering-pan"));var m=Math.round(u/c),g=Math.floor(p/h);d&&!o.config.xaxis.convertedCatToNumeric&&(m=Math.ceil(u/c),m-=1);var f=null,b=null,y=o.globals.seriesXvalues.map(function(e){return e.filter(function(e){return Xc.isNumber(e)})}),w=o.globals.seriesYvalues.map(function(e){return e.filter(function(e){return Xc.isNumber(e)})});if(o.globals.isXNumeric){var v=this.ttCtx.getElGrid().getBoundingClientRect(),x=u*(v.width/r),S=p*(v.height/l);f=(b=this.closestInMultiArray(x,S,y,w)).index,m=b.j,null!==f&&o.globals.hasNullValues&&(y=o.globals.seriesXvalues[f],m=(b=this.closestInArray(x,y)).j)}return o.globals.capturedSeriesIndex=null===f?-1:f,(!m||m<1)&&(m=0),o.globals.isBarHorizontal?o.globals.capturedDataPointIndex=g:o.globals.capturedDataPointIndex=m,{capturedSeries:f,j:o.globals.isBarHorizontal?g:m,hoverX:u,hoverY:p}}},{key:"getFirstActiveXArray",value:function(e){for(var t=this.w,a=0,i=e.map(function(e,t){return e.length>0?t:-1}),s=0;s<i.length;s++)if(-1!==i[s]&&-1===t.globals.collapsedSeriesIndices.indexOf(s)&&-1===t.globals.ancillaryCollapsedSeriesIndices.indexOf(s)){a=i[s];break}return a}},{key:"closestInMultiArray",value:function(e,t,a,i){for(var s,o=this.w,n=1/0,r=null,l=null,c=0;c<a.length;c++)if(s=c,-1===o.globals.collapsedSeriesIndices.indexOf(s)&&-1===o.globals.ancillaryCollapsedSeriesIndices.indexOf(s))for(var h=a[c],d=i[c],u=Math.min(h.length,d.length),p=0;p<u;p++){var m=e-h[p],g=Math.sqrt(m*m);if(!o.globals.allSeriesHasEqualX){var f=t-d[p];g=Math.sqrt(m*m+f*f)}g<n&&(n=g,r=c,l=p)}return{index:r,j:l}}},{key:"closestInArray",value:function(e,t){for(var a=t[0],i=null,s=Math.abs(e-a),o=0;o<t.length;o++){var n=Math.abs(e-t[o]);n<s&&(s=n,i=o)}return{j:i}}},{key:"isXoverlap",value:function(e){var t=[],a=this.w.globals.seriesX.filter(function(e){return void 0!==e[0]});if(a.length>0)for(var i=0;i<a.length-1;i++)void 0!==a[i][e]&&void 0!==a[i+1][e]&&a[i][e]!==a[i+1][e]&&t.push("unEqual");return 0===t.length}},{key:"isInitialSeriesSameLen",value:function(){for(var e=!0,t=this.w.globals.initialSeries,a=0;a<t.length-1;a++)if(t[a].data.length!==t[a+1].data.length){e=!1;break}return e}},{key:"getBarsHeight",value:function(e){return Vc(e).reduce(function(e,t){return e+t.getBBox().height},0)}},{key:"getElMarkers",value:function(e){return"number"==typeof e?this.w.globals.dom.baseEl.querySelectorAll(".apexcharts-series[data\\:realIndex='".concat(e,"'] .apexcharts-series-markers-wrap > *")):this.w.globals.dom.baseEl.querySelectorAll(".apexcharts-series-markers-wrap > *")}},{key:"getAllMarkers",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=this.w.globals.dom.baseEl.querySelectorAll(".apexcharts-series-markers-wrap");a=Vc(a),t&&(a=a.filter(function(t){var a=Number(t.getAttribute("data:realIndex"));return-1===e.w.globals.collapsedSeriesIndices.indexOf(a)})),a.sort(function(e,t){var a=Number(e.getAttribute("data:realIndex")),i=Number(t.getAttribute("data:realIndex"));return i<a?1:i>a?-1:0});var i=[];return a.forEach(function(e){i.push(e.querySelector(".apexcharts-marker"))}),i}},{key:"hasMarkers",value:function(e){return this.getElMarkers(e).length>0}},{key:"getPathFromPoint",value:function(e,t){var a=Number(e.getAttribute("cx")),i=Number(e.getAttribute("cy")),s=e.getAttribute("shape");return new Ku(this.ctx).getMarkerPath(a,i,s,t)}},{key:"getElBars",value:function(){return this.w.globals.dom.baseEl.querySelectorAll(".apexcharts-bar-series,  .apexcharts-candlestick-series, .apexcharts-boxPlot-series, .apexcharts-rangebar-series")}},{key:"hasBars",value:function(){return this.getElBars().length>0}},{key:"getHoverMarkerSize",value:function(e){var t=this.w,a=t.config.markers.hover.size;return void 0===a&&(a=t.globals.markers.size[e]+t.config.markers.hover.sizeOffset),a}},{key:"toggleAllTooltipSeriesGroups",value:function(e){var t=this.w,a=this.ttCtx;0===a.allTooltipSeriesGroups.length&&(a.allTooltipSeriesGroups=t.globals.dom.baseEl.querySelectorAll(".apexcharts-tooltip-series-group"));for(var i=a.allTooltipSeriesGroups,s=0;s<i.length;s++)"enable"===e?(i[s].classList.add("apexcharts-active"),i[s].style.display=t.config.tooltip.items.display):(i[s].classList.remove("apexcharts-active"),i[s].style.display="none")}}]),e}(),Vp=function(){function e(t){Rc(this,e),this.w=t.w,this.ctx=t.ctx,this.ttCtx=t,this.tooltipUtil=new Wp(t)}return Mc(e,[{key:"drawSeriesTexts",value:function(e){var t=e.shared,a=void 0===t||t,i=e.ttItems,s=e.i,o=void 0===s?0:s,n=e.j,r=void 0===n?null:n,l=e.y1,c=e.y2,h=e.e,d=this.w;void 0!==d.config.tooltip.custom?this.handleCustomTooltip({i:o,j:r,y1:l,y2:c,w:d}):this.toggleActiveInactiveSeries(a,o);var u=this.getValuesToPrint({i:o,j:r});this.printLabels({i:o,j:r,values:u,ttItems:i,shared:a,e:h});var p=this.ttCtx.getElTooltip();this.ttCtx.tooltipRect.ttWidth=p.getBoundingClientRect().width,this.ttCtx.tooltipRect.ttHeight=p.getBoundingClientRect().height}},{key:"printLabels",value:function(e){var t,a=this,i=e.i,s=e.j,o=e.values,n=e.ttItems,r=e.shared,l=e.e,c=this.w,h=[],d=function(e){return c.globals.seriesGoals[e]&&c.globals.seriesGoals[e][s]&&Array.isArray(c.globals.seriesGoals[e][s])},u=o.xVal,p=o.zVal,m=o.xAxisTTVal,g="",f=c.globals.colors[i];null!==s&&c.config.plotOptions.bar.distributed&&(f=c.globals.colors[s]);for(var b=function(e,o){var b=a.getFormatters(i);g=a.getSeriesName({fn:b.yLbTitleFormatter,index:i,seriesIndex:i,j:s}),"treemap"===c.config.chart.type&&(g=b.yLbTitleFormatter(String(c.config.series[i].data[s].x),{series:c.globals.series,seriesIndex:i,dataPointIndex:s,w:c}));var y=c.config.tooltip.inverseOrder?o:e;if(c.globals.axisCharts){var w=function(e){var t,a,i,o;return c.globals.isRangeData?b.yLbFormatter(null===(t=c.globals.seriesRangeStart)||void 0===t||null===(a=t[e])||void 0===a?void 0:a[s],{series:c.globals.seriesRangeStart,seriesIndex:e,dataPointIndex:s,w:c})+" - "+b.yLbFormatter(null===(i=c.globals.seriesRangeEnd)||void 0===i||null===(o=i[e])||void 0===o?void 0:o[s],{series:c.globals.seriesRangeEnd,seriesIndex:e,dataPointIndex:s,w:c}):b.yLbFormatter(c.globals.series[e][s],{series:c.globals.series,seriesIndex:e,dataPointIndex:s,w:c})};if(r)b=a.getFormatters(y),g=a.getSeriesName({fn:b.yLbTitleFormatter,index:y,seriesIndex:i,j:s}),f=c.globals.colors[y],t=w(y),d(y)&&(h=c.globals.seriesGoals[y][s].map(function(e){return{attrs:e,val:b.yLbFormatter(e.value,{seriesIndex:y,dataPointIndex:s,w:c})}}));else{var v,x=null==l||null===(v=l.target)||void 0===v?void 0:v.getAttribute("fill");x&&(-1!==x.indexOf("url")?-1!==x.indexOf("Pattern")&&(f=c.globals.dom.baseEl.querySelector(x.substr(4).slice(0,-1)).childNodes[0].getAttribute("stroke")):f=x),t=w(i),d(i)&&Array.isArray(c.globals.seriesGoals[i][s])&&(h=c.globals.seriesGoals[i][s].map(function(e){return{attrs:e,val:b.yLbFormatter(e.value,{seriesIndex:i,dataPointIndex:s,w:c})}}))}}null===s&&(t=b.yLbFormatter(c.globals.series[i],Uc(Uc({},c),{},{seriesIndex:i,dataPointIndex:i}))),a.DOMHandling({i:i,t:y,j:s,ttItems:n,values:{val:t,goalVals:h,xVal:u,xAxisTTVal:m,zVal:p},seriesName:g,shared:r,pColor:f})},y=0,w=c.globals.series.length-1;y<c.globals.series.length;y++,w--)b(y,w)}},{key:"getFormatters",value:function(e){var t,a=this.w,i=a.globals.yLabelFormatters[e];return void 0!==a.globals.ttVal?Array.isArray(a.globals.ttVal)?(i=a.globals.ttVal[e]&&a.globals.ttVal[e].formatter,t=a.globals.ttVal[e]&&a.globals.ttVal[e].title&&a.globals.ttVal[e].title.formatter):(i=a.globals.ttVal.formatter,"function"==typeof a.globals.ttVal.title.formatter&&(t=a.globals.ttVal.title.formatter)):t=a.config.tooltip.y.title.formatter,"function"!=typeof i&&(i=a.globals.yLabelFormatters[0]?a.globals.yLabelFormatters[0]:function(e){return e}),"function"!=typeof t&&(t=function(e){return e?e+": ":""}),{yLbFormatter:i,yLbTitleFormatter:t}}},{key:"getSeriesName",value:function(e){var t=e.fn,a=e.index,i=e.seriesIndex,s=e.j,o=this.w;return t(String(o.globals.seriesNames[a]),{series:o.globals.series,seriesIndex:i,dataPointIndex:s,w:o})}},{key:"DOMHandling",value:function(e){e.i;var t=e.t,a=e.j,i=e.ttItems,s=e.values,o=e.seriesName,n=e.shared,r=e.pColor,l=this.w,c=this.ttCtx,h=s.val,d=s.goalVals,u=s.xVal,p=s.xAxisTTVal,m=s.zVal,g=null;g=i[t].children,l.config.tooltip.fillSeriesColor&&(i[t].style.backgroundColor=r,g[0].style.display="none"),c.showTooltipTitle&&(null===c.tooltipTitle&&(c.tooltipTitle=l.globals.dom.baseEl.querySelector(".apexcharts-tooltip-title")),c.tooltipTitle.innerHTML=u),c.isXAxisTooltipEnabled&&(c.xaxisTooltipText.innerHTML=""!==p?p:u);var f=i[t].querySelector(".apexcharts-tooltip-text-y-label");f&&(f.innerHTML=o||"");var b=i[t].querySelector(".apexcharts-tooltip-text-y-value");b&&(b.innerHTML=void 0!==h?h:""),g[0]&&g[0].classList.contains("apexcharts-tooltip-marker")&&(l.config.tooltip.marker.fillColors&&Array.isArray(l.config.tooltip.marker.fillColors)&&(r=l.config.tooltip.marker.fillColors[t]),l.config.tooltip.fillSeriesColor?g[0].style.backgroundColor=r:g[0].style.color=r),l.config.tooltip.marker.show||(g[0].style.display="none");var y=i[t].querySelector(".apexcharts-tooltip-text-goals-label"),w=i[t].querySelector(".apexcharts-tooltip-text-goals-value");if(d.length&&l.globals.seriesGoals[t]){var v=function(){var e="<div>",t="<div>";d.forEach(function(a,i){e+=' <div style="display: flex"><span class="apexcharts-tooltip-marker" style="background-color: '.concat(a.attrs.strokeColor,'; height: 3px; border-radius: 0; top: 5px;"></span> ').concat(a.attrs.name,"</div>"),t+="<div>".concat(a.val,"</div>")}),y.innerHTML=e+"</div>",w.innerHTML=t+"</div>"};n?l.globals.seriesGoals[t][a]&&Array.isArray(l.globals.seriesGoals[t][a])?v():(y.innerHTML="",w.innerHTML=""):v()}else y.innerHTML="",w.innerHTML="";if(null!==m&&(i[t].querySelector(".apexcharts-tooltip-text-z-label").innerHTML=l.config.tooltip.z.title,i[t].querySelector(".apexcharts-tooltip-text-z-value").innerHTML=void 0!==m?m:""),n&&g[0]){if(l.config.tooltip.hideEmptySeries){var x=i[t].querySelector(".apexcharts-tooltip-marker"),S=i[t].querySelector(".apexcharts-tooltip-text");0==parseFloat(h)?(x.style.display="none",S.style.display="none"):(x.style.display="block",S.style.display="block")}null==h||l.globals.ancillaryCollapsedSeriesIndices.indexOf(t)>-1||l.globals.collapsedSeriesIndices.indexOf(t)>-1||Array.isArray(c.tConfig.enabledOnSeries)&&-1===c.tConfig.enabledOnSeries.indexOf(t)?g[0].parentNode.style.display="none":g[0].parentNode.style.display=l.config.tooltip.items.display}else Array.isArray(c.tConfig.enabledOnSeries)&&-1===c.tConfig.enabledOnSeries.indexOf(t)&&(g[0].parentNode.style.display="none")}},{key:"toggleActiveInactiveSeries",value:function(e,t){var a=this.w;if(e)this.tooltipUtil.toggleAllTooltipSeriesGroups("enable");else{this.tooltipUtil.toggleAllTooltipSeriesGroups("disable");var i=a.globals.dom.baseEl.querySelector(".apexcharts-tooltip-series-group-".concat(t));i&&(i.classList.add("apexcharts-active"),i.style.display=a.config.tooltip.items.display)}}},{key:"getValuesToPrint",value:function(e){var t=e.i,a=e.j,i=this.w,s=this.ctx.series.filteredSeriesX(),o="",n="",r=null,l=null,c={series:i.globals.series,seriesIndex:t,dataPointIndex:a,w:i},h=i.globals.ttZFormatter;null===a?l=i.globals.series[t]:i.globals.isXNumeric&&"treemap"!==i.config.chart.type?(o=s[t][a],0===s[t].length&&(o=s[this.tooltipUtil.getFirstActiveXArray(s)][a])):o=new vp(this.ctx).isFormatXY()?void 0!==i.config.series[t].data[a]?i.config.series[t].data[a].x:"":void 0!==i.globals.labels[a]?i.globals.labels[a]:"";var d=o;return o=i.globals.isXNumeric&&"datetime"===i.config.xaxis.type?new ap(this.ctx).xLabelFormat(i.globals.ttKeyFormatter,d,d,{i:void 0,dateFormatter:new tp(this.ctx).formatDate,w:this.w}):i.globals.isBarHorizontal?i.globals.yLabelFormatters[0](d,c):i.globals.xLabelFormatter(d,c),void 0!==i.config.tooltip.x.formatter&&(o=i.globals.ttKeyFormatter(d,c)),i.globals.seriesZ.length>0&&i.globals.seriesZ[t].length>0&&(r=h(i.globals.seriesZ[t][a],i)),n="function"==typeof i.config.xaxis.tooltip.formatter?i.globals.xaxisTooltipFormatter(d,c):o,{val:Array.isArray(l)?l.join(" "):l,xVal:Array.isArray(o)?o.join(" "):o,xAxisTTVal:Array.isArray(n)?n.join(" "):n,zVal:r}}},{key:"handleCustomTooltip",value:function(e){var t=e.i,a=e.j,i=e.y1,s=e.y2,o=e.w,n=this.ttCtx.getElTooltip(),r=o.config.tooltip.custom;Array.isArray(r)&&r[t]&&(r=r[t]);var l=r({ctx:this.ctx,series:o.globals.series,seriesIndex:t,dataPointIndex:a,y1:i,y2:s,w:o});"string"==typeof l||"number"==typeof l?n.innerHTML=l:(l instanceof Element||"string"==typeof l.nodeName)&&(n.innerHTML="",n.appendChild(l.cloneNode(!0)))}}]),e}(),jp=function(){function e(t){Rc(this,e),this.ttCtx=t,this.ctx=t.ctx,this.w=t.w}return Mc(e,[{key:"moveXCrosshairs",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=this.ttCtx,i=this.w,s=a.getElXCrosshairs(),o=e-a.xcrosshairsWidth/2,n=i.globals.labels.slice().length;if(null!==t&&(o=i.globals.gridWidth/n*t),null===s||i.globals.isBarHorizontal||(s.setAttribute("x",o),s.setAttribute("x1",o),s.setAttribute("x2",o),s.setAttribute("y2",i.globals.gridHeight),s.classList.add("apexcharts-active")),o<0&&(o=0),o>i.globals.gridWidth&&(o=i.globals.gridWidth),a.isXAxisTooltipEnabled){var r=o;"tickWidth"!==i.config.xaxis.crosshairs.width&&"barWidth"!==i.config.xaxis.crosshairs.width||(r=o+a.xcrosshairsWidth/2),this.moveXAxisTooltip(r)}}},{key:"moveYCrosshairs",value:function(e){var t=this.ttCtx;null!==t.ycrosshairs&&Ku.setAttrs(t.ycrosshairs,{y1:e,y2:e}),null!==t.ycrosshairsHidden&&Ku.setAttrs(t.ycrosshairsHidden,{y1:e,y2:e})}},{key:"moveXAxisTooltip",value:function(e){var t=this.w,a=this.ttCtx;if(null!==a.xaxisTooltip&&0!==a.xcrosshairsWidth){a.xaxisTooltip.classList.add("apexcharts-active");var i,s=a.xaxisOffY+t.config.xaxis.tooltip.offsetY+t.globals.translateY+1+t.config.xaxis.offsetY;if(e-=a.xaxisTooltip.getBoundingClientRect().width/2,!isNaN(e))e+=t.globals.translateX,i=new Ku(this.ctx).getTextRects(a.xaxisTooltipText.innerHTML),a.xaxisTooltipText.style.minWidth=i.width+"px",a.xaxisTooltip.style.left=e+"px",a.xaxisTooltip.style.top=s+"px"}}},{key:"moveYAxisTooltip",value:function(e){var t=this.w,a=this.ttCtx;null===a.yaxisTTEls&&(a.yaxisTTEls=t.globals.dom.baseEl.querySelectorAll(".apexcharts-yaxistooltip"));var i=parseInt(a.ycrosshairsHidden.getAttribute("y1"),10),s=t.globals.translateY+i,o=a.yaxisTTEls[e].getBoundingClientRect(),n=o.height,r=t.globals.translateYAxisX[e]-2;t.config.yaxis[e].opposite&&(r-=o.width),s-=n/2,-1===t.globals.ignoreYAxisIndexes.indexOf(e)&&s>0&&s<t.globals.gridHeight?(a.yaxisTTEls[e].classList.add("apexcharts-active"),a.yaxisTTEls[e].style.top=s+"px",a.yaxisTTEls[e].style.left=r+t.config.yaxis[e].tooltip.offsetX+"px"):a.yaxisTTEls[e].classList.remove("apexcharts-active")}},{key:"moveTooltip",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=this.w,s=this.ttCtx,o=s.getElTooltip(),n=s.tooltipRect,r=null!==a?parseFloat(a):1,l=parseFloat(e)+r+5,c=parseFloat(t)+r/2;if(l>i.globals.gridWidth/2&&(l=l-n.ttWidth-r-10),l>i.globals.gridWidth-n.ttWidth-10&&(l=i.globals.gridWidth-n.ttWidth),l<-20&&(l=-20),i.config.tooltip.followCursor){var h=s.getElGrid().getBoundingClientRect();(l=s.e.clientX-h.left)>i.globals.gridWidth/2&&(l-=s.tooltipRect.ttWidth),(c=s.e.clientY+i.globals.translateY-h.top)>i.globals.gridHeight/2&&(c-=s.tooltipRect.ttHeight)}else i.globals.isBarHorizontal||n.ttHeight/2+c>i.globals.gridHeight&&(c=i.globals.gridHeight-n.ttHeight+i.globals.translateY);isNaN(l)||(l+=i.globals.translateX,o.style.left=l+"px",o.style.top=c+"px")}},{key:"moveMarkers",value:function(e,t){var a=this.w,i=this.ttCtx;if(a.globals.markers.size[e]>0)for(var s=a.globals.dom.baseEl.querySelectorAll(" .apexcharts-series[data\\:realIndex='".concat(e,"'] .apexcharts-marker")),o=0;o<s.length;o++)parseInt(s[o].getAttribute("rel"),10)===t&&(i.marker.resetPointsSize(),i.marker.enlargeCurrentPoint(t,s[o]));else i.marker.resetPointsSize(),this.moveDynamicPointOnHover(t,e)}},{key:"moveDynamicPointOnHover",value:function(e,t){var a,i,s,o,n=this.w,r=this.ttCtx,l=new Ku(this.ctx),c=n.globals.pointsArray,h=r.tooltipUtil.getHoverMarkerSize(t),d=n.config.series[t].type;if(!d||"column"!==d&&"candlestick"!==d&&"boxPlot"!==d){s=null===(a=c[t][e])||void 0===a?void 0:a[0],o=(null===(i=c[t][e])||void 0===i?void 0:i[1])||0;var u=n.globals.dom.baseEl.querySelector(".apexcharts-series[data\\:realIndex='".concat(t,"'] .apexcharts-series-markers path"));if(u&&o<n.globals.gridHeight&&o>0){var p=u.getAttribute("shape"),m=l.getMarkerPath(s,o,p,1.5*h);u.setAttribute("d",m)}this.moveXCrosshairs(s),r.fixedTooltip||this.moveTooltip(s,o,h)}}},{key:"moveDynamicPointsOnHover",value:function(e){var t,a=this.ttCtx,i=a.w,s=0,o=0,n=i.globals.pointsArray,r=new wp(this.ctx),l=new Ku(this.ctx);t=r.getActiveConfigSeriesIndex("asc",["line","area","scatter","bubble"]);var c=a.tooltipUtil.getHoverMarkerSize(t);if(n[t]&&(s=n[t][e][0],o=n[t][e][1]),!isNaN(s)){var h=a.tooltipUtil.getAllMarkers();if(h.length)for(var d=0;d<i.globals.series.length;d++){var u=n[d];if(i.globals.comboCharts&&void 0===u&&h.splice(d,0,null),u&&u.length){var p=n[d][e][1],m=void 0;h[d].setAttribute("cx",s);var g=h[d].getAttribute("shape");if("rangeArea"===i.config.chart.type&&!i.globals.comboCharts){var f=e+i.globals.series[d].length;m=n[d][f][1],p-=Math.abs(p-m)/2}if(null!==p&&!isNaN(p)&&p<i.globals.gridHeight+c&&p+c>0){var b=l.getMarkerPath(s,p,g,c);h[d].setAttribute("d",b)}else h[d].setAttribute("d","")}}this.moveXCrosshairs(s),a.fixedTooltip||this.moveTooltip(s,o||i.globals.gridHeight,c)}}},{key:"moveStickyTooltipOverBars",value:function(e,t){var a=this.w,i=this.ttCtx,s=a.globals.columnSeries?a.globals.columnSeries.length:a.globals.series.length;a.config.chart.stacked&&(s=a.globals.barGroups.length);var o=s>=2&&s%2==0?Math.floor(s/2):Math.floor(s/2)+1;a.globals.isBarHorizontal&&(o=new wp(this.ctx).getActiveConfigSeriesIndex("desc")+1);var n=a.globals.dom.baseEl.querySelector(".apexcharts-bar-series .apexcharts-series[rel='".concat(o,"'] path[j='").concat(e,"'], .apexcharts-candlestick-series .apexcharts-series[rel='").concat(o,"'] path[j='").concat(e,"'], .apexcharts-boxPlot-series .apexcharts-series[rel='").concat(o,"'] path[j='").concat(e,"'], .apexcharts-rangebar-series .apexcharts-series[rel='").concat(o,"'] path[j='").concat(e,"']"));n||"number"!=typeof t||(n=a.globals.dom.baseEl.querySelector(".apexcharts-bar-series .apexcharts-series[data\\:realIndex='".concat(t,"'] path[j='").concat(e,"'],\n        .apexcharts-candlestick-series .apexcharts-series[data\\:realIndex='").concat(t,"'] path[j='").concat(e,"'],\n        .apexcharts-boxPlot-series .apexcharts-series[data\\:realIndex='").concat(t,"'] path[j='").concat(e,"'],\n        .apexcharts-rangebar-series .apexcharts-series[data\\:realIndex='").concat(t,"'] path[j='").concat(e,"']")));var r=n?parseFloat(n.getAttribute("cx")):0,l=n?parseFloat(n.getAttribute("cy")):0,c=n?parseFloat(n.getAttribute("barWidth")):0,h=i.getElGrid().getBoundingClientRect(),d=n&&(n.classList.contains("apexcharts-candlestick-area")||n.classList.contains("apexcharts-boxPlot-area"));a.globals.isXNumeric?(n&&!d&&(r-=s%2!=0?c/2:0),n&&d&&(r-=c/2)):a.globals.isBarHorizontal||(r=i.xAxisTicksPositions[e-1]+i.dataPointsDividedWidth/2,isNaN(r)&&(r=i.xAxisTicksPositions[e]-i.dataPointsDividedWidth/2)),a.globals.isBarHorizontal?l-=i.tooltipRect.ttHeight:a.config.tooltip.followCursor?l=i.e.clientY-h.top-i.tooltipRect.ttHeight/2:l+i.tooltipRect.ttHeight+15>a.globals.gridHeight&&(l=a.globals.gridHeight),a.globals.isBarHorizontal||this.moveXCrosshairs(r),i.fixedTooltip||this.moveTooltip(r,l||a.globals.gridHeight)}}]),e}(),Yp=function(){function e(t){Rc(this,e),this.w=t.w,this.ttCtx=t,this.ctx=t.ctx,this.tooltipPosition=new jp(t)}return Mc(e,[{key:"drawDynamicPoints",value:function(){var e=this.w,t=new Ku(this.ctx),a=new fp(this.ctx),i=e.globals.dom.baseEl.querySelectorAll(".apexcharts-series");i=Vc(i),e.config.chart.stacked&&i.sort(function(e,t){return parseFloat(e.getAttribute("data:realIndex"))-parseFloat(t.getAttribute("data:realIndex"))});for(var s=0;s<i.length;s++){var o=i[s].querySelector(".apexcharts-series-markers-wrap");if(null!==o){var n=void 0,r="apexcharts-marker w".concat((Math.random()+1).toString(36).substring(4));"line"!==e.config.chart.type&&"area"!==e.config.chart.type||e.globals.comboCharts||e.config.tooltip.intersect||(r+=" no-pointer-events");var l=a.getMarkerConfig({cssClass:r,seriesIndex:Number(o.getAttribute("data:realIndex"))});(n=t.drawMarker(0,0,l)).node.setAttribute("default-marker-size",0);var c=document.createElementNS(e.globals.SVGNS,"g");c.classList.add("apexcharts-series-markers"),c.appendChild(n.node),o.appendChild(c)}}}},{key:"enlargeCurrentPoint",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=this.w;"bubble"!==s.config.chart.type&&this.newPointSize(e,t);var o=t.getAttribute("cx"),n=t.getAttribute("cy");if(null!==a&&null!==i&&(o=a,n=i),this.tooltipPosition.moveXCrosshairs(o),!this.fixedTooltip){if("radar"===s.config.chart.type){var r=this.ttCtx.getElGrid().getBoundingClientRect();o=this.ttCtx.e.clientX-r.left}this.tooltipPosition.moveTooltip(o,n,s.config.markers.hover.size)}}},{key:"enlargePoints",value:function(e){for(var t=this.w,a=this,i=this.ttCtx,s=e,o=t.globals.dom.baseEl.querySelectorAll(".apexcharts-series:not(.apexcharts-series-collapsed) .apexcharts-marker"),n=t.config.markers.hover.size,r=0;r<o.length;r++){var l=o[r].getAttribute("rel"),c=o[r].getAttribute("index");if(void 0===n&&(n=t.globals.markers.size[c]+t.config.markers.hover.sizeOffset),s===parseInt(l,10)){a.newPointSize(s,o[r]);var h=o[r].getAttribute("cx"),d=o[r].getAttribute("cy");a.tooltipPosition.moveXCrosshairs(h),i.fixedTooltip||a.tooltipPosition.moveTooltip(h,d,n)}else a.oldPointSize(o[r])}}},{key:"newPointSize",value:function(e,t){var a=this.w,i=a.config.markers.hover.size,s=0===e?t.parentNode.firstChild:t.parentNode.lastChild;if("0"!==s.getAttribute("default-marker-size")){var o=parseInt(s.getAttribute("index"),10);void 0===i&&(i=a.globals.markers.size[o]+a.config.markers.hover.sizeOffset),i<0&&(i=0);var n=this.ttCtx.tooltipUtil.getPathFromPoint(t,i);t.setAttribute("d",n)}}},{key:"oldPointSize",value:function(e){var t=parseFloat(e.getAttribute("default-marker-size")),a=this.ttCtx.tooltipUtil.getPathFromPoint(e,t);e.setAttribute("d",a)}},{key:"resetPointsSize",value:function(){for(var e=this.w.globals.dom.baseEl.querySelectorAll(".apexcharts-series:not(.apexcharts-series-collapsed) .apexcharts-marker"),t=0;t<e.length;t++){var a=parseFloat(e[t].getAttribute("default-marker-size"));if(Xc.isNumber(a)&&a>0){var i=this.ttCtx.tooltipUtil.getPathFromPoint(e[t],a);e[t].setAttribute("d",i)}else e[t].setAttribute("d","M0,0")}}}]),e}(),qp=function(){function e(t){Rc(this,e),this.w=t.w;var a=this.w;this.ttCtx=t,this.isVerticalGroupedRangeBar=!a.globals.isBarHorizontal&&"rangeBar"===a.config.chart.type&&a.config.plotOptions.bar.rangeBarGroupRows}return Mc(e,[{key:"getAttr",value:function(e,t){return parseFloat(e.target.getAttribute(t))}},{key:"handleHeatTreeTooltip",value:function(e){var t=e.e,a=e.opt,i=e.x,s=e.y,o=e.type,n=this.ttCtx,r=this.w;if(t.target.classList.contains("apexcharts-".concat(o,"-rect"))){var l=this.getAttr(t,"i"),c=this.getAttr(t,"j"),h=this.getAttr(t,"cx"),d=this.getAttr(t,"cy"),u=this.getAttr(t,"width"),p=this.getAttr(t,"height");if(n.tooltipLabels.drawSeriesTexts({ttItems:a.ttItems,i:l,j:c,shared:!1,e:t}),r.globals.capturedSeriesIndex=l,r.globals.capturedDataPointIndex=c,i=h+n.tooltipRect.ttWidth/2+u,s=d+n.tooltipRect.ttHeight/2-p/2,n.tooltipPosition.moveXCrosshairs(h+u/2),i>r.globals.gridWidth/2&&(i=h-n.tooltipRect.ttWidth/2+u),n.w.config.tooltip.followCursor){var m=r.globals.dom.elWrap.getBoundingClientRect();i=r.globals.clientX-m.left-(i>r.globals.gridWidth/2?n.tooltipRect.ttWidth:0),s=r.globals.clientY-m.top-(s>r.globals.gridHeight/2?n.tooltipRect.ttHeight:0)}}return{x:i,y:s}}},{key:"handleMarkerTooltip",value:function(e){var t,a,i=e.e,s=e.opt,o=e.x,n=e.y,r=this.w,l=this.ttCtx;if(i.target.classList.contains("apexcharts-marker")){var c=parseInt(s.paths.getAttribute("cx"),10),h=parseInt(s.paths.getAttribute("cy"),10),d=parseFloat(s.paths.getAttribute("val"));if(a=parseInt(s.paths.getAttribute("rel"),10),t=parseInt(s.paths.parentNode.parentNode.parentNode.getAttribute("rel"),10)-1,l.intersect){var u=Xc.findAncestor(s.paths,"apexcharts-series");u&&(t=parseInt(u.getAttribute("data:realIndex"),10))}if(l.tooltipLabels.drawSeriesTexts({ttItems:s.ttItems,i:t,j:a,shared:!l.showOnIntersect&&r.config.tooltip.shared,e:i}),"mouseup"===i.type&&l.markerClick(i,t,a),r.globals.capturedSeriesIndex=t,r.globals.capturedDataPointIndex=a,o=c,n=h+r.globals.translateY-1.4*l.tooltipRect.ttHeight,l.w.config.tooltip.followCursor){var p=l.getElGrid().getBoundingClientRect();n=l.e.clientY+r.globals.translateY-p.top}d<0&&(n=h),l.marker.enlargeCurrentPoint(a,s.paths,o,n)}return{x:o,y:n}}},{key:"handleBarTooltip",value:function(e){var t,a,i=e.e,s=e.opt,o=this.w,n=this.ttCtx,r=n.getElTooltip(),l=0,c=0,h=0,d=this.getBarTooltipXY({e:i,opt:s});if(null!==d.j||0!==d.barHeight||0!==d.barWidth){t=d.i;var u=d.j;if(o.globals.capturedSeriesIndex=t,o.globals.capturedDataPointIndex=u,o.globals.isBarHorizontal&&n.tooltipUtil.hasBars()||!o.config.tooltip.shared?(c=d.x,h=d.y,a=Array.isArray(o.config.stroke.width)?o.config.stroke.width[t]:o.config.stroke.width,l=c):o.globals.comboCharts||o.config.tooltip.shared||(l/=2),isNaN(h)&&(h=o.globals.svgHeight-n.tooltipRect.ttHeight),parseInt(s.paths.parentNode.getAttribute("data:realIndex"),10),c+n.tooltipRect.ttWidth>o.globals.gridWidth?c-=n.tooltipRect.ttWidth:c<0&&(c=0),n.w.config.tooltip.followCursor){var p=n.getElGrid().getBoundingClientRect();h=n.e.clientY-p.top}null===n.tooltip&&(n.tooltip=o.globals.dom.baseEl.querySelector(".apexcharts-tooltip")),o.config.tooltip.shared||(o.globals.comboBarCount>0?n.tooltipPosition.moveXCrosshairs(l+a/2):n.tooltipPosition.moveXCrosshairs(l)),!n.fixedTooltip&&(!o.config.tooltip.shared||o.globals.isBarHorizontal&&n.tooltipUtil.hasBars())&&(h=h+o.globals.translateY-n.tooltipRect.ttHeight/2,r.style.left=c+o.globals.translateX+"px",r.style.top=h+"px")}}},{key:"getBarTooltipXY",value:function(e){var t=this,a=e.e,i=e.opt,s=this.w,o=null,n=this.ttCtx,r=0,l=0,c=0,h=0,d=0,u=a.target.classList;if(u.contains("apexcharts-bar-area")||u.contains("apexcharts-candlestick-area")||u.contains("apexcharts-boxPlot-area")||u.contains("apexcharts-rangebar-area")){var p=a.target,m=p.getBoundingClientRect(),g=i.elGrid.getBoundingClientRect(),f=m.height;d=m.height;var b=m.width,y=parseInt(p.getAttribute("cx"),10),w=parseInt(p.getAttribute("cy"),10);h=parseFloat(p.getAttribute("barWidth"));var v="touchmove"===a.type?a.touches[0].clientX:a.clientX;o=parseInt(p.getAttribute("j"),10),r=parseInt(p.parentNode.getAttribute("rel"),10)-1;var x=p.getAttribute("data-range-y1"),S=p.getAttribute("data-range-y2");s.globals.comboCharts&&(r=parseInt(p.parentNode.getAttribute("data:realIndex"),10));var _=function(e){return s.globals.isXNumeric?y-b/2:t.isVerticalGroupedRangeBar?y+b/2:y-n.dataPointsDividedWidth+b/2},k=function(){return w-n.dataPointsDividedHeight+f/2-n.tooltipRect.ttHeight/2};n.tooltipLabels.drawSeriesTexts({ttItems:i.ttItems,i:r,j:o,y1:x?parseInt(x,10):null,y2:S?parseInt(S,10):null,shared:!n.showOnIntersect&&s.config.tooltip.shared,e:a}),s.config.tooltip.followCursor?s.globals.isBarHorizontal?(l=v-g.left+15,c=k()):(l=_(),c=a.clientY-g.top-n.tooltipRect.ttHeight/2-15):s.globals.isBarHorizontal?((l=y)<n.xyRatios.baseLineInvertedY&&(l=y-n.tooltipRect.ttWidth),c=k()):(l=_(),c=w)}return{x:l,y:c,barHeight:d,barWidth:h,i:r,j:o}}}]),e}(),Xp=function(){function e(t){Rc(this,e),this.w=t.w,this.ttCtx=t}return Mc(e,[{key:"drawXaxisTooltip",value:function(){var e=this.w,t=this.ttCtx,a="bottom"===e.config.xaxis.position;t.xaxisOffY=a?e.globals.gridHeight+1:-e.globals.xAxisHeight-e.config.xaxis.axisTicks.height+3;var i=a?"apexcharts-xaxistooltip apexcharts-xaxistooltip-bottom":"apexcharts-xaxistooltip apexcharts-xaxistooltip-top",s=e.globals.dom.elWrap;t.isXAxisTooltipEnabled&&null===e.globals.dom.baseEl.querySelector(".apexcharts-xaxistooltip")&&(t.xaxisTooltip=document.createElement("div"),t.xaxisTooltip.setAttribute("class",i+" apexcharts-theme-"+e.config.tooltip.theme),s.appendChild(t.xaxisTooltip),t.xaxisTooltipText=document.createElement("div"),t.xaxisTooltipText.classList.add("apexcharts-xaxistooltip-text"),t.xaxisTooltipText.style.fontFamily=e.config.xaxis.tooltip.style.fontFamily||e.config.chart.fontFamily,t.xaxisTooltipText.style.fontSize=e.config.xaxis.tooltip.style.fontSize,t.xaxisTooltip.appendChild(t.xaxisTooltipText))}},{key:"drawYaxisTooltip",value:function(){for(var e=this.w,t=this.ttCtx,a=0;a<e.config.yaxis.length;a++){var i=e.config.yaxis[a].opposite||e.config.yaxis[a].crosshairs.opposite;t.yaxisOffX=i?e.globals.gridWidth+1:1;var s="apexcharts-yaxistooltip apexcharts-yaxistooltip-".concat(a,i?" apexcharts-yaxistooltip-right":" apexcharts-yaxistooltip-left"),o=e.globals.dom.elWrap;null===e.globals.dom.baseEl.querySelector(".apexcharts-yaxistooltip apexcharts-yaxistooltip-".concat(a))&&(t.yaxisTooltip=document.createElement("div"),t.yaxisTooltip.setAttribute("class",s+" apexcharts-theme-"+e.config.tooltip.theme),o.appendChild(t.yaxisTooltip),0===a&&(t.yaxisTooltipText=[]),t.yaxisTooltipText[a]=document.createElement("div"),t.yaxisTooltipText[a].classList.add("apexcharts-yaxistooltip-text"),t.yaxisTooltip.appendChild(t.yaxisTooltipText[a]))}}},{key:"setXCrosshairWidth",value:function(){var e=this.w,t=this.ttCtx,a=t.getElXCrosshairs();if(t.xcrosshairsWidth=parseInt(e.config.xaxis.crosshairs.width,10),e.globals.comboCharts){var i=e.globals.dom.baseEl.querySelector(".apexcharts-bar-area");if(null!==i&&"barWidth"===e.config.xaxis.crosshairs.width){var s=parseFloat(i.getAttribute("barWidth"));t.xcrosshairsWidth=s}else if("tickWidth"===e.config.xaxis.crosshairs.width){var o=e.globals.labels.length;t.xcrosshairsWidth=e.globals.gridWidth/o}}else if("tickWidth"===e.config.xaxis.crosshairs.width){var n=e.globals.labels.length;t.xcrosshairsWidth=e.globals.gridWidth/n}else if("barWidth"===e.config.xaxis.crosshairs.width){var r=e.globals.dom.baseEl.querySelector(".apexcharts-bar-area");if(null!==r){var l=parseFloat(r.getAttribute("barWidth"));t.xcrosshairsWidth=l}else t.xcrosshairsWidth=1}e.globals.isBarHorizontal&&(t.xcrosshairsWidth=0),null!==a&&t.xcrosshairsWidth>0&&a.setAttribute("width",t.xcrosshairsWidth)}},{key:"handleYCrosshair",value:function(){var e=this.w,t=this.ttCtx;t.ycrosshairs=e.globals.dom.baseEl.querySelector(".apexcharts-ycrosshairs"),t.ycrosshairsHidden=e.globals.dom.baseEl.querySelector(".apexcharts-ycrosshairs-hidden")}},{key:"drawYaxisTooltipText",value:function(e,t,a){var i=this.ttCtx,s=this.w,o=s.globals,n=o.seriesYAxisMap[e];if(i.yaxisTooltips[e]&&n.length>0){var r=o.yLabelFormatters[e],l=i.getElGrid().getBoundingClientRect(),c=n[0],h=0;a.yRatio.length>1&&(h=c);var d=(t-l.top)*a.yRatio[h],u=o.maxYArr[c]-o.minYArr[c],p=o.minYArr[c]+(u-d);s.config.yaxis[e].reversed&&(p=o.maxYArr[c]-(u-d)),i.tooltipPosition.moveYCrosshairs(t-l.top),i.yaxisTooltipText[e].innerHTML=r(p),i.tooltipPosition.moveYAxisTooltip(e)}}}]),e}(),$p=function(){function e(t){Rc(this,e),this.ctx=t,this.w=t.w;var a=this.w;this.tConfig=a.config.tooltip,this.tooltipUtil=new Wp(this),this.tooltipLabels=new Vp(this),this.tooltipPosition=new jp(this),this.marker=new Yp(this),this.intersect=new qp(this),this.axesTooltip=new Xp(this),this.showOnIntersect=this.tConfig.intersect,this.showTooltipTitle=this.tConfig.x.show,this.fixedTooltip=this.tConfig.fixed.enabled,this.xaxisTooltip=null,this.yaxisTTEls=null,this.isBarShared=!a.globals.isBarHorizontal&&this.tConfig.shared,this.lastHoverTime=Date.now()}return Mc(e,[{key:"getElTooltip",value:function(e){return e||(e=this),e.w.globals.dom.baseEl?e.w.globals.dom.baseEl.querySelector(".apexcharts-tooltip"):null}},{key:"getElXCrosshairs",value:function(){return this.w.globals.dom.baseEl.querySelector(".apexcharts-xcrosshairs")}},{key:"getElGrid",value:function(){return this.w.globals.dom.baseEl.querySelector(".apexcharts-grid")}},{key:"drawTooltip",value:function(e){var t=this.w;this.xyRatios=e,this.isXAxisTooltipEnabled=t.config.xaxis.tooltip.enabled&&t.globals.axisCharts,this.yaxisTooltips=t.config.yaxis.map(function(e,a){return!!(e.show&&e.tooltip.enabled&&t.globals.axisCharts)}),this.allTooltipSeriesGroups=[],t.globals.axisCharts||(this.showTooltipTitle=!1);var a=document.createElement("div");if(a.classList.add("apexcharts-tooltip"),t.config.tooltip.cssClass&&a.classList.add(t.config.tooltip.cssClass),a.classList.add("apexcharts-theme-".concat(this.tConfig.theme||"light")),t.globals.dom.elWrap.appendChild(a),t.globals.axisCharts){this.axesTooltip.drawXaxisTooltip(),this.axesTooltip.drawYaxisTooltip(),this.axesTooltip.setXCrosshairWidth(),this.axesTooltip.handleYCrosshair();var i=new Sp(this.ctx);this.xAxisTicksPositions=i.getXAxisTicksPositions()}if(!t.globals.comboCharts&&!this.tConfig.intersect&&"rangeBar"!==t.config.chart.type||this.tConfig.shared||(this.showOnIntersect=!0),0!==t.config.markers.size&&0!==t.globals.markers.largestSize||this.marker.drawDynamicPoints(this),t.globals.collapsedSeries.length!==t.globals.series.length){this.dataPointsDividedHeight=t.globals.gridHeight/t.globals.dataPoints,this.dataPointsDividedWidth=t.globals.gridWidth/t.globals.dataPoints,this.showTooltipTitle&&(this.tooltipTitle=document.createElement("div"),this.tooltipTitle.classList.add("apexcharts-tooltip-title"),this.tooltipTitle.style.fontFamily=this.tConfig.style.fontFamily||t.config.chart.fontFamily,this.tooltipTitle.style.fontSize=this.tConfig.style.fontSize,a.appendChild(this.tooltipTitle));var s=t.globals.series.length;(t.globals.xyCharts||t.globals.comboCharts)&&this.tConfig.shared&&(s=this.showOnIntersect?1:t.globals.series.length),this.legendLabels=t.globals.dom.baseEl.querySelectorAll(".apexcharts-legend-text"),this.ttItems=this.createTTElements(s),this.addSVGEvents()}}},{key:"createTTElements",value:function(e){for(var t=this,a=this.w,i=[],s=this.getElTooltip(),o=function(o){var n=document.createElement("div");n.classList.add("apexcharts-tooltip-series-group","apexcharts-tooltip-series-group-".concat(o)),n.style.order=a.config.tooltip.inverseOrder?e-o:o+1;var r=document.createElement("span");r.classList.add("apexcharts-tooltip-marker"),a.config.tooltip.fillSeriesColor?r.style.backgroundColor=a.globals.colors[o]:r.style.color=a.globals.colors[o];var l=a.config.markers.shape,c=l;Array.isArray(l)&&(c=l[o]),r.setAttribute("shape",c),n.appendChild(r);var h=document.createElement("div");h.classList.add("apexcharts-tooltip-text"),h.style.fontFamily=t.tConfig.style.fontFamily||a.config.chart.fontFamily,h.style.fontSize=t.tConfig.style.fontSize,["y","goals","z"].forEach(function(e){var t=document.createElement("div");t.classList.add("apexcharts-tooltip-".concat(e,"-group"));var a=document.createElement("span");a.classList.add("apexcharts-tooltip-text-".concat(e,"-label")),t.appendChild(a);var i=document.createElement("span");i.classList.add("apexcharts-tooltip-text-".concat(e,"-value")),t.appendChild(i),h.appendChild(t)}),n.appendChild(h),s.appendChild(n),i.push(n)},n=0;n<e;n++)o(n);return i}},{key:"addSVGEvents",value:function(){var e=this.w,t=e.config.chart.type,a=this.getElTooltip(),i=!("bar"!==t&&"candlestick"!==t&&"boxPlot"!==t&&"rangeBar"!==t),s="area"===t||"line"===t||"scatter"===t||"bubble"===t||"radar"===t,o=e.globals.dom.Paper.node,n=this.getElGrid();n&&(this.seriesBound=n.getBoundingClientRect());var r,l=[],c=[],h={hoverArea:o,elGrid:n,tooltipEl:a,tooltipY:l,tooltipX:c,ttItems:this.ttItems};if(e.globals.axisCharts&&(s?r=e.globals.dom.baseEl.querySelectorAll(".apexcharts-series[data\\:longestSeries='true'] .apexcharts-marker"):i?r=e.globals.dom.baseEl.querySelectorAll(".apexcharts-series .apexcharts-bar-area, .apexcharts-series .apexcharts-candlestick-area, .apexcharts-series .apexcharts-boxPlot-area, .apexcharts-series .apexcharts-rangebar-area"):"heatmap"!==t&&"treemap"!==t||(r=e.globals.dom.baseEl.querySelectorAll(".apexcharts-series .apexcharts-heatmap, .apexcharts-series .apexcharts-treemap")),r&&r.length))for(var d=0;d<r.length;d++)l.push(r[d].getAttribute("cy")),c.push(r[d].getAttribute("cx"));if(e.globals.xyCharts&&!this.showOnIntersect||e.globals.comboCharts&&!this.showOnIntersect||i&&this.tooltipUtil.hasBars()&&this.tConfig.shared)this.addPathsEventListeners([o],h);else if(i&&!e.globals.comboCharts||s&&this.showOnIntersect)this.addDatapointEventsListeners(h);else if(!e.globals.axisCharts||"heatmap"===t||"treemap"===t){var u=e.globals.dom.baseEl.querySelectorAll(".apexcharts-series");this.addPathsEventListeners(u,h)}if(this.showOnIntersect){var p=e.globals.dom.baseEl.querySelectorAll(".apexcharts-line-series .apexcharts-marker, .apexcharts-area-series .apexcharts-marker");p.length>0&&this.addPathsEventListeners(p,h),this.tooltipUtil.hasBars()&&!this.tConfig.shared&&this.addDatapointEventsListeners(h)}}},{key:"drawFixedTooltipRect",value:function(){var e=this.w,t=this.getElTooltip(),a=t.getBoundingClientRect(),i=a.width+10,s=a.height+10,o=this.tConfig.fixed.offsetX,n=this.tConfig.fixed.offsetY,r=this.tConfig.fixed.position.toLowerCase();return r.indexOf("right")>-1&&(o=o+e.globals.svgWidth-i+10),r.indexOf("bottom")>-1&&(n=n+e.globals.svgHeight-s-10),t.style.left=o+"px",t.style.top=n+"px",{x:o,y:n,ttWidth:i,ttHeight:s}}},{key:"addDatapointEventsListeners",value:function(e){var t=this.w.globals.dom.baseEl.querySelectorAll(".apexcharts-series-markers .apexcharts-marker, .apexcharts-bar-area, .apexcharts-candlestick-area, .apexcharts-boxPlot-area, .apexcharts-rangebar-area");this.addPathsEventListeners(t,e)}},{key:"addPathsEventListeners",value:function(e,t){for(var a=this,i=function(i){var s={paths:e[i],tooltipEl:t.tooltipEl,tooltipY:t.tooltipY,tooltipX:t.tooltipX,elGrid:t.elGrid,hoverArea:t.hoverArea,ttItems:t.ttItems};["mousemove","mouseup","touchmove","mouseout","touchend"].map(function(t){return e[i].addEventListener(t,a.onSeriesHover.bind(a,s),{capture:!1,passive:!0})})},s=0;s<e.length;s++)i(s)}},{key:"onSeriesHover",value:function(e,t){var a=this,i=Date.now()-this.lastHoverTime;i>=20?this.seriesHover(e,t):(clearTimeout(this.seriesHoverTimeout),this.seriesHoverTimeout=setTimeout(function(){a.seriesHover(e,t)},20-i))}},{key:"seriesHover",value:function(e,t){var a=this;this.lastHoverTime=Date.now();var i=[],s=this.w;s.config.chart.group&&(i=this.ctx.getGroupedCharts()),s.globals.axisCharts&&(s.globals.minX===-1/0&&s.globals.maxX===1/0||0===s.globals.dataPoints)||(i.length?i.forEach(function(i){var s=a.getElTooltip(i),o={paths:e.paths,tooltipEl:s,tooltipY:e.tooltipY,tooltipX:e.tooltipX,elGrid:e.elGrid,hoverArea:e.hoverArea,ttItems:i.w.globals.tooltip.ttItems};i.w.globals.minX===a.w.globals.minX&&i.w.globals.maxX===a.w.globals.maxX&&i.w.globals.tooltip.seriesHoverByContext({chartCtx:i,ttCtx:i.w.globals.tooltip,opt:o,e:t})}):this.seriesHoverByContext({chartCtx:this.ctx,ttCtx:this.w.globals.tooltip,opt:e,e:t}))}},{key:"seriesHoverByContext",value:function(e){var t=e.chartCtx,a=e.ttCtx,i=e.opt,s=e.e,o=t.w,n=this.getElTooltip(t);n&&(a.tooltipRect={x:0,y:0,ttWidth:n.getBoundingClientRect().width,ttHeight:n.getBoundingClientRect().height},a.e=s,!a.tooltipUtil.hasBars()||o.globals.comboCharts||a.isBarShared||this.tConfig.onDatasetHover.highlightDataSeries&&new wp(t).toggleSeriesOnHover(s,s.target.parentNode),o.globals.axisCharts?a.axisChartsTooltips({e:s,opt:i,tooltipRect:a.tooltipRect}):a.nonAxisChartsTooltips({e:s,opt:i,tooltipRect:a.tooltipRect}),a.fixedTooltip&&a.drawFixedTooltipRect())}},{key:"axisChartsTooltips",value:function(e){var t,a,i=e.e,s=e.opt,o=this.w,n=s.elGrid.getBoundingClientRect(),r="touchmove"===i.type?i.touches[0].clientX:i.clientX,l="touchmove"===i.type?i.touches[0].clientY:i.clientY;if(this.clientY=l,this.clientX=r,o.globals.capturedSeriesIndex=-1,o.globals.capturedDataPointIndex=-1,l<n.top||l>n.top+n.height)this.handleMouseOut(s);else{if(Array.isArray(this.tConfig.enabledOnSeries)&&!o.config.tooltip.shared){var c=parseInt(s.paths.getAttribute("index"),10);if(this.tConfig.enabledOnSeries.indexOf(c)<0)return void this.handleMouseOut(s)}var h=this.getElTooltip(),d=this.getElXCrosshairs(),u=[];o.config.chart.group&&(u=this.ctx.getSyncedCharts());var p=o.globals.xyCharts||"bar"===o.config.chart.type&&!o.globals.isBarHorizontal&&this.tooltipUtil.hasBars()&&this.tConfig.shared||o.globals.comboCharts&&this.tooltipUtil.hasBars();if("mousemove"===i.type||"touchmove"===i.type||"mouseup"===i.type){if(o.globals.collapsedSeries.length+o.globals.ancillaryCollapsedSeries.length===o.globals.series.length)return;null!==d&&d.classList.add("apexcharts-active");var m=this.yaxisTooltips.filter(function(e){return!0===e});if(null!==this.ycrosshairs&&m.length&&this.ycrosshairs.classList.add("apexcharts-active"),p&&!this.showOnIntersect||u.length>1)this.handleStickyTooltip(i,r,l,s);else if("heatmap"===o.config.chart.type||"treemap"===o.config.chart.type){var g=this.intersect.handleHeatTreeTooltip({e:i,opt:s,x:t,y:a,type:o.config.chart.type});t=g.x,a=g.y,h.style.left=t+"px",h.style.top=a+"px"}else this.tooltipUtil.hasBars()&&this.intersect.handleBarTooltip({e:i,opt:s}),this.tooltipUtil.hasMarkers()&&this.intersect.handleMarkerTooltip({e:i,opt:s,x:t,y:a});if(this.yaxisTooltips.length)for(var f=0;f<o.config.yaxis.length;f++)this.axesTooltip.drawYaxisTooltipText(f,l,this.xyRatios);o.globals.dom.baseEl.classList.add("apexcharts-tooltip-active"),s.tooltipEl.classList.add("apexcharts-active")}else"mouseout"!==i.type&&"touchend"!==i.type||this.handleMouseOut(s)}}},{key:"nonAxisChartsTooltips",value:function(e){var t=e.e,a=e.opt,i=e.tooltipRect,s=this.w,o=a.paths.getAttribute("rel"),n=this.getElTooltip(),r=s.globals.dom.elWrap.getBoundingClientRect();if("mousemove"===t.type||"touchmove"===t.type){s.globals.dom.baseEl.classList.add("apexcharts-tooltip-active"),n.classList.add("apexcharts-active"),this.tooltipLabels.drawSeriesTexts({ttItems:a.ttItems,i:parseInt(o,10)-1,shared:!1});var l=s.globals.clientX-r.left-i.ttWidth/2,c=s.globals.clientY-r.top-i.ttHeight-10;if(n.style.left=l+"px",n.style.top=c+"px",s.config.legend.tooltipHoverFormatter){var h=o-1,d=(0,s.config.legend.tooltipHoverFormatter)(this.legendLabels[h].getAttribute("data:default-text"),{seriesIndex:h,dataPointIndex:h,w:s});this.legendLabels[h].innerHTML=d}}else"mouseout"!==t.type&&"touchend"!==t.type||(n.classList.remove("apexcharts-active"),s.globals.dom.baseEl.classList.remove("apexcharts-tooltip-active"),s.config.legend.tooltipHoverFormatter&&this.legendLabels.forEach(function(e){var t=e.getAttribute("data:default-text");e.innerHTML=decodeURIComponent(t)}))}},{key:"handleStickyTooltip",value:function(e,t,a,i){var s=this.w,o=this.tooltipUtil.getNearestValues({context:this,hoverArea:i.hoverArea,elGrid:i.elGrid,clientX:t,clientY:a}),n=o.j,r=o.capturedSeries;s.globals.collapsedSeriesIndices.includes(r)&&(r=null);var l=i.elGrid.getBoundingClientRect();if(o.hoverX<0||o.hoverX>l.width)this.handleMouseOut(i);else if(null!==r)this.handleStickyCapturedSeries(e,r,i,n);else if(this.tooltipUtil.isXoverlap(n)||s.globals.isBarHorizontal){var c=s.globals.series.findIndex(function(e,t){return!s.globals.collapsedSeriesIndices.includes(t)});this.create(e,this,c,n,i.ttItems)}}},{key:"handleStickyCapturedSeries",value:function(e,t,a,i){var s=this.w;if(this.tConfig.shared||null!==s.globals.series[t][i]){if(void 0!==s.globals.series[t][i])this.tConfig.shared&&this.tooltipUtil.isXoverlap(i)&&this.tooltipUtil.isInitialSeriesSameLen()?this.create(e,this,t,i,a.ttItems):this.create(e,this,t,i,a.ttItems,!1);else if(this.tooltipUtil.isXoverlap(i)){var o=s.globals.series.findIndex(function(e,t){return!s.globals.collapsedSeriesIndices.includes(t)});this.create(e,this,o,i,a.ttItems)}}else this.handleMouseOut(a)}},{key:"deactivateHoverFilter",value:function(){for(var e=this.w,t=new Ku(this.ctx),a=e.globals.dom.Paper.find(".apexcharts-bar-area"),i=0;i<a.length;i++)t.pathMouseLeave(a[i])}},{key:"handleMouseOut",value:function(e){var t=this.w,a=this.getElXCrosshairs();if(t.globals.dom.baseEl.classList.remove("apexcharts-tooltip-active"),e.tooltipEl.classList.remove("apexcharts-active"),this.deactivateHoverFilter(),"bubble"!==t.config.chart.type&&this.marker.resetPointsSize(),null!==a&&a.classList.remove("apexcharts-active"),null!==this.ycrosshairs&&this.ycrosshairs.classList.remove("apexcharts-active"),this.isXAxisTooltipEnabled&&this.xaxisTooltip.classList.remove("apexcharts-active"),this.yaxisTooltips.length){null===this.yaxisTTEls&&(this.yaxisTTEls=t.globals.dom.baseEl.querySelectorAll(".apexcharts-yaxistooltip"));for(var i=0;i<this.yaxisTTEls.length;i++)this.yaxisTTEls[i].classList.remove("apexcharts-active")}t.config.legend.tooltipHoverFormatter&&this.legendLabels.forEach(function(e){var t=e.getAttribute("data:default-text");e.innerHTML=decodeURIComponent(t)})}},{key:"markerClick",value:function(e,t,a){var i=this.w;"function"==typeof i.config.chart.events.markerClick&&i.config.chart.events.markerClick(e,this.ctx,{seriesIndex:t,dataPointIndex:a,w:i}),this.ctx.events.fireEvent("markerClick",[e,this.ctx,{seriesIndex:t,dataPointIndex:a,w:i}])}},{key:"create",value:function(e,t,a,i,s){var o,n,r,l,c,h,d,u,p,m,g,f,b,y,w,v,x=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,S=this.w,_=t;"mouseup"===e.type&&this.markerClick(e,a,i),null===x&&(x=this.tConfig.shared);var k=this.tooltipUtil.hasMarkers(a),C=this.tooltipUtil.getElBars(),I=function(){S.globals.markers.largestSize>0?_.marker.enlargePoints(i):_.tooltipPosition.moveDynamicPointsOnHover(i)};if(S.config.legend.tooltipHoverFormatter){var E=S.config.legend.tooltipHoverFormatter,T=Array.from(this.legendLabels);T.forEach(function(e){var t=e.getAttribute("data:default-text");e.innerHTML=decodeURIComponent(t)});for(var A=0;A<T.length;A++){var P=T[A],R=parseInt(P.getAttribute("i"),10),D=decodeURIComponent(P.getAttribute("data:default-text")),M=E(D,{seriesIndex:x?R:a,dataPointIndex:i,w:S});if(x)P.innerHTML=S.globals.collapsedSeriesIndices.indexOf(R)<0?M:D;else if(P.innerHTML=R===a?M:D,a===R)break}}var L=Uc(Uc({ttItems:s,i:a,j:i},void 0!==(null===(o=S.globals.seriesRange)||void 0===o||null===(n=o[a])||void 0===n||null===(r=n[i])||void 0===r||null===(l=r.y[0])||void 0===l?void 0:l.y1)&&{y1:null===(c=S.globals.seriesRange)||void 0===c||null===(h=c[a])||void 0===h||null===(d=h[i])||void 0===d||null===(u=d.y[0])||void 0===u?void 0:u.y1}),void 0!==(null===(p=S.globals.seriesRange)||void 0===p||null===(m=p[a])||void 0===m||null===(g=m[i])||void 0===g||null===(f=g.y[0])||void 0===f?void 0:f.y2)&&{y2:null===(b=S.globals.seriesRange)||void 0===b||null===(y=b[a])||void 0===y||null===(w=y[i])||void 0===w||null===(v=w.y[0])||void 0===v?void 0:v.y2});if(x){if(_.tooltipLabels.drawSeriesTexts(Uc(Uc({},L),{},{shared:!this.showOnIntersect&&this.tConfig.shared})),k)I();else if(this.tooltipUtil.hasBars()&&(this.barSeriesHeight=this.tooltipUtil.getBarsHeight(C),this.barSeriesHeight>0)){var N=new Ku(this.ctx),O=S.globals.dom.Paper.find(".apexcharts-bar-area[j='".concat(i,"']"));this.deactivateHoverFilter(),_.tooltipUtil.getAllMarkers(!0).length&&!this.barSeriesHeight&&I(),_.tooltipPosition.moveStickyTooltipOverBars(i,a);for(var G=0;G<O.length;G++)N.pathMouseEnter(O[G])}}else _.tooltipLabels.drawSeriesTexts(Uc({shared:!1},L)),this.tooltipUtil.hasBars()&&_.tooltipPosition.moveStickyTooltipOverBars(i,a),k&&_.tooltipPosition.moveMarkers(a,i)}}]),e}(),Zp=function(){function e(t){Rc(this,e),this.w=t.w,this.barCtx=t,this.totalFormatter=this.w.config.plotOptions.bar.dataLabels.total.formatter,this.totalFormatter||(this.totalFormatter=this.w.config.dataLabels.formatter)}return Mc(e,[{key:"handleBarDataLabels",value:function(e){var t,a,i=e.x,s=e.y,o=e.y1,n=e.y2,r=e.i,l=e.j,c=e.realIndex,h=e.columnGroupIndex,d=e.series,u=e.barHeight,p=e.barWidth,m=e.barXPosition,g=e.barYPosition,f=e.visibleSeries,b=this.w,y=new Ku(this.barCtx.ctx),w=Array.isArray(this.barCtx.strokeWidth)?this.barCtx.strokeWidth[c]:this.barCtx.strokeWidth;b.globals.isXNumeric&&!b.globals.isBarHorizontal?(t=i+parseFloat(p*(f+1)),a=s+parseFloat(u*(f+1))-w):(t=i+parseFloat(p*f),a=s+parseFloat(u*f));var v,x,S=null,_=i,k=s,C=b.config.dataLabels,I=this.barCtx.barOptions.dataLabels,E=this.barCtx.barOptions.dataLabels.total;void 0!==g&&this.barCtx.isRangeBar&&(a=g,k=g),void 0!==m&&this.barCtx.isVerticalGroupedRangeBar&&(t=m,_=m);var T=C.offsetX,A=C.offsetY,P={width:0,height:0};if(b.config.dataLabels.enabled){var R=b.globals.series[r][l];P=y.getTextRects(b.config.dataLabels.formatter?b.config.dataLabels.formatter(R,Uc(Uc({},b),{},{seriesIndex:r,dataPointIndex:l,w:b})):b.globals.yLabelFormatters[0](R),parseFloat(C.style.fontSize))}var D={x:i,y:s,i:r,j:l,realIndex:c,columnGroupIndex:h,bcx:t,bcy:a,barHeight:u,barWidth:p,textRects:P,strokeWidth:w,dataLabelsX:_,dataLabelsY:k,dataLabelsConfig:C,barDataLabelsConfig:I,barTotalDataLabelsConfig:E,offX:T,offY:A};return x=this.barCtx.isHorizontal?this.calculateBarsDataLabelsPosition(D):this.calculateColumnsDataLabelsPosition(D),v=this.drawCalculatedDataLabels({x:x.dataLabelsX,y:x.dataLabelsY,val:this.barCtx.isRangeBar?[o,n]:"100%"===b.config.chart.stackType?d[c][l]:b.globals.series[c][l],i:c,j:l,barWidth:p,barHeight:u,textRects:P,dataLabelsConfig:C}),b.config.chart.stacked&&E.enabled&&(S=this.drawTotalDataLabels({x:x.totalDataLabelsX,y:x.totalDataLabelsY,barWidth:p,barHeight:u,realIndex:c,textAnchor:x.totalDataLabelsAnchor,val:this.getStackedTotalDataLabel({realIndex:c,j:l}),dataLabelsConfig:C,barTotalDataLabelsConfig:E})),{dataLabelsPos:x,dataLabels:v,totalDataLabels:S}}},{key:"getStackedTotalDataLabel",value:function(e){var t=e.realIndex,a=e.j,i=this.w,s=this.barCtx.stackedSeriesTotals[a];return this.totalFormatter&&(s=this.totalFormatter(s,Uc(Uc({},i),{},{seriesIndex:t,dataPointIndex:a,w:i}))),s}},{key:"calculateColumnsDataLabelsPosition",value:function(e){var t=this,a=this.w,i=e.i,s=e.j,o=e.realIndex;e.columnGroupIndex;var n,r,l=e.y,c=e.bcx,h=e.barWidth,d=e.barHeight,u=e.textRects,p=e.dataLabelsX,m=e.dataLabelsY,g=e.dataLabelsConfig,f=e.barDataLabelsConfig,b=e.barTotalDataLabelsConfig,y=e.strokeWidth,w=e.offX,v=e.offY,x=c;d=Math.abs(d);var S="vertical"===a.config.plotOptions.bar.dataLabels.orientation,_=this.barCtx.barHelpers.getZeroValueEncounters({i:i,j:s}).zeroEncounters;c-=y/2;var k=a.globals.gridWidth/a.globals.dataPoints;this.barCtx.isVerticalGroupedRangeBar?p+=h/2:(p=a.globals.isXNumeric?c-h/2+w:c-k+h/2+w,!a.config.chart.stacked&&_>0&&a.config.plotOptions.bar.hideZeroBarsWhenGrouped&&(p-=h*_)),S&&(p=p+u.height/2-y/2-2);var C=a.globals.series[i][s]<0,I=l;switch(this.barCtx.isReversed&&(I=l+(C?d:-d)),f.position){case"center":m=S?C?I-d/2+v:I+d/2-v:C?I-d/2+u.height/2+v:I+d/2+u.height/2-v;break;case"bottom":m=S?C?I-d+v:I+d-v:C?I-d+u.height+y+v:I+d-u.height/2+y-v;break;case"top":m=S?C?I+v:I-v:C?I-u.height/2-v:I+u.height+v}var E=I;if(a.globals.seriesGroups.forEach(function(e){var a;null===(a=t.barCtx[e.join(",")])||void 0===a||a.prevY.forEach(function(e){E=C?Math.max(e[s],E):Math.min(e[s],E)})}),this.barCtx.lastActiveBarSerieIndex===o&&b.enabled){var T=new Ku(this.barCtx.ctx).getTextRects(this.getStackedTotalDataLabel({realIndex:o,j:s}),g.fontSize);n=C?E-T.height/2-v-b.offsetY+18:E+T.height+v+b.offsetY-18;var A=k;r=x+(a.globals.isXNumeric?-h*a.globals.barGroups.length/2:a.globals.barGroups.length*h/2-(a.globals.barGroups.length-1)*h-A)+b.offsetX}return a.config.chart.stacked||(m<0?m=0+y:m+u.height/3>a.globals.gridHeight&&(m=a.globals.gridHeight-y)),{bcx:c,bcy:l,dataLabelsX:p,dataLabelsY:m,totalDataLabelsX:r,totalDataLabelsY:n,totalDataLabelsAnchor:"middle"}}},{key:"calculateBarsDataLabelsPosition",value:function(e){var t=this,a=this.w,i=e.x,s=e.i,o=e.j,n=e.realIndex,r=e.bcy,l=e.barHeight,c=e.barWidth,h=e.textRects,d=e.dataLabelsX,u=e.strokeWidth,p=e.dataLabelsConfig,m=e.barDataLabelsConfig,g=e.barTotalDataLabelsConfig,f=e.offX,b=e.offY,y=a.globals.gridHeight/a.globals.dataPoints,w=this.barCtx.barHelpers.getZeroValueEncounters({i:s,j:o}).zeroEncounters;c=Math.abs(c);var v,x,S=r-(this.barCtx.isRangeBar?0:y)+l/2+h.height/2+b-3;!a.config.chart.stacked&&w>0&&a.config.plotOptions.bar.hideZeroBarsWhenGrouped&&(S-=l*w);var _="start",k=a.globals.series[s][o]<0,C=i;switch(this.barCtx.isReversed&&(C=i+(k?-c:c),_=k?"start":"end"),m.position){case"center":d=k?C+c/2-f:Math.max(h.width/2,C-c/2)+f;break;case"bottom":d=k?C+c-u-f:C-c+u+f;break;case"top":d=k?C-u-f:C-u+f}var I=C;if(a.globals.seriesGroups.forEach(function(e){var a;null===(a=t.barCtx[e.join(",")])||void 0===a||a.prevX.forEach(function(e){I=k?Math.min(e[o],I):Math.max(e[o],I)})}),this.barCtx.lastActiveBarSerieIndex===n&&g.enabled){var E=new Ku(this.barCtx.ctx).getTextRects(this.getStackedTotalDataLabel({realIndex:n,j:o}),p.fontSize);k?(v=I-u-f-g.offsetX,_="end"):v=I+f+g.offsetX+(this.barCtx.isReversed?-(c+u):u),x=S-h.height/2+E.height/2+g.offsetY+u,a.globals.barGroups.length>1&&(x-=a.globals.barGroups.length/2*(l/2))}return a.config.chart.stacked||("start"===p.textAnchor?d-h.width<0?d=k?h.width+u:u:d+h.width>a.globals.gridWidth&&(d=k?a.globals.gridWidth-u:a.globals.gridWidth-h.width-u):"middle"===p.textAnchor?d-h.width/2<0?d=h.width/2+u:d+h.width/2>a.globals.gridWidth&&(d=a.globals.gridWidth-h.width/2-u):"end"===p.textAnchor&&(d<1?d=h.width+u:d+1>a.globals.gridWidth&&(d=a.globals.gridWidth-h.width-u))),{bcx:i,bcy:r,dataLabelsX:d,dataLabelsY:S,totalDataLabelsX:v,totalDataLabelsY:x,totalDataLabelsAnchor:_}}},{key:"drawCalculatedDataLabels",value:function(e){var t=e.x,a=e.y,i=e.val,s=e.i,o=e.j,n=e.textRects,r=e.barHeight,l=e.barWidth,c=e.dataLabelsConfig,h=this.w,d="rotate(0)";"vertical"===h.config.plotOptions.bar.dataLabels.orientation&&(d="rotate(-90, ".concat(t,", ").concat(a,")"));var u=new yp(this.barCtx.ctx),p=new Ku(this.barCtx.ctx),m=c.formatter,g=null,f=h.globals.collapsedSeriesIndices.indexOf(s)>-1;if(c.enabled&&!f){g=p.group({class:"apexcharts-data-labels",transform:d});var b="";void 0!==i&&(b=m(i,Uc(Uc({},h),{},{seriesIndex:s,dataPointIndex:o,w:h}))),!i&&h.config.plotOptions.bar.hideZeroBarsWhenGrouped&&(b="");var y=h.globals.series[s][o]<0,w=h.config.plotOptions.bar.dataLabels.position;"vertical"===h.config.plotOptions.bar.dataLabels.orientation&&("top"===w&&(c.textAnchor=y?"end":"start"),"center"===w&&(c.textAnchor="middle"),"bottom"===w&&(c.textAnchor=y?"end":"start")),this.barCtx.isRangeBar&&this.barCtx.barOptions.dataLabels.hideOverflowingLabels&&l<p.getTextRects(b,parseFloat(c.style.fontSize)).width&&(b=""),h.config.chart.stacked&&this.barCtx.barOptions.dataLabels.hideOverflowingLabels&&(this.barCtx.isHorizontal?n.width/1.6>Math.abs(l)&&(b=""):n.height/1.6>Math.abs(r)&&(b=""));var v=Uc({},c);this.barCtx.isHorizontal&&i<0&&("start"===c.textAnchor?v.textAnchor="end":"end"===c.textAnchor&&(v.textAnchor="start")),u.plotDataLabelsText({x:t,y:a,text:b,i:s,j:o,parent:g,dataLabelsConfig:v,alwaysDrawDataLabel:!0,offsetCorrection:!0})}return g}},{key:"drawTotalDataLabels",value:function(e){var t=e.x,a=e.y,i=e.val,s=e.realIndex,o=e.textAnchor,n=e.barTotalDataLabelsConfig;this.w;var r,l=new Ku(this.barCtx.ctx);return n.enabled&&void 0!==t&&void 0!==a&&this.barCtx.lastActiveBarSerieIndex===s&&(r=l.drawText({x:t,y:a,foreColor:n.style.color,text:i,textAnchor:o,fontFamily:n.style.fontFamily,fontSize:n.style.fontSize,fontWeight:n.style.fontWeight})),r}}]),e}(),Kp=function(){function e(t){Rc(this,e),this.w=t.w,this.barCtx=t}return Mc(e,[{key:"initVariables",value:function(e){var t=this.w;this.barCtx.series=e,this.barCtx.totalItems=0,this.barCtx.seriesLen=0,this.barCtx.visibleI=-1,this.barCtx.visibleItems=1;for(var a=0;a<e.length;a++)if(e[a].length>0&&(this.barCtx.seriesLen=this.barCtx.seriesLen+1,this.barCtx.totalItems+=e[a].length),t.globals.isXNumeric)for(var i=0;i<e[a].length;i++)t.globals.seriesX[a][i]>t.globals.minX&&t.globals.seriesX[a][i]<t.globals.maxX&&this.barCtx.visibleItems++;else this.barCtx.visibleItems=t.globals.dataPoints;this.arrBorderRadius=this.createBorderRadiusArr(t.globals.series),Xc.isSafari()&&(this.arrBorderRadius=this.arrBorderRadius.map(function(e){return e.map(function(e){return"none"})})),0===this.barCtx.seriesLen&&(this.barCtx.seriesLen=1),this.barCtx.zeroSerieses=[],t.globals.comboCharts||this.checkZeroSeries({series:e})}},{key:"initialPositions",value:function(e){var t,a,i,s,o,n,r,l,c=this.w,h=c.globals.dataPoints;this.barCtx.isRangeBar&&(h=c.globals.labels.length);var d=this.barCtx.seriesLen;if(c.config.plotOptions.bar.rangeBarGroupRows&&(d=1),this.barCtx.isHorizontal)o=(i=c.globals.gridHeight/h)/d,c.globals.isXNumeric&&(o=(i=c.globals.gridHeight/this.barCtx.totalItems)/this.barCtx.seriesLen),o=o*parseInt(this.barCtx.barOptions.barHeight,10)/100,-1===String(this.barCtx.barOptions.barHeight).indexOf("%")&&(o=parseInt(this.barCtx.barOptions.barHeight,10)),l=this.barCtx.baseLineInvertedY+c.globals.padHorizontal+(this.barCtx.isReversed?c.globals.gridWidth:0)-(this.barCtx.isReversed?2*this.barCtx.baseLineInvertedY:0),this.barCtx.isFunnel&&(l=c.globals.gridWidth/2),a=(i-o*this.barCtx.seriesLen)/2;else{if(s=c.globals.gridWidth/this.barCtx.visibleItems,c.config.xaxis.convertedCatToNumeric&&(s=c.globals.gridWidth/c.globals.dataPoints),n=s/d*parseInt(this.barCtx.barOptions.columnWidth,10)/100,c.globals.isXNumeric){var u=this.barCtx.xRatio;c.globals.minXDiff&&.5!==c.globals.minXDiff&&c.globals.minXDiff/u>0&&(s=c.globals.minXDiff/u),(n=s/d*parseInt(this.barCtx.barOptions.columnWidth,10)/100)<1&&(n=1)}-1===String(this.barCtx.barOptions.columnWidth).indexOf("%")&&(n=parseInt(this.barCtx.barOptions.columnWidth,10)),r=c.globals.gridHeight-this.barCtx.baseLineY[this.barCtx.translationsIndex]-(this.barCtx.isReversed?c.globals.gridHeight:0)+(this.barCtx.isReversed?2*this.barCtx.baseLineY[this.barCtx.translationsIndex]:0),t=c.globals.isXNumeric?this.barCtx.getBarXForNumericXAxis({x:t,j:0,realIndex:e,barWidth:n}).x:c.globals.padHorizontal+Xc.noExponents(s-n*this.barCtx.seriesLen)/2}return c.globals.barHeight=o,c.globals.barWidth=n,{x:t,y:a,yDivision:i,xDivision:s,barHeight:o,barWidth:n,zeroH:r,zeroW:l}}},{key:"initializeStackedPrevVars",value:function(e){e.w.globals.seriesGroups.forEach(function(t){e[t]||(e[t]={}),e[t].prevY=[],e[t].prevX=[],e[t].prevYF=[],e[t].prevXF=[],e[t].prevYVal=[],e[t].prevXVal=[]})}},{key:"initializeStackedXYVars",value:function(e){e.w.globals.seriesGroups.forEach(function(t){e[t]||(e[t]={}),e[t].xArrj=[],e[t].xArrjF=[],e[t].xArrjVal=[],e[t].yArrj=[],e[t].yArrjF=[],e[t].yArrjVal=[]})}},{key:"getPathFillColor",value:function(e,t,a,i){var s,o,n,r,l=this.w,c=this.barCtx.ctx.fill,h=null,d=this.barCtx.barOptions.distributed?a:t,u=!1;return this.barCtx.barOptions.colors.ranges.length>0&&this.barCtx.barOptions.colors.ranges.map(function(i){e[t][a]>=i.from&&e[t][a]<=i.to&&(h=i.color,u=!0)}),{color:c.fillPath({seriesNumber:this.barCtx.barOptions.distributed?d:i,dataPointIndex:a,color:h,value:e[t][a],fillConfig:null===(s=l.config.series[t].data[a])||void 0===s?void 0:s.fill,fillType:null!==(o=l.config.series[t].data[a])&&void 0!==o&&null!==(n=o.fill)&&void 0!==n&&n.type?null===(r=l.config.series[t].data[a])||void 0===r?void 0:r.fill.type:Array.isArray(l.config.fill.type)?l.config.fill.type[i]:l.config.fill.type}),useRangeColor:u}}},{key:"getStrokeWidth",value:function(e,t,a){var i=0,s=this.w;return void 0===this.barCtx.series[e][t]||null===this.barCtx.series[e][t]?this.barCtx.isNullValue=!0:this.barCtx.isNullValue=!1,s.config.stroke.show&&(this.barCtx.isNullValue||(i=Array.isArray(this.barCtx.strokeWidth)?this.barCtx.strokeWidth[a]:this.barCtx.strokeWidth)),i}},{key:"createBorderRadiusArr",value:function(e){var t,a=this.w,i=!this.w.config.chart.stacked||a.config.plotOptions.bar.borderRadius<=0,s=e.length,o=0|(null===(t=e[0])||void 0===t?void 0:t.length),n=Array.from({length:s},function(){return Array(o).fill(i?"top":"none")});if(i)return n;for(var r=0;r<o;r++){for(var l=[],c=[],h=0,d=0;d<s;d++){var u=e[d][r];u>0?(l.push(d),h++):u<0&&(c.push(d),h++)}if(l.length>0&&0===c.length)if(1===l.length)n[l[0]][r]="both";else{var p,m=l[0],g=l[l.length-1],f=Lc(l);try{for(f.s();!(p=f.n()).done;){var b=p.value;n[b][r]=b===m?"bottom":b===g?"top":"none"}}catch(R){f.e(R)}finally{f.f()}}else if(c.length>0&&0===l.length)if(1===c.length)n[c[0]][r]="both";else{var y,w=Math.max.apply(Math,c),v=Math.min.apply(Math,c),x=Lc(c);try{for(x.s();!(y=x.n()).done;){var S=y.value;n[S][r]=S===w?"bottom":S===v?"top":"none"}}catch(R){x.e(R)}finally{x.f()}}else if(l.length>0&&c.length>0){var _,k=l[l.length-1],C=Lc(l);try{for(C.s();!(_=C.n()).done;){var I=_.value;n[I][r]=I===k?"top":"none"}}catch(R){C.e(R)}finally{C.f()}var E,T=Math.max.apply(Math,c),A=Lc(c);try{for(A.s();!(E=A.n()).done;){var P=E.value;n[P][r]=P===T?"bottom":"none"}}catch(R){A.e(R)}finally{A.f()}}else 1===h&&(n[l[0]||c[0]][r]="both")}return n}},{key:"barBackground",value:function(e){var t=e.j,a=e.i,i=e.x1,s=e.x2,o=e.y1,n=e.y2,r=e.elSeries,l=this.w,c=new Ku(this.barCtx.ctx),h=new wp(this.barCtx.ctx).getActiveConfigSeriesIndex();if(this.barCtx.barOptions.colors.backgroundBarColors.length>0&&h===a){t>=this.barCtx.barOptions.colors.backgroundBarColors.length&&(t%=this.barCtx.barOptions.colors.backgroundBarColors.length);var d=this.barCtx.barOptions.colors.backgroundBarColors[t],u=c.drawRect(void 0!==i?i:0,void 0!==o?o:0,void 0!==s?s:l.globals.gridWidth,void 0!==n?n:l.globals.gridHeight,this.barCtx.barOptions.colors.backgroundBarRadius,d,this.barCtx.barOptions.colors.backgroundBarOpacity);r.add(u),u.node.classList.add("apexcharts-backgroundBar")}}},{key:"getColumnPaths",value:function(e){var t,a=e.barWidth,i=e.barXPosition,s=e.y1,o=e.y2,n=e.strokeWidth,r=e.isReversed,l=e.series,c=e.seriesGroup,h=e.realIndex,d=e.i,u=e.j,p=e.w,m=new Ku(this.barCtx.ctx);(n=Array.isArray(n)?n[h]:n)||(n=0);var g=a,f=i;null!==(t=p.config.series[h].data[u])&&void 0!==t&&t.columnWidthOffset&&(f=i-p.config.series[h].data[u].columnWidthOffset/2,g=a+p.config.series[h].data[u].columnWidthOffset);var b=n/2,y=f+b,w=f+g-b,v=(l[d][u]>=0?1:-1)*(r?-1:1);s+=.001-b*v,o+=.001+b*v;var x=m.move(y,s),S=m.move(y,s),_=m.line(w,s);if(p.globals.previousPaths.length>0&&(S=this.barCtx.getPreviousPath(h,u,!1)),x=x+m.line(y,o)+m.line(w,o)+_+("around"===p.config.plotOptions.bar.borderRadiusApplication||"both"===this.arrBorderRadius[h][u]?" Z":" z"),S=S+m.line(y,s)+_+_+_+_+_+m.line(y,s)+("around"===p.config.plotOptions.bar.borderRadiusApplication||"both"===this.arrBorderRadius[h][u]?" Z":" z"),"none"!==this.arrBorderRadius[h][u]&&(x=m.roundPathCorners(x,p.config.plotOptions.bar.borderRadius)),p.config.chart.stacked){var k=this.barCtx;(k=this.barCtx[c]).yArrj.push(o-b*v),k.yArrjF.push(Math.abs(s-o+n*v)),k.yArrjVal.push(this.barCtx.series[d][u])}return{pathTo:x,pathFrom:S}}},{key:"getBarpaths",value:function(e){var t,a=e.barYPosition,i=e.barHeight,s=e.x1,o=e.x2,n=e.strokeWidth,r=e.isReversed,l=e.series,c=e.seriesGroup,h=e.realIndex,d=e.i,u=e.j,p=e.w,m=new Ku(this.barCtx.ctx);(n=Array.isArray(n)?n[h]:n)||(n=0);var g=a,f=i;null!==(t=p.config.series[h].data[u])&&void 0!==t&&t.barHeightOffset&&(g=a-p.config.series[h].data[u].barHeightOffset/2,f=i+p.config.series[h].data[u].barHeightOffset);var b=n/2,y=g+b,w=g+f-b,v=(l[d][u]>=0?1:-1)*(r?-1:1);s+=.001+b*v,o+=.001-b*v;var x=m.move(s,y),S=m.move(s,y);p.globals.previousPaths.length>0&&(S=this.barCtx.getPreviousPath(h,u,!1));var _=m.line(s,w);if(x=x+m.line(o,y)+m.line(o,w)+_+("around"===p.config.plotOptions.bar.borderRadiusApplication||"both"===this.arrBorderRadius[h][u]?" Z":" z"),S=S+m.line(s,y)+_+_+_+_+_+m.line(s,y)+("around"===p.config.plotOptions.bar.borderRadiusApplication||"both"===this.arrBorderRadius[h][u]?" Z":" z"),"none"!==this.arrBorderRadius[h][u]&&(x=m.roundPathCorners(x,p.config.plotOptions.bar.borderRadius)),p.config.chart.stacked){var k=this.barCtx;(k=this.barCtx[c]).xArrj.push(o+b*v),k.xArrjF.push(Math.abs(s-o-n*v)),k.xArrjVal.push(this.barCtx.series[d][u])}return{pathTo:x,pathFrom:S}}},{key:"checkZeroSeries",value:function(e){for(var t=e.series,a=this.w,i=0;i<t.length;i++){for(var s=0,o=0;o<t[a.globals.maxValsInArrayIndex].length;o++)s+=t[i][o];0===s&&this.barCtx.zeroSerieses.push(i)}}},{key:"getXForValue",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&!arguments[2]?null:t;return null!=e&&(a=t+e/this.barCtx.invertedYRatio-2*(this.barCtx.isReversed?e/this.barCtx.invertedYRatio:0)),a}},{key:"getYForValue",value:function(e,t,a){var i=arguments.length>3&&void 0!==arguments[3]&&!arguments[3]?null:t;return null!=e&&(i=t-e/this.barCtx.yRatio[a]+2*(this.barCtx.isReversed?e/this.barCtx.yRatio[a]:0)),i}},{key:"getGoalValues",value:function(e,t,a,i,s,o){var n=this,r=this.w,l=[],c=function(i,s){var r;l.push((Oc(r={},e,"x"===e?n.getXForValue(i,t,!1):n.getYForValue(i,a,o,!1)),Oc(r,"attrs",s),r))};if(r.globals.seriesGoals[i]&&r.globals.seriesGoals[i][s]&&Array.isArray(r.globals.seriesGoals[i][s])&&r.globals.seriesGoals[i][s].forEach(function(e){c(e.value,e)}),this.barCtx.barOptions.isDumbbell&&r.globals.seriesRange.length){var h=this.barCtx.barOptions.dumbbellColors?this.barCtx.barOptions.dumbbellColors:r.globals.colors,d={strokeHeight:"x"===e?0:r.globals.markers.size[i],strokeWidth:"x"===e?r.globals.markers.size[i]:0,strokeDashArray:0,strokeLineCap:"round",strokeColor:Array.isArray(h[i])?h[i][0]:h[i]};c(r.globals.seriesRangeStart[i][s],d),c(r.globals.seriesRangeEnd[i][s],Uc(Uc({},d),{},{strokeColor:Array.isArray(h[i])?h[i][1]:h[i]}))}return l}},{key:"drawGoalLine",value:function(e){var t=e.barXPosition,a=e.barYPosition,i=e.goalX,s=e.goalY,o=e.barWidth,n=e.barHeight,r=new Ku(this.barCtx.ctx),l=r.group({className:"apexcharts-bar-goals-groups"});l.node.classList.add("apexcharts-element-hidden"),this.barCtx.w.globals.delayedElements.push({el:l.node}),l.attr("clip-path","url(#gridRectMarkerMask".concat(this.barCtx.w.globals.cuid,")"));var c=null;return this.barCtx.isHorizontal?Array.isArray(i)&&i.forEach(function(e){if(e.x>=-1&&e.x<=r.w.globals.gridWidth+1){var t=void 0!==e.attrs.strokeHeight?e.attrs.strokeHeight:n/2,i=a+t+n/2;c=r.drawLine(e.x,i-2*t,e.x,i,e.attrs.strokeColor?e.attrs.strokeColor:void 0,e.attrs.strokeDashArray,e.attrs.strokeWidth?e.attrs.strokeWidth:2,e.attrs.strokeLineCap),l.add(c)}}):Array.isArray(s)&&s.forEach(function(e){if(e.y>=-1&&e.y<=r.w.globals.gridHeight+1){var a=void 0!==e.attrs.strokeWidth?e.attrs.strokeWidth:o/2,i=t+a+o/2;c=r.drawLine(i-2*a,e.y,i,e.y,e.attrs.strokeColor?e.attrs.strokeColor:void 0,e.attrs.strokeDashArray,e.attrs.strokeHeight?e.attrs.strokeHeight:2,e.attrs.strokeLineCap),l.add(c)}}),l}},{key:"drawBarShadow",value:function(e){var t=e.prevPaths,a=e.currPaths,i=e.color,s=this.w,o=t.x,n=t.x1,r=t.barYPosition,l=a.x,c=a.x1,h=a.barYPosition,d=r+a.barHeight,u=new Ku(this.barCtx.ctx),p=new Xc,m=u.move(n,d)+u.line(o,d)+u.line(l,h)+u.line(c,h)+u.line(n,d)+("around"===s.config.plotOptions.bar.borderRadiusApplication||"both"===this.arrBorderRadius[realIndex][j]?" Z":" z");return u.drawPath({d:m,fill:p.shadeColor(.5,Xc.rgb2hex(i)),stroke:"none",strokeWidth:0,fillOpacity:1,classes:"apexcharts-bar-shadow apexcharts-decoration-element"})}},{key:"getZeroValueEncounters",value:function(e){var t,a=e.i,i=e.j,s=this.w,o=0,n=0;return(s.config.plotOptions.bar.horizontal?s.globals.series.map(function(e,t){return t}):(null===(t=s.globals.columnSeries)||void 0===t?void 0:t.i.map(function(e){return e}))||[]).forEach(function(e){var t=s.globals.seriesPercent[e][i];t&&o++,e<a&&0===t&&n++}),{nonZeroColumns:o,zeroEncounters:n}}},{key:"getGroupIndex",value:function(e){var t=this.w,a=t.globals.seriesGroups.findIndex(function(a){return a.indexOf(t.globals.seriesNames[e])>-1}),i=this.barCtx.columnGroupIndices,s=i.indexOf(a);return s<0&&(i.push(a),s=i.length-1),{groupIndex:a,columnGroupIndex:s}}}]),e}(),Jp=function(){function e(t,a){Rc(this,e),this.ctx=t,this.w=t.w;var i=this.w;this.barOptions=i.config.plotOptions.bar,this.isHorizontal=this.barOptions.horizontal,this.strokeWidth=i.config.stroke.width,this.isNullValue=!1,this.isRangeBar=i.globals.seriesRange.length&&this.isHorizontal,this.isVerticalGroupedRangeBar=!i.globals.isBarHorizontal&&i.globals.seriesRange.length&&i.config.plotOptions.bar.rangeBarGroupRows,this.isFunnel=this.barOptions.isFunnel,this.xyRatios=a,null!==this.xyRatios&&(this.xRatio=a.xRatio,this.yRatio=a.yRatio,this.invertedXRatio=a.invertedXRatio,this.invertedYRatio=a.invertedYRatio,this.baseLineY=a.baseLineY,this.baseLineInvertedY=a.baseLineInvertedY),this.yaxisIndex=0,this.translationsIndex=0,this.seriesLen=0,this.pathArr=[];var s=new wp(this.ctx);this.lastActiveBarSerieIndex=s.getActiveConfigSeriesIndex("desc",["bar","column"]),this.columnGroupIndices=[];var o=s.getBarSeriesIndices(),n=new Ju(this.ctx);this.stackedSeriesTotals=n.getStackedSeriesTotals(this.w.config.series.map(function(e,t){return-1===o.indexOf(t)?t:-1}).filter(function(e){return-1!==e})),this.barHelpers=new Kp(this)}return Mc(e,[{key:"draw",value:function(e,t){var a=this.w,i=new Ku(this.ctx),s=new Ju(this.ctx,a);e=s.getLogSeries(e),this.series=e,this.yRatio=s.getLogYRatios(this.yRatio),this.barHelpers.initVariables(e);var o=i.group({class:"apexcharts-bar-series apexcharts-plot-series"});a.config.dataLabels.enabled&&this.totalItems>this.barOptions.dataLabels.maxItems&&console.warn("WARNING: DataLabels are enabled but there are too many to display. This may cause performance issue when rendering - ApexCharts");for(var n=0,r=0;n<e.length;n++,r++){var l,c,h,d,u=void 0,p=void 0,m=[],g=[],f=a.globals.comboCharts?t[n]:n,b=this.barHelpers.getGroupIndex(f).columnGroupIndex,y=i.group({class:"apexcharts-series",rel:n+1,seriesName:Xc.escapeString(a.globals.seriesNames[f]),"data:realIndex":f});this.ctx.series.addCollapsedClassToSeries(y,f),e[n].length>0&&(this.visibleI=this.visibleI+1);var w=0,v=0;this.yRatio.length>1&&(this.yaxisIndex=a.globals.seriesYAxisReverseMap[f],this.translationsIndex=f);var x=this.translationsIndex;this.isReversed=a.config.yaxis[this.yaxisIndex]&&a.config.yaxis[this.yaxisIndex].reversed;var S=this.barHelpers.initialPositions(f);p=S.y,w=S.barHeight,c=S.yDivision,d=S.zeroW,u=S.x,v=S.barWidth,l=S.xDivision,h=S.zeroH,this.isHorizontal||g.push(u+v/2);var _=i.group({class:"apexcharts-datalabels","data:realIndex":f});a.globals.delayedElements.push({el:_.node}),_.node.classList.add("apexcharts-element-hidden");var k=i.group({class:"apexcharts-bar-goals-markers"}),C=i.group({class:"apexcharts-bar-shadows"});a.globals.delayedElements.push({el:C.node}),C.node.classList.add("apexcharts-element-hidden");for(var I=0;I<e[n].length;I++){var E=this.barHelpers.getStrokeWidth(n,I,f),T=null,A={indexes:{i:n,j:I,realIndex:f,translationsIndex:x,bc:r},x:u,y:p,strokeWidth:E,elSeries:y};this.isHorizontal?(T=this.drawBarPaths(Uc(Uc({},A),{},{barHeight:w,zeroW:d,yDivision:c})),v=this.series[n][I]/this.invertedYRatio):(T=this.drawColumnPaths(Uc(Uc({},A),{},{xDivision:l,barWidth:v,zeroH:h})),w=this.series[n][I]/this.yRatio[x]);var P=this.barHelpers.getPathFillColor(e,n,I,f);if(this.isFunnel&&this.barOptions.isFunnel3d&&this.pathArr.length&&I>0){var R,D=this.barHelpers.drawBarShadow({color:"string"==typeof P.color&&-1===(null===(R=P.color)||void 0===R?void 0:R.indexOf("url"))?P.color:Xc.hexToRgba(a.globals.colors[n]),prevPaths:this.pathArr[this.pathArr.length-1],currPaths:T});C.add(D),a.config.chart.dropShadow.enabled&&new Zu(this.ctx).dropShadow(D,a.config.chart.dropShadow,f)}this.pathArr.push(T);var M=this.barHelpers.drawGoalLine({barXPosition:T.barXPosition,barYPosition:T.barYPosition,goalX:T.goalX,goalY:T.goalY,barHeight:w,barWidth:v});M&&k.add(M),p=T.y,u=T.x,I>0&&g.push(u+v/2),m.push(p),this.renderSeries(Uc(Uc({realIndex:f,pathFill:P.color},P.useRangeColor?{lineFill:P.color}:{}),{},{j:I,i:n,columnGroupIndex:b,pathFrom:T.pathFrom,pathTo:T.pathTo,strokeWidth:E,elSeries:y,x:u,y:p,series:e,barHeight:Math.abs(T.barHeight?T.barHeight:w),barWidth:Math.abs(T.barWidth?T.barWidth:v),elDataLabelsWrap:_,elGoalsMarkers:k,elBarShadows:C,visibleSeries:this.visibleI,type:"bar"}))}a.globals.seriesXvalues[f]=g,a.globals.seriesYvalues[f]=m,o.add(y)}return o}},{key:"renderSeries",value:function(e){var t,a,i,s=e.realIndex,o=e.pathFill,n=e.lineFill,r=e.j,l=e.i,c=e.columnGroupIndex,h=e.pathFrom,d=e.pathTo,u=e.strokeWidth,p=e.elSeries,m=e.x,g=e.y,f=e.y1,b=e.y2,y=e.series,w=e.barHeight,v=e.barWidth,x=e.barXPosition,S=e.barYPosition,_=e.elDataLabelsWrap,k=e.elGoalsMarkers,C=e.elBarShadows,I=e.visibleSeries,E=e.type,T=e.classes,A=this.w,P=new Ku(this.ctx),R=!1;if(!n){var D="function"==typeof A.globals.stroke.colors[s]?(t=s,i=A.config.stroke.colors,Array.isArray(i)&&i.length>0&&((a=i[t])||(a=""),"function"==typeof a)?a({value:A.globals.series[t][r],dataPointIndex:r,w:A}):a):A.globals.stroke.colors[s];n=this.barOptions.distributed?A.globals.stroke.colors[r]:D}var M=new Zp(this).handleBarDataLabels({x:m,y:g,y1:f,y2:b,i:l,j:r,series:y,realIndex:s,columnGroupIndex:c,barHeight:w,barWidth:v,barXPosition:x,barYPosition:S,visibleSeries:I});A.globals.isBarHorizontal||(M.dataLabelsPos.dataLabelsX+v<0||M.dataLabelsPos.dataLabelsX-v>A.globals.gridWidth)&&(R=!0),A.config.series[l].data[r]&&A.config.series[l].data[r].strokeColor&&(n=A.config.series[l].data[r].strokeColor),this.isNullValue&&(o="none");var L=r/A.config.chart.animations.animateGradually.delay*(A.config.chart.animations.speed/A.globals.dataPoints)/2.4;if(!R){var N=P.renderPaths({i:l,j:r,realIndex:s,pathFrom:h,pathTo:d,stroke:n,strokeWidth:u,strokeLineCap:A.config.stroke.lineCap,fill:o,animationDelay:L,initialSpeed:A.config.chart.animations.speed,dataChangeSpeed:A.config.chart.animations.dynamicAnimation.speed,className:"apexcharts-".concat(E,"-area ").concat(T),chartType:E});N.attr("clip-path","url(#gridRectBarMask".concat(A.globals.cuid,")"));var O=A.config.forecastDataPoints;O.count>0&&r>=A.globals.dataPoints-O.count&&(N.node.setAttribute("stroke-dasharray",O.dashArray),N.node.setAttribute("stroke-width",O.strokeWidth),N.node.setAttribute("fill-opacity",O.fillOpacity)),void 0!==f&&void 0!==b&&(N.attr("data-range-y1",f),N.attr("data-range-y2",b)),new Zu(this.ctx).setSelectionFilter(N,s,r),p.add(N),N.attr({cy:M.dataLabelsPos.bcy,cx:M.dataLabelsPos.bcx,j:r,val:A.globals.series[l][r],barHeight:w,barWidth:v}),null!==M.dataLabels&&_.add(M.dataLabels),M.totalDataLabels&&_.add(M.totalDataLabels),p.add(_),k&&p.add(k),C&&p.add(C)}return p}},{key:"drawBarPaths",value:function(e){var t,a=e.indexes,i=e.barHeight,s=e.strokeWidth,o=e.zeroW,n=e.x,r=e.y,l=e.yDivision,c=e.elSeries,h=this.w,d=a.i,u=a.j;if(h.globals.isXNumeric)t=(r=(h.globals.seriesX[d][u]-h.globals.minX)/this.invertedXRatio-i)+i*this.visibleI;else if(h.config.plotOptions.bar.hideZeroBarsWhenGrouped){var p=this.barHelpers.getZeroValueEncounters({i:d,j:u}),m=p.nonZeroColumns,g=p.zeroEncounters;m>0&&(i=this.seriesLen*i/m),t=r+i*this.visibleI,t-=i*g}else t=r+i*this.visibleI;this.isFunnel&&(o-=(this.barHelpers.getXForValue(this.series[d][u],o)-o)/2),n=this.barHelpers.getXForValue(this.series[d][u],o);var f=this.barHelpers.getBarpaths({barYPosition:t,barHeight:i,x1:o,x2:n,strokeWidth:s,isReversed:this.isReversed,series:this.series,realIndex:a.realIndex,i:d,j:u,w:h});return h.globals.isXNumeric||(r+=l),this.barHelpers.barBackground({j:u,i:d,y1:t-i*this.visibleI,y2:i*this.seriesLen,elSeries:c}),{pathTo:f.pathTo,pathFrom:f.pathFrom,x1:o,x:n,y:r,goalX:this.barHelpers.getGoalValues("x",o,null,d,u),barYPosition:t,barHeight:i}}},{key:"drawColumnPaths",value:function(e){var t,a=e.indexes,i=e.x,s=e.y,o=e.xDivision,n=e.barWidth,r=e.zeroH,l=e.strokeWidth,c=e.elSeries,h=this.w,d=a.realIndex,u=a.translationsIndex,p=a.i,m=a.j,g=a.bc;if(h.globals.isXNumeric){var f=this.getBarXForNumericXAxis({x:i,j:m,realIndex:d,barWidth:n});i=f.x,t=f.barXPosition}else if(h.config.plotOptions.bar.hideZeroBarsWhenGrouped){var b=this.barHelpers.getZeroValueEncounters({i:p,j:m}),y=b.nonZeroColumns,w=b.zeroEncounters;y>0&&(n=this.seriesLen*n/y),t=i+n*this.visibleI,t-=n*w}else t=i+n*this.visibleI;s=this.barHelpers.getYForValue(this.series[p][m],r,u);var v=this.barHelpers.getColumnPaths({barXPosition:t,barWidth:n,y1:r,y2:s,strokeWidth:l,isReversed:this.isReversed,series:this.series,realIndex:d,i:p,j:m,w:h});return h.globals.isXNumeric||(i+=o),this.barHelpers.barBackground({bc:g,j:m,i:p,x1:t-l/2-n*this.visibleI,x2:n*this.seriesLen+l/2,elSeries:c}),{pathTo:v.pathTo,pathFrom:v.pathFrom,x:i,y:s,goalY:this.barHelpers.getGoalValues("y",null,r,p,m,u),barXPosition:t,barWidth:n}}},{key:"getBarXForNumericXAxis",value:function(e){var t=e.x,a=e.barWidth,i=e.realIndex,s=e.j,o=this.w,n=i;return o.globals.seriesX[i].length||(n=o.globals.maxValsInArrayIndex),Xc.isNumber(o.globals.seriesX[n][s])&&(t=(o.globals.seriesX[n][s]-o.globals.minX)/this.xRatio-a*this.seriesLen/2),{barXPosition:t+a*this.visibleI,x:t}}},{key:"getPreviousPath",value:function(e,t){for(var a=this.w,i="M 0 0",s=0;s<a.globals.previousPaths.length;s++){var o=a.globals.previousPaths[s];o.paths&&o.paths.length>0&&parseInt(o.realIndex,10)===parseInt(e,10)&&void 0!==a.globals.previousPaths[s].paths[t]&&(i=a.globals.previousPaths[s].paths[t].d)}return i}}]),e}(),Qp=function(){zc(t,Jp);var e=Nc(t);function t(){return Rc(this,t),e.apply(this,arguments)}return Mc(t,[{key:"draw",value:function(e,t){var a=this,i=this.w;this.graphics=new Ku(this.ctx),this.bar=new Jp(this.ctx,this.xyRatios);var s=new Ju(this.ctx,i);e=s.getLogSeries(e),this.yRatio=s.getLogYRatios(this.yRatio),this.barHelpers.initVariables(e),"100%"===i.config.chart.stackType&&(e=i.globals.comboCharts?t.map(function(e){return i.globals.seriesPercent[e]}):i.globals.seriesPercent.slice()),this.series=e,this.barHelpers.initializeStackedPrevVars(this);for(var o=this.graphics.group({class:"apexcharts-bar-series apexcharts-plot-series"}),n=0,r=0,l=function(s,l){var c=void 0,h=void 0,d=void 0,u=void 0,p=i.globals.comboCharts?t[s]:s,m=a.barHelpers.getGroupIndex(p),g=m.groupIndex,f=m.columnGroupIndex;a.groupCtx=a[i.globals.seriesGroups[g]];var b=[],y=[],w=0;a.yRatio.length>1&&(a.yaxisIndex=i.globals.seriesYAxisReverseMap[p][0],w=p),a.isReversed=i.config.yaxis[a.yaxisIndex]&&i.config.yaxis[a.yaxisIndex].reversed;var v=a.graphics.group({class:"apexcharts-series",seriesName:Xc.escapeString(i.globals.seriesNames[p]),rel:s+1,"data:realIndex":p});a.ctx.series.addCollapsedClassToSeries(v,p);var x=a.graphics.group({class:"apexcharts-datalabels","data:realIndex":p}),S=a.graphics.group({class:"apexcharts-bar-goals-markers"}),_=0,k=0,C=a.initialPositions(n,r,c,h,d,u,w);r=C.y,_=C.barHeight,h=C.yDivision,u=C.zeroW,n=C.x,k=C.barWidth,c=C.xDivision,d=C.zeroH,i.globals.barHeight=_,i.globals.barWidth=k,a.barHelpers.initializeStackedXYVars(a),1===a.groupCtx.prevY.length&&a.groupCtx.prevY[0].every(function(e){return isNaN(e)})&&(a.groupCtx.prevY[0]=a.groupCtx.prevY[0].map(function(){return d}),a.groupCtx.prevYF[0]=a.groupCtx.prevYF[0].map(function(){return 0}));for(var I=0;I<i.globals.dataPoints;I++){var E=a.barHelpers.getStrokeWidth(s,I,p),T={indexes:{i:s,j:I,realIndex:p,translationsIndex:w,bc:l},strokeWidth:E,x:n,y:r,elSeries:v,columnGroupIndex:f,seriesGroup:i.globals.seriesGroups[g]},A=null;a.isHorizontal?(A=a.drawStackedBarPaths(Uc(Uc({},T),{},{zeroW:u,barHeight:_,yDivision:h})),k=a.series[s][I]/a.invertedYRatio):(A=a.drawStackedColumnPaths(Uc(Uc({},T),{},{xDivision:c,barWidth:k,zeroH:d})),_=a.series[s][I]/a.yRatio[w]);var P=a.barHelpers.drawGoalLine({barXPosition:A.barXPosition,barYPosition:A.barYPosition,goalX:A.goalX,goalY:A.goalY,barHeight:_,barWidth:k});P&&S.add(P),r=A.y,n=A.x,b.push(n),y.push(r);var R=a.barHelpers.getPathFillColor(e,s,I,p),D="",M=i.globals.isBarHorizontal?"apexcharts-flip-x":"apexcharts-flip-y";("bottom"===a.barHelpers.arrBorderRadius[p][I]&&i.globals.series[p][I]>0||"top"===a.barHelpers.arrBorderRadius[p][I]&&i.globals.series[p][I]<0)&&(D=M),v=a.renderSeries(Uc(Uc({realIndex:p,pathFill:R.color},R.useRangeColor?{lineFill:R.color}:{}),{},{j:I,i:s,columnGroupIndex:f,pathFrom:A.pathFrom,pathTo:A.pathTo,strokeWidth:E,elSeries:v,x:n,y:r,series:e,barHeight:_,barWidth:k,elDataLabelsWrap:x,elGoalsMarkers:S,type:"bar",visibleSeries:f,classes:D}))}i.globals.seriesXvalues[p]=b,i.globals.seriesYvalues[p]=y,a.groupCtx.prevY.push(a.groupCtx.yArrj),a.groupCtx.prevYF.push(a.groupCtx.yArrjF),a.groupCtx.prevYVal.push(a.groupCtx.yArrjVal),a.groupCtx.prevX.push(a.groupCtx.xArrj),a.groupCtx.prevXF.push(a.groupCtx.xArrjF),a.groupCtx.prevXVal.push(a.groupCtx.xArrjVal),o.add(v)},c=0,h=0;c<e.length;c++,h++)l(c,h);return o}},{key:"initialPositions",value:function(e,t,a,i,s,o,n){var r,l,c=this.w;if(this.isHorizontal){i=c.globals.gridHeight/c.globals.dataPoints;var h=c.config.plotOptions.bar.barHeight;r=-1===String(h).indexOf("%")?parseInt(h,10):i*parseInt(h,10)/100,o=c.globals.padHorizontal+(this.isReversed?c.globals.gridWidth-this.baseLineInvertedY:this.baseLineInvertedY),t=(i-r)/2}else{l=a=c.globals.gridWidth/c.globals.dataPoints;var d=c.config.plotOptions.bar.columnWidth;c.globals.isXNumeric&&c.globals.dataPoints>1?l=(a=c.globals.minXDiff/this.xRatio)*parseInt(this.barOptions.columnWidth,10)/100:-1===String(d).indexOf("%")?l=parseInt(d,10):l*=parseInt(d,10)/100,s=this.isReversed?this.baseLineY[n]:c.globals.gridHeight-this.baseLineY[n],e=c.globals.padHorizontal+(a-l)/2}var u=c.globals.barGroups.length||1;return{x:e,y:t,yDivision:i,xDivision:a,barHeight:r/u,barWidth:l/u,zeroH:s,zeroW:o}}},{key:"drawStackedBarPaths",value:function(e){for(var t,a=e.indexes,i=e.barHeight,s=e.strokeWidth,o=e.zeroW,n=e.x,r=e.y,l=e.columnGroupIndex,c=e.seriesGroup,h=e.yDivision,d=e.elSeries,u=this.w,p=r+l*i,m=a.i,g=a.j,f=a.realIndex,b=a.translationsIndex,y=0,w=0;w<this.groupCtx.prevXF.length;w++)y+=this.groupCtx.prevXF[w][g];var v=m;if(u.config.series[f].name&&(v=c.indexOf(u.config.series[f].name)),v>0){var x=o;this.groupCtx.prevXVal[v-1][g]<0?x=this.series[m][g]>=0?this.groupCtx.prevX[v-1][g]+y-2*(this.isReversed?y:0):this.groupCtx.prevX[v-1][g]:this.groupCtx.prevXVal[v-1][g]>=0&&(x=this.series[m][g]>=0?this.groupCtx.prevX[v-1][g]:this.groupCtx.prevX[v-1][g]-y+2*(this.isReversed?y:0)),t=x}else t=o;n=null===this.series[m][g]?t:t+this.series[m][g]/this.invertedYRatio-2*(this.isReversed?this.series[m][g]/this.invertedYRatio:0);var S=this.barHelpers.getBarpaths({barYPosition:p,barHeight:i,x1:t,x2:n,strokeWidth:s,isReversed:this.isReversed,series:this.series,realIndex:a.realIndex,seriesGroup:c,i:m,j:g,w:u});return this.barHelpers.barBackground({j:g,i:m,y1:p,y2:i,elSeries:d}),r+=h,{pathTo:S.pathTo,pathFrom:S.pathFrom,goalX:this.barHelpers.getGoalValues("x",o,null,m,g,b),barXPosition:t,barYPosition:p,x:n,y:r}}},{key:"drawStackedColumnPaths",value:function(e){var t=e.indexes,a=e.x,i=e.y,s=e.xDivision,o=e.barWidth,n=e.zeroH,r=e.columnGroupIndex,l=e.seriesGroup,c=e.elSeries,h=this.w,d=t.i,u=t.j,p=t.bc,m=t.realIndex,g=t.translationsIndex;if(h.globals.isXNumeric){var f=h.globals.seriesX[m][u];f||(f=0),a=(f-h.globals.minX)/this.xRatio-o/2*h.globals.barGroups.length}for(var b,y=a+r*o,w=0,v=0;v<this.groupCtx.prevYF.length;v++)w+=isNaN(this.groupCtx.prevYF[v][u])?0:this.groupCtx.prevYF[v][u];var x=d;if(l&&(x=l.indexOf(h.globals.seriesNames[m])),x>0&&!h.globals.isXNumeric||x>0&&h.globals.isXNumeric&&h.globals.seriesX[m-1][u]===h.globals.seriesX[m][u]){var S,_,k,C=Math.min(this.yRatio.length+1,m+1);if(void 0!==this.groupCtx.prevY[x-1]&&this.groupCtx.prevY[x-1].length)for(var I=1;I<C;I++){var E;if(!isNaN(null===(E=this.groupCtx.prevY[x-I])||void 0===E?void 0:E[u])){k=this.groupCtx.prevY[x-I][u];break}}for(var T=1;T<C;T++){var A,P;if((null===(A=this.groupCtx.prevYVal[x-T])||void 0===A?void 0:A[u])<0){_=this.series[d][u]>=0?k-w+2*(this.isReversed?w:0):k;break}if((null===(P=this.groupCtx.prevYVal[x-T])||void 0===P?void 0:P[u])>=0){_=this.series[d][u]>=0?k:k+w-2*(this.isReversed?w:0);break}}void 0===_&&(_=h.globals.gridHeight),b=null!==(S=this.groupCtx.prevYF[0])&&void 0!==S&&S.every(function(e){return 0===e})&&this.groupCtx.prevYF.slice(1,x).every(function(e){return e.every(function(e){return isNaN(e)})})?n:_}else b=n;i=this.series[d][u]?b-this.series[d][u]/this.yRatio[g]+2*(this.isReversed?this.series[d][u]/this.yRatio[g]:0):b;var R=this.barHelpers.getColumnPaths({barXPosition:y,barWidth:o,y1:b,y2:i,yRatio:this.yRatio[g],strokeWidth:this.strokeWidth,isReversed:this.isReversed,series:this.series,seriesGroup:l,realIndex:t.realIndex,i:d,j:u,w:h});return this.barHelpers.barBackground({bc:p,j:u,i:d,x1:y,x2:o,elSeries:c}),{pathTo:R.pathTo,pathFrom:R.pathFrom,goalY:this.barHelpers.getGoalValues("y",null,n,d,u),barXPosition:y,x:h.globals.isXNumeric?a:a+s,y:i}}}]),t}(),em=function(){zc(t,Jp);var e=Nc(t);function t(){return Rc(this,t),e.apply(this,arguments)}return Mc(t,[{key:"draw",value:function(e,t,a){var i=this,s=this.w,o=new Ku(this.ctx),n=s.globals.comboCharts?t:s.config.chart.type,r=new gp(this.ctx);this.candlestickOptions=this.w.config.plotOptions.candlestick,this.boxOptions=this.w.config.plotOptions.boxPlot,this.isHorizontal=s.config.plotOptions.bar.horizontal,this.isOHLC=this.candlestickOptions&&"ohlc"===this.candlestickOptions.type;var l=new Ju(this.ctx,s);e=l.getLogSeries(e),this.series=e,this.yRatio=l.getLogYRatios(this.yRatio),this.barHelpers.initVariables(e);for(var c=o.group({class:"apexcharts-".concat(n,"-series apexcharts-plot-series")}),h=function(t){i.isBoxPlot="boxPlot"===s.config.chart.type||"boxPlot"===s.config.series[t].type;var n,l,h,d,u=void 0,p=void 0,m=[],g=[],f=s.globals.comboCharts?a[t]:t,b=i.barHelpers.getGroupIndex(f).columnGroupIndex,y=o.group({class:"apexcharts-series",seriesName:Xc.escapeString(s.globals.seriesNames[f]),rel:t+1,"data:realIndex":f});i.ctx.series.addCollapsedClassToSeries(y,f),e[t].length>0&&(i.visibleI=i.visibleI+1);var w,v,x=0;i.yRatio.length>1&&(i.yaxisIndex=s.globals.seriesYAxisReverseMap[f][0],x=f);var S=i.barHelpers.initialPositions(f);p=S.y,w=S.barHeight,l=S.yDivision,d=S.zeroW,u=S.x,v=S.barWidth,n=S.xDivision,h=S.zeroH,g.push(u+v/2);for(var _=o.group({class:"apexcharts-datalabels","data:realIndex":f}),k=o.group({class:"apexcharts-bar-goals-markers"}),C=function(a){var o=i.barHelpers.getStrokeWidth(t,a,f),c=null,S={indexes:{i:t,j:a,realIndex:f,translationsIndex:x},x:u,y:p,strokeWidth:o,elSeries:y};c=i.isHorizontal?i.drawHorizontalBoxPaths(Uc(Uc({},S),{},{yDivision:l,barHeight:w,zeroW:d})):i.drawVerticalBoxPaths(Uc(Uc({},S),{},{xDivision:n,barWidth:v,zeroH:h})),p=c.y,u=c.x;var C=i.barHelpers.drawGoalLine({barXPosition:c.barXPosition,barYPosition:c.barYPosition,goalX:c.goalX,goalY:c.goalY,barHeight:w,barWidth:v});C&&k.add(C),a>0&&g.push(u+v/2),m.push(p),c.pathTo.forEach(function(n,l){var h=!i.isBoxPlot&&i.candlestickOptions.wick.useFillColor?c.color[l]:s.globals.stroke.colors[t],d=r.fillPath({seriesNumber:f,dataPointIndex:a,color:c.color[l],value:e[t][a]});i.renderSeries({realIndex:f,pathFill:d,lineFill:h,j:a,i:t,pathFrom:c.pathFrom,pathTo:n,strokeWidth:o,elSeries:y,x:u,y:p,series:e,columnGroupIndex:b,barHeight:w,barWidth:v,elDataLabelsWrap:_,elGoalsMarkers:k,visibleSeries:i.visibleI,type:s.config.chart.type})})},I=0;I<s.globals.dataPoints;I++)C(I);s.globals.seriesXvalues[f]=g,s.globals.seriesYvalues[f]=m,c.add(y)},d=0;d<e.length;d++)h(d);return c}},{key:"drawVerticalBoxPaths",value:function(e){var t=e.indexes,a=e.x;e.y;var i=e.xDivision,s=e.barWidth,o=e.zeroH,n=e.strokeWidth,r=this.w,l=new Ku(this.ctx),c=t.i,h=t.j,d=r.config.plotOptions.candlestick.colors,u=this.boxOptions.colors,p=t.realIndex,m=function(e){return Array.isArray(e)?e[p]:e},g=m(d.upward),f=m(d.downward),b=this.yRatio[t.translationsIndex],y=this.getOHLCValue(p,h),w=o,v=o,x=y.o<y.c?[g]:[f];this.isBoxPlot&&(x=[m(u.lower),m(u.upper)]);var S=Math.min(y.o,y.c),_=Math.max(y.o,y.c),k=y.m;r.globals.isXNumeric&&(a=(r.globals.seriesX[p][h]-r.globals.minX)/this.xRatio-s/2);var C=a+s*this.visibleI;void 0===this.series[c][h]||null===this.series[c][h]?(S=o,_=o):(S=o-S/b,_=o-_/b,w=o-y.h/b,v=o-y.l/b,k=o-y.m/b);var I=l.move(C,o),E=l.move(C+s/2,S);if(r.globals.previousPaths.length>0&&(E=this.getPreviousPath(p,h,!0)),this.isOHLC){var T=C+s/2,A=o-y.o/b,P=o-y.c/b;I=[l.move(T,w)+l.line(T,v)+l.move(T,A)+l.line(C,A)+l.move(T,P)+l.line(C+s,P)]}else I=this.isBoxPlot?[l.move(C,S)+l.line(C+s/2,S)+l.line(C+s/2,w)+l.line(C+s/4,w)+l.line(C+s-s/4,w)+l.line(C+s/2,w)+l.line(C+s/2,S)+l.line(C+s,S)+l.line(C+s,k)+l.line(C,k)+l.line(C,S+n/2),l.move(C,k)+l.line(C+s,k)+l.line(C+s,_)+l.line(C+s/2,_)+l.line(C+s/2,v)+l.line(C+s-s/4,v)+l.line(C+s/4,v)+l.line(C+s/2,v)+l.line(C+s/2,_)+l.line(C,_)+l.line(C,k)+"z"]:[l.move(C,_)+l.line(C+s/2,_)+l.line(C+s/2,w)+l.line(C+s/2,_)+l.line(C+s,_)+l.line(C+s,S)+l.line(C+s/2,S)+l.line(C+s/2,v)+l.line(C+s/2,S)+l.line(C,S)+l.line(C,_-n/2)];return E+=l.move(C,S),r.globals.isXNumeric||(a+=i),{pathTo:I,pathFrom:E,x:a,y:_,goalY:this.barHelpers.getGoalValues("y",null,o,c,h,t.translationsIndex),barXPosition:C,color:x}}},{key:"drawHorizontalBoxPaths",value:function(e){var t=e.indexes;e.x;var a=e.y,i=e.yDivision,s=e.barHeight,o=e.zeroW,n=e.strokeWidth,r=this.w,l=new Ku(this.ctx),c=t.i,h=t.j,d=this.boxOptions.colors.lower;this.isBoxPlot&&(d=[this.boxOptions.colors.lower,this.boxOptions.colors.upper]);var u=this.invertedYRatio,p=t.realIndex,m=this.getOHLCValue(p,h),g=o,f=o,b=Math.min(m.o,m.c),y=Math.max(m.o,m.c),w=m.m;r.globals.isXNumeric&&(a=(r.globals.seriesX[p][h]-r.globals.minX)/this.invertedXRatio-s/2);var v=a+s*this.visibleI;void 0===this.series[c][h]||null===this.series[c][h]?(b=o,y=o):(b=o+b/u,y=o+y/u,g=o+m.h/u,f=o+m.l/u,w=o+m.m/u);var x=l.move(o,v),S=l.move(b,v+s/2);return r.globals.previousPaths.length>0&&(S=this.getPreviousPath(p,h,!0)),x=[l.move(b,v)+l.line(b,v+s/2)+l.line(g,v+s/2)+l.line(g,v+s/2-s/4)+l.line(g,v+s/2+s/4)+l.line(g,v+s/2)+l.line(b,v+s/2)+l.line(b,v+s)+l.line(w,v+s)+l.line(w,v)+l.line(b+n/2,v),l.move(w,v)+l.line(w,v+s)+l.line(y,v+s)+l.line(y,v+s/2)+l.line(f,v+s/2)+l.line(f,v+s-s/4)+l.line(f,v+s/4)+l.line(f,v+s/2)+l.line(y,v+s/2)+l.line(y,v)+l.line(w,v)+"z"],S+=l.move(b,v),r.globals.isXNumeric||(a+=i),{pathTo:x,pathFrom:S,x:y,y:a,goalX:this.barHelpers.getGoalValues("x",o,null,c,h),barYPosition:v,color:d}}},{key:"getOHLCValue",value:function(e,t){var a=this.w,i=new Ju(this.ctx,a),s=i.getLogValAtSeriesIndex(a.globals.seriesCandleH[e][t],e),o=i.getLogValAtSeriesIndex(a.globals.seriesCandleO[e][t],e),n=i.getLogValAtSeriesIndex(a.globals.seriesCandleM[e][t],e),r=i.getLogValAtSeriesIndex(a.globals.seriesCandleC[e][t],e),l=i.getLogValAtSeriesIndex(a.globals.seriesCandleL[e][t],e);return{o:this.isBoxPlot?s:o,h:this.isBoxPlot?o:s,m:n,l:this.isBoxPlot?r:l,c:this.isBoxPlot?l:r}}}]),t}(),tm=function(){function e(t){Rc(this,e),this.ctx=t,this.w=t.w}return Mc(e,[{key:"checkColorRange",value:function(){var e=this.w,t=!1,a=e.config.plotOptions[e.config.chart.type];return a.colorScale.ranges.length>0&&a.colorScale.ranges.map(function(e,a){e.from<=0&&(t=!0)}),t}},{key:"getShadeColor",value:function(e,t,a,i){var s=this.w,o=1,n=s.config.plotOptions[e].shadeIntensity,r=this.determineColor(e,t,a);s.globals.hasNegs||i?o=s.config.plotOptions[e].reverseNegativeShade?r.percent<0?r.percent/100*(1.25*n):(1-r.percent/100)*(1.25*n):r.percent<=0?1-(1+r.percent/100)*n:(1-r.percent/100)*n:(o=1-r.percent/100,"treemap"===e&&(o=(1-r.percent/100)*(1.25*n)));var l=r.color,c=new Xc;if(s.config.plotOptions[e].enableShades)if("dark"===this.w.config.theme.mode){var h=c.shadeColor(-1*o,r.color);l=Xc.hexToRgba(Xc.isColorHex(h)?h:Xc.rgb2hex(h),s.config.fill.opacity)}else{var d=c.shadeColor(o,r.color);l=Xc.hexToRgba(Xc.isColorHex(d)?d:Xc.rgb2hex(d),s.config.fill.opacity)}return{color:l,colorProps:r}}},{key:"determineColor",value:function(e,t,a){var i=this.w,s=i.globals.series[t][a],o=i.config.plotOptions[e],n=o.colorScale.inverse?a:t;o.distributed&&"treemap"===i.config.chart.type&&(n=a);var r=i.globals.colors[n],l=null,c=Math.min.apply(Math,Vc(i.globals.series[t])),h=Math.max.apply(Math,Vc(i.globals.series[t]));o.distributed||"heatmap"!==e||(c=i.globals.minY,h=i.globals.maxY),void 0!==o.colorScale.min&&(c=o.colorScale.min<i.globals.minY?o.colorScale.min:i.globals.minY,h=o.colorScale.max>i.globals.maxY?o.colorScale.max:i.globals.maxY);var d=Math.abs(h)+Math.abs(c),u=100*s/(0===d?d-1e-6:d);return o.colorScale.ranges.length>0&&o.colorScale.ranges.map(function(e,t){if(s>=e.from&&s<=e.to){r=e.color,l=e.foreColor?e.foreColor:null,c=e.from,h=e.to;var a=Math.abs(h)+Math.abs(c);u=100*s/(0===a?a-1e-6:a)}}),{color:r,foreColor:l,percent:u}}},{key:"calculateDataLabels",value:function(e){var t=e.text,a=e.x,i=e.y,s=e.i,o=e.j,n=e.colorProps,r=e.fontSize,l=this.w.config.dataLabels,c=new Ku(this.ctx),h=new yp(this.ctx),d=null;if(l.enabled){d=c.group({class:"apexcharts-data-labels"});var u=l.offsetX,p=l.offsetY,m=a+u,g=i+parseFloat(l.style.fontSize)/3+p;h.plotDataLabelsText({x:m,y:g,text:t,i:s,j:o,color:n.foreColor,parent:d,fontSize:r,dataLabelsConfig:l})}return d}},{key:"addListeners",value:function(e){var t=new Ku(this.ctx);e.node.addEventListener("mouseenter",t.pathMouseEnter.bind(this,e)),e.node.addEventListener("mouseleave",t.pathMouseLeave.bind(this,e)),e.node.addEventListener("mousedown",t.pathMouseDown.bind(this,e))}}]),e}(),am=function(){function e(t,a){Rc(this,e),this.ctx=t,this.w=t.w,this.xRatio=a.xRatio,this.yRatio=a.yRatio,this.dynamicAnim=this.w.config.chart.animations.dynamicAnimation,this.helpers=new tm(t),this.rectRadius=this.w.config.plotOptions.heatmap.radius,this.strokeWidth=this.w.config.stroke.show?this.w.config.stroke.width:0}return Mc(e,[{key:"draw",value:function(e){var t=this.w,a=new Ku(this.ctx),i=a.group({class:"apexcharts-heatmap"});i.attr("clip-path","url(#gridRectMask".concat(t.globals.cuid,")"));var s=t.globals.gridWidth/t.globals.dataPoints,o=t.globals.gridHeight/t.globals.series.length,n=0,r=!1;this.negRange=this.helpers.checkColorRange();var l=e.slice();t.config.yaxis[0].reversed&&(r=!0,l.reverse());for(var c=r?0:l.length-1;r?c<l.length:c>=0;r?c++:c--){var h=a.group({class:"apexcharts-series apexcharts-heatmap-series",seriesName:Xc.escapeString(t.globals.seriesNames[c]),rel:c+1,"data:realIndex":c});if(this.ctx.series.addCollapsedClassToSeries(h,c),t.config.chart.dropShadow.enabled){var d=t.config.chart.dropShadow;new Zu(this.ctx).dropShadow(h,d,c)}for(var u=0,p=t.config.plotOptions.heatmap.shadeIntensity,m=0,g=0;g<t.globals.dataPoints;g++)if(t.globals.seriesX.length&&!t.globals.allSeriesHasEqualX&&t.globals.minX+t.globals.minXDiff*g<t.globals.seriesX[c][m])u+=s;else{if(m>=l[c].length)break;var f=this.helpers.getShadeColor(t.config.chart.type,c,m,this.negRange),b=f.color,y=f.colorProps;"image"===t.config.fill.type&&(b=new gp(this.ctx).fillPath({seriesNumber:c,dataPointIndex:m,opacity:t.globals.hasNegs?y.percent<0?1-(1+y.percent/100):p+y.percent/100:y.percent/100,patternID:Xc.randomId(),width:t.config.fill.image.width?t.config.fill.image.width:s,height:t.config.fill.image.height?t.config.fill.image.height:o}));var w=this.rectRadius,v=a.drawRect(u,n,s,o,w);if(v.attr({cx:u,cy:n}),v.node.classList.add("apexcharts-heatmap-rect"),h.add(v),v.attr({fill:b,i:c,index:c,j:m,val:e[c][m],"stroke-width":this.strokeWidth,stroke:t.config.plotOptions.heatmap.useFillColorAsStroke?b:t.globals.stroke.colors[0],color:b}),this.helpers.addListeners(v),t.config.chart.animations.enabled&&!t.globals.dataChanged){var x=1;t.globals.resized||(x=t.config.chart.animations.speed),this.animateHeatMap(v,u,n,s,o,x)}if(t.globals.dataChanged){var S=1;if(this.dynamicAnim.enabled&&t.globals.shouldAnimate){S=this.dynamicAnim.speed;var _=t.globals.previousPaths[c]&&t.globals.previousPaths[c][m]&&t.globals.previousPaths[c][m].color;_||(_="rgba(255, 255, 255, 0)"),this.animateHeatColor(v,Xc.isColorHex(_)?_:Xc.rgb2hex(_),Xc.isColorHex(b)?b:Xc.rgb2hex(b),S)}}var k=(0,t.config.dataLabels.formatter)(t.globals.series[c][m],{value:t.globals.series[c][m],seriesIndex:c,dataPointIndex:m,w:t}),C=this.helpers.calculateDataLabels({text:k,x:u+s/2,y:n+o/2,i:c,j:m,colorProps:y,series:l});null!==C&&h.add(C),u+=s,m++}n+=o,i.add(h)}var I=t.globals.yAxisScale[0].result.slice();return t.config.yaxis[0].reversed?I.unshift(""):I.push(""),t.globals.yAxisScale[0].result=I,i}},{key:"animateHeatMap",value:function(e,t,a,i,s,o){var n=new $c(this.ctx);n.animateRect(e,{x:t+i/2,y:a+s/2,width:0,height:0},{x:t,y:a,width:i,height:s},o,function(){n.animationCompleted(e)})}},{key:"animateHeatColor",value:function(e,t,a,i){e.attr({fill:t}).animate(i).attr({fill:a})}}]),e}(),im=function(){function e(t){Rc(this,e),this.ctx=t,this.w=t.w}return Mc(e,[{key:"drawYAxisTexts",value:function(e,t,a,i){var s=this.w,o=s.config.yaxis[0],n=s.globals.yLabelFormatters[0];return new Ku(this.ctx).drawText({x:e+o.labels.offsetX,y:t+o.labels.offsetY,text:n(i,a),textAnchor:"middle",fontSize:o.labels.style.fontSize,fontFamily:o.labels.style.fontFamily,foreColor:Array.isArray(o.labels.style.colors)?o.labels.style.colors[a]:o.labels.style.colors})}}]),e}(),sm=function(){function e(t){Rc(this,e),this.ctx=t,this.w=t.w;var a=this.w;this.chartType=this.w.config.chart.type,this.initialAnim=this.w.config.chart.animations.enabled,this.dynamicAnim=this.initialAnim&&this.w.config.chart.animations.dynamicAnimation.enabled,this.animBeginArr=[0],this.animDur=0,this.donutDataLabels=this.w.config.plotOptions.pie.donut.labels,this.lineColorArr=void 0!==a.globals.stroke.colors?a.globals.stroke.colors:a.globals.colors,this.defaultSize=Math.min(a.globals.gridWidth,a.globals.gridHeight),this.centerY=this.defaultSize/2,this.centerX=a.globals.gridWidth/2,"radialBar"===a.config.chart.type?this.fullAngle=360:this.fullAngle=Math.abs(a.config.plotOptions.pie.endAngle-a.config.plotOptions.pie.startAngle),this.initialAngle=a.config.plotOptions.pie.startAngle%this.fullAngle,a.globals.radialSize=this.defaultSize/2.05-a.config.stroke.width-(a.config.chart.sparkline.enabled?0:a.config.chart.dropShadow.blur),this.donutSize=a.globals.radialSize*parseInt(a.config.plotOptions.pie.donut.size,10)/100;var i=a.config.plotOptions.pie.customScale,s=a.globals.gridWidth/2,o=a.globals.gridHeight/2;this.translateX=s-s*i,this.translateY=o-o*i,this.dataLabelsGroup=new Ku(this.ctx).group({class:"apexcharts-datalabels-group",transform:"translate(".concat(this.translateX,", ").concat(this.translateY,") scale(").concat(i,")")}),this.maxY=0,this.sliceLabels=[],this.sliceSizes=[],this.prevSectorAngleArr=[]}return Mc(e,[{key:"draw",value:function(e){var t=this,a=this.w,i=new Ku(this.ctx),s=i.group({class:"apexcharts-pie"});if(a.globals.noData)return s;for(var o=0,n=0;n<e.length;n++)o+=Xc.negToZero(e[n]);var r=[],l=i.group();0===o&&(o=1e-5),e.forEach(function(e){t.maxY=Math.max(t.maxY,e)}),a.config.yaxis[0].max&&(this.maxY=a.config.yaxis[0].max),"back"===a.config.grid.position&&"polarArea"===this.chartType&&this.drawPolarElements(s);for(var c=0;c<e.length;c++){var h=this.fullAngle*Xc.negToZero(e[c])/o;r.push(h),"polarArea"===this.chartType?(r[c]=this.fullAngle/e.length,this.sliceSizes.push(a.globals.radialSize*e[c]/this.maxY)):this.sliceSizes.push(a.globals.radialSize)}if(a.globals.dataChanged){for(var d,u=0,p=0;p<a.globals.previousPaths.length;p++)u+=Xc.negToZero(a.globals.previousPaths[p]);for(var m=0;m<a.globals.previousPaths.length;m++)d=this.fullAngle*Xc.negToZero(a.globals.previousPaths[m])/u,this.prevSectorAngleArr.push(d)}if(this.donutSize<0&&(this.donutSize=0),"donut"===this.chartType){var g=i.drawCircle(this.donutSize);g.attr({cx:this.centerX,cy:this.centerY,fill:a.config.plotOptions.pie.donut.background?a.config.plotOptions.pie.donut.background:"transparent"}),l.add(g)}var f=this.drawArcs(r,e);if(this.sliceLabels.forEach(function(e){f.add(e)}),l.attr({transform:"translate(".concat(this.translateX,", ").concat(this.translateY,") scale(").concat(a.config.plotOptions.pie.customScale,")")}),l.add(f),s.add(l),this.donutDataLabels.show){var b=this.renderInnerDataLabels(this.dataLabelsGroup,this.donutDataLabels,{hollowSize:this.donutSize,centerX:this.centerX,centerY:this.centerY,opacity:this.donutDataLabels.show});s.add(b)}return"front"===a.config.grid.position&&"polarArea"===this.chartType&&this.drawPolarElements(s),s}},{key:"drawArcs",value:function(e,t){var a=this.w,i=new Zu(this.ctx),s=new Ku(this.ctx),o=new gp(this.ctx),n=s.group({class:"apexcharts-slices"}),r=this.initialAngle,l=this.initialAngle,c=this.initialAngle,h=this.initialAngle;this.strokeWidth=a.config.stroke.show?a.config.stroke.width:0;for(var d=0;d<e.length;d++){var u=s.group({class:"apexcharts-series apexcharts-pie-series",seriesName:Xc.escapeString(a.globals.seriesNames[d]),rel:d+1,"data:realIndex":d});n.add(u),l=h,c=(r=c)+e[d],h=l+this.prevSectorAngleArr[d];var p=c<r?this.fullAngle+c-r:c-r,m=o.fillPath({seriesNumber:d,size:this.sliceSizes[d],value:t[d]}),g=this.getChangedPath(l,h),f=s.drawPath({d:g,stroke:Array.isArray(this.lineColorArr)?this.lineColorArr[d]:this.lineColorArr,strokeWidth:0,fill:m,fillOpacity:a.config.fill.opacity,classes:"apexcharts-pie-area apexcharts-".concat(this.chartType.toLowerCase(),"-slice-").concat(d)});if(f.attr({index:0,j:d}),i.setSelectionFilter(f,0,d),a.config.chart.dropShadow.enabled){var b=a.config.chart.dropShadow;i.dropShadow(f,b,d)}this.addListeners(f,this.donutDataLabels),Ku.setAttrs(f.node,{"data:angle":p,"data:startAngle":r,"data:strokeWidth":this.strokeWidth,"data:value":t[d]});var y={x:0,y:0};"pie"===this.chartType||"polarArea"===this.chartType?y=Xc.polarToCartesian(this.centerX,this.centerY,a.globals.radialSize/1.25+a.config.plotOptions.pie.dataLabels.offset,(r+p/2)%this.fullAngle):"donut"===this.chartType&&(y=Xc.polarToCartesian(this.centerX,this.centerY,(a.globals.radialSize+this.donutSize)/2+a.config.plotOptions.pie.dataLabels.offset,(r+p/2)%this.fullAngle)),u.add(f);var w=0;if(!this.initialAnim||a.globals.resized||a.globals.dataChanged?this.animBeginArr.push(0):(0===(w=p/this.fullAngle*a.config.chart.animations.speed)&&(w=1),this.animDur=w+this.animDur,this.animBeginArr.push(this.animDur)),this.dynamicAnim&&a.globals.dataChanged?this.animatePaths(f,{size:this.sliceSizes[d],endAngle:c,startAngle:r,prevStartAngle:l,prevEndAngle:h,animateStartingPos:!0,i:d,animBeginArr:this.animBeginArr,shouldSetPrevPaths:!0,dur:a.config.chart.animations.dynamicAnimation.speed}):this.animatePaths(f,{size:this.sliceSizes[d],endAngle:c,startAngle:r,i:d,totalItems:e.length-1,animBeginArr:this.animBeginArr,dur:w}),a.config.plotOptions.pie.expandOnClick&&"polarArea"!==this.chartType&&f.node.addEventListener("mouseup",this.pieClicked.bind(this,d)),void 0!==a.globals.selectedDataPoints[0]&&a.globals.selectedDataPoints[0].indexOf(d)>-1&&this.pieClicked(d),a.config.dataLabels.enabled){var v=y.x,x=y.y,S=100*p/this.fullAngle+"%";if(0!==p&&a.config.plotOptions.pie.dataLabels.minAngleToShowLabel<e[d]){var _=a.config.dataLabels.formatter;void 0!==_&&(S=_(a.globals.seriesPercent[d][0],{seriesIndex:d,w:a}));var k=a.globals.dataLabels.style.colors[d],C=s.group({class:"apexcharts-datalabels"}),I=s.drawText({x:v,y:x,text:S,textAnchor:"middle",fontSize:a.config.dataLabels.style.fontSize,fontFamily:a.config.dataLabels.style.fontFamily,fontWeight:a.config.dataLabels.style.fontWeight,foreColor:k});if(C.add(I),a.config.dataLabels.dropShadow.enabled){var E=a.config.dataLabels.dropShadow;i.dropShadow(I,E)}I.node.classList.add("apexcharts-pie-label"),a.config.chart.animations.animate&&!1===a.globals.resized&&(I.node.classList.add("apexcharts-pie-label-delay"),I.node.style.animationDelay=a.config.chart.animations.speed/940+"s"),this.sliceLabels.push(C)}}}return n}},{key:"addListeners",value:function(e,t){var a=new Ku(this.ctx);e.node.addEventListener("mouseenter",a.pathMouseEnter.bind(this,e)),e.node.addEventListener("mouseleave",a.pathMouseLeave.bind(this,e)),e.node.addEventListener("mouseleave",this.revertDataLabelsInner.bind(this,e.node,t)),e.node.addEventListener("mousedown",a.pathMouseDown.bind(this,e)),this.donutDataLabels.total.showAlways||(e.node.addEventListener("mouseenter",this.printDataLabelsInner.bind(this,e.node,t)),e.node.addEventListener("mousedown",this.printDataLabelsInner.bind(this,e.node,t)))}},{key:"animatePaths",value:function(e,t){var a=this.w,i=t.endAngle<t.startAngle?this.fullAngle+t.endAngle-t.startAngle:t.endAngle-t.startAngle,s=i,o=t.startAngle,n=t.startAngle;void 0!==t.prevStartAngle&&void 0!==t.prevEndAngle&&(o=t.prevEndAngle,s=t.prevEndAngle<t.prevStartAngle?this.fullAngle+t.prevEndAngle-t.prevStartAngle:t.prevEndAngle-t.prevStartAngle),t.i===a.config.series.length-1&&(i+n>this.fullAngle?t.endAngle=t.endAngle-(i+n):i+n<this.fullAngle&&(t.endAngle=t.endAngle+(this.fullAngle-(i+n)))),i===this.fullAngle&&(i=this.fullAngle-.01),this.animateArc(e,o,n,i,s,t)}},{key:"animateArc",value:function(e,t,a,i,s,o){var n,r=this,l=this.w,c=new $c(this.ctx),h=o.size;(isNaN(t)||isNaN(s))&&(t=a,s=i,o.dur=0);var d=i,u=a,p=t<a?this.fullAngle+t-a:t-a;l.globals.dataChanged&&o.shouldSetPrevPaths&&o.prevEndAngle&&(n=r.getPiePath({me:r,startAngle:o.prevStartAngle,angle:o.prevEndAngle<o.prevStartAngle?this.fullAngle+o.prevEndAngle-o.prevStartAngle:o.prevEndAngle-o.prevStartAngle,size:h}),e.attr({d:n})),0!==o.dur?e.animate(o.dur,o.animBeginArr[o.i]).after(function(){"pie"!==r.chartType&&"donut"!==r.chartType&&"polarArea"!==r.chartType||this.animate(l.config.chart.animations.dynamicAnimation.speed).attr({"stroke-width":r.strokeWidth}),o.i===l.config.series.length-1&&c.animationCompleted(e)}).during(function(l){d=p+(i-p)*l,o.animateStartingPos&&(d=s+(i-s)*l,u=t-s+(a-(t-s))*l),n=r.getPiePath({me:r,startAngle:u,angle:d,size:h}),e.node.setAttribute("data:pathOrig",n),e.attr({d:n})}):(n=r.getPiePath({me:r,startAngle:u,angle:i,size:h}),o.isTrack||(l.globals.animationEnded=!0),e.node.setAttribute("data:pathOrig",n),e.attr({d:n,"stroke-width":r.strokeWidth}))}},{key:"pieClicked",value:function(e){var t,a=this.w,i=this,s=i.sliceSizes[e]+(a.config.plotOptions.pie.expandOnClick?4:0),o=a.globals.dom.Paper.findOne(".apexcharts-".concat(i.chartType.toLowerCase(),"-slice-").concat(e));if("true"!==o.attr("data:pieClicked")){var n=a.globals.dom.baseEl.getElementsByClassName("apexcharts-pie-area");Array.prototype.forEach.call(n,function(e){e.setAttribute("data:pieClicked","false");var t=e.getAttribute("data:pathOrig");t&&e.setAttribute("d",t)}),a.globals.capturedDataPointIndex=e,o.attr("data:pieClicked","true");var r=parseInt(o.attr("data:startAngle"),10),l=parseInt(o.attr("data:angle"),10);t=i.getPiePath({me:i,startAngle:r,angle:l,size:s}),360!==l&&o.plot(t)}else{o.attr({"data:pieClicked":"false"}),this.revertDataLabelsInner(o.node,this.donutDataLabels);var c=o.attr("data:pathOrig");o.attr({d:c})}}},{key:"getChangedPath",value:function(e,t){var a="";return this.dynamicAnim&&this.w.globals.dataChanged&&(a=this.getPiePath({me:this,startAngle:e,angle:t-e,size:this.size})),a}},{key:"getPiePath",value:function(e){var t,a=e.me,i=e.startAngle,s=e.angle,o=e.size,n=new Ku(this.ctx),r=i,l=Math.PI*(r-90)/180,c=s+i;Math.ceil(c)>=this.fullAngle+this.w.config.plotOptions.pie.startAngle%this.fullAngle&&(c=this.fullAngle+this.w.config.plotOptions.pie.startAngle%this.fullAngle-.01),Math.ceil(c)>this.fullAngle&&(c-=this.fullAngle);var h=Math.PI*(c-90)/180,d=a.centerX+o*Math.cos(l),u=a.centerY+o*Math.sin(l),p=a.centerX+o*Math.cos(h),m=a.centerY+o*Math.sin(h),g=Xc.polarToCartesian(a.centerX,a.centerY,a.donutSize,c),f=Xc.polarToCartesian(a.centerX,a.centerY,a.donutSize,r),b=s>180?1:0,y=["M",d,u,"A",o,o,0,b,1,p,m];return t="donut"===a.chartType?[].concat(y,["L",g.x,g.y,"A",a.donutSize,a.donutSize,0,b,0,f.x,f.y,"L",d,u,"z"]).join(" "):"pie"===a.chartType||"polarArea"===a.chartType?[].concat(y,["L",a.centerX,a.centerY,"L",d,u]).join(" "):[].concat(y).join(" "),n.roundPathCorners(t,2*this.strokeWidth)}},{key:"drawPolarElements",value:function(e){var t=this.w,a=new kp(this.ctx),i=new Ku(this.ctx),s=new im(this.ctx),o=i.group(),n=i.group(),r=a.niceScale(0,Math.ceil(this.maxY),0),l=r.result.reverse(),c=r.result.length;this.maxY=r.niceMax;for(var h=t.globals.radialSize,d=h/(c-1),u=0;u<c-1;u++){var p=i.drawCircle(h);if(p.attr({cx:this.centerX,cy:this.centerY,fill:"none","stroke-width":t.config.plotOptions.polarArea.rings.strokeWidth,stroke:t.config.plotOptions.polarArea.rings.strokeColor}),t.config.yaxis[0].show){var m=s.drawYAxisTexts(this.centerX,this.centerY-h+parseInt(t.config.yaxis[0].labels.style.fontSize,10)/2,u,l[u]);n.add(m)}o.add(p),h-=d}this.drawSpokes(e),e.add(o),e.add(n)}},{key:"renderInnerDataLabels",value:function(e,t,a){var i=this.w,s=new Ku(this.ctx),o=t.total.show;e.node.innerHTML="",e.node.style.opacity=a.opacity;var n,r,l=a.centerX,c=this.donutDataLabels.total.label?a.centerY:a.centerY-a.centerY/6;n=void 0===t.name.color?i.globals.colors[0]:t.name.color;var h=t.name.fontSize,d=t.name.fontFamily,u=t.name.fontWeight;r=void 0===t.value.color?i.config.chart.foreColor:t.value.color;var p=t.value.formatter,m="",g="";if(o?(n=t.total.color,h=t.total.fontSize,d=t.total.fontFamily,u=t.total.fontWeight,g=this.donutDataLabels.total.label?t.total.label:"",m=t.total.formatter(i)):1===i.globals.series.length&&(m=p(i.globals.series[0],i),g=i.globals.seriesNames[0]),g&&(g=t.name.formatter(g,t.total.show,i)),t.name.show){var f=s.drawText({x:l,y:c+parseFloat(t.name.offsetY),text:g,textAnchor:"middle",foreColor:n,fontSize:h,fontWeight:u,fontFamily:d});f.node.classList.add("apexcharts-datalabel-label"),e.add(f)}if(t.value.show){var b=t.name.show?parseFloat(t.value.offsetY)+16:t.value.offsetY,y=s.drawText({x:l,y:c+b,text:m,textAnchor:"middle",foreColor:r,fontWeight:t.value.fontWeight,fontSize:t.value.fontSize,fontFamily:t.value.fontFamily});y.node.classList.add("apexcharts-datalabel-value"),e.add(y)}return e}},{key:"printInnerLabels",value:function(e,t,a,i){var s,o=this.w;i?s=void 0===e.name.color?o.globals.colors[parseInt(i.parentNode.getAttribute("rel"),10)-1]:e.name.color:o.globals.series.length>1&&e.total.show&&(s=e.total.color);var n=o.globals.dom.baseEl.querySelector(".apexcharts-datalabel-label"),r=o.globals.dom.baseEl.querySelector(".apexcharts-datalabel-value");a=(0,e.value.formatter)(a,o),i||"function"!=typeof e.total.formatter||(a=e.total.formatter(o));var l=t===e.total.label;t=this.donutDataLabels.total.label?e.name.formatter(t,l,o):"",null!==n&&(n.textContent=t),null!==r&&(r.textContent=a),null!==n&&(n.style.fill=s)}},{key:"printDataLabelsInner",value:function(e,t){var a=this.w,i=e.getAttribute("data:value"),s=a.globals.seriesNames[parseInt(e.parentNode.getAttribute("rel"),10)-1];a.globals.series.length>1&&this.printInnerLabels(t,s,i,e);var o=a.globals.dom.baseEl.querySelector(".apexcharts-datalabels-group");null!==o&&(o.style.opacity=1)}},{key:"drawSpokes",value:function(e){var t=this,a=this.w,i=new Ku(this.ctx),s=a.config.plotOptions.polarArea.spokes;if(0!==s.strokeWidth){for(var o=[],n=360/a.globals.series.length,r=0;r<a.globals.series.length;r++)o.push(Xc.polarToCartesian(this.centerX,this.centerY,a.globals.radialSize,a.config.plotOptions.pie.startAngle+n*r));o.forEach(function(a,o){var n=i.drawLine(a.x,a.y,t.centerX,t.centerY,Array.isArray(s.connectorColors)?s.connectorColors[o]:s.connectorColors);e.add(n)})}}},{key:"revertDataLabelsInner",value:function(){var e=this.w;if(this.donutDataLabels.show){var t=e.globals.dom.Paper.findOne(".apexcharts-datalabels-group"),a=this.renderInnerDataLabels(t,this.donutDataLabels,{hollowSize:this.donutSize,centerX:this.centerX,centerY:this.centerY,opacity:this.donutDataLabels.show});e.globals.dom.Paper.findOne(".apexcharts-radialbar, .apexcharts-pie").add(a)}}}]),e}(),om=function(){function e(t){Rc(this,e),this.ctx=t,this.w=t.w,this.chartType=this.w.config.chart.type,this.initialAnim=this.w.config.chart.animations.enabled,this.dynamicAnim=this.initialAnim&&this.w.config.chart.animations.dynamicAnimation.enabled,this.animDur=0;var a=this.w;this.graphics=new Ku(this.ctx),this.lineColorArr=void 0!==a.globals.stroke.colors?a.globals.stroke.colors:a.globals.colors,this.defaultSize=a.globals.svgHeight<a.globals.svgWidth?a.globals.gridHeight:a.globals.gridWidth,this.isLog=a.config.yaxis[0].logarithmic,this.logBase=a.config.yaxis[0].logBase,this.coreUtils=new Ju(this.ctx),this.maxValue=this.isLog?this.coreUtils.getLogVal(this.logBase,a.globals.maxY,0):a.globals.maxY,this.minValue=this.isLog?this.coreUtils.getLogVal(this.logBase,this.w.globals.minY,0):a.globals.minY,this.polygons=a.config.plotOptions.radar.polygons,this.strokeWidth=a.config.stroke.show?a.config.stroke.width:0,this.size=this.defaultSize/2.1-this.strokeWidth-a.config.chart.dropShadow.blur,a.config.xaxis.labels.show&&(this.size=this.size-a.globals.xAxisLabelsWidth/1.75),void 0!==a.config.plotOptions.radar.size&&(this.size=a.config.plotOptions.radar.size),this.dataRadiusOfPercent=[],this.dataRadius=[],this.angleArr=[],this.yaxisLabelsTextsPos=[]}return Mc(e,[{key:"draw",value:function(e){var t=this,a=this.w,i=new gp(this.ctx),s=[],o=new yp(this.ctx);e.length&&(this.dataPointsLen=e[a.globals.maxValsInArrayIndex].length),this.disAngle=2*Math.PI/this.dataPointsLen;var n=a.globals.gridWidth/2,r=a.globals.gridHeight/2,l=n+a.config.plotOptions.radar.offsetX,c=r+a.config.plotOptions.radar.offsetY,h=this.graphics.group({class:"apexcharts-radar-series apexcharts-plot-series",transform:"translate(".concat(l||0,", ").concat(c||0,")")}),d=[],u=null,p=null;if(this.yaxisLabels=this.graphics.group({class:"apexcharts-yaxis"}),e.forEach(function(e,n){var r=e.length===a.globals.dataPoints,l=t.graphics.group().attr({class:"apexcharts-series","data:longestSeries":r,seriesName:Xc.escapeString(a.globals.seriesNames[n]),rel:n+1,"data:realIndex":n});t.dataRadiusOfPercent[n]=[],t.dataRadius[n]=[],t.angleArr[n]=[],e.forEach(function(e,a){var i=Math.abs(t.maxValue-t.minValue);e-=t.minValue,t.isLog&&(e=t.coreUtils.getLogVal(t.logBase,e,0)),t.dataRadiusOfPercent[n][a]=e/i,t.dataRadius[n][a]=t.dataRadiusOfPercent[n][a]*t.size,t.angleArr[n][a]=a*t.disAngle}),d=t.getDataPointsPos(t.dataRadius[n],t.angleArr[n]);var c=t.createPaths(d,{x:0,y:0});u=t.graphics.group({class:"apexcharts-series-markers-wrap apexcharts-element-hidden"}),p=t.graphics.group({class:"apexcharts-datalabels","data:realIndex":n}),a.globals.delayedElements.push({el:u.node,index:n});var h={i:n,realIndex:n,animationDelay:n,initialSpeed:a.config.chart.animations.speed,dataChangeSpeed:a.config.chart.animations.dynamicAnimation.speed,className:"apexcharts-radar",shouldClipToGrid:!1,bindEventsOnPaths:!1,stroke:a.globals.stroke.colors[n],strokeLineCap:a.config.stroke.lineCap},m=null;a.globals.previousPaths.length>0&&(m=t.getPreviousPath(n));for(var g=0;g<c.linePathsTo.length;g++){var f=t.graphics.renderPaths(Uc(Uc({},h),{},{pathFrom:null===m?c.linePathsFrom[g]:m,pathTo:c.linePathsTo[g],strokeWidth:Array.isArray(t.strokeWidth)?t.strokeWidth[n]:t.strokeWidth,fill:"none",drawShadow:!1}));l.add(f);var b=i.fillPath({seriesNumber:n}),y=t.graphics.renderPaths(Uc(Uc({},h),{},{pathFrom:null===m?c.areaPathsFrom[g]:m,pathTo:c.areaPathsTo[g],strokeWidth:0,fill:b,drawShadow:!1}));if(a.config.chart.dropShadow.enabled){var w=new Zu(t.ctx),v=a.config.chart.dropShadow;w.dropShadow(y,Object.assign({},v,{noUserSpaceOnUse:!0}),n)}l.add(y)}e.forEach(function(e,i){var s=new fp(t.ctx).getMarkerConfig({cssClass:"apexcharts-marker",seriesIndex:n,dataPointIndex:i}),r=t.graphics.drawMarker(d[i].x,d[i].y,s);r.attr("rel",i),r.attr("j",i),r.attr("index",n),r.node.setAttribute("default-marker-size",s.pSize);var c=t.graphics.group({class:"apexcharts-series-markers"});c&&c.add(r),u.add(c),l.add(u);var h=a.config.dataLabels;if(h.enabled){var m=h.formatter(a.globals.series[n][i],{seriesIndex:n,dataPointIndex:i,w:a});o.plotDataLabelsText({x:d[i].x,y:d[i].y,text:m,textAnchor:"middle",i:n,j:n,parent:p,offsetCorrection:!1,dataLabelsConfig:Uc({},h)})}l.add(p)}),s.push(l)}),this.drawPolygons({parent:h}),a.config.xaxis.labels.show){var m=this.drawXAxisTexts();h.add(m)}return s.forEach(function(e){h.add(e)}),h.add(this.yaxisLabels),h}},{key:"drawPolygons",value:function(e){for(var t=this,a=this.w,i=e.parent,s=new im(this.ctx),o=a.globals.yAxisScale[0].result.reverse(),n=o.length,r=[],l=this.size/(n-1),c=0;c<n;c++)r[c]=l*c;r.reverse();var h=[],d=[];r.forEach(function(e,a){var i=Xc.getPolygonPos(e,t.dataPointsLen),s="";i.forEach(function(e,i){if(0===a){var o=t.graphics.drawLine(e.x,e.y,0,0,Array.isArray(t.polygons.connectorColors)?t.polygons.connectorColors[i]:t.polygons.connectorColors);d.push(o)}0===i&&t.yaxisLabelsTextsPos.push({x:e.x,y:e.y}),s+=e.x+","+e.y+" "}),h.push(s)}),h.forEach(function(e,s){var o=t.polygons.strokeColors,n=t.polygons.strokeWidth,r=t.graphics.drawPolygon(e,Array.isArray(o)?o[s]:o,Array.isArray(n)?n[s]:n,a.globals.radarPolygons.fill.colors[s]);i.add(r)}),d.forEach(function(e){i.add(e)}),a.config.yaxis[0].show&&this.yaxisLabelsTextsPos.forEach(function(e,a){var i=s.drawYAxisTexts(e.x,e.y,a,o[a]);t.yaxisLabels.add(i)})}},{key:"drawXAxisTexts",value:function(){var e=this,t=this.w,a=t.config.xaxis.labels,i=this.graphics.group({class:"apexcharts-xaxis"}),s=Xc.getPolygonPos(this.size,this.dataPointsLen);return t.globals.labels.forEach(function(o,n){var r=t.config.xaxis.labels.formatter,l=new yp(e.ctx);if(s[n]){var c=e.getTextPos(s[n],e.size),h=r(o,{seriesIndex:-1,dataPointIndex:n,w:t});l.plotDataLabelsText({x:c.newX,y:c.newY,text:h,textAnchor:c.textAnchor,i:n,j:n,parent:i,className:"apexcharts-xaxis-label",color:Array.isArray(a.style.colors)&&a.style.colors[n]?a.style.colors[n]:"#a8a8a8",dataLabelsConfig:Uc({textAnchor:c.textAnchor,dropShadow:{enabled:!1}},a),offsetCorrection:!1}).on("click",function(a){if("function"==typeof t.config.chart.events.xAxisLabelClick){var i=Object.assign({},t,{labelIndex:n});t.config.chart.events.xAxisLabelClick(a,e.ctx,i)}})}}),i}},{key:"createPaths",value:function(e,t){var a=this,i=[],s=[],o=[],n=[];if(e.length){s=[this.graphics.move(t.x,t.y)],n=[this.graphics.move(t.x,t.y)];var r=this.graphics.move(e[0].x,e[0].y),l=this.graphics.move(e[0].x,e[0].y);e.forEach(function(t,i){r+=a.graphics.line(t.x,t.y),l+=a.graphics.line(t.x,t.y),i===e.length-1&&(r+="Z",l+="Z")}),i.push(r),o.push(l)}return{linePathsFrom:s,linePathsTo:i,areaPathsFrom:n,areaPathsTo:o}}},{key:"getTextPos",value:function(e,t){var a="middle",i=e.x,s=e.y;return Math.abs(e.x)>=10?e.x>0?(a="start",i+=10):e.x<0&&(a="end",i-=10):a="middle",Math.abs(e.y)>=t-10&&(e.y<0?s-=10:e.y>0&&(s+=10)),{textAnchor:a,newX:i,newY:s}}},{key:"getPreviousPath",value:function(e){for(var t=this.w,a=null,i=0;i<t.globals.previousPaths.length;i++){var s=t.globals.previousPaths[i];s.paths.length>0&&parseInt(s.realIndex,10)===parseInt(e,10)&&void 0!==t.globals.previousPaths[i].paths[0]&&(a=t.globals.previousPaths[i].paths[0].d)}return a}},{key:"getDataPointsPos",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.dataPointsLen;e=e||[],t=t||[];for(var i=[],s=0;s<a;s++){var o={};o.x=e[s]*Math.sin(t[s]),o.y=-e[s]*Math.cos(t[s]),i.push(o)}return i}}]),e}(),nm=function(){zc(t,sm);var e=Nc(t);function t(a){var i;Rc(this,t),(i=e.call(this,a)).ctx=a,i.w=a.w,i.animBeginArr=[0],i.animDur=0;var s=i.w;return i.startAngle=s.config.plotOptions.radialBar.startAngle,i.endAngle=s.config.plotOptions.radialBar.endAngle,i.totalAngle=Math.abs(s.config.plotOptions.radialBar.endAngle-s.config.plotOptions.radialBar.startAngle),i.trackStartAngle=s.config.plotOptions.radialBar.track.startAngle,i.trackEndAngle=s.config.plotOptions.radialBar.track.endAngle,i.barLabels=i.w.config.plotOptions.radialBar.barLabels,i.donutDataLabels=i.w.config.plotOptions.radialBar.dataLabels,i.radialDataLabels=i.donutDataLabels,i.trackStartAngle||(i.trackStartAngle=i.startAngle),i.trackEndAngle||(i.trackEndAngle=i.endAngle),360===i.endAngle&&(i.endAngle=359.99),i.margin=parseInt(s.config.plotOptions.radialBar.track.margin,10),i.onBarLabelClick=i.onBarLabelClick.bind(Pc(i)),i}return Mc(t,[{key:"draw",value:function(e){var t=this.w,a=new Ku(this.ctx),i=a.group({class:"apexcharts-radialbar"});if(t.globals.noData)return i;var s=a.group(),o=this.defaultSize/2,n=t.globals.gridWidth/2,r=this.defaultSize/2.05;t.config.chart.sparkline.enabled||(r=r-t.config.stroke.width-t.config.chart.dropShadow.blur);var l=t.globals.fill.colors;if(t.config.plotOptions.radialBar.track.show){var c=this.drawTracks({size:r,centerX:n,centerY:o,colorArr:l,series:e});s.add(c)}var h=this.drawArcs({size:r,centerX:n,centerY:o,colorArr:l,series:e}),d=360;t.config.plotOptions.radialBar.startAngle<0&&(d=this.totalAngle);var u=(360-d)/360;if(t.globals.radialSize=r-r*u,this.radialDataLabels.value.show){var p=Math.max(this.radialDataLabels.value.offsetY,this.radialDataLabels.name.offsetY);t.globals.radialSize+=p*u}return s.add(h.g),"front"===t.config.plotOptions.radialBar.hollow.position&&(h.g.add(h.elHollow),h.dataLabels&&h.g.add(h.dataLabels)),i.add(s),i}},{key:"drawTracks",value:function(e){var t=this.w,a=new Ku(this.ctx),i=a.group({class:"apexcharts-tracks"}),s=new Zu(this.ctx),o=new gp(this.ctx),n=this.getStrokeWidth(e);e.size=e.size-n/2;for(var r=0;r<e.series.length;r++){var l=a.group({class:"apexcharts-radialbar-track apexcharts-track"});i.add(l),l.attr({rel:r+1}),e.size=e.size-n-this.margin;var c=t.config.plotOptions.radialBar.track,h=o.fillPath({seriesNumber:0,size:e.size,fillColors:Array.isArray(c.background)?c.background[r]:c.background,solid:!0}),d=this.trackStartAngle,u=this.trackEndAngle;Math.abs(u)+Math.abs(d)>=360&&(u=360-Math.abs(this.startAngle)-.1);var p=a.drawPath({d:"",stroke:h,strokeWidth:n*parseInt(c.strokeWidth,10)/100,fill:"none",strokeOpacity:c.opacity,classes:"apexcharts-radialbar-area"});if(c.dropShadow.enabled){var m=c.dropShadow;s.dropShadow(p,m)}l.add(p),p.attr("id","apexcharts-radialbarTrack-"+r),this.animatePaths(p,{centerX:e.centerX,centerY:e.centerY,endAngle:u,startAngle:d,size:e.size,i:r,totalItems:2,animBeginArr:0,dur:0,isTrack:!0})}return i}},{key:"drawArcs",value:function(e){var t=this.w,a=new Ku(this.ctx),i=new gp(this.ctx),s=new Zu(this.ctx),o=a.group(),n=this.getStrokeWidth(e);e.size=e.size-n/2;var r=t.config.plotOptions.radialBar.hollow.background,l=e.size-n*e.series.length-this.margin*e.series.length-n*parseInt(t.config.plotOptions.radialBar.track.strokeWidth,10)/100/2,c=l-t.config.plotOptions.radialBar.hollow.margin;void 0!==t.config.plotOptions.radialBar.hollow.image&&(r=this.drawHollowImage(e,o,l,r));var h=this.drawHollow({size:c,centerX:e.centerX,centerY:e.centerY,fill:r||"transparent"});if(t.config.plotOptions.radialBar.hollow.dropShadow.enabled){var d=t.config.plotOptions.radialBar.hollow.dropShadow;s.dropShadow(h,d)}var u=1;!this.radialDataLabels.total.show&&t.globals.series.length>1&&(u=0);var p=null;if(this.radialDataLabels.show){var m=t.globals.dom.Paper.findOne(".apexcharts-datalabels-group");p=this.renderInnerDataLabels(m,this.radialDataLabels,{hollowSize:l,centerX:e.centerX,centerY:e.centerY,opacity:u})}"back"===t.config.plotOptions.radialBar.hollow.position&&(o.add(h),p&&o.add(p));var g=!1;t.config.plotOptions.radialBar.inverseOrder&&(g=!0);for(var f=g?e.series.length-1:0;g?f>=0:f<e.series.length;g?f--:f++){var b=a.group({class:"apexcharts-series apexcharts-radial-series",seriesName:Xc.escapeString(t.globals.seriesNames[f])});o.add(b),b.attr({rel:f+1,"data:realIndex":f}),this.ctx.series.addCollapsedClassToSeries(b,f),e.size=e.size-n-this.margin;var y=i.fillPath({seriesNumber:f,size:e.size,value:e.series[f]}),w=this.startAngle,v=void 0,x=Xc.negToZero(e.series[f]>100?100:e.series[f])/100,S=Math.round(this.totalAngle*x)+this.startAngle,_=void 0;t.globals.dataChanged&&(v=this.startAngle,_=Math.round(this.totalAngle*Xc.negToZero(t.globals.previousPaths[f])/100)+v),Math.abs(S)+Math.abs(w)>360&&(S-=.01),Math.abs(_)+Math.abs(v)>360&&(_-=.01);var k=S-w,C=Array.isArray(t.config.stroke.dashArray)?t.config.stroke.dashArray[f]:t.config.stroke.dashArray,I=a.drawPath({d:"",stroke:y,strokeWidth:n,fill:"none",fillOpacity:t.config.fill.opacity,classes:"apexcharts-radialbar-area apexcharts-radialbar-slice-"+f,strokeDashArray:C});if(Ku.setAttrs(I.node,{"data:angle":k,"data:value":e.series[f]}),t.config.chart.dropShadow.enabled){var E=t.config.chart.dropShadow;s.dropShadow(I,E,f)}if(s.setSelectionFilter(I,0,f),this.addListeners(I,this.radialDataLabels),b.add(I),I.attr({index:0,j:f}),this.barLabels.enabled){var T=Xc.polarToCartesian(e.centerX,e.centerY,e.size,w),A=this.barLabels.formatter(t.globals.seriesNames[f],{seriesIndex:f,w:t}),P=["apexcharts-radialbar-label"];this.barLabels.onClick||P.push("apexcharts-no-click");var R=this.barLabels.useSeriesColors?t.globals.colors[f]:t.config.chart.foreColor;R||(R=t.config.chart.foreColor);var D=T.x+this.barLabels.offsetX,M=T.y+this.barLabels.offsetY,L=a.drawText({x:D,y:M,text:A,textAnchor:"end",dominantBaseline:"middle",fontFamily:this.barLabels.fontFamily,fontWeight:this.barLabels.fontWeight,fontSize:this.barLabels.fontSize,foreColor:R,cssClass:P.join(" ")});L.on("click",this.onBarLabelClick),L.attr({rel:f+1}),0!==w&&L.attr({"transform-origin":"".concat(D," ").concat(M),transform:"rotate(".concat(w," 0 0)")}),b.add(L)}var N=0;!this.initialAnim||t.globals.resized||t.globals.dataChanged||(N=t.config.chart.animations.speed),t.globals.dataChanged&&(N=t.config.chart.animations.dynamicAnimation.speed),this.animDur=N/(1.2*e.series.length)+this.animDur,this.animBeginArr.push(this.animDur),this.animatePaths(I,{centerX:e.centerX,centerY:e.centerY,endAngle:S,startAngle:w,prevEndAngle:_,prevStartAngle:v,size:e.size,i:f,totalItems:2,animBeginArr:this.animBeginArr,dur:N,shouldSetPrevPaths:!0})}return{g:o,elHollow:h,dataLabels:p}}},{key:"drawHollow",value:function(e){var t=new Ku(this.ctx).drawCircle(2*e.size);return t.attr({class:"apexcharts-radialbar-hollow",cx:e.centerX,cy:e.centerY,r:e.size,fill:e.fill}),t}},{key:"drawHollowImage",value:function(e,t,a,i){var s=this.w,o=new gp(this.ctx),n=Xc.randomId(),r=s.config.plotOptions.radialBar.hollow.image;if(s.config.plotOptions.radialBar.hollow.imageClipped)o.clippedImgArea({width:a,height:a,image:r,patternID:"pattern".concat(s.globals.cuid).concat(n)}),i="url(#pattern".concat(s.globals.cuid).concat(n,")");else{var l=s.config.plotOptions.radialBar.hollow.imageWidth,c=s.config.plotOptions.radialBar.hollow.imageHeight;if(void 0===l&&void 0===c){var h=s.globals.dom.Paper.image(r,function(t){this.move(e.centerX-t.width/2+s.config.plotOptions.radialBar.hollow.imageOffsetX,e.centerY-t.height/2+s.config.plotOptions.radialBar.hollow.imageOffsetY)});t.add(h)}else{var d=s.globals.dom.Paper.image(r,function(t){this.move(e.centerX-l/2+s.config.plotOptions.radialBar.hollow.imageOffsetX,e.centerY-c/2+s.config.plotOptions.radialBar.hollow.imageOffsetY),this.size(l,c)});t.add(d)}}return i}},{key:"getStrokeWidth",value:function(e){var t=this.w;return e.size*(100-parseInt(t.config.plotOptions.radialBar.hollow.size,10))/100/(e.series.length+1)-this.margin}},{key:"onBarLabelClick",value:function(e){var t=parseInt(e.target.getAttribute("rel"),10)-1,a=this.barLabels.onClick,i=this.w;a&&a(i.globals.seriesNames[t],{w:i,seriesIndex:t})}}]),t}(),rm=function(){zc(t,Jp);var e=Nc(t);function t(){return Rc(this,t),e.apply(this,arguments)}return Mc(t,[{key:"draw",value:function(e,t){var a=this.w,i=new Ku(this.ctx);this.rangeBarOptions=this.w.config.plotOptions.rangeBar,this.series=e,this.seriesRangeStart=a.globals.seriesRangeStart,this.seriesRangeEnd=a.globals.seriesRangeEnd,this.barHelpers.initVariables(e);for(var s=i.group({class:"apexcharts-rangebar-series apexcharts-plot-series"}),o=0;o<e.length;o++){var n,r,l,c,h=void 0,d=void 0,u=a.globals.comboCharts?t[o]:o,p=this.barHelpers.getGroupIndex(u).columnGroupIndex,m=i.group({class:"apexcharts-series",seriesName:Xc.escapeString(a.globals.seriesNames[u]),rel:o+1,"data:realIndex":u});this.ctx.series.addCollapsedClassToSeries(m,u),e[o].length>0&&(this.visibleI=this.visibleI+1);var g=0,f=0,b=0;this.yRatio.length>1&&(this.yaxisIndex=a.globals.seriesYAxisReverseMap[u][0],b=u);var y=this.barHelpers.initialPositions(u);d=y.y,c=y.zeroW,h=y.x,f=y.barWidth,g=y.barHeight,n=y.xDivision,r=y.yDivision,l=y.zeroH;for(var w=i.group({class:"apexcharts-datalabels","data:realIndex":u}),v=i.group({class:"apexcharts-rangebar-goals-markers"}),x=0;x<a.globals.dataPoints;x++){var S=this.barHelpers.getStrokeWidth(o,x,u),_=this.seriesRangeStart[o][x],k=this.seriesRangeEnd[o][x],C=null,I=null,E=null,T={x:h,y:d,strokeWidth:S,elSeries:m},A=this.seriesLen;if(a.config.plotOptions.bar.rangeBarGroupRows&&(A=1),void 0===a.config.series[o].data[x])break;if(this.isHorizontal){E=d+g*this.visibleI;var P=(r-g*A)/2;if(a.config.series[o].data[x].x){var R=this.detectOverlappingBars({i:o,j:x,barYPosition:E,srty:P,barHeight:g,yDivision:r,initPositions:y});g=R.barHeight,E=R.barYPosition}f=(C=this.drawRangeBarPaths(Uc({indexes:{i:o,j:x,realIndex:u},barHeight:g,barYPosition:E,zeroW:c,yDivision:r,y1:_,y2:k},T))).barWidth}else{a.globals.isXNumeric&&(h=(a.globals.seriesX[o][x]-a.globals.minX)/this.xRatio-f/2),I=h+f*this.visibleI;var D=(n-f*A)/2;if(a.config.series[o].data[x].x){var M=this.detectOverlappingBars({i:o,j:x,barXPosition:I,srtx:D,barWidth:f,xDivision:n,initPositions:y});f=M.barWidth,I=M.barXPosition}g=(C=this.drawRangeColumnPaths(Uc({indexes:{i:o,j:x,realIndex:u,translationsIndex:b},barWidth:f,barXPosition:I,zeroH:l,xDivision:n},T))).barHeight}var L=this.barHelpers.drawGoalLine({barXPosition:C.barXPosition,barYPosition:E,goalX:C.goalX,goalY:C.goalY,barHeight:g,barWidth:f});L&&v.add(L),d=C.y,h=C.x;var N=this.barHelpers.getPathFillColor(e,o,x,u);this.renderSeries({realIndex:u,pathFill:N.color,lineFill:N.useRangeColor?N.color:a.globals.stroke.colors[u],j:x,i:o,x:h,y:d,y1:_,y2:k,pathFrom:C.pathFrom,pathTo:C.pathTo,strokeWidth:S,elSeries:m,series:e,barHeight:g,barWidth:f,barXPosition:I,barYPosition:E,columnGroupIndex:p,elDataLabelsWrap:w,elGoalsMarkers:v,visibleSeries:this.visibleI,type:"rangebar"})}s.add(m)}return s}},{key:"detectOverlappingBars",value:function(e){var t=e.i,a=e.j,i=e.barYPosition,s=e.barXPosition,o=e.srty,n=e.srtx,r=e.barHeight,l=e.barWidth,c=e.yDivision,h=e.xDivision,d=e.initPositions,u=this.w,p=[],m=u.config.series[t].data[a].rangeName,g=u.config.series[t].data[a].x,f=Array.isArray(g)?g.join(" "):g,b=u.globals.labels.map(function(e){return Array.isArray(e)?e.join(" "):e}).indexOf(f),y=u.globals.seriesRange[t].findIndex(function(e){return e.x===f&&e.overlaps.length>0});return this.isHorizontal?(i=u.config.plotOptions.bar.rangeBarGroupRows?o+c*b:o+r*this.visibleI+c*b,y>-1&&!u.config.plotOptions.bar.rangeBarOverlap&&(p=u.globals.seriesRange[t][y].overlaps).indexOf(m)>-1&&(i=(r=d.barHeight/p.length)*this.visibleI+c*(100-parseInt(this.barOptions.barHeight,10))/100/2+r*(this.visibleI+p.indexOf(m))+c*b)):(b>-1&&!u.globals.timescaleLabels.length&&(s=u.config.plotOptions.bar.rangeBarGroupRows?n+h*b:n+l*this.visibleI+h*b),y>-1&&!u.config.plotOptions.bar.rangeBarOverlap&&(p=u.globals.seriesRange[t][y].overlaps).indexOf(m)>-1&&(s=(l=d.barWidth/p.length)*this.visibleI+h*(100-parseInt(this.barOptions.barWidth,10))/100/2+l*(this.visibleI+p.indexOf(m))+h*b)),{barYPosition:i,barXPosition:s,barHeight:r,barWidth:l}}},{key:"drawRangeColumnPaths",value:function(e){var t=e.indexes,a=e.x,i=e.xDivision,s=e.barWidth,o=e.barXPosition,n=e.zeroH,r=this.w,l=t.i,c=t.j,h=t.realIndex,d=t.translationsIndex,u=this.yRatio[d],p=this.getRangeValue(h,c),m=Math.min(p.start,p.end),g=Math.max(p.start,p.end);void 0===this.series[l][c]||null===this.series[l][c]?m=n:(m=n-m/u,g=n-g/u);var f=Math.abs(g-m),b=this.barHelpers.getColumnPaths({barXPosition:o,barWidth:s,y1:m,y2:g,strokeWidth:this.strokeWidth,series:this.seriesRangeEnd,realIndex:h,i:h,j:c,w:r});if(r.globals.isXNumeric){var y=this.getBarXForNumericXAxis({x:a,j:c,realIndex:h,barWidth:s});a=y.x,o=y.barXPosition}else a+=i;return{pathTo:b.pathTo,pathFrom:b.pathFrom,barHeight:f,x:a,y:p.start<0&&p.end<0?m:g,goalY:this.barHelpers.getGoalValues("y",null,n,l,c,d),barXPosition:o}}},{key:"preventBarOverflow",value:function(e){var t=this.w;return e<0&&(e=0),e>t.globals.gridWidth&&(e=t.globals.gridWidth),e}},{key:"drawRangeBarPaths",value:function(e){var t=e.indexes,a=e.y,i=e.y1,s=e.y2,o=e.yDivision,n=e.barHeight,r=e.barYPosition,l=e.zeroW,c=this.w,h=t.realIndex,d=t.j,u=this.preventBarOverflow(l+i/this.invertedYRatio),p=this.preventBarOverflow(l+s/this.invertedYRatio),m=this.getRangeValue(h,d),g=Math.abs(p-u),f=this.barHelpers.getBarpaths({barYPosition:r,barHeight:n,x1:u,x2:p,strokeWidth:this.strokeWidth,series:this.seriesRangeEnd,i:h,realIndex:h,j:d,w:c});return c.globals.isXNumeric||(a+=o),{pathTo:f.pathTo,pathFrom:f.pathFrom,barWidth:g,x:m.start<0&&m.end<0?u:p,goalX:this.barHelpers.getGoalValues("x",l,null,h,d),y:a}}},{key:"getRangeValue",value:function(e,t){var a=this.w;return{start:a.globals.seriesRangeStart[e][t],end:a.globals.seriesRangeEnd[e][t]}}}]),t}(),lm=function(){function e(t){Rc(this,e),this.w=t.w,this.lineCtx=t}return Mc(e,[{key:"sameValueSeriesFix",value:function(e,t){var a=this.w;if(("gradient"===a.config.fill.type||"gradient"===a.config.fill.type[e])&&new Ju(this.lineCtx.ctx,a).seriesHaveSameValues(e)){var i=t[e].slice();i[i.length-1]=i[i.length-1]+1e-6,t[e]=i}return t}},{key:"calculatePoints",value:function(e){var t=e.series,a=e.realIndex,i=e.x,s=e.y,o=e.i,n=e.j,r=e.prevY,l=this.w,c=[],h=[],d=this.lineCtx.categoryAxisCorrection+l.config.markers.offsetX;return l.globals.isXNumeric&&(d=(l.globals.seriesX[a][0]-l.globals.minX)/this.lineCtx.xRatio+l.config.markers.offsetX),0===n&&(c.push(d),h.push(Xc.isNumber(t[o][0])?r+l.config.markers.offsetY:null)),c.push(i+l.config.markers.offsetX),h.push(Xc.isNumber(t[o][n+1])?s+l.config.markers.offsetY:null),{x:c,y:h}}},{key:"checkPreviousPaths",value:function(e){for(var t=e.pathFromLine,a=e.pathFromArea,i=e.realIndex,s=this.w,o=0;o<s.globals.previousPaths.length;o++){var n=s.globals.previousPaths[o];("line"===n.type||"area"===n.type)&&n.paths.length>0&&parseInt(n.realIndex,10)===parseInt(i,10)&&("line"===n.type?(this.lineCtx.appendPathFrom=!1,t=s.globals.previousPaths[o].paths[0].d):"area"===n.type&&(this.lineCtx.appendPathFrom=!1,a=s.globals.previousPaths[o].paths[0].d,s.config.stroke.show&&s.globals.previousPaths[o].paths[1]&&(t=s.globals.previousPaths[o].paths[1].d)))}return{pathFromLine:t,pathFromArea:a}}},{key:"determineFirstPrevY",value:function(e){var t,a,i,s=e.i,o=e.realIndex,n=e.series,r=e.prevY,l=e.lineYPosition,c=e.translationsIndex,h=this.w,d=h.config.chart.stacked&&!h.globals.comboCharts||h.config.chart.stacked&&h.globals.comboCharts&&(!this.w.config.chart.stackOnlyBar||"bar"===(null===(t=this.w.config.series[o])||void 0===t?void 0:t.type)||"column"===(null===(a=this.w.config.series[o])||void 0===a?void 0:a.type));if(void 0!==(null===(i=n[s])||void 0===i?void 0:i[0]))r=(l=d&&s>0?this.lineCtx.prevSeriesY[s-1][0]:this.lineCtx.zeroY)-n[s][0]/this.lineCtx.yRatio[c]+2*(this.lineCtx.isReversed?n[s][0]/this.lineCtx.yRatio[c]:0);else if(d&&s>0&&void 0===n[s][0])for(var u=s-1;u>=0;u--)if(null!==n[u][0]&&void 0!==n[u][0]){r=l=this.lineCtx.prevSeriesY[u][0];break}return{prevY:r,lineYPosition:l}}}]),e}(),cm=function(e){var t=function(e){for(var t,a,i,s,o=function(e){for(var t=[],a=e[0],i=e[1],s=t[0]=dm(a,i),o=1,n=e.length-1;o<n;o++)a=i,i=e[o+1],t[o]=.5*(s+(s=dm(a,i)));return t[o]=s,t}(e),n=e.length-1,r=[],l=0;l<n;l++)i=dm(e[l],e[l+1]),Math.abs(i)<1e-6?o[l]=o[l+1]=0:(s=(t=o[l]/i)*t+(a=o[l+1]/i)*a)>9&&(s=3*i/Math.sqrt(s),o[l]=s*t,o[l+1]=s*a);for(var c=0;c<=n;c++)s=(e[Math.min(n,c+1)][0]-e[Math.max(0,c-1)][0])/(6*(1+o[c]*o[c])),r.push([s||0,o[c]*s||0]);return r}(e),a=e[1],i=e[0],s=[],o=t[1],n=t[0];s.push(i,[i[0]+n[0],i[1]+n[1],a[0]-o[0],a[1]-o[1],a[0],a[1]]);for(var r=2,l=t.length;r<l;r++){var c=e[r],h=t[r];s.push([c[0]-h[0],c[1]-h[1],c[0],c[1]])}return s},hm=function(e,t,a){var i=e.slice(t,a);if(t){if(a-t>1&&i[1].length<6){var s=i[0].length;i[1]=[2*i[0][s-2]-i[0][s-4],2*i[0][s-1]-i[0][s-3]].concat(i[1])}i[0]=i[0].slice(-2)}return i};function dm(e,t){return(t[1]-e[1])/(t[0]-e[0])}var um=function(){function e(t,a,i){Rc(this,e),this.ctx=t,this.w=t.w,this.xyRatios=a,this.pointsChart=!("bubble"!==this.w.config.chart.type&&"scatter"!==this.w.config.chart.type)||i,this.scatter=new bp(this.ctx),this.noNegatives=this.w.globals.minX===Number.MAX_VALUE,this.lineHelpers=new lm(this),this.markers=new fp(this.ctx),this.prevSeriesY=[],this.categoryAxisCorrection=0,this.yaxisIndex=0}return Mc(e,[{key:"draw",value:function(e,t,a,i){var s,o=this.w,n=new Ku(this.ctx),r=o.globals.comboCharts?t:o.config.chart.type,l=n.group({class:"apexcharts-".concat(r,"-series apexcharts-plot-series")}),c=new Ju(this.ctx,o);this.yRatio=this.xyRatios.yRatio,this.zRatio=this.xyRatios.zRatio,this.xRatio=this.xyRatios.xRatio,this.baseLineY=this.xyRatios.baseLineY,e=c.getLogSeries(e),this.yRatio=c.getLogYRatios(this.yRatio),this.prevSeriesY=[];for(var h=[],d=0;d<e.length;d++){e=this.lineHelpers.sameValueSeriesFix(d,e);var u=o.globals.comboCharts?a[d]:d,p=this.yRatio.length>1?u:0;this._initSerieVariables(e,d,u);var m=[],g=[],f=[],b=o.globals.padHorizontal+this.categoryAxisCorrection;this.ctx.series.addCollapsedClassToSeries(this.elSeries,u),o.globals.isXNumeric&&o.globals.seriesX.length>0&&(b=(o.globals.seriesX[u][0]-o.globals.minX)/this.xRatio),f.push(b);var y,w=b,v=void 0,x=w,S=this.zeroY,_=this.zeroY;S=this.lineHelpers.determineFirstPrevY({i:d,realIndex:u,series:e,prevY:S,lineYPosition:0,translationsIndex:p}).prevY,"monotoneCubic"===o.config.stroke.curve&&null===e[d][0]?m.push(null):m.push(S),y=S,"rangeArea"===r&&(v=_=this.lineHelpers.determineFirstPrevY({i:d,realIndex:u,series:i,prevY:_,lineYPosition:0,translationsIndex:p}).prevY,g.push(null!==m[0]?_:null));var k=this._calculatePathsFrom({type:r,series:e,i:d,realIndex:u,translationsIndex:p,prevX:x,prevY:S,prevY2:_}),C=[m[0]],I=[g[0]],E={type:r,series:e,realIndex:u,translationsIndex:p,i:d,x:b,y:1,pX:w,pY:y,pathsFrom:k,linePaths:[],areaPaths:[],seriesIndex:a,lineYPosition:0,xArrj:f,yArrj:m,y2Arrj:g,seriesRangeEnd:i},T=this._iterateOverDataPoints(Uc(Uc({},E),{},{iterations:"rangeArea"===r?e[d].length-1:void 0,isRangeStart:!0}));if("rangeArea"===r){for(var A=this._calculatePathsFrom({series:i,i:d,realIndex:u,prevX:x,prevY:_}),P=this._iterateOverDataPoints(Uc(Uc({},E),{},{series:i,xArrj:[b],yArrj:C,y2Arrj:I,pY:v,areaPaths:T.areaPaths,pathsFrom:A,iterations:i[d].length-1,isRangeStart:!1})),R=T.linePaths.length/2,D=0;D<R;D++)T.linePaths[D]=P.linePaths[D+R]+T.linePaths[D];T.linePaths.splice(R),T.pathFromLine=P.pathFromLine+T.pathFromLine}else T.pathFromArea+="z";this._handlePaths({type:r,realIndex:u,i:d,paths:T}),this.elSeries.add(this.elPointsMain),this.elSeries.add(this.elDataLabelsWrap),h.push(this.elSeries)}if(void 0!==(null===(s=o.config.series[0])||void 0===s?void 0:s.zIndex)&&h.sort(function(e,t){return Number(e.node.getAttribute("zIndex"))-Number(t.node.getAttribute("zIndex"))}),o.config.chart.stacked)for(var M=h.length-1;M>=0;M--)l.add(h[M]);else for(var L=0;L<h.length;L++)l.add(h[L]);return l}},{key:"_initSerieVariables",value:function(e,t,a){var i=this.w,s=new Ku(this.ctx);this.xDivision=i.globals.gridWidth/(i.globals.dataPoints-("on"===i.config.xaxis.tickPlacement?1:0)),this.strokeWidth=Array.isArray(i.config.stroke.width)?i.config.stroke.width[a]:i.config.stroke.width;var o=0;if(this.yRatio.length>1&&(this.yaxisIndex=i.globals.seriesYAxisReverseMap[a],o=a),this.isReversed=i.config.yaxis[this.yaxisIndex]&&i.config.yaxis[this.yaxisIndex].reversed,this.zeroY=i.globals.gridHeight-this.baseLineY[o]-(this.isReversed?i.globals.gridHeight:0)+(this.isReversed?2*this.baseLineY[o]:0),this.areaBottomY=this.zeroY,(this.zeroY>i.globals.gridHeight||"end"===i.config.plotOptions.area.fillTo)&&(this.areaBottomY=i.globals.gridHeight),this.categoryAxisCorrection=this.xDivision/2,this.elSeries=s.group({class:"apexcharts-series",zIndex:void 0!==i.config.series[a].zIndex?i.config.series[a].zIndex:a,seriesName:Xc.escapeString(i.globals.seriesNames[a])}),this.elPointsMain=s.group({class:"apexcharts-series-markers-wrap","data:realIndex":a}),i.globals.hasNullValues){var n=this.markers.plotChartMarkers({pointsPos:{x:[0],y:[i.globals.gridHeight+i.globals.markers.largestSize]},seriesIndex:t,j:0,pSize:.1,alwaysDrawMarker:!0,isVirtualPoint:!0});null!==n&&this.elPointsMain.add(n)}this.elDataLabelsWrap=s.group({class:"apexcharts-datalabels","data:realIndex":a});var r=e[t].length===i.globals.dataPoints;this.elSeries.attr({"data:longestSeries":r,rel:t+1,"data:realIndex":a}),this.appendPathFrom=!0}},{key:"_calculatePathsFrom",value:function(e){var t,a,i,s,o=e.type,n=e.series,r=e.i,l=e.realIndex,c=e.translationsIndex,h=e.prevX,d=e.prevY,u=e.prevY2,p=this.w,m=new Ku(this.ctx);if(null===n[r][0]){for(var g=0;g<n[r].length;g++)if(null!==n[r][g]){h=this.xDivision*g,d=this.zeroY-n[r][g]/this.yRatio[c],t=m.move(h,d),a=m.move(h,this.areaBottomY);break}}else t=m.move(h,d),"rangeArea"===o&&(t=m.move(h,u)+m.line(h,d)),a=m.move(h,this.areaBottomY)+m.line(h,d);if(i=m.move(0,this.areaBottomY)+m.line(0,this.areaBottomY),s=m.move(0,this.areaBottomY)+m.line(0,this.areaBottomY),p.globals.previousPaths.length>0){var f=this.lineHelpers.checkPreviousPaths({pathFromLine:i,pathFromArea:s,realIndex:l});i=f.pathFromLine,s=f.pathFromArea}return{prevX:h,prevY:d,linePath:t,areaPath:a,pathFromLine:i,pathFromArea:s}}},{key:"_handlePaths",value:function(e){var t=e.type,a=e.realIndex,i=e.i,s=e.paths,o=this.w,n=new Ku(this.ctx),r=new gp(this.ctx);this.prevSeriesY.push(s.yArrj),o.globals.seriesXvalues[a]=s.xArrj,o.globals.seriesYvalues[a]=s.yArrj;var l=o.config.forecastDataPoints;if(l.count>0&&"rangeArea"!==t){var c=o.globals.seriesXvalues[a][o.globals.seriesXvalues[a].length-l.count-1],h=n.drawRect(c,0,o.globals.gridWidth,o.globals.gridHeight,0);o.globals.dom.elForecastMask.appendChild(h.node);var d=n.drawRect(0,0,c,o.globals.gridHeight,0);o.globals.dom.elNonForecastMask.appendChild(d.node)}this.pointsChart||o.globals.delayedElements.push({el:this.elPointsMain.node,index:a});var u={i:i,realIndex:a,animationDelay:i,initialSpeed:o.config.chart.animations.speed,dataChangeSpeed:o.config.chart.animations.dynamicAnimation.speed,className:"apexcharts-".concat(t)};if("area"===t)for(var p=r.fillPath({seriesNumber:a}),m=0;m<s.areaPaths.length;m++){var g=n.renderPaths(Uc(Uc({},u),{},{pathFrom:s.pathFromArea,pathTo:s.areaPaths[m],stroke:"none",strokeWidth:0,strokeLineCap:null,fill:p}));this.elSeries.add(g)}if(o.config.stroke.show&&!this.pointsChart){var f=null;if("line"===t)f=r.fillPath({seriesNumber:a,i:i});else if("solid"===o.config.stroke.fill.type)f=o.globals.stroke.colors[a];else{var b=o.config.fill;o.config.fill=o.config.stroke.fill,f=r.fillPath({seriesNumber:a,i:i}),o.config.fill=b}for(var y=0;y<s.linePaths.length;y++){var w=f;"rangeArea"===t&&(w=r.fillPath({seriesNumber:a}));var v=Uc(Uc({},u),{},{pathFrom:s.pathFromLine,pathTo:s.linePaths[y],stroke:f,strokeWidth:this.strokeWidth,strokeLineCap:o.config.stroke.lineCap,fill:"rangeArea"===t?w:"none"}),x=n.renderPaths(v);if(this.elSeries.add(x),x.attr("fill-rule","evenodd"),l.count>0&&"rangeArea"!==t){var S=n.renderPaths(v);S.node.setAttribute("stroke-dasharray",l.dashArray),l.strokeWidth&&S.node.setAttribute("stroke-width",l.strokeWidth),this.elSeries.add(S),S.attr("clip-path","url(#forecastMask".concat(o.globals.cuid,")")),x.attr("clip-path","url(#nonForecastMask".concat(o.globals.cuid,")"))}}}}},{key:"_iterateOverDataPoints",value:function(e){var t,a,i=this,s=e.type,o=e.series,n=e.iterations,r=e.realIndex,l=e.translationsIndex,c=e.i,h=e.x,d=e.y,u=e.pX,p=e.pY,m=e.pathsFrom,g=e.linePaths,f=e.areaPaths,b=e.seriesIndex,y=e.lineYPosition,w=e.xArrj,v=e.yArrj,x=e.y2Arrj,S=e.isRangeStart,_=e.seriesRangeEnd,k=this.w,C=new Ku(this.ctx),I=this.yRatio,E=m.prevY,T=m.linePath,A=m.areaPath,P=m.pathFromLine,R=m.pathFromArea,D=Xc.isNumber(k.globals.minYArr[r])?k.globals.minYArr[r]:k.globals.minY;n||(n=k.globals.dataPoints>1?k.globals.dataPoints-1:k.globals.dataPoints);var M=function(e,t){return t-e/I[l]+2*(i.isReversed?e/I[l]:0)},L=d,N=k.config.chart.stacked&&!k.globals.comboCharts||k.config.chart.stacked&&k.globals.comboCharts&&(!this.w.config.chart.stackOnlyBar||"bar"===(null===(t=this.w.config.series[r])||void 0===t?void 0:t.type)||"column"===(null===(a=this.w.config.series[r])||void 0===a?void 0:a.type)),O=k.config.stroke.curve;Array.isArray(O)&&(O=Array.isArray(b)?O[b[c]]:O[c]);for(var G,z=0,F=0;F<n&&0!==o[c].length;F++){var H=void 0===o[c][F+1]||null===o[c][F+1];if(k.globals.isXNumeric){var U=k.globals.seriesX[r][F+1];void 0===k.globals.seriesX[r][F+1]&&(U=k.globals.seriesX[r][n-1]),h=(U-k.globals.minX)/this.xRatio}else h+=this.xDivision;y=N&&c>0&&k.globals.collapsedSeries.length<k.config.series.length-1?this.prevSeriesY[function(e){for(var t=e;t>0;t--){if(!(k.globals.collapsedSeriesIndices.indexOf((null==b?void 0:b[t])||t)>-1))return t;t--}return 0}(c-1)][F+1]:this.zeroY,H?d=M(D,y):(d=M(o[c][F+1],y),"rangeArea"===s&&(L=M(_[c][F+1],y))),w.push(null===o[c][F+1]?null:h),!H||"smooth"!==k.config.stroke.curve&&"monotoneCubic"!==k.config.stroke.curve?(v.push(d),x.push(L)):(v.push(null),x.push(null));var B=this.lineHelpers.calculatePoints({series:o,x:h,y:d,realIndex:r,i:c,j:F,prevY:E}),W=this._createPaths({type:s,series:o,i:c,realIndex:r,j:F,x:h,y:d,y2:L,xArrj:w,yArrj:v,y2Arrj:x,pX:u,pY:p,pathState:z,segmentStartX:G,linePath:T,areaPath:A,linePaths:g,areaPaths:f,curve:O,isRangeStart:S});f=W.areaPaths,g=W.linePaths,u=W.pX,p=W.pY,z=W.pathState,G=W.segmentStartX,A=W.areaPath,T=W.linePath,!this.appendPathFrom||k.globals.hasNullValues||"monotoneCubic"===O&&"rangeArea"===s||(P+=C.line(h,this.areaBottomY),R+=C.line(h,this.areaBottomY)),this.handleNullDataPoints(o,B,c,F,r),this._handleMarkersAndLabels({type:s,pointsPos:B,i:c,j:F,realIndex:r,isRangeStart:S})}return{yArrj:v,xArrj:w,pathFromArea:R,areaPaths:f,pathFromLine:P,linePaths:g,linePath:T,areaPath:A}}},{key:"_handleMarkersAndLabels",value:function(e){var t=e.type,a=e.pointsPos,i=e.isRangeStart,s=e.i,o=e.j,n=e.realIndex,r=this.w,l=new yp(this.ctx);if(this.pointsChart)this.scatter.draw(this.elSeries,o,{realIndex:n,pointsPos:a,zRatio:this.zRatio,elParent:this.elPointsMain});else{r.globals.series[s].length>1&&this.elPointsMain.node.classList.add("apexcharts-element-hidden");var c=this.markers.plotChartMarkers({pointsPos:a,seriesIndex:n,j:o+1});null!==c&&this.elPointsMain.add(c)}var h=l.drawDataLabel({type:t,isRangeStart:i,pos:a,i:n,j:o+1});null!==h&&this.elDataLabelsWrap.add(h)}},{key:"_createPaths",value:function(e){var t=e.type,a=e.series,i=e.i;e.realIndex;var s,o=e.j,n=e.x,r=e.y,l=e.xArrj,c=e.yArrj,h=e.y2,d=e.y2Arrj,u=e.pX,p=e.pY,m=e.pathState,g=e.segmentStartX,f=e.linePath,b=e.areaPath,y=e.linePaths,w=e.areaPaths,v=e.curve,x=e.isRangeStart,S=new Ku(this.ctx),_=this.areaBottomY,k="rangeArea"===t,C="rangeArea"===t&&x;switch(v){case"monotoneCubic":var I=x?c:d;switch(m){case 0:if(null===I[o+1])break;m=1;case 1:if(!(k?l.length===a[i].length:o===a[i].length-2))break;case 2:var E=x?l:l.slice().reverse(),T=x?I:I.slice().reverse(),A=(s=T,E.map(function(e,t){return[e,s[t]]}).filter(function(e){return null!==e[1]})),P=A.length>1?cm(A):A,R=[];k&&(C?w=A:R=w.reverse());var D=0,M=0;if(function(e,t){for(var a=function(e){var t=[],a=0;return e.forEach(function(e){null!==e?a++:a>0&&(t.push(a),a=0)}),a>0&&t.push(a),t}(e),i=[],s=0,o=0;s<a.length;o+=a[s++])i[s]=hm(t,o,o+a[s]);return i}(T,P).forEach(function(e){D++;var t=function(e){for(var t="",a=0;a<e.length;a++){var i=e[a],s=i.length;s>4?(t+="C".concat(i[0],", ").concat(i[1]),t+=", ".concat(i[2],", ").concat(i[3]),t+=", ".concat(i[4],", ").concat(i[5])):s>2&&(t+="S".concat(i[0],", ").concat(i[1]),t+=", ".concat(i[2],", ").concat(i[3]))}return t}(e),a=M,i=(M+=e.length)-1;C?f=S.move(A[a][0],A[a][1])+t:k?f=S.move(R[a][0],R[a][1])+S.line(A[a][0],A[a][1])+t+S.line(R[i][0],R[i][1]):(f=S.move(A[a][0],A[a][1])+t,b=f+S.line(A[i][0],_)+S.line(A[a][0],_)+"z",w.push(b)),y.push(f)}),k&&D>1&&!C){var L=y.slice(D).reverse();y.splice(D),L.forEach(function(e){return y.push(e)})}m=0}break;case"smooth":var N=.35*(n-u);if(null===a[i][o])m=0;else switch(m){case 0:if(g=u,f=C?S.move(u,d[o])+S.line(u,p):S.move(u,p),b=S.move(u,p),null===a[i][o+1]||void 0===a[i][o+1]){y.push(f),w.push(b);break}if(m=1,o<a[i].length-2){var O=S.curve(u+N,p,n-N,r,n,r);f+=O,b+=O;break}case 1:if(null===a[i][o+1])f+=C?S.line(u,h):S.move(u,p),b+=S.line(u,_)+S.line(g,_)+"z",y.push(f),w.push(b),m=-1;else{var G=S.curve(u+N,p,n-N,r,n,r);f+=G,b+=G,o>=a[i].length-2&&(C&&(f+=S.curve(n,r,n,r,n,h)+S.move(n,h)),b+=S.curve(n,r,n,r,n,_)+S.line(g,_)+"z",y.push(f),w.push(b),m=-1)}}u=n,p=r;break;default:var z=function(e,t,a){var i=[];switch(e){case"stepline":i=S.line(t,null,"H")+S.line(null,a,"V");break;case"linestep":i=S.line(null,a,"V")+S.line(t,null,"H");break;case"straight":i=S.line(t,a)}return i};if(null===a[i][o])m=0;else switch(m){case 0:if(g=u,f=C?S.move(u,d[o])+S.line(u,p):S.move(u,p),b=S.move(u,p),null===a[i][o+1]||void 0===a[i][o+1]){y.push(f),w.push(b);break}if(m=1,o<a[i].length-2){var F=z(v,n,r);f+=F,b+=F;break}case 1:if(null===a[i][o+1])f+=C?S.line(u,h):S.move(u,p),b+=S.line(u,_)+S.line(g,_)+"z",y.push(f),w.push(b),m=-1;else{var H=z(v,n,r);f+=H,b+=H,o>=a[i].length-2&&(C&&(f+=S.line(n,h)),b+=S.line(n,_)+S.line(g,_)+"z",y.push(f),w.push(b),m=-1)}}u=n,p=r}return{linePaths:y,areaPaths:w,pX:u,pY:p,pathState:m,segmentStartX:g,linePath:f,areaPath:b}}},{key:"handleNullDataPoints",value:function(e,t,a,i,s){var o=this.w;if(null===e[a][i]&&o.config.markers.showNullDataPoints||1===e[a].length){var n=this.strokeWidth-o.config.markers.strokeWidth/2;n>0||(n=0);var r=this.markers.plotChartMarkers({pointsPos:t,seriesIndex:s,j:i+1,pSize:n,alwaysDrawMarker:!0});null!==r&&this.elPointsMain.add(r)}}}]),e}();window.TreemapSquared={},window.TreemapSquared.generate=function(){function e(t,a,i,s){this.xoffset=t,this.yoffset=a,this.height=s,this.width=i,this.shortestEdge=function(){return Math.min(this.height,this.width)},this.getCoordinates=function(e){var t,a=[],i=this.xoffset,s=this.yoffset,n=o(e)/this.height,r=o(e)/this.width;if(this.width>=this.height)for(t=0;t<e.length;t++)a.push([i,s,i+n,s+e[t]/n]),s+=e[t]/n;else for(t=0;t<e.length;t++)a.push([i,s,i+e[t]/r,s+r]),i+=e[t]/r;return a},this.cutArea=function(t){var a;if(this.width>=this.height){var i=t/this.height,s=this.width-i;a=new e(this.xoffset+i,this.yoffset,s,this.height)}else{var o=t/this.width,n=this.height-o;a=new e(this.xoffset,this.yoffset+o,this.width,n)}return a}}function t(t,i,s,n,r){return n=void 0===n?0:n,r=void 0===r?0:r,function(e){var t,a,i=[];for(t=0;t<e.length;t++)for(a=0;a<e[t].length;a++)i.push(e[t][a]);return i}(a(function(e,t){var a,i=[],s=t/o(e);for(a=0;a<e.length;a++)i[a]=e[a]*s;return i}(t,i*s),[],new e(n,r,i,s),[]))}function a(e,t,s,n){var r,l,c,h,d,u,p;if(0!==e.length)return r=s.shortestEdge(),h=t,d=l=e[0],u=r,0===h.length||((p=h.slice()).push(d),i(h,u)>=i(p,u))?(t.push(l),a(e.slice(1),t,s,n)):(c=s.cutArea(o(t),n),n.push(s.getCoordinates(t)),a(e,[],c,n)),n;n.push(s.getCoordinates(t))}function i(e,t){var a=Math.min.apply(Math,e),i=Math.max.apply(Math,e),s=o(e);return Math.max(Math.pow(t,2)*i/Math.pow(s,2),Math.pow(s,2)/(Math.pow(t,2)*a))}function s(e){return e&&e.constructor===Array}function o(e){var t,a=0;for(t=0;t<e.length;t++)a+=e[t];return a}function n(e){var t,a=0;if(s(e[0]))for(t=0;t<e.length;t++)a+=n(e[t]);else a=o(e);return a}return function e(a,i,o,r,l){r=void 0===r?0:r,l=void 0===l?0:l;var c,h,d=[],u=[];if(s(a[0])){for(h=0;h<a.length;h++)d[h]=n(a[h]);for(c=t(d,i,o,r,l),h=0;h<a.length;h++)u.push(e(a[h],c[h][2]-c[h][0],c[h][3]-c[h][1],c[h][0],c[h][1]))}else u=t(a,i,o,r,l);return u}}();var pm=function(){function e(t,a){Rc(this,e),this.ctx=t,this.w=t.w,this.strokeWidth=this.w.config.stroke.width,this.helpers=new tm(t),this.dynamicAnim=this.w.config.chart.animations.dynamicAnimation,this.labels=[]}return Mc(e,[{key:"draw",value:function(e){var t=this,a=this.w,i=new Ku(this.ctx),s=new gp(this.ctx),o=i.group({class:"apexcharts-treemap"});if(a.globals.noData)return o;var n=[];return e.forEach(function(e){var t=e.map(function(e){return Math.abs(e)});n.push(t)}),this.negRange=this.helpers.checkColorRange(),a.config.series.forEach(function(e,a){e.data.forEach(function(e){Array.isArray(t.labels[a])||(t.labels[a]=[]),t.labels[a].push(e.x)})}),window.TreemapSquared.generate(n,a.globals.gridWidth,a.globals.gridHeight).forEach(function(n,r){var l=i.group({class:"apexcharts-series apexcharts-treemap-series",seriesName:Xc.escapeString(a.globals.seriesNames[r]),rel:r+1,"data:realIndex":r});if(a.config.chart.dropShadow.enabled){var c=a.config.chart.dropShadow;new Zu(t.ctx).dropShadow(o,c,r)}var h=i.group({class:"apexcharts-data-labels"}),d={xMin:1/0,yMin:1/0,xMax:-1/0,yMax:-1/0};n.forEach(function(o,n){var c=o[0],h=o[1],u=o[2],p=o[3];d.xMin=Math.min(d.xMin,c),d.yMin=Math.min(d.yMin,h),d.xMax=Math.max(d.xMax,u),d.yMax=Math.max(d.yMax,p);var m=t.helpers.getShadeColor(a.config.chart.type,r,n,t.negRange),g=m.color,f=s.fillPath({color:g,seriesNumber:r,dataPointIndex:n}),b=i.drawRect(c,h,u-c,p-h,a.config.plotOptions.treemap.borderRadius,"#fff",1,t.strokeWidth,a.config.plotOptions.treemap.useFillColorAsStroke?g:a.globals.stroke.colors[r]);b.attr({cx:c,cy:h,index:r,i:r,j:n,width:u-c,height:p-h,fill:f}),b.node.classList.add("apexcharts-treemap-rect"),t.helpers.addListeners(b);var y={x:c+(u-c)/2,y:h+(p-h)/2,width:0,height:0},w={x:c,y:h,width:u-c,height:p-h};if(a.config.chart.animations.enabled&&!a.globals.dataChanged){var v=1;a.globals.resized||(v=a.config.chart.animations.speed),t.animateTreemap(b,y,w,v)}if(a.globals.dataChanged){var x=1;t.dynamicAnim.enabled&&a.globals.shouldAnimate&&(x=t.dynamicAnim.speed,a.globals.previousPaths[r]&&a.globals.previousPaths[r][n]&&a.globals.previousPaths[r][n].rect&&(y=a.globals.previousPaths[r][n].rect),t.animateTreemap(b,y,w,x))}var S=t.getFontSize(o),_=a.config.dataLabels.formatter(t.labels[r][n],{value:a.globals.series[r][n],seriesIndex:r,dataPointIndex:n,w:a});"truncate"===a.config.plotOptions.treemap.dataLabels.format&&(S=parseInt(a.config.dataLabels.style.fontSize,10),_=t.truncateLabels(_,S,c,h,u,p));var k=null;a.globals.series[r][n]&&(k=t.helpers.calculateDataLabels({text:_,x:(c+u)/2,y:(h+p)/2+t.strokeWidth/2+S/3,i:r,j:n,colorProps:m,fontSize:S,series:e})),a.config.dataLabels.enabled&&k&&t.rotateToFitLabel(k,S,_,c,h,u,p),l.add(b),null!==k&&l.add(k)});var u=a.config.plotOptions.treemap.seriesTitle;if(a.config.series.length>1&&u&&u.show){var p=a.config.series[r].name||"";if(p&&d.xMin<1/0&&d.yMin<1/0){var m=u.offsetX,g=u.offsetY,f=u.borderColor,b=u.borderWidth,y=u.borderRadius,w=u.style,v=w.color||a.config.chart.foreColor,x={left:w.padding.left,right:w.padding.right,top:w.padding.top,bottom:w.padding.bottom},S=i.getTextRects(p,w.fontSize,w.fontFamily),_=S.width+x.left+x.right,k=S.height+x.top+x.bottom,C=d.xMin+(m||0),I=d.yMin+(g||0),E=i.drawRect(C,I,_,k,y,w.background,1,b,f),T=i.drawText({x:C+x.left,y:I+x.top+.75*S.height,text:p,fontSize:w.fontSize,fontFamily:w.fontFamily,fontWeight:w.fontWeight,foreColor:v,cssClass:w.cssClass||""});l.add(E),l.add(T)}}l.add(h),o.add(l)}),o}},{key:"getFontSize",value:function(e){var t,a,i,s,o=this.w,n=function e(t){var a,i=0;if(Array.isArray(t[0]))for(a=0;a<t.length;a++)i+=e(t[a]);else for(a=0;a<t.length;a++)i+=t[a].length;return i}(this.labels)/function e(t){var a,i=0;if(Array.isArray(t[0]))for(a=0;a<t.length;a++)i+=e(t[a]);else for(a=0;a<t.length;a++)i+=1;return i}(this.labels);return t=e[2]-e[0],a=e[3]-e[1],i=t*a,s=Math.pow(i,.5),Math.min(s/n,parseInt(o.config.dataLabels.style.fontSize,10))}},{key:"rotateToFitLabel",value:function(e,t,a,i,s,o,n){var r=new Ku(this.ctx),l=r.getTextRects(a,t);if(l.width+this.w.config.stroke.width+5>o-i&&l.width<=n-s){var c=r.rotateAroundCenter(e.node);e.node.setAttribute("transform","rotate(-90 ".concat(c.x," ").concat(c.y,") translate(").concat(l.height/3,")"))}}},{key:"truncateLabels",value:function(e,t,a,i,s,o){var n=new Ku(this.ctx),r=n.getTextRects(e,t).width+this.w.config.stroke.width+5>s-a&&o-i>s-a?o-i:s-a,l=n.getTextBasedOnMaxWidth({text:e,maxWidth:r,fontSize:t});return e.length!==l.length&&r/t<5?"":l}},{key:"animateTreemap",value:function(e,t,a,i){var s=new $c(this.ctx);s.animateRect(e,t,a,i,function(){s.animationCompleted(e)})}}]),e}(),mm=10/86400,gm=function(){function e(t){Rc(this,e),this.ctx=t,this.w=t.w,this.timeScaleArray=[],this.utc=this.w.config.xaxis.labels.datetimeUTC}return Mc(e,[{key:"calculateTimeScaleTicks",value:function(e,t){var a=this,i=this.w;if(i.globals.allSeriesCollapsed)return i.globals.labels=[],i.globals.timescaleLabels=[],[];var s=new tp(this.ctx),o=(t-e)/864e5;this.determineInterval(o),i.globals.disableZoomIn=!1,i.globals.disableZoomOut=!1,o<mm?i.globals.disableZoomIn=!0:o>5e4&&(i.globals.disableZoomOut=!0);var n=s.getTimeUnitsfromTimestamp(e,t,this.utc),r=i.globals.gridWidth/o,l=r/24,c=l/60,h=c/60,d=Math.floor(24*o),u=Math.floor(1440*o),p=Math.floor(86400*o),m=Math.floor(o),g=Math.floor(o/30),f=Math.floor(o/365),b={minMillisecond:n.minMillisecond,minSecond:n.minSecond,minMinute:n.minMinute,minHour:n.minHour,minDate:n.minDate,minMonth:n.minMonth,minYear:n.minYear},y={firstVal:b,currentMillisecond:b.minMillisecond,currentSecond:b.minSecond,currentMinute:b.minMinute,currentHour:b.minHour,currentMonthDate:b.minDate,currentDate:b.minDate,currentMonth:b.minMonth,currentYear:b.minYear,daysWidthOnXAxis:r,hoursWidthOnXAxis:l,minutesWidthOnXAxis:c,secondsWidthOnXAxis:h,numberOfSeconds:p,numberOfMinutes:u,numberOfHours:d,numberOfDays:m,numberOfMonths:g,numberOfYears:f};switch(this.tickInterval){case"years":this.generateYearScale(y);break;case"months":case"half_year":this.generateMonthScale(y);break;case"months_days":case"months_fortnight":case"days":case"week_days":this.generateDayScale(y);break;case"hours":this.generateHourScale(y);break;case"minutes_fives":case"minutes":this.generateMinuteScale(y);break;case"seconds_tens":case"seconds_fives":case"seconds":this.generateSecondScale(y)}var w=this.timeScaleArray.map(function(e){var t={position:e.position,unit:e.unit,year:e.year,day:e.day?e.day:1,hour:e.hour?e.hour:0,month:e.month+1};return"month"===e.unit?Uc(Uc({},t),{},{day:1,value:e.value+1}):"day"===e.unit||"hour"===e.unit?Uc(Uc({},t),{},{value:e.value}):"minute"===e.unit?Uc(Uc({},t),{},{value:e.value,minute:e.value}):"second"===e.unit?Uc(Uc({},t),{},{value:e.value,minute:e.minute,second:e.second}):e});return w.filter(function(e){var t=1,s=Math.ceil(i.globals.gridWidth/120),o=e.value;void 0!==i.config.xaxis.tickAmount&&(s=i.config.xaxis.tickAmount),w.length>s&&(t=Math.floor(w.length/s));var n=!1,r=!1;switch(a.tickInterval){case"years":"year"===e.unit&&(n=!0);break;case"half_year":t=7,"year"===e.unit&&(n=!0);break;case"months":t=1,"year"===e.unit&&(n=!0);break;case"months_fortnight":t=15,"year"!==e.unit&&"month"!==e.unit||(n=!0),30===o&&(r=!0);break;case"months_days":t=10,"month"===e.unit&&(n=!0),30===o&&(r=!0);break;case"week_days":t=8,"month"===e.unit&&(n=!0);break;case"days":t=1,"month"===e.unit&&(n=!0);break;case"hours":"day"===e.unit&&(n=!0);break;case"minutes_fives":case"seconds_fives":o%5!=0&&(r=!0);break;case"seconds_tens":o%10!=0&&(r=!0)}if("hours"===a.tickInterval||"minutes_fives"===a.tickInterval||"seconds_tens"===a.tickInterval||"seconds_fives"===a.tickInterval){if(!r)return!0}else if((o%t==0||n)&&!r)return!0})}},{key:"recalcDimensionsBasedOnFormat",value:function(e,t){var a=this.w,i=this.formatDates(e),s=this.removeOverlappingTS(i);a.globals.timescaleLabels=s.slice(),new zp(this.ctx).plotCoords()}},{key:"determineInterval",value:function(e){var t=24*e,a=60*t;switch(!0){case e/365>5:this.tickInterval="years";break;case e>800:this.tickInterval="half_year";break;case e>180:this.tickInterval="months";break;case e>90:this.tickInterval="months_fortnight";break;case e>60:this.tickInterval="months_days";break;case e>30:this.tickInterval="week_days";break;case e>2:this.tickInterval="days";break;case t>2.4:this.tickInterval="hours";break;case a>15:this.tickInterval="minutes_fives";break;case a>5:this.tickInterval="minutes";break;case a>1:this.tickInterval="seconds_tens";break;case 60*a>20:this.tickInterval="seconds_fives";break;default:this.tickInterval="seconds"}}},{key:"generateYearScale",value:function(e){var t=e.firstVal,a=e.currentMonth,i=e.currentYear,s=e.daysWidthOnXAxis,o=e.numberOfYears,n=t.minYear,r=0,l=new tp(this.ctx),c="year";if(t.minDate>1||t.minMonth>0){var h=l.determineRemainingDaysOfYear(t.minYear,t.minMonth,t.minDate);r=(l.determineDaysOfYear(t.minYear)-h+1)*s,n=t.minYear+1,this.timeScaleArray.push({position:r,value:n,unit:c,year:n,month:Xc.monthMod(a+1)})}else 1===t.minDate&&0===t.minMonth&&this.timeScaleArray.push({position:r,value:n,unit:c,year:i,month:Xc.monthMod(a+1)});for(var d=n,u=r,p=0;p<o;p++)d++,u=l.determineDaysOfYear(d-1)*s+u,this.timeScaleArray.push({position:u,value:d,unit:c,year:d,month:1})}},{key:"generateMonthScale",value:function(e){var t=e.firstVal,a=e.currentMonthDate,i=e.currentMonth,s=e.currentYear,o=e.daysWidthOnXAxis,n=e.numberOfMonths,r=i,l=0,c=new tp(this.ctx),h="month",d=0;if(t.minDate>1){l=(c.determineDaysOfMonths(i+1,t.minYear)-a+1)*o,r=Xc.monthMod(i+1);var u=s+d,p=Xc.monthMod(r),m=r;0===r&&(h="year",m=u,p=1,u+=d+=1),this.timeScaleArray.push({position:l,value:m,unit:h,year:u,month:p})}else this.timeScaleArray.push({position:l,value:r,unit:h,year:s,month:Xc.monthMod(i)});for(var g=r+1,f=l,b=0,y=1;b<n;b++,y++){0===(g=Xc.monthMod(g))?(h="year",d+=1):h="month";var w=this._getYear(s,g,d);f=c.determineDaysOfMonths(g,w)*o+f;var v=0===g?w:g;this.timeScaleArray.push({position:f,value:v,unit:h,year:w,month:0===g?1:g}),g++}}},{key:"generateDayScale",value:function(e){var t=e.firstVal,a=e.currentMonth,i=e.currentYear,s=e.hoursWidthOnXAxis,o=e.numberOfDays,n=new tp(this.ctx),r="day",l=t.minDate+1,c=l,h=function(e,t,a){return e>n.determineDaysOfMonths(t+1,a)?(c=1,r="month",u=t+=1,t):t},d=(24-t.minHour)*s,u=l,p=h(c,a,i);0===t.minHour&&1===t.minDate?(d=0,u=Xc.monthMod(t.minMonth),r="month",c=t.minDate):1!==t.minDate&&0===t.minHour&&0===t.minMinute&&(d=0,l=t.minDate,u=l,p=h(c=l,a,i),1!==u&&(r="day")),this.timeScaleArray.push({position:d,value:u,unit:r,year:this._getYear(i,p,0),month:Xc.monthMod(p),day:c});for(var m=d,g=0;g<o;g++){r="day",p=h(c+=1,p,this._getYear(i,p,0));var f=this._getYear(i,p,0);m=24*s+m;var b=1===c?Xc.monthMod(p):c;this.timeScaleArray.push({position:m,value:b,unit:r,year:f,month:Xc.monthMod(p),day:b})}}},{key:"generateHourScale",value:function(e){var t=e.firstVal,a=e.currentDate,i=e.currentMonth,s=e.currentYear,o=e.minutesWidthOnXAxis,n=e.numberOfHours,r=new tp(this.ctx),l="hour",c=function(e,t){return e>r.determineDaysOfMonths(t+1,s)&&(g=1,t+=1),{month:t,date:g}},h=function(e,t){return e>r.determineDaysOfMonths(t+1,s)?t+=1:t},d=60-(t.minMinute+t.minSecond/60),u=d*o,p=t.minHour+1,m=p;60===d&&(u=0,m=p=t.minHour);var g=a;m>=24&&(m=0,l="day",p=g+=1);var f=c(g,i).month;f=h(g,f),p>31&&(p=g=1),this.timeScaleArray.push({position:u,value:p,unit:l,day:g,hour:m,year:s,month:Xc.monthMod(f)}),m++;for(var b=u,y=0;y<n;y++){l="hour",m>=24&&(m=0,l="day",f=c(g+=1,f).month,f=h(g,f));var w=this._getYear(s,f,0);b=60*o+b;var v=0===m?g:m;this.timeScaleArray.push({position:b,value:v,unit:l,hour:m,day:g,year:w,month:Xc.monthMod(f)}),m++}}},{key:"generateMinuteScale",value:function(e){for(var t=e.currentMillisecond,a=e.currentSecond,i=e.currentMinute,s=e.currentHour,o=e.currentDate,n=e.currentMonth,r=e.currentYear,l=e.minutesWidthOnXAxis,c=e.secondsWidthOnXAxis,h=e.numberOfMinutes,d=i+1,u=o,p=n,m=r,g=s,f=(60-a-t/1e3)*c,b=0;b<h;b++)d>=60&&(d=0,24===(g+=1)&&(g=0)),this.timeScaleArray.push({position:f,value:d,unit:"minute",hour:g,minute:d,day:u,year:this._getYear(m,p,0),month:Xc.monthMod(p)}),f+=l,d++}},{key:"generateSecondScale",value:function(e){for(var t=e.currentMillisecond,a=e.currentSecond,i=e.currentMinute,s=e.currentHour,o=e.currentDate,n=e.currentMonth,r=e.currentYear,l=e.secondsWidthOnXAxis,c=e.numberOfSeconds,h=a+1,d=i,u=o,p=n,m=r,g=s,f=(1e3-t)/1e3*l,b=0;b<c;b++)h>=60&&(h=0,++d>=60&&(d=0,24===++g&&(g=0))),this.timeScaleArray.push({position:f,value:h,unit:"second",hour:g,minute:d,second:h,day:u,year:this._getYear(m,p,0),month:Xc.monthMod(p)}),f+=l,h++}},{key:"createRawDateString",value:function(e,t){var a=e.year;return 0===e.month&&(e.month=1),a+="-"+("0"+e.month.toString()).slice(-2),"day"===e.unit?a+="day"===e.unit?"-"+("0"+t).slice(-2):"-01":a+="-"+("0"+(e.day?e.day:"1")).slice(-2),"hour"===e.unit?a+="hour"===e.unit?"T"+("0"+t).slice(-2):"T00":a+="T"+("0"+(e.hour?e.hour:"0")).slice(-2),"minute"===e.unit?a+=":"+("0"+t).slice(-2):a+=":"+(e.minute?("0"+e.minute).slice(-2):"00"),"second"===e.unit?a+=":"+("0"+t).slice(-2):a+=":00",this.utc&&(a+=".000Z"),a}},{key:"formatDates",value:function(e){var t=this,a=this.w;return e.map(function(e){var i=e.value.toString(),s=new tp(t.ctx),o=t.createRawDateString(e,i),n=s.getDate(s.parseDate(o));if(t.utc||(n=s.getDate(s.parseDateWithTimezone(o))),void 0===a.config.xaxis.labels.format){var r="dd MMM",l=a.config.xaxis.labels.datetimeFormatter;"year"===e.unit&&(r=l.year),"month"===e.unit&&(r=l.month),"day"===e.unit&&(r=l.day),"hour"===e.unit&&(r=l.hour),"minute"===e.unit&&(r=l.minute),"second"===e.unit&&(r=l.second),i=s.formatDate(n,r)}else i=s.formatDate(n,a.config.xaxis.labels.format);return{dateString:o,position:e.position,value:i,unit:e.unit,year:e.year,month:e.month}})}},{key:"removeOverlappingTS",value:function(e){var t,a=this,i=new Ku(this.ctx),s=!1;e.length>0&&e[0].value&&e.every(function(t){return t.value.length===e[0].value.length})&&(s=!0,t=i.getTextRects(e[0].value).width);var o=0,n=e.map(function(n,r){if(r>0&&a.w.config.xaxis.labels.hideOverlappingLabels){var l=s?t:i.getTextRects(e[o].value).width,c=e[o].position;return n.position>c+l+10?(o=r,n):null}return n});return n.filter(function(e){return null!==e})}},{key:"_getYear",value:function(e,t,a){return e+Math.floor(t/12)+a}}]),e}(),fm=function(){function e(t,a){Rc(this,e),this.ctx=a,this.w=a.w,this.el=t}return Mc(e,[{key:"setupElements",value:function(){var e=this.w,t=e.globals,a=e.config,i=a.chart.type;t.axisCharts=["line","area","bar","rangeBar","rangeArea","candlestick","boxPlot","scatter","bubble","radar","heatmap","treemap"].includes(i),t.xyCharts=["line","area","bar","rangeBar","rangeArea","candlestick","boxPlot","scatter","bubble"].includes(i),t.isBarHorizontal=["bar","rangeBar","boxPlot"].includes(i)&&a.plotOptions.bar.horizontal,t.chartClass=".apexcharts".concat(t.chartID),t.dom.baseEl=this.el,t.dom.elWrap=document.createElement("div"),Ku.setAttrs(t.dom.elWrap,{id:t.chartClass.substring(1),class:"apexcharts-canvas ".concat(t.chartClass.substring(1))}),this.el.appendChild(t.dom.elWrap),t.dom.Paper=window.SVG().addTo(t.dom.elWrap),t.dom.Paper.attr({class:"apexcharts-svg","xmlns:data":"ApexChartsNS",transform:"translate(".concat(a.chart.offsetX,", ").concat(a.chart.offsetY,")")}),t.dom.Paper.node.style.background="dark"!==a.theme.mode||a.chart.background?"light"!==a.theme.mode||a.chart.background?a.chart.background:"#fff":"#343A3F",this.setSVGDimensions(),t.dom.elLegendForeign=document.createElementNS(t.SVGNS,"foreignObject"),Ku.setAttrs(t.dom.elLegendForeign,{x:0,y:0,width:t.svgWidth,height:t.svgHeight}),t.dom.elLegendWrap=document.createElement("div"),t.dom.elLegendWrap.classList.add("apexcharts-legend"),t.dom.elWrap.appendChild(t.dom.elLegendWrap),t.dom.Paper.node.appendChild(t.dom.elLegendForeign),t.dom.elGraphical=t.dom.Paper.group().attr({class:"apexcharts-inner apexcharts-graphical"}),t.dom.elDefs=t.dom.Paper.defs(),t.dom.Paper.add(t.dom.elGraphical),t.dom.elGraphical.add(t.dom.elDefs)}},{key:"plotChartType",value:function(e,t){var a=this.w,i=this.ctx,s=a.config,o=a.globals,n={line:{series:[],i:[]},area:{series:[],i:[]},scatter:{series:[],i:[]},bubble:{series:[],i:[]},bar:{series:[],i:[]},candlestick:{series:[],i:[]},boxPlot:{series:[],i:[]},rangeBar:{series:[],i:[]},rangeArea:{series:[],seriesRangeEnd:[],i:[]}},r=s.chart.type||"line",l=null,c=0;o.series.forEach(function(t,i){var s="column"===e[i].type?"bar":e[i].type||("column"===r?"bar":r);n[s]?("rangeArea"===s?(n[s].series.push(o.seriesRangeStart[i]),n[s].seriesRangeEnd.push(o.seriesRangeEnd[i])):n[s].series.push(t),n[s].i.push(i),"bar"===s&&(a.globals.columnSeries=n.bar)):["heatmap","treemap","pie","donut","polarArea","radialBar","radar"].includes(s)?l=s:console.warn("You have specified an unrecognized series type (".concat(s,").")),r!==s&&"scatter"!==s&&c++}),c>0&&(l&&console.warn("Chart or series type ".concat(l," cannot appear with other chart or series types.")),n.bar.series.length>0&&s.plotOptions.bar.horizontal&&(c-=n.bar.series.length,n.bar={series:[],i:[]},a.globals.columnSeries={series:[],i:[]},console.warn("Horizontal bars are not supported in a mixed/combo chart. Please turn off `plotOptions.bar.horizontal`"))),o.comboCharts||(o.comboCharts=c>0);var h=new um(i,t),d=new em(i,t);i.pie=new sm(i);var u=new nm(i);i.rangeBar=new rm(i,t);var p=new om(i),m=[];if(o.comboCharts){var g,f,b=new Ju(i);if(n.area.series.length>0&&(g=m).push.apply(g,Vc(b.drawSeriesByGroup(n.area,o.areaGroups,"area",h))),n.bar.series.length>0)if(s.chart.stacked){var y=new Qp(i,t);m.push(y.draw(n.bar.series,n.bar.i))}else i.bar=new Jp(i,t),m.push(i.bar.draw(n.bar.series,n.bar.i));if(n.rangeArea.series.length>0&&m.push(h.draw(n.rangeArea.series,"rangeArea",n.rangeArea.i,n.rangeArea.seriesRangeEnd)),n.line.series.length>0&&(f=m).push.apply(f,Vc(b.drawSeriesByGroup(n.line,o.lineGroups,"line",h))),n.candlestick.series.length>0&&m.push(d.draw(n.candlestick.series,"candlestick",n.candlestick.i)),n.boxPlot.series.length>0&&m.push(d.draw(n.boxPlot.series,"boxPlot",n.boxPlot.i)),n.rangeBar.series.length>0&&m.push(i.rangeBar.draw(n.rangeBar.series,n.rangeBar.i)),n.scatter.series.length>0){var w=new um(i,t,!0);m.push(w.draw(n.scatter.series,"scatter",n.scatter.i))}if(n.bubble.series.length>0){var v=new um(i,t,!0);m.push(v.draw(n.bubble.series,"bubble",n.bubble.i))}}else switch(s.chart.type){case"line":m=h.draw(o.series,"line");break;case"area":m=h.draw(o.series,"area");break;case"bar":s.chart.stacked?m=new Qp(i,t).draw(o.series):(i.bar=new Jp(i,t),m=i.bar.draw(o.series));break;case"candlestick":m=new em(i,t).draw(o.series,"candlestick");break;case"boxPlot":m=new em(i,t).draw(o.series,s.chart.type);break;case"rangeBar":m=i.rangeBar.draw(o.series);break;case"rangeArea":m=h.draw(o.seriesRangeStart,"rangeArea",void 0,o.seriesRangeEnd);break;case"heatmap":m=new am(i,t).draw(o.series);break;case"treemap":m=new pm(i,t).draw(o.series);break;case"pie":case"donut":case"polarArea":m=i.pie.draw(o.series);break;case"radialBar":m=u.draw(o.series);break;case"radar":m=p.draw(o.series);break;default:m=h.draw(o.series)}return m}},{key:"setSVGDimensions",value:function(){var e=this.w,t=e.globals,a=e.config;a.chart.width=a.chart.width||"100%",a.chart.height=a.chart.height||"auto",t.svgWidth=a.chart.width,t.svgHeight=a.chart.height;var i=Xc.getDimensions(this.el),s=a.chart.width.toString().split(/[0-9]+/g).pop();"%"===s?Xc.isNumber(i[0])&&(0===i[0].width&&(i=Xc.getDimensions(this.el.parentNode)),t.svgWidth=i[0]*parseInt(a.chart.width,10)/100):"px"!==s&&""!==s||(t.svgWidth=parseInt(a.chart.width,10));var o=String(a.chart.height).toString().split(/[0-9]+/g).pop();if("auto"!==t.svgHeight&&""!==t.svgHeight)if("%"===o){var n=Xc.getDimensions(this.el.parentNode);t.svgHeight=n[1]*parseInt(a.chart.height,10)/100}else t.svgHeight=parseInt(a.chart.height,10);else t.svgHeight=t.axisCharts?t.svgWidth/1.61:t.svgWidth/1.2;if(t.svgWidth=Math.max(t.svgWidth,0),t.svgHeight=Math.max(t.svgHeight,0),Ku.setAttrs(t.dom.Paper.node,{width:t.svgWidth,height:t.svgHeight}),"%"!==o){var r=a.chart.sparkline.enabled?0:t.axisCharts?a.chart.parentHeightOffset:0;t.dom.Paper.node.parentNode.parentNode.style.minHeight="".concat(t.svgHeight+r,"px")}t.dom.elWrap.style.width="".concat(t.svgWidth,"px"),t.dom.elWrap.style.height="".concat(t.svgHeight,"px")}},{key:"shiftGraphPosition",value:function(){var e=this.w.globals,t=e.translateY,a=e.translateX;Ku.setAttrs(e.dom.elGraphical.node,{transform:"translate(".concat(a,", ").concat(t,")")})}},{key:"resizeNonAxisCharts",value:function(){var e=this.w,t=e.globals,a=0,i=e.config.chart.sparkline.enabled?1:15;i+=e.config.grid.padding.bottom,["top","bottom"].includes(e.config.legend.position)&&e.config.legend.show&&!e.config.legend.floating&&(a=new Hp(this.ctx).legendHelpers.getLegendDimensions().clwh+7);var s=e.globals.dom.baseEl.querySelector(".apexcharts-radialbar, .apexcharts-pie"),o=2.05*e.globals.radialSize;if(s&&!e.config.chart.sparkline.enabled&&0!==e.config.plotOptions.radialBar.startAngle){var n=Xc.getBoundingClientRect(s);o=n.bottom;var r=n.bottom-n.top;o=Math.max(2.05*e.globals.radialSize,r)}var l=Math.ceil(o+t.translateY+a+i);t.dom.elLegendForeign&&t.dom.elLegendForeign.setAttribute("height",l),e.config.chart.height&&String(e.config.chart.height).includes("%")||(t.dom.elWrap.style.height="".concat(l,"px"),Ku.setAttrs(t.dom.Paper.node,{height:l}),t.dom.Paper.node.parentNode.parentNode.style.minHeight="".concat(l,"px"))}},{key:"coreCalculations",value:function(){new Cp(this.ctx).init()}},{key:"resetGlobals",value:function(){var e=this,t=function(){return e.w.config.series.map(function(){return[]})},a=new pp,i=this.w.globals;a.initGlobalVars(i),i.seriesXvalues=t(),i.seriesYvalues=t()}},{key:"isMultipleY",value:function(){return!!(Array.isArray(this.w.config.yaxis)&&this.w.config.yaxis.length>1)&&(this.w.globals.isMultipleYAxis=!0,!0)}},{key:"xySettings",value:function(){var e=this.w,t=null;if(e.globals.axisCharts){if("back"===e.config.xaxis.crosshairs.position&&new Pp(this.ctx).drawXCrosshairs(),"back"===e.config.yaxis[0].crosshairs.position&&new Pp(this.ctx).drawYCrosshairs(),"datetime"===e.config.xaxis.type&&void 0===e.config.xaxis.labels.formatter){this.ctx.timeScale=new gm(this.ctx);var a=[];isFinite(e.globals.minX)&&isFinite(e.globals.maxX)&&!e.globals.isBarHorizontal?a=this.ctx.timeScale.calculateTimeScaleTicks(e.globals.minX,e.globals.maxX):e.globals.isBarHorizontal&&(a=this.ctx.timeScale.calculateTimeScaleTicks(e.globals.minY,e.globals.maxY)),this.ctx.timeScale.recalcDimensionsBasedOnFormat(a)}t=new Ju(this.ctx).getCalculatedRatios()}return t}},{key:"updateSourceChart",value:function(e){this.ctx.w.globals.selection=void 0,this.ctx.updateHelpers._updateOptions({chart:{selection:{xaxis:{min:e.w.globals.minX,max:e.w.globals.maxX}}}},!1,!1)}},{key:"setupBrushHandler",value:function(){var e=this,t=this.ctx,a=this.w;if(a.config.chart.brush.enabled&&"function"!=typeof a.config.chart.events.selection){var i=Array.isArray(a.config.chart.brush.targets)?a.config.chart.brush.targets:[a.config.chart.brush.target];i.forEach(function(a){var i=t.constructor.getChartByID(a);i.w.globals.brushSource=e.ctx,"function"!=typeof i.w.config.chart.events.zoomed&&(i.w.config.chart.events.zoomed=function(){return e.updateSourceChart(i)}),"function"!=typeof i.w.config.chart.events.scrolled&&(i.w.config.chart.events.scrolled=function(){return e.updateSourceChart(i)})}),a.config.chart.events.selection=function(e,a){i.forEach(function(e){t.constructor.getChartByID(e).ctx.updateHelpers._updateOptions({xaxis:{min:a.xaxis.min,max:a.xaxis.max}},!1,!1,!1,!1)})}}}}]),e}(),bm=function(){function e(t){Rc(this,e),this.ctx=t,this.w=t.w}return Mc(e,[{key:"_updateOptions",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return new Promise(function(n){var r=[t.ctx];s&&(r=t.ctx.getSyncedCharts()),t.ctx.w.globals.isExecCalled&&(r=[t.ctx],t.ctx.w.globals.isExecCalled=!1),r.forEach(function(s,l){var c=s.w;if(c.globals.shouldAnimate=i,a||(c.globals.resized=!0,c.globals.dataChanged=!0,i&&s.series.getPreviousPaths()),e&&"object"===Yc(e)&&(s.config=new up(e),e=Ju.extendArrayProps(s.config,e,c),s.w.globals.chartID!==t.ctx.w.globals.chartID&&delete e.series,c.config=Xc.extend(c.config,e),o&&(c.globals.lastXAxis=e.xaxis?Xc.clone(e.xaxis):[],c.globals.lastYAxis=e.yaxis?Xc.clone(e.yaxis):[],c.globals.initialConfig=Xc.extend({},c.config),c.globals.initialSeries=Xc.clone(c.config.series),e.series))){for(var h=0;h<c.globals.collapsedSeriesIndices.length;h++){var d=c.config.series[c.globals.collapsedSeriesIndices[h]];c.globals.collapsedSeries[h].data=c.globals.axisCharts?d.data.slice():d}for(var u=0;u<c.globals.ancillaryCollapsedSeriesIndices.length;u++){var p=c.config.series[c.globals.ancillaryCollapsedSeriesIndices[u]];c.globals.ancillaryCollapsedSeries[u].data=c.globals.axisCharts?p.data.slice():p}s.series.emptyCollapsedSeries(c.config.series)}return s.update(e).then(function(){l===r.length-1&&n(s)})})})}},{key:"_updateSeries",value:function(e,t){var a=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise(function(s){var o,n=a.w;return n.globals.shouldAnimate=t,n.globals.dataChanged=!0,t&&a.ctx.series.getPreviousPaths(),n.globals.axisCharts?(0===(o=e.map(function(e,t){return a._extendSeries(e,t)})).length&&(o=[{data:[]}]),n.config.series=o):n.config.series=e.slice(),i&&(n.globals.initialConfig.series=Xc.clone(n.config.series),n.globals.initialSeries=Xc.clone(n.config.series)),a.ctx.update().then(function(){s(a.ctx)})})}},{key:"_extendSeries",value:function(e,t){var a=this.w,i=a.config.series[t];return Uc(Uc({},a.config.series[t]),{},{name:e.name?e.name:null==i?void 0:i.name,color:e.color?e.color:null==i?void 0:i.color,type:e.type?e.type:null==i?void 0:i.type,group:e.group?e.group:null==i?void 0:i.group,hidden:void 0!==e.hidden?e.hidden:null==i?void 0:i.hidden,data:e.data?e.data:null==i?void 0:i.data,zIndex:void 0!==e.zIndex?e.zIndex:t})}},{key:"toggleDataPointSelection",value:function(e,t){var a=this.w,i=null,s=".apexcharts-series[data\\:realIndex='".concat(e,"']");return a.globals.axisCharts?i=a.globals.dom.Paper.findOne("".concat(s," path[j='").concat(t,"'], ").concat(s," circle[j='").concat(t,"'], ").concat(s," rect[j='").concat(t,"']")):void 0===t&&(i=a.globals.dom.Paper.findOne("".concat(s," path[j='").concat(e,"']")),"pie"!==a.config.chart.type&&"polarArea"!==a.config.chart.type&&"donut"!==a.config.chart.type||this.ctx.pie.pieClicked(e)),i?(new Ku(this.ctx).pathMouseDown(i,null),i.node?i.node:null):(console.warn("toggleDataPointSelection: Element not found"),null)}},{key:"forceXAxisUpdate",value:function(e){var t=this.w;if(["min","max"].forEach(function(a){void 0!==e.xaxis[a]&&(t.config.xaxis[a]=e.xaxis[a],t.globals.lastXAxis[a]=e.xaxis[a])}),e.xaxis.categories&&e.xaxis.categories.length&&(t.config.xaxis.categories=e.xaxis.categories),t.config.xaxis.convertedCatToNumeric){var a=new dp(e);e=a.convertCatToNumericXaxis(e,this.ctx)}return e}},{key:"forceYAxisUpdate",value:function(e){return e.chart&&e.chart.stacked&&"100%"===e.chart.stackType&&(Array.isArray(e.yaxis)?e.yaxis.forEach(function(t,a){e.yaxis[a].min=0,e.yaxis[a].max=100}):(e.yaxis.min=0,e.yaxis.max=100)),e}},{key:"revertDefaultAxisMinMax",value:function(e){var t=this,a=this.w,i=a.globals.lastXAxis,s=a.globals.lastYAxis;e&&e.xaxis&&(i=e.xaxis),e&&e.yaxis&&(s=e.yaxis),a.config.xaxis.min=i.min,a.config.xaxis.max=i.max;a.config.yaxis.map(function(e,i){a.globals.zoomed||void 0!==s[i]?function(e){void 0!==s[e]&&(a.config.yaxis[e].min=s[e].min,a.config.yaxis[e].max=s[e].max)}(i):void 0!==t.ctx.opts.yaxis[i]&&(e.min=t.ctx.opts.yaxis[i].min,e.max=t.ctx.opts.yaxis[i].max)})}}]),e}();!function(){function e(){for(var e=arguments.length>0&&arguments[0]!==c?arguments[0]:[],s=arguments.length>1?arguments[1]:c,o=arguments.length>2?arguments[2]:c,n=arguments.length>3?arguments[3]:c,r=arguments.length>4?arguments[4]:c,l=arguments.length>5?arguments[5]:c,c=arguments.length>6?arguments[6]:c,h=e.slice(s,o||c),d=n.slice(r,l||c),u=0,p={pos:[0,0],start:[0,0]},m={pos:[0,0],start:[0,0]};h[u]=t.call(p,h[u]),d[u]=t.call(m,d[u]),h[u][0]!=d[u][0]||"M"==h[u][0]||"A"==h[u][0]&&(h[u][4]!=d[u][4]||h[u][5]!=d[u][5])?(Array.prototype.splice.apply(h,[u,1].concat(i.call(p,h[u]))),Array.prototype.splice.apply(d,[u,1].concat(i.call(m,d[u])))):(h[u]=a.call(p,h[u]),d[u]=a.call(m,d[u])),++u!=h.length||u!=d.length;)u==h.length&&h.push(["C",p.pos[0],p.pos[1],p.pos[0],p.pos[1],p.pos[0],p.pos[1]]),u==d.length&&d.push(["C",m.pos[0],m.pos[1],m.pos[0],m.pos[1],m.pos[0],m.pos[1]]);return{start:h,dest:d}}function t(e){switch(e[0]){case"z":case"Z":e[0]="L",e[1]=this.start[0],e[2]=this.start[1];break;case"H":e[0]="L",e[2]=this.pos[1];break;case"V":e[0]="L",e[2]=e[1],e[1]=this.pos[0];break;case"T":e[0]="Q",e[3]=e[1],e[4]=e[2],e[1]=this.reflection[1],e[2]=this.reflection[0];break;case"S":e[0]="C",e[6]=e[4],e[5]=e[3],e[4]=e[2],e[3]=e[1],e[2]=this.reflection[1],e[1]=this.reflection[0]}return e}function a(e){var t=e.length;return this.pos=[e[t-2],e[t-1]],-1!="SCQT".indexOf(e[0])&&(this.reflection=[2*this.pos[0]-e[t-4],2*this.pos[1]-e[t-3]]),e}function i(e){var t=[e];switch(e[0]){case"M":return this.pos=this.start=[e[1],e[2]],t;case"L":e[5]=e[3]=e[1],e[6]=e[4]=e[2],e[1]=this.pos[0],e[2]=this.pos[1];break;case"Q":e[6]=e[4],e[5]=e[3],e[4]=1*e[4]/3+2*e[2]/3,e[3]=1*e[3]/3+2*e[1]/3,e[2]=1*this.pos[1]/3+2*e[2]/3,e[1]=1*this.pos[0]/3+2*e[1]/3;break;case"A":e=(t=function(e,t){var a,i,s,o,n,r,l,c,h,d,u,p,m,g,f,b,y,w,v,x,S,_,k,C,I,E,T=Math.abs(t[1]),A=Math.abs(t[2]),P=t[3]%360,R=t[4],D=t[5],M=t[6],L=t[7],N=new jh(e),O=new jh(M,L),G=[];if(0===T||0===A||N.x===O.x&&N.y===O.y)return[["C",N.x,N.y,O.x,O.y,O.x,O.y]];for((i=(a=new jh((N.x-O.x)/2,(N.y-O.y)/2).transform((new qh).rotate(P))).x*a.x/(T*T)+a.y*a.y/(A*A))>1&&(T*=i=Math.sqrt(i),A*=i),s=(new qh).rotate(P).scale(1/T,1/A).rotate(-P),N=N.transform(s),r=(o=[(O=O.transform(s)).x-N.x,O.y-N.y])[0]*o[0]+o[1]*o[1],n=Math.sqrt(r),o[0]/=n,o[1]/=n,l=r<4?Math.sqrt(1-r/4):0,R===D&&(l*=-1),c=new jh((O.x+N.x)/2+l*-o[1],(O.y+N.y)/2+l*o[0]),h=new jh(N.x-c.x,N.y-c.y),d=new jh(O.x-c.x,O.y-c.y),u=Math.acos(h.x/Math.sqrt(h.x*h.x+h.y*h.y)),h.y<0&&(u*=-1),p=Math.acos(d.x/Math.sqrt(d.x*d.x+d.y*d.y)),d.y<0&&(p*=-1),D&&u>p&&(p+=2*Math.PI),!D&&u<p&&(p-=2*Math.PI),b=[],y=u,m=(p-u)/(g=Math.ceil(2*Math.abs(u-p)/Math.PI)),f=4*Math.tan(m/4)/3,S=0;S<=g;S++)v=Math.cos(y),w=Math.sin(y),x=new jh(c.x+v,c.y+w),b[S]=[new jh(x.x+f*w,x.y-f*v),x,new jh(x.x-f*w,x.y+f*v)],y+=m;for(b[0][0]=b[0][1].clone(),b[b.length-1][2]=b[b.length-1][1].clone(),s=(new qh).rotate(P).scale(T,A).rotate(-P),S=0,_=b.length;S<_;S++)b[S][0]=b[S][0].transform(s),b[S][1]=b[S][1].transform(s),b[S][2]=b[S][2].transform(s);for(S=1,_=b.length;S<_;S++)k=(x=b[S-1][2]).x,C=x.y,I=(x=b[S][0]).x,E=x.y,M=(x=b[S][1]).x,L=x.y,G.push(["C",k,C,I,E,M,L]);return G}(this.pos,e))[0]}return e[0]="C",this.pos=[e[5],e[6]],this.reflection=[2*e[5]-e[3],2*e[6]-e[4]],t}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(!1===t)return!1;for(var a=t,i=e.length;a<i;++a)if("M"==e[a][0])return a;return!1}Ih(ou,{morph:function(t,a,i,o,n){for(var r=this.parse(t),l=this.parse(a),c=0,h=0,d=!1,u=!1;!1!==c||!1!==h;){var p;d=s(r,!1!==c&&c+1),u=s(l,!1!==h&&h+1),!1===c&&(c=0==(p=new ou(m.start).bbox()).height||0==p.width?r.push(r[0])-1:r.push(["M",p.x+p.width/2,p.y+p.height/2])-1),!1===h&&(h=0==(p=new ou(m.dest).bbox()).height||0==p.width?l.push(l[0])-1:l.push(["M",p.x+p.width/2,p.y+p.height/2])-1);var m=e(r,c,d,l,h,u);r=r.slice(0,c).concat(m.start,!1===d?[]:r.slice(d)),l=l.slice(0,h).concat(m.dest,!1===u?[]:l.slice(u)),c=!1!==d&&c+m.start.length,h=!1!==u&&h+m.dest.length}return this._array=r,this.destination=new ou,this.destination._array=l,this.fromArray(r.map(function(e,t){return l[t].map(function(a,s){return 0===s?a:o.step(e[s],l[t][s],i,n[t],n)})}))}})}();const ym=e=>(e.changedTouches&&(e=e.changedTouches[0]),{x:e.clientX,y:e.clientY});class wm{constructor(e){e.remember("_draggable",this),this.el=e,this.drag=this.drag.bind(this),this.startDrag=this.startDrag.bind(this),this.endDrag=this.endDrag.bind(this)}init(e){e?(this.el.on("mousedown.drag",this.startDrag),this.el.on("touchstart.drag",this.startDrag,{passive:!1})):(this.el.off("mousedown.drag"),this.el.off("touchstart.drag"))}startDrag(e){const t=!e.type.indexOf("mouse");if(t&&1!==e.which&&0!==e.buttons)return;if(this.el.dispatch("beforedrag",{event:e,handler:this}).defaultPrevented)return;e.preventDefault(),e.stopPropagation(),this.init(!1),this.box=this.el.bbox(),this.lastClick=this.el.point(ym(e));const a=(t?"mouseup":"touchend")+".drag";od(window,(t?"mousemove":"touchmove")+".drag",this.drag,this,{passive:!1}),od(window,a,this.endDrag,this,{passive:!1}),this.el.fire("dragstart",{event:e,handler:this,box:this.box})}drag(e){const{box:t,lastClick:a}=this,i=this.el.point(ym(e)),s=i.x-a.x,o=i.y-a.y;if(!s&&!o)return t;const n=t.x+s,r=t.y+o;this.box=new Zh(n,r,t.w,t.h),this.lastClick=i,this.el.dispatch("dragmove",{event:e,handler:this,box:this.box}).defaultPrevented||this.move(n,r)}move(e,t){"svg"===this.el.type?zu.prototype.move.call(this.el,e,t):this.el.move(e,t)}endDrag(e){this.drag(e),this.el.fire("dragend",{event:e,handler:this,box:this.box}),nd(window,"mousemove.drag"),nd(window,"touchmove.drag"),nd(window,"mouseup.drag"),nd(window,"touchend.drag"),this.init(!0)}}
/*!
* @svgdotjs/svg.select.js - An extension of svg.js which allows to select elements with mouse
* @version 4.0.1
* https://github.com/svgdotjs/svg.select.js
*
* @copyright Ulrich-Matthias Schfer
* @license MIT
*
* BUILT: Mon Jul 01 2024 15:04:42 GMT+0200 (Central European Summer Time)
*/function vm(e,t,a,i=null){return function(s){s.preventDefault(),s.stopPropagation();var o=s.pageX||s.touches[0].pageX,n=s.pageY||s.touches[0].pageY;t.fire(e,{x:o,y:n,event:s,index:i,points:a})}}function xm([e,t],{a:a,b:i,c:s,d:o,e:n,f:r}){return[e*a+t*s+n,e*i+t*o+r]}Ih(gd,{draggable(e=!0){return(this.remember("_draggable")||new wm(this)).init(e),this}});let Sm=class{constructor(e){this.el=e,e.remember("_selectHandler",this),this.selection=new zu,this.order=["lt","t","rt","r","rb","b","lb","l","rot"],this.mutationHandler=this.mutationHandler.bind(this);const t=ph();this.observer=new t.MutationObserver(this.mutationHandler)}init(e){this.createHandle=e.createHandle||this.createHandleFn,this.createRot=e.createRot||this.createRotFn,this.updateHandle=e.updateHandle||this.updateHandleFn,this.updateRot=e.updateRot||this.updateRotFn,this.el.root().put(this.selection),this.updatePoints(),this.createSelection(),this.createResizeHandles(),this.updateResizeHandles(),this.createRotationHandle(),this.updateRotationHandle(),this.observer.observe(this.el.node,{attributes:!0})}active(e,t){if(!e)return this.selection.clear().remove(),void this.observer.disconnect();this.init(t)}createSelection(){this.selection.polygon(this.handlePoints).addClass("svg_select_shape")}updateSelection(){this.selection.get(0).plot(this.handlePoints)}createResizeHandles(){this.handlePoints.forEach((e,t,a)=>{const i=this.order[t];this.createHandle.call(this,this.selection,e,t,a,i),this.selection.get(t+1).addClass("svg_select_handle svg_select_handle_"+i).on("mousedown.selection touchstart.selection",vm(i,this.el,this.handlePoints,t))})}createHandleFn(e){e.polyline()}updateHandleFn(e,t,a,i){const s=i.at(a-1),o=i[(a+1)%i.length],n=t,r=[n[0]-s[0],n[1]-s[1]],l=[n[0]-o[0],n[1]-o[1]],c=Math.sqrt(r[0]*r[0]+r[1]*r[1]),h=Math.sqrt(l[0]*l[0]+l[1]*l[1]),d=[r[0]/c,r[1]/c],u=[l[0]/h,l[1]/h],p=[n[0]-10*d[0],n[1]-10*d[1]],m=[n[0]-10*u[0],n[1]-10*u[1]];e.plot([p,n,m])}updateResizeHandles(){this.handlePoints.forEach((e,t,a)=>{const i=this.order[t];this.updateHandle.call(this,this.selection.get(t+1),e,t,a,i)})}createRotFn(e){e.line(),e.circle(5)}getPoint(e){return this.handlePoints[this.order.indexOf(e)]}getPointHandle(e){return this.selection.get(this.order.indexOf(e)+1)}updateRotFn(e,t){const a=this.getPoint("t");e.get(0).plot(a[0],a[1],t[0],t[1]),e.get(1).center(t[0],t[1])}createRotationHandle(){const e=this.selection.group().addClass("svg_select_handle_rot").on("mousedown.selection touchstart.selection",vm("rot",this.el,this.handlePoints));this.createRot.call(this,e)}updateRotationHandle(){const e=this.selection.findOne("g.svg_select_handle_rot");this.updateRot(e,this.rotationPoint,this.handlePoints)}updatePoints(){const e=this.el.bbox(),t=this.el.parent().screenCTM().inverseO().multiplyO(this.el.screenCTM());this.handlePoints=this.getHandlePoints(e).map(e=>xm(e,t)),this.rotationPoint=xm(this.getRotationPoint(e),t)}getHandlePoints({x:e,x2:t,y:a,y2:i,cx:s,cy:o}=this.el.bbox()){return[[e,a],[s,a],[t,a],[t,o],[t,i],[s,i],[e,i],[e,o]]}getRotationPoint({y:e,cx:t}=this.el.bbox()){return[t,e-20]}mutationHandler(){this.updatePoints(),this.updateSelection(),this.updateResizeHandles(),this.updateRotationHandle()}};const _m=e=>function(t=!0,a={}){"object"==typeof t&&(a=t,t=!0);let i=this.remember("_"+e.name);return i||(t.prototype instanceof Sm?(i=new t(this),t=!0):i=new e(this),this.remember("_"+e.name,i)),i.active(t,a),this};
/*!
* @svgdotjs/svg.resize.js - An extension for svg.js which allows to resize elements which are selected
* @version 2.0.4
* https://github.com/svgdotjs/svg.resize.js
*
* @copyright [object Object]
* @license MIT
*
* BUILT: Fri Sep 13 2024 12:43:14 GMT+0200 (Central European Summer Time)
*/
/*!
* @svgdotjs/svg.select.js - An extension of svg.js which allows to select elements with mouse
* @version 4.0.1
* https://github.com/svgdotjs/svg.select.js
*
* @copyright Ulrich-Matthias Schfer
* @license MIT
*
* BUILT: Mon Jul 01 2024 15:04:42 GMT+0200 (Central European Summer Time)
*/function km(e,t,a,i=null){return function(s){s.preventDefault(),s.stopPropagation();var o=s.pageX||s.touches[0].pageX,n=s.pageY||s.touches[0].pageY;t.fire(e,{x:o,y:n,event:s,index:i,points:a})}}function Cm([e,t],{a:a,b:i,c:s,d:o,e:n,f:r}){return[e*a+t*s+n,e*i+t*o+r]}Ih(gd,{select:_m(Sm)}),Ih([gu,fu,Ud],{pointSelect:_m(class{constructor(e){this.el=e,e.remember("_pointSelectHandler",this),this.selection=new zu,this.order=["lt","t","rt","r","rb","b","lb","l","rot"],this.mutationHandler=this.mutationHandler.bind(this);const t=ph();this.observer=new t.MutationObserver(this.mutationHandler)}init(e){this.createHandle=e.createHandle||this.createHandleFn,this.updateHandle=e.updateHandle||this.updateHandleFn,this.el.root().put(this.selection),this.updatePoints(),this.createSelection(),this.createPointHandles(),this.updatePointHandles(),this.observer.observe(this.el.node,{attributes:!0})}active(e,t){if(!e)return this.selection.clear().remove(),void this.observer.disconnect();this.init(t)}createSelection(){this.selection.polygon(this.points).addClass("svg_select_shape_pointSelect")}updateSelection(){this.selection.get(0).plot(this.points)}createPointHandles(){this.points.forEach((e,t,a)=>{this.createHandle.call(this,this.selection,e,t,a),this.selection.get(t+1).addClass("svg_select_handle_point").on("mousedown.selection touchstart.selection",vm("point",this.el,this.points,t))})}createHandleFn(e){e.circle(5)}updateHandleFn(e,t){e.center(t[0],t[1])}updatePointHandles(){this.points.forEach((e,t,a)=>{this.updateHandle.call(this,this.selection.get(t+1),e,t,a)})}updatePoints(){const e=this.el.parent().screenCTM().inverseO().multiplyO(this.el.screenCTM());this.points=this.el.array().map(t=>xm(t,e))}mutationHandler(){this.updatePoints(),this.updateSelection(),this.updatePointHandles()}})});class Im{constructor(e){this.el=e,e.remember("_selectHandler",this),this.selection=new zu,this.order=["lt","t","rt","r","rb","b","lb","l","rot"],this.mutationHandler=this.mutationHandler.bind(this);const t=ph();this.observer=new t.MutationObserver(this.mutationHandler)}init(e){this.createHandle=e.createHandle||this.createHandleFn,this.createRot=e.createRot||this.createRotFn,this.updateHandle=e.updateHandle||this.updateHandleFn,this.updateRot=e.updateRot||this.updateRotFn,this.el.root().put(this.selection),this.updatePoints(),this.createSelection(),this.createResizeHandles(),this.updateResizeHandles(),this.createRotationHandle(),this.updateRotationHandle(),this.observer.observe(this.el.node,{attributes:!0})}active(e,t){if(!e)return this.selection.clear().remove(),void this.observer.disconnect();this.init(t)}createSelection(){this.selection.polygon(this.handlePoints).addClass("svg_select_shape")}updateSelection(){this.selection.get(0).plot(this.handlePoints)}createResizeHandles(){this.handlePoints.forEach((e,t,a)=>{const i=this.order[t];this.createHandle.call(this,this.selection,e,t,a,i),this.selection.get(t+1).addClass("svg_select_handle svg_select_handle_"+i).on("mousedown.selection touchstart.selection",km(i,this.el,this.handlePoints,t))})}createHandleFn(e){e.polyline()}updateHandleFn(e,t,a,i){const s=i.at(a-1),o=i[(a+1)%i.length],n=t,r=[n[0]-s[0],n[1]-s[1]],l=[n[0]-o[0],n[1]-o[1]],c=Math.sqrt(r[0]*r[0]+r[1]*r[1]),h=Math.sqrt(l[0]*l[0]+l[1]*l[1]),d=[r[0]/c,r[1]/c],u=[l[0]/h,l[1]/h],p=[n[0]-10*d[0],n[1]-10*d[1]],m=[n[0]-10*u[0],n[1]-10*u[1]];e.plot([p,n,m])}updateResizeHandles(){this.handlePoints.forEach((e,t,a)=>{const i=this.order[t];this.updateHandle.call(this,this.selection.get(t+1),e,t,a,i)})}createRotFn(e){e.line(),e.circle(5)}getPoint(e){return this.handlePoints[this.order.indexOf(e)]}getPointHandle(e){return this.selection.get(this.order.indexOf(e)+1)}updateRotFn(e,t){const a=this.getPoint("t");e.get(0).plot(a[0],a[1],t[0],t[1]),e.get(1).center(t[0],t[1])}createRotationHandle(){const e=this.selection.group().addClass("svg_select_handle_rot").on("mousedown.selection touchstart.selection",km("rot",this.el,this.handlePoints));this.createRot.call(this,e)}updateRotationHandle(){const e=this.selection.findOne("g.svg_select_handle_rot");this.updateRot(e,this.rotationPoint,this.handlePoints)}updatePoints(){const e=this.el.bbox(),t=this.el.parent().screenCTM().inverseO().multiplyO(this.el.screenCTM());this.handlePoints=this.getHandlePoints(e).map(e=>Cm(e,t)),this.rotationPoint=Cm(this.getRotationPoint(e),t)}getHandlePoints({x:e,x2:t,y:a,y2:i,cx:s,cy:o}=this.el.bbox()){return[[e,a],[s,a],[t,a],[t,o],[t,i],[s,i],[e,i],[e,o]]}getRotationPoint({y:e,cx:t}=this.el.bbox()){return[t,e-20]}mutationHandler(){this.updatePoints(),this.updateSelection(),this.updateResizeHandles(),this.updateRotationHandle()}}const Em=e=>function(t=!0,a={}){"object"==typeof t&&(a=t,t=!0);let i=this.remember("_"+e.name);return i||(t.prototype instanceof Im?(i=new t(this),t=!0):i=new e(this),this.remember("_"+e.name,i)),i.active(t,a),this};Ih(gd,{select:Em(Im)}),Ih([gu,fu,Ud],{pointSelect:Em(class{constructor(e){this.el=e,e.remember("_pointSelectHandler",this),this.selection=new zu,this.order=["lt","t","rt","r","rb","b","lb","l","rot"],this.mutationHandler=this.mutationHandler.bind(this);const t=ph();this.observer=new t.MutationObserver(this.mutationHandler)}init(e){this.createHandle=e.createHandle||this.createHandleFn,this.updateHandle=e.updateHandle||this.updateHandleFn,this.el.root().put(this.selection),this.updatePoints(),this.createSelection(),this.createPointHandles(),this.updatePointHandles(),this.observer.observe(this.el.node,{attributes:!0})}active(e,t){if(!e)return this.selection.clear().remove(),void this.observer.disconnect();this.init(t)}createSelection(){this.selection.polygon(this.points).addClass("svg_select_shape_pointSelect")}updateSelection(){this.selection.get(0).plot(this.points)}createPointHandles(){this.points.forEach((e,t,a)=>{this.createHandle.call(this,this.selection,e,t,a),this.selection.get(t+1).addClass("svg_select_handle_point").on("mousedown.selection touchstart.selection",km("point",this.el,this.points,t))})}createHandleFn(e){e.circle(5)}updateHandleFn(e,t){e.center(t[0],t[1])}updatePointHandles(){this.points.forEach((e,t,a)=>{this.updateHandle.call(this,this.selection.get(t+1),e,t,a)})}updatePoints(){const e=this.el.parent().screenCTM().inverseO().multiplyO(this.el.screenCTM());this.points=this.el.array().map(t=>Cm(t,e))}mutationHandler(){this.updatePoints(),this.updateSelection(),this.updatePointHandles()}})});const Tm=e=>(e.changedTouches&&(e=e.changedTouches[0]),{x:e.clientX,y:e.clientY}),Am=e=>{let t=1/0,a=1/0,i=-1/0,s=-1/0;for(let o=0;o<e.length;o++){const n=e[o];t=Math.min(t,n[0]),a=Math.min(a,n[1]),i=Math.max(i,n[0]),s=Math.max(s,n[1])}return new Zh(t,a,i-t,s-a)};class Pm{constructor(e){this.el=e,e.remember("_ResizeHandler",this),this.lastCoordinates=null,this.eventType="",this.lastEvent=null,this.handleResize=this.handleResize.bind(this),this.resize=this.resize.bind(this),this.endResize=this.endResize.bind(this),this.rotate=this.rotate.bind(this),this.movePoint=this.movePoint.bind(this)}active(e,t){this.preserveAspectRatio=t.preserveAspectRatio??!1,this.aroundCenter=t.aroundCenter??!1,this.grid=t.grid??0,this.degree=t.degree??0,this.el.off(".resize"),e&&(this.el.on(["lt.resize","rt.resize","rb.resize","lb.resize","t.resize","r.resize","b.resize","l.resize","rot.resize","point.resize"],this.handleResize),this.lastEvent&&("rot"===this.eventType?this.rotate(this.lastEvent):"point"===this.eventType?this.movePoint(this.lastEvent):this.resize(this.lastEvent)))}handleResize(e){this.eventType=e.type;const{event:t,index:a,points:i}=e.detail,s=!t.type.indexOf("mouse");if(s&&1!==(t.which||t.buttons))return;if(this.el.dispatch("beforeresize",{event:e,handler:this}).defaultPrevented)return;this.box=this.el.bbox(),this.startPoint=this.el.point(Tm(t)),this.index=a,this.points=i.slice();const o=(s?"mousemove":"touchmove")+".resize",n=(s?"mouseup":"touchcancel.resize touchend")+".resize";"point"===e.type?od(window,o,this.movePoint):"rot"===e.type?od(window,o,this.rotate):od(window,o,this.resize),od(window,n,this.endResize)}resize(e){this.lastEvent=e;const t=this.snapToGrid(this.el.point(Tm(e)));let a=t.x-this.startPoint.x,i=t.y-this.startPoint.y;this.preserveAspectRatio&&this.aroundCenter&&(a*=2,i*=2);const s=this.box.x+a,o=this.box.y+i,n=this.box.x2+a,r=this.box.y2+i;let l=new Zh(this.box);if(this.eventType.includes("l")&&(l.x=Math.min(s,this.box.x2),l.x2=Math.max(s,this.box.x2)),this.eventType.includes("r")&&(l.x=Math.min(n,this.box.x),l.x2=Math.max(n,this.box.x)),this.eventType.includes("t")&&(l.y=Math.min(o,this.box.y2),l.y2=Math.max(o,this.box.y2)),this.eventType.includes("b")&&(l.y=Math.min(r,this.box.y),l.y2=Math.max(r,this.box.y)),l.width=l.x2-l.x,l.height=l.y2-l.y,this.preserveAspectRatio){const e=l.width/this.box.width,t=l.height/this.box.height,a=["lt","t","rt","r","rb","b","lb","l"],i=(a.indexOf(this.eventType)+4)%a.length,s=this.aroundCenter?[this.box.cx,this.box.cy]:this.points[i];let o=this.eventType.includes("t")||this.eventType.includes("b")?t:e;o=2===this.eventType.length?Math.max(e,t):o,l=function(e,t,a){const i=[[e.x,e.y],[e.x+e.width,e.y],[e.x+e.width,e.y+e.height],[e.x,e.y+e.height]].map(([e,i])=>{const s=e-t[0],o=(i-t[1])*a;return[s*a+t[0],o+t[1]]});return Am(i)}(this.box,s,o)}this.el.dispatch("resize",{box:new Zh(l),angle:0,eventType:this.eventType,event:e,handler:this}).defaultPrevented||this.el.size(l.width,l.height).move(l.x,l.y)}movePoint(e){this.lastEvent=e;const{x:t,y:a}=this.snapToGrid(this.el.point(Tm(e))),i=this.el.array().slice();i[this.index]=[t,a],this.el.dispatch("resize",{box:Am(i),angle:0,eventType:this.eventType,event:e,handler:this}).defaultPrevented||this.el.plot(i)}rotate(e){this.lastEvent=e;const t=this.startPoint,a=this.el.point(Tm(e)),{cx:i,cy:s}=this.box,o=t.x-i,n=t.y-s,r=a.x-i,l=a.y-s,c=Math.sqrt(o*o+n*n)*Math.sqrt(r*r+l*l);if(0===c)return;let h=Math.acos((o*r+n*l)/c)/Math.PI*180;if(!h)return;a.x<t.x&&(h=-h);const d=new qh(this.el),{x:u,y:p}=new jh(i,s).transformO(d),{rotate:m}=d.decompose(),g=this.snapToAngle(m+h)-m;this.el.dispatch("resize",{box:this.box,angle:g,eventType:this.eventType,event:e,handler:this}).defaultPrevented||this.el.transform(d.rotateO(g,u,p))}endResize(e){"rot"!==this.eventType&&"point"!==this.eventType&&this.resize(e),this.lastEvent=null,this.eventType="",nd(window,"mousemove.resize touchmove.resize"),nd(window,"mouseup.resize touchend.resize")}snapToGrid(e){return this.grid&&(e.x=Math.round(e.x/this.grid)*this.grid,e.y=Math.round(e.y/this.grid)*this.grid),e}snapToAngle(e){return this.degree&&(e=Math.round(e/this.degree)*this.degree),e}}Ih(gd,{resize:function(e=!0,t={}){"object"==typeof e&&(t=e,e=!0);let a=this.remember("_ResizeHandler");return a||(e.prototype instanceof Pm?(a=new e(this),e=!0):a=new Pm(this),this.remember("_resizeHandler",a)),a.active(e,t),this}}),void 0===window.SVG&&(window.SVG=ju),void 0===window.Apex&&(window.Apex={});var Rm=function(){function e(t){Rc(this,e),this.ctx=t,this.w=t.w}return Mc(e,[{key:"initModules",value:function(){this.ctx.publicMethods=["updateOptions","updateSeries","appendData","appendSeries","isSeriesHidden","highlightSeries","toggleSeries","showSeries","hideSeries","setLocale","resetSeries","zoomX","toggleDataPointSelection","dataURI","exportToCSV","addXaxisAnnotation","addYaxisAnnotation","addPointAnnotation","clearAnnotations","removeAnnotation","paper","destroy"],this.ctx.eventList=["click","mousedown","mousemove","mouseleave","touchstart","touchmove","touchleave","mouseup","touchend"],this.ctx.animations=new $c(this.ctx),this.ctx.axes=new Ap(this.ctx),this.ctx.core=new fm(this.ctx.el,this.ctx),this.ctx.config=new up({}),this.ctx.data=new vp(this.ctx),this.ctx.grid=new _p(this.ctx),this.ctx.graphics=new Ku(this.ctx),this.ctx.coreUtils=new Ju(this.ctx),this.ctx.crosshairs=new Pp(this.ctx),this.ctx.events=new Ep(this.ctx),this.ctx.exports=new xp(this.ctx),this.ctx.fill=new gp(this.ctx),this.ctx.localization=new Tp(this.ctx),this.ctx.options=new rp,this.ctx.responsive=new Rp(this.ctx),this.ctx.series=new wp(this.ctx),this.ctx.theme=new Dp(this.ctx),this.ctx.formatters=new ap(this.ctx),this.ctx.titleSubtitle=new Mp(this.ctx),this.ctx.legend=new Hp(this.ctx),this.ctx.toolbar=new Up(this.ctx),this.ctx.tooltip=new $p(this.ctx),this.ctx.dimensions=new zp(this.ctx),this.ctx.updateHelpers=new bm(this.ctx),this.ctx.zoomPanSelection=new Bp(this.ctx),this.ctx.w.globals.tooltip=new $p(this.ctx)}}]),e}(),Dm=function(){function e(t){Rc(this,e),this.ctx=t,this.w=t.w}return Mc(e,[{key:"clear",value:function(e){var t=e.isUpdating;this.ctx.zoomPanSelection&&this.ctx.zoomPanSelection.destroy(),this.ctx.toolbar&&this.ctx.toolbar.destroy(),this.ctx.animations=null,this.ctx.axes=null,this.ctx.annotations=null,this.ctx.core=null,this.ctx.data=null,this.ctx.grid=null,this.ctx.series=null,this.ctx.responsive=null,this.ctx.theme=null,this.ctx.formatters=null,this.ctx.titleSubtitle=null,this.ctx.legend=null,this.ctx.dimensions=null,this.ctx.options=null,this.ctx.crosshairs=null,this.ctx.zoomPanSelection=null,this.ctx.updateHelpers=null,this.ctx.toolbar=null,this.ctx.localization=null,this.ctx.w.globals.tooltip=null,this.clearDomElements({isUpdating:t})}},{key:"killSVG",value:function(e){e.each(function(){this.removeClass("*"),this.off()},!0),e.clear()}},{key:"clearDomElements",value:function(e){var t=this,a=e.isUpdating,i=this.w.globals.dom.Paper.node;i.parentNode&&i.parentNode.parentNode&&!a&&(i.parentNode.parentNode.style.minHeight="unset");var s=this.w.globals.dom.baseEl;s&&this.ctx.eventList.forEach(function(e){s.removeEventListener(e,t.ctx.events.documentEvent)});var o=this.w.globals.dom;if(null!==this.ctx.el)for(;this.ctx.el.firstChild;)this.ctx.el.removeChild(this.ctx.el.firstChild);this.killSVG(o.Paper),o.Paper.remove(),o.elWrap=null,o.elGraphical=null,o.elLegendWrap=null,o.elLegendForeign=null,o.baseEl=null,o.elGridRect=null,o.elGridRectMask=null,o.elGridRectBarMask=null,o.elGridRectMarkerMask=null,o.elForecastMask=null,o.elNonForecastMask=null,o.elDefs=null}}]),e}(),Mm=new WeakMap,Lm=function(){function e(t,a){Rc(this,e),this.opts=a,this.ctx=this,this.w=new mp(a).init(),this.el=t,this.w.globals.cuid=Xc.randomId(),this.w.globals.chartID=this.w.config.chart.id?Xc.escapeString(this.w.config.chart.id):this.w.globals.cuid,new Rm(this).initModules(),this.lastUpdateOptions=null,this.create=Xc.bind(this.create,this),this.windowResizeHandler=this._windowResizeHandler.bind(this),this.parentResizeHandler=this._parentResizeCallback.bind(this)}return Mc(e,[{key:"render",value:function(){var e=this;return new Promise(function(t,a){if(Xc.elementExists(e.el)){void 0===Apex._chartInstances&&(Apex._chartInstances=[]),e.w.config.chart.id&&Apex._chartInstances.push({id:e.w.globals.chartID,group:e.w.config.chart.group,chart:e}),e.setLocale(e.w.config.chart.defaultLocale);var i=e.w.config.chart.events.beforeMount;"function"==typeof i&&i(e,e.w),e.events.fireEvent("beforeMount",[e,e.w]),window.addEventListener("resize",e.windowResizeHandler),function(e,t){var a=!1;if(e.nodeType!==Node.DOCUMENT_FRAGMENT_NODE){var i=e.getBoundingClientRect();"none"!==e.style.display&&0!==i.width||(a=!0)}var s=new ResizeObserver(function(i){a&&t.call(e,i),a=!0});e.nodeType===Node.DOCUMENT_FRAGMENT_NODE?Array.from(e.children).forEach(function(e){return s.observe(e)}):s.observe(e),Mm.set(t,s)}(e.el.parentNode,e.parentResizeHandler);var s=e.el.getRootNode&&e.el.getRootNode(),o=Xc.is("ShadowRoot",s),n=e.el.ownerDocument,r=o?s.getElementById("apexcharts-css"):n.getElementById("apexcharts-css");if(!r){var l;(r=document.createElement("style")).id="apexcharts-css",r.textContent='@keyframes opaque {\n  0% {\n    opacity: 0\n  }\n\n  to {\n    opacity: 1\n  }\n}\n\n@keyframes resizeanim {\n\n  0%,\n  to {\n    opacity: 0\n  }\n}\n\n.apexcharts-canvas {\n  position: relative;\n  direction: ltr !important;\n  user-select: none\n}\n\n.apexcharts-canvas ::-webkit-scrollbar {\n  -webkit-appearance: none;\n  width: 6px\n}\n\n.apexcharts-canvas ::-webkit-scrollbar-thumb {\n  border-radius: 4px;\n  background-color: rgba(0, 0, 0, .5);\n  box-shadow: 0 0 1px rgba(255, 255, 255, .5);\n  -webkit-box-shadow: 0 0 1px rgba(255, 255, 255, .5)\n}\n\n.apexcharts-inner {\n  position: relative\n}\n\n.apexcharts-text tspan {\n  font-family: inherit\n}\n\nrect.legend-mouseover-inactive,\n.legend-mouseover-inactive rect,\n.legend-mouseover-inactive path,\n.legend-mouseover-inactive circle,\n.legend-mouseover-inactive line,\n.legend-mouseover-inactive text.apexcharts-yaxis-title-text,\n.legend-mouseover-inactive text.apexcharts-yaxis-label {\n  transition: .15s ease all;\n  opacity: .2\n}\n\n.apexcharts-legend-text {\n  padding-left: 15px;\n  margin-left: -15px;\n}\n\n.apexcharts-series-collapsed {\n  opacity: 0\n}\n\n.apexcharts-tooltip {\n  border-radius: 5px;\n  box-shadow: 2px 2px 6px -4px #999;\n  cursor: default;\n  font-size: 14px;\n  left: 62px;\n  opacity: 0;\n  pointer-events: none;\n  position: absolute;\n  top: 20px;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n  white-space: nowrap;\n  z-index: 12;\n  transition: .15s ease all\n}\n\n.apexcharts-tooltip.apexcharts-active {\n  opacity: 1;\n  transition: .15s ease all\n}\n\n.apexcharts-tooltip.apexcharts-theme-light {\n  border: 1px solid #e3e3e3;\n  background: rgba(255, 255, 255, .96)\n}\n\n.apexcharts-tooltip.apexcharts-theme-dark {\n  color: #fff;\n  background: rgba(30, 30, 30, .8)\n}\n\n.apexcharts-tooltip * {\n  font-family: inherit\n}\n\n.apexcharts-tooltip-title {\n  padding: 6px;\n  font-size: 15px;\n  margin-bottom: 4px\n}\n\n.apexcharts-tooltip.apexcharts-theme-light .apexcharts-tooltip-title {\n  background: #eceff1;\n  border-bottom: 1px solid #ddd\n}\n\n.apexcharts-tooltip.apexcharts-theme-dark .apexcharts-tooltip-title {\n  background: rgba(0, 0, 0, .7);\n  border-bottom: 1px solid #333\n}\n\n.apexcharts-tooltip-text-goals-value,\n.apexcharts-tooltip-text-y-value,\n.apexcharts-tooltip-text-z-value {\n  display: inline-block;\n  margin-left: 5px;\n  font-weight: 600\n}\n\n.apexcharts-tooltip-text-goals-label:empty,\n.apexcharts-tooltip-text-goals-value:empty,\n.apexcharts-tooltip-text-y-label:empty,\n.apexcharts-tooltip-text-y-value:empty,\n.apexcharts-tooltip-text-z-value:empty,\n.apexcharts-tooltip-title:empty {\n  display: none\n}\n\n.apexcharts-tooltip-text-goals-label,\n.apexcharts-tooltip-text-goals-value {\n  padding: 6px 0 5px\n}\n\n.apexcharts-tooltip-goals-group,\n.apexcharts-tooltip-text-goals-label,\n.apexcharts-tooltip-text-goals-value {\n  display: flex\n}\n\n.apexcharts-tooltip-text-goals-label:not(:empty),\n.apexcharts-tooltip-text-goals-value:not(:empty) {\n  margin-top: -6px\n}\n\n.apexcharts-tooltip-marker {\n  display: inline-block;\n  position: relative;\n  width: 16px;\n  height: 16px;\n  font-size: 16px;\n  line-height: 16px;\n  margin-right: 4px;\n  text-align: center;\n  vertical-align: middle;\n  color: inherit;\n}\n\n.apexcharts-tooltip-marker::before {\n  content: "";\n  display: inline-block;\n  width: 100%;\n  text-align: center;\n  color: currentcolor;\n  text-rendering: optimizeLegibility;\n  -webkit-font-smoothing: antialiased;\n  font-size: 26px;\n  font-family: Arial, Helvetica, sans-serif;\n  line-height: 14px;\n  font-weight: 900;\n}\n\n.apexcharts-tooltip-marker[shape="circle"]::before {\n  content: "\\25CF";\n}\n\n.apexcharts-tooltip-marker[shape="square"]::before,\n.apexcharts-tooltip-marker[shape="rect"]::before {\n  content: "\\25A0";\n  transform: translate(-1px, -2px);\n}\n\n.apexcharts-tooltip-marker[shape="line"]::before {\n  content: "\\2500";\n}\n\n.apexcharts-tooltip-marker[shape="diamond"]::before {\n  content: "\\25C6";\n  font-size: 28px;\n}\n\n.apexcharts-tooltip-marker[shape="triangle"]::before {\n  content: "\\25B2";\n  font-size: 22px;\n}\n\n.apexcharts-tooltip-marker[shape="cross"]::before {\n  content: "\\2715";\n  font-size: 18px;\n}\n\n.apexcharts-tooltip-marker[shape="plus"]::before {\n  content: "\\2715";\n  transform: rotate(45deg) translate(-1px, -1px);\n  font-size: 18px;\n}\n\n.apexcharts-tooltip-marker[shape="star"]::before {\n  content: "\\2605";\n  font-size: 18px;\n}\n\n.apexcharts-tooltip-marker[shape="sparkle"]::before {\n  content: "\\2726";\n  font-size: 20px;\n}\n\n.apexcharts-tooltip-series-group {\n  padding: 0 10px;\n  display: none;\n  text-align: left;\n  justify-content: left;\n  align-items: center\n}\n\n.apexcharts-tooltip-series-group.apexcharts-active .apexcharts-tooltip-marker {\n  opacity: 1\n}\n\n.apexcharts-tooltip-series-group.apexcharts-active,\n.apexcharts-tooltip-series-group:last-child {\n  padding-bottom: 4px\n}\n\n.apexcharts-tooltip-y-group {\n  padding: 6px 0 5px\n}\n\n.apexcharts-custom-tooltip,\n.apexcharts-tooltip-box {\n  padding: 4px 8px\n}\n\n.apexcharts-tooltip-boxPlot {\n  display: flex;\n  flex-direction: column-reverse\n}\n\n.apexcharts-tooltip-box>div {\n  margin: 4px 0\n}\n\n.apexcharts-tooltip-box span.value {\n  font-weight: 700\n}\n\n.apexcharts-tooltip-rangebar {\n  padding: 5px 8px\n}\n\n.apexcharts-tooltip-rangebar .category {\n  font-weight: 600;\n  color: #777\n}\n\n.apexcharts-tooltip-rangebar .series-name {\n  font-weight: 700;\n  display: block;\n  margin-bottom: 5px\n}\n\n.apexcharts-xaxistooltip,\n.apexcharts-yaxistooltip {\n  opacity: 0;\n  pointer-events: none;\n  color: #373d3f;\n  font-size: 13px;\n  text-align: center;\n  border-radius: 2px;\n  position: absolute;\n  z-index: 10;\n  background: #eceff1;\n  border: 1px solid #90a4ae\n}\n\n.apexcharts-xaxistooltip {\n  padding: 9px 10px;\n  transition: .15s ease all\n}\n\n.apexcharts-xaxistooltip.apexcharts-theme-dark {\n  background: rgba(0, 0, 0, .7);\n  border: 1px solid rgba(0, 0, 0, .5);\n  color: #fff\n}\n\n.apexcharts-xaxistooltip:after,\n.apexcharts-xaxistooltip:before {\n  left: 50%;\n  border: solid transparent;\n  content: " ";\n  height: 0;\n  width: 0;\n  position: absolute;\n  pointer-events: none\n}\n\n.apexcharts-xaxistooltip:after {\n  border-color: transparent;\n  border-width: 6px;\n  margin-left: -6px\n}\n\n.apexcharts-xaxistooltip:before {\n  border-color: transparent;\n  border-width: 7px;\n  margin-left: -7px\n}\n\n.apexcharts-xaxistooltip-bottom:after,\n.apexcharts-xaxistooltip-bottom:before {\n  bottom: 100%\n}\n\n.apexcharts-xaxistooltip-top:after,\n.apexcharts-xaxistooltip-top:before {\n  top: 100%\n}\n\n.apexcharts-xaxistooltip-bottom:after {\n  border-bottom-color: #eceff1\n}\n\n.apexcharts-xaxistooltip-bottom:before {\n  border-bottom-color: #90a4ae\n}\n\n.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:after,\n.apexcharts-xaxistooltip-bottom.apexcharts-theme-dark:before {\n  border-bottom-color: rgba(0, 0, 0, .5)\n}\n\n.apexcharts-xaxistooltip-top:after {\n  border-top-color: #eceff1\n}\n\n.apexcharts-xaxistooltip-top:before {\n  border-top-color: #90a4ae\n}\n\n.apexcharts-xaxistooltip-top.apexcharts-theme-dark:after,\n.apexcharts-xaxistooltip-top.apexcharts-theme-dark:before {\n  border-top-color: rgba(0, 0, 0, .5)\n}\n\n.apexcharts-xaxistooltip.apexcharts-active {\n  opacity: 1;\n  transition: .15s ease all\n}\n\n.apexcharts-yaxistooltip {\n  padding: 4px 10px\n}\n\n.apexcharts-yaxistooltip.apexcharts-theme-dark {\n  background: rgba(0, 0, 0, .7);\n  border: 1px solid rgba(0, 0, 0, .5);\n  color: #fff\n}\n\n.apexcharts-yaxistooltip:after,\n.apexcharts-yaxistooltip:before {\n  top: 50%;\n  border: solid transparent;\n  content: " ";\n  height: 0;\n  width: 0;\n  position: absolute;\n  pointer-events: none\n}\n\n.apexcharts-yaxistooltip:after {\n  border-color: transparent;\n  border-width: 6px;\n  margin-top: -6px\n}\n\n.apexcharts-yaxistooltip:before {\n  border-color: transparent;\n  border-width: 7px;\n  margin-top: -7px\n}\n\n.apexcharts-yaxistooltip-left:after,\n.apexcharts-yaxistooltip-left:before {\n  left: 100%\n}\n\n.apexcharts-yaxistooltip-right:after,\n.apexcharts-yaxistooltip-right:before {\n  right: 100%\n}\n\n.apexcharts-yaxistooltip-left:after {\n  border-left-color: #eceff1\n}\n\n.apexcharts-yaxistooltip-left:before {\n  border-left-color: #90a4ae\n}\n\n.apexcharts-yaxistooltip-left.apexcharts-theme-dark:after,\n.apexcharts-yaxistooltip-left.apexcharts-theme-dark:before {\n  border-left-color: rgba(0, 0, 0, .5)\n}\n\n.apexcharts-yaxistooltip-right:after {\n  border-right-color: #eceff1\n}\n\n.apexcharts-yaxistooltip-right:before {\n  border-right-color: #90a4ae\n}\n\n.apexcharts-yaxistooltip-right.apexcharts-theme-dark:after,\n.apexcharts-yaxistooltip-right.apexcharts-theme-dark:before {\n  border-right-color: rgba(0, 0, 0, .5)\n}\n\n.apexcharts-yaxistooltip.apexcharts-active {\n  opacity: 1\n}\n\n.apexcharts-yaxistooltip-hidden {\n  display: none\n}\n\n.apexcharts-xcrosshairs,\n.apexcharts-ycrosshairs {\n  pointer-events: none;\n  opacity: 0;\n  transition: .15s ease all\n}\n\n.apexcharts-xcrosshairs.apexcharts-active,\n.apexcharts-ycrosshairs.apexcharts-active {\n  opacity: 1;\n  transition: .15s ease all\n}\n\n.apexcharts-ycrosshairs-hidden {\n  opacity: 0\n}\n\n.apexcharts-selection-rect {\n  cursor: move\n}\n\n.svg_select_shape {\n  stroke-width: 1;\n  stroke-dasharray: 10 10;\n  stroke: black;\n  stroke-opacity: 0.1;\n  pointer-events: none;\n  fill: none;\n}\n\n.svg_select_handle {\n  stroke-width: 3;\n  stroke: black;\n  fill: none;\n}\n\n.svg_select_handle_r {\n  cursor: e-resize;\n}\n\n.svg_select_handle_l {\n  cursor: w-resize;\n}\n\n.apexcharts-svg.apexcharts-zoomable.hovering-zoom {\n  cursor: crosshair\n}\n\n.apexcharts-svg.apexcharts-zoomable.hovering-pan {\n  cursor: move\n}\n\n.apexcharts-menu-icon,\n.apexcharts-pan-icon,\n.apexcharts-reset-icon,\n.apexcharts-selection-icon,\n.apexcharts-toolbar-custom-icon,\n.apexcharts-zoom-icon,\n.apexcharts-zoomin-icon,\n.apexcharts-zoomout-icon {\n  cursor: pointer;\n  width: 20px;\n  height: 20px;\n  line-height: 24px;\n  color: #6e8192;\n  text-align: center\n}\n\n.apexcharts-menu-icon svg,\n.apexcharts-reset-icon svg,\n.apexcharts-zoom-icon svg,\n.apexcharts-zoomin-icon svg,\n.apexcharts-zoomout-icon svg {\n  fill: #6e8192\n}\n\n.apexcharts-selection-icon svg {\n  fill: #444;\n  transform: scale(.76)\n}\n\n.apexcharts-theme-dark .apexcharts-menu-icon svg,\n.apexcharts-theme-dark .apexcharts-pan-icon svg,\n.apexcharts-theme-dark .apexcharts-reset-icon svg,\n.apexcharts-theme-dark .apexcharts-selection-icon svg,\n.apexcharts-theme-dark .apexcharts-toolbar-custom-icon svg,\n.apexcharts-theme-dark .apexcharts-zoom-icon svg,\n.apexcharts-theme-dark .apexcharts-zoomin-icon svg,\n.apexcharts-theme-dark .apexcharts-zoomout-icon svg {\n  fill: #f3f4f5\n}\n\n.apexcharts-canvas .apexcharts-reset-zoom-icon.apexcharts-selected svg,\n.apexcharts-canvas .apexcharts-selection-icon.apexcharts-selected svg,\n.apexcharts-canvas .apexcharts-zoom-icon.apexcharts-selected svg {\n  fill: #008ffb\n}\n\n.apexcharts-theme-light .apexcharts-menu-icon:hover svg,\n.apexcharts-theme-light .apexcharts-reset-icon:hover svg,\n.apexcharts-theme-light .apexcharts-selection-icon:not(.apexcharts-selected):hover svg,\n.apexcharts-theme-light .apexcharts-zoom-icon:not(.apexcharts-selected):hover svg,\n.apexcharts-theme-light .apexcharts-zoomin-icon:hover svg,\n.apexcharts-theme-light .apexcharts-zoomout-icon:hover svg {\n  fill: #333\n}\n\n.apexcharts-menu-icon,\n.apexcharts-selection-icon {\n  position: relative\n}\n\n.apexcharts-reset-icon {\n  margin-left: 5px\n}\n\n.apexcharts-menu-icon,\n.apexcharts-reset-icon,\n.apexcharts-zoom-icon {\n  transform: scale(.85)\n}\n\n.apexcharts-zoomin-icon,\n.apexcharts-zoomout-icon {\n  transform: scale(.7)\n}\n\n.apexcharts-zoomout-icon {\n  margin-right: 3px\n}\n\n.apexcharts-pan-icon {\n  transform: scale(.62);\n  position: relative;\n  left: 1px;\n  top: 0\n}\n\n.apexcharts-pan-icon svg {\n  fill: #fff;\n  stroke: #6e8192;\n  stroke-width: 2\n}\n\n.apexcharts-pan-icon.apexcharts-selected svg {\n  stroke: #008ffb\n}\n\n.apexcharts-pan-icon:not(.apexcharts-selected):hover svg {\n  stroke: #333\n}\n\n.apexcharts-toolbar {\n  position: absolute;\n  z-index: 11;\n  max-width: 176px;\n  text-align: right;\n  border-radius: 3px;\n  padding: 0 6px 2px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center\n}\n\n.apexcharts-menu {\n  background: #fff;\n  position: absolute;\n  top: 100%;\n  border: 1px solid #ddd;\n  border-radius: 3px;\n  padding: 3px;\n  right: 10px;\n  opacity: 0;\n  min-width: 110px;\n  transition: .15s ease all;\n  pointer-events: none\n}\n\n.apexcharts-menu.apexcharts-menu-open {\n  opacity: 1;\n  pointer-events: all;\n  transition: .15s ease all\n}\n\n.apexcharts-menu-item {\n  padding: 6px 7px;\n  font-size: 12px;\n  cursor: pointer\n}\n\n.apexcharts-theme-light .apexcharts-menu-item:hover {\n  background: #eee\n}\n\n.apexcharts-theme-dark .apexcharts-menu {\n  background: rgba(0, 0, 0, .7);\n  color: #fff\n}\n\n@media screen and (min-width:768px) {\n  .apexcharts-canvas:hover .apexcharts-toolbar {\n    opacity: 1\n  }\n}\n\n.apexcharts-canvas .apexcharts-element-hidden,\n.apexcharts-datalabel.apexcharts-element-hidden,\n.apexcharts-hide .apexcharts-series-points {\n  opacity: 0;\n}\n\n.apexcharts-hidden-element-shown {\n  opacity: 1;\n  transition: 0.25s ease all;\n}\n\n.apexcharts-datalabel,\n.apexcharts-datalabel-label,\n.apexcharts-datalabel-value,\n.apexcharts-datalabels,\n.apexcharts-pie-label {\n  cursor: default;\n  pointer-events: none\n}\n\n.apexcharts-pie-label-delay {\n  opacity: 0;\n  animation-name: opaque;\n  animation-duration: .3s;\n  animation-fill-mode: forwards;\n  animation-timing-function: ease\n}\n\n.apexcharts-radialbar-label {\n  cursor: pointer;\n}\n\n.apexcharts-annotation-rect,\n.apexcharts-area-series .apexcharts-area,\n.apexcharts-gridline,\n.apexcharts-line,\n.apexcharts-point-annotation-label,\n.apexcharts-radar-series path:not(.apexcharts-marker),\n.apexcharts-radar-series polygon,\n.apexcharts-toolbar svg,\n.apexcharts-tooltip .apexcharts-marker,\n.apexcharts-xaxis-annotation-label,\n.apexcharts-yaxis-annotation-label,\n.apexcharts-zoom-rect,\n.no-pointer-events {\n  pointer-events: none\n}\n\n.apexcharts-tooltip-active .apexcharts-marker {\n  transition: .15s ease all\n}\n\n.apexcharts-radar-series .apexcharts-yaxis {\n  pointer-events: none;\n}\n\n.resize-triggers {\n  animation: 1ms resizeanim;\n  visibility: hidden;\n  opacity: 0;\n  height: 100%;\n  width: 100%;\n  overflow: hidden\n}\n\n.contract-trigger:before,\n.resize-triggers,\n.resize-triggers>div {\n  content: " ";\n  display: block;\n  position: absolute;\n  top: 0;\n  left: 0\n}\n\n.resize-triggers>div {\n  height: 100%;\n  width: 100%;\n  background: #eee;\n  overflow: auto\n}\n\n.contract-trigger:before {\n  overflow: hidden;\n  width: 200%;\n  height: 200%\n}\n\n.apexcharts-bar-goals-markers {\n  pointer-events: none\n}\n\n.apexcharts-bar-shadows {\n  pointer-events: none\n}\n\n.apexcharts-rangebar-goals-markers {\n  pointer-events: none\n}\n\n.apexcharts-disable-transitions * {\n  transition: none !important;\n}';var c=(null===(l=e.opts.chart)||void 0===l?void 0:l.nonce)||e.w.config.chart.nonce;c&&r.setAttribute("nonce",c),o?s.prepend(r):n.head.appendChild(r)}var h=e.create(e.w.config.series,{});if(!h)return t(e);e.mount(h).then(function(){"function"==typeof e.w.config.chart.events.mounted&&e.w.config.chart.events.mounted(e,e.w),e.events.fireEvent("mounted",[e,e.w]),t(h)}).catch(function(e){a(e)})}else a(new Error("Element not found"))})}},{key:"create",value:function(e,t){var a=this,i=this.w;new Rm(this).initModules();var s=this.w.globals;if(s.noData=!1,s.animationEnded=!1,!Xc.elementExists(this.el))return s.animationEnded=!0,null;if(this.responsive.checkResponsiveConfig(t),i.config.xaxis.convertedCatToNumeric&&new dp(i.config).convertCatToNumericXaxis(i.config,this.ctx),this.core.setupElements(),"treemap"===i.config.chart.type&&(i.config.grid.show=!1,i.config.yaxis[0].show=!1),0===s.svgWidth)return s.animationEnded=!0,null;var o=e;e.forEach(function(e,t){e.hidden&&(o=a.legend.legendHelpers.getSeriesAfterCollapsing({realIndex:t}))});var n=Ju.checkComboSeries(o,i.config.chart.type);s.comboCharts=n.comboCharts,s.comboBarCount=n.comboBarCount;var r=o.every(function(e){return e.data&&0===e.data.length});(0===o.length||r&&s.collapsedSeries.length<1)&&this.series.handleNoData(),this.events.setupEventHandlers(),this.data.parseData(o),this.theme.init(),new fp(this).setGlobalMarkerSize(),this.formatters.setLabelFormatters(),this.titleSubtitle.draw(),s.noData&&s.collapsedSeries.length!==s.series.length&&!i.config.legend.showForSingleSeries||this.legend.init(),this.series.hasAllSeriesEqualX(),s.axisCharts&&(this.core.coreCalculations(),"category"!==i.config.xaxis.type&&this.formatters.setLabelFormatters(),this.ctx.toolbar.minX=i.globals.minX,this.ctx.toolbar.maxX=i.globals.maxX),this.formatters.heatmapLabelFormatters(),new Ju(this).getLargestMarkerSize(),this.dimensions.plotCoords();var l=this.core.xySettings();this.grid.createGridMask();var c=this.core.plotChartType(o,l),h=new yp(this);return h.bringForward(),i.config.dataLabels.background.enabled&&h.dataLabelsBackground(),this.core.shiftGraphPosition(),i.globals.dataPoints>50&&i.globals.dom.elWrap.classList.add("apexcharts-disable-transitions"),{elGraph:c,xyRatios:l,dimensions:{plot:{left:i.globals.translateX,top:i.globals.translateY,width:i.globals.gridWidth,height:i.globals.gridHeight}}}}},{key:"mount",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=this,i=a.w;return new Promise(function(s,o){if(null===a.el)return o(new Error("Not enough data to display or target element not found"));(null===t||i.globals.allSeriesCollapsed)&&a.series.handleNoData(),a.grid=new _p(a);var n,r,l=a.grid.drawGrid();if(a.annotations=new lp(a),a.annotations.drawImageAnnos(),a.annotations.drawTextAnnos(),"back"===i.config.grid.position&&(l&&i.globals.dom.elGraphical.add(l.el),null!=l&&null!==(n=l.elGridBorders)&&void 0!==n&&n.node&&i.globals.dom.elGraphical.add(l.elGridBorders)),Array.isArray(t.elGraph))for(var c=0;c<t.elGraph.length;c++)i.globals.dom.elGraphical.add(t.elGraph[c]);else i.globals.dom.elGraphical.add(t.elGraph);"front"===i.config.grid.position&&(l&&i.globals.dom.elGraphical.add(l.el),null!=l&&null!==(r=l.elGridBorders)&&void 0!==r&&r.node&&i.globals.dom.elGraphical.add(l.elGridBorders)),"front"===i.config.xaxis.crosshairs.position&&a.crosshairs.drawXCrosshairs(),"front"===i.config.yaxis[0].crosshairs.position&&a.crosshairs.drawYCrosshairs(),"treemap"!==i.config.chart.type&&a.axes.drawAxis(i.config.chart.type,l);var h=new Sp(e.ctx,l),d=new Ip(e.ctx,l);if(null!==l&&(h.xAxisLabelCorrections(l.xAxisTickWidth),d.setYAxisTextAlignments(),i.config.yaxis.map(function(e,t){-1===i.globals.ignoreYAxisIndexes.indexOf(t)&&d.yAxisTitleRotate(t,e.opposite)})),a.annotations.drawAxesAnnotations(),!i.globals.noData){if(i.config.tooltip.enabled&&!i.globals.noData&&a.w.globals.tooltip.drawTooltip(t.xyRatios),i.globals.axisCharts&&(i.globals.isXNumeric||i.config.xaxis.convertedCatToNumeric||i.globals.isRangeBar))(i.config.chart.zoom.enabled||i.config.chart.selection&&i.config.chart.selection.enabled||i.config.chart.pan&&i.config.chart.pan.enabled)&&a.zoomPanSelection.init({xyRatios:t.xyRatios});else{var u=i.config.chart.toolbar.tools;["zoom","zoomin","zoomout","selection","pan","reset"].forEach(function(e){u[e]=!1})}i.config.chart.toolbar.show&&!i.globals.allSeriesCollapsed&&a.toolbar.createToolbar()}i.globals.memory.methodsToExec.length>0&&i.globals.memory.methodsToExec.forEach(function(e){e.method(e.params,!1,e.context)}),i.globals.axisCharts||i.globals.noData||a.core.resizeNonAxisCharts(),s(a)})}},{key:"destroy",value:function(){var e,t;window.removeEventListener("resize",this.windowResizeHandler),this.el.parentNode,e=this.parentResizeHandler,(t=Mm.get(e))&&(t.disconnect(),Mm.delete(e));var a=this.w.config.chart.id;a&&Apex._chartInstances.forEach(function(e,t){e.id===Xc.escapeString(a)&&Apex._chartInstances.splice(t,1)}),new Dm(this.ctx).clear({isUpdating:!1})}},{key:"updateOptions",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],n=this.w;return n.globals.selection=void 0,this.lastUpdateOptions&&JSON.stringify(this.lastUpdateOptions)===JSON.stringify(e)?this:(this.lastUpdateOptions=Xc.clone(e),e.series&&(this.series.resetSeries(!1,!0,!1),e.series.length&&e.series[0].data&&(e.series=e.series.map(function(e,a){return t.updateHelpers._extendSeries(e,a)})),this.updateHelpers.revertDefaultAxisMinMax()),e.xaxis&&(e=this.updateHelpers.forceXAxisUpdate(e)),e.yaxis&&(e=this.updateHelpers.forceYAxisUpdate(e)),n.globals.collapsedSeriesIndices.length>0&&this.series.clearPreviousPaths(),e.theme&&(e=this.theme.updateThemeOptions(e)),this.updateHelpers._updateOptions(e,a,i,s,o))}},{key:"updateSeries",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.series.resetSeries(!1),this.updateHelpers.revertDefaultAxisMinMax(),this.updateHelpers._updateSeries(e,t,a)}},{key:"appendSeries",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this.w.config.series.slice();return i.push(e),this.series.resetSeries(!1),this.updateHelpers.revertDefaultAxisMinMax(),this.updateHelpers._updateSeries(i,t,a)}},{key:"appendData",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=this;a.w.globals.dataChanged=!0,a.series.getPreviousPaths();for(var i=a.w.config.series.slice(),s=0;s<i.length;s++)if(null!==e[s]&&void 0!==e[s])for(var o=0;o<e[s].data.length;o++)i[s].data.push(e[s].data[o]);return a.w.config.series=i,t&&(a.w.globals.initialSeries=Xc.clone(a.w.config.series)),this.update()}},{key:"update",value:function(e){var t=this;return new Promise(function(a,i){if(t.lastUpdateOptions&&JSON.stringify(t.lastUpdateOptions)===JSON.stringify(e))return a(t);t.lastUpdateOptions=Xc.clone(e),new Dm(t.ctx).clear({isUpdating:!0});var s=t.create(t.w.config.series,e);if(!s)return a(t);t.mount(s).then(function(){"function"==typeof t.w.config.chart.events.updated&&t.w.config.chart.events.updated(t,t.w),t.events.fireEvent("updated",[t,t.w]),t.w.globals.isDirty=!0,a(t)}).catch(function(e){i(e)})})}},{key:"getSyncedCharts",value:function(){var e=this.getGroupedCharts(),t=[this];return e.length&&(t=[],e.forEach(function(e){t.push(e)})),t}},{key:"getGroupedCharts",value:function(){var e=this;return Apex._chartInstances.filter(function(e){if(e.group)return!0}).map(function(t){return e.w.config.chart.group===t.group?t.chart:e})}},{key:"toggleSeries",value:function(e){return this.series.toggleSeries(e)}},{key:"highlightSeriesOnLegendHover",value:function(e,t){return this.series.toggleSeriesOnHover(e,t)}},{key:"showSeries",value:function(e){this.series.showSeries(e)}},{key:"hideSeries",value:function(e){this.series.hideSeries(e)}},{key:"highlightSeries",value:function(e){this.series.highlightSeries(e)}},{key:"isSeriesHidden",value:function(e){this.series.isSeriesHidden(e)}},{key:"resetSeries",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.series.resetSeries(e,t)}},{key:"addEventListener",value:function(e,t){this.events.addEventListener(e,t)}},{key:"removeEventListener",value:function(e,t){this.events.removeEventListener(e,t)}},{key:"addXaxisAnnotation",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,i=this;a&&(i=a),i.annotations.addXaxisAnnotationExternal(e,t,i)}},{key:"addYaxisAnnotation",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,i=this;a&&(i=a),i.annotations.addYaxisAnnotationExternal(e,t,i)}},{key:"addPointAnnotation",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,i=this;a&&(i=a),i.annotations.addPointAnnotationExternal(e,t,i)}},{key:"clearAnnotations",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=this;e&&(t=e),t.annotations.clearAnnotations(t)}},{key:"removeAnnotation",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,a=this;t&&(a=t),a.annotations.removeAnnotation(a,e)}},{key:"getChartArea",value:function(){return this.w.globals.dom.baseEl.querySelector(".apexcharts-inner")}},{key:"getSeriesTotalXRange",value:function(e,t){return this.coreUtils.getSeriesTotalsXRange(e,t)}},{key:"getHighestValueInSeries",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Cp(this.ctx).getMinYMaxY(e).highestY}},{key:"getLowestValueInSeries",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Cp(this.ctx).getMinYMaxY(e).lowestY}},{key:"getSeriesTotal",value:function(){return this.w.globals.seriesTotals}},{key:"toggleDataPointSelection",value:function(e,t){return this.updateHelpers.toggleDataPointSelection(e,t)}},{key:"zoomX",value:function(e,t){this.ctx.toolbar.zoomUpdateOptions(e,t)}},{key:"setLocale",value:function(e){this.localization.setCurrentLocaleValues(e)}},{key:"dataURI",value:function(e){return new xp(this.ctx).dataURI(e)}},{key:"getSvgString",value:function(e){return new xp(this.ctx).getSvgString(e)}},{key:"exportToCSV",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new xp(this.ctx).exportToCSV(e)}},{key:"paper",value:function(){return this.w.globals.dom.Paper}},{key:"_parentResizeCallback",value:function(){this.w.globals.animationEnded&&this.w.config.chart.redrawOnParentResize&&this._windowResize()}},{key:"_windowResize",value:function(){var e=this;clearTimeout(this.w.globals.resizeTimer),this.w.globals.resizeTimer=window.setTimeout(function(){e.w.globals.resized=!0,e.w.globals.dataChanged=!1,e.ctx.update()},150)}},{key:"_windowResizeHandler",value:function(){var e=this.w.config.chart.redrawOnWindowResize;"function"==typeof e&&(e=e()),e&&this._windowResize()}}],[{key:"getChartByID",value:function(e){var t=Xc.escapeString(e);if(Apex._chartInstances){var a=Apex._chartInstances.filter(function(e){return e.id===t})[0];return a&&a.chart}}},{key:"initOnLoad",value:function(){for(var t=document.querySelectorAll("[data-apexcharts]"),a=0;a<t.length;a++)new e(t[a],JSON.parse(t[a].getAttribute("data-options"))).render()}},{key:"exec",value:function(e,t){var a=this.getChartByID(e);if(a){a.w.globals.isExecCalled=!0;var i=null;if(-1!==a.publicMethods.indexOf(t)){for(var s=arguments.length,o=new Array(s>2?s-2:0),n=2;n<s;n++)o[n-2]=arguments[n];i=a[t].apply(a,o)}return i}}},{key:"merge",value:function(e,t){return Xc.extend(e,t)}}]),e}();const Nm="#ed5653",Om="#2E93fA",Gm="#b56d07",zm=new Sr;class Fm extends Ul{constructor(e){e.rootCssClass="timeline-root",super(e),this.rotationTimelineTimeRulerElem=null,this.cacheHandler=new Sr({keysToKeep:2}),this.resultData=null,this.prevResultData=null,this.rendered=!1,this.hiddenIds=[],this.hiddenIdsChangeEmitter=new te,this.secondaryResource=e.secondaryResource,this.rootElem.appendChild(H("div",{className:"timeline-disclaimer"},H("div",{className:"d-flex flex-column"},H("p",null,H("i",{className:"warning fa fa-exclamation-triangle fa-xl me-2"}),oe.t("results_tab.details.timeline.disclaimer")),H("p",null,oe.t("results_tab.details.timeline.note"))),H("select",{className:"timeline-chart-picker form-select"},H("option",{className:"rotation-option",value:"rotation"},oe.t("results_tab.details.timeline.chart_types.rotation")),H("option",{className:"dps-option",value:"dps"},oe.t("results_tab.details.timeline.chart_types.dps")),H("option",{className:"threat-option",value:"threat"},oe.t("results_tab.details.timeline.chart_types.threat"))))),this.rootElem.appendChild(H("div",{className:"timeline-plots-container"},H("div",{className:"timeline-plot dps-resources-plot hide"}),H("div",{className:"timeline-plot rotation-plot"},H("div",{className:"rotation-container"},H("div",{className:"rotation-labels"}),H("div",{className:"rotation-timeline",draggable:!0})),H("div",{className:"rotation-hidden-ids"})))),this.chartPicker=this.rootElem.querySelector(".timeline-chart-picker"),this.chartPicker.addEventListener("change",()=>this.onChartPickerSelectHandler()),this.dpsResourcesPlotElem=this.rootElem.querySelector(".dps-resources-plot"),this.dpsResourcesPlot=new Lm(this.dpsResourcesPlotElem,{chart:{animations:{enabled:!1},background:"transparent",foreColor:"white",height:"100%",id:"dpsResources",type:"line",zoom:{enabled:!0,allowMouseWheelZoom:!1}},series:[],xaxis:{title:{text:oe.t("results_tab.details.timeline.chart_options.time_axis")}},noData:{text:oe.t("results_tab.details.timeline.chart_options.waiting_for_data")},stroke:{width:2,curve:"straight"}}),this.rotationPlotElem=this.rootElem.querySelector(".rotation-plot"),this.rotationLabels=this.rootElem.querySelector(".rotation-labels"),this.rotationTimeline=this.rootElem.querySelector(".rotation-timeline"),this.rotationHiddenIdsContainer=this.rootElem.querySelector(".rotation-hidden-ids");let t=!1,a=0,i=0;this.rotationTimeline.addEventListener("dragstart",e=>{e.preventDefault()}),this.rotationTimeline.addEventListener("mousedown",e=>{t=!0,a=e.pageX-this.rotationTimeline.offsetLeft,i=this.rotationTimeline.scrollLeft}),this.rotationTimeline.addEventListener("mouseleave",()=>{t=!1,this.rotationTimeline.classList.remove("active")}),this.rotationTimeline.addEventListener("mouseup",()=>{t=!1,this.rotationTimeline.classList.remove("active")}),this.rotationTimeline.addEventListener("mousemove",e=>{if(!t)return;e.preventDefault();const s=3*(e.pageX-this.rotationTimeline.offsetLeft-a);this.rotationTimeline.scrollLeft=i-s})}onChartPickerSelectHandler(){"rotation"===this.chartPicker.value?(this.dpsResourcesPlotElem.classList.add("hide"),this.rotationPlotElem.classList.remove("hide")):(this.dpsResourcesPlotElem.classList.remove("hide"),this.rotationPlotElem.classList.add("hide"))}onSimResult(e){this.prevResultData=this.resultData,this.resultData=e,this.update()}updatePlot(){if(null==this.resultData)return;const e=this.cacheHandler.get(this.resultData.result.request.requestId);if(e){const{dpsResourcesPlotOptions:t,rotationLabels:a,rotationTimeline:i,rotationHiddenIdsContainer:s,rotationTimelineTimeRulerImage:o}=e;return this.rotationLabels.replaceChildren(...a.cloneNode(!0).childNodes),this.rotationTimeline.replaceChildren(...i.cloneNode(!0).childNodes),this.rotationHiddenIdsContainer.replaceChildren(...s.cloneNode(!0).childNodes),this.dpsResourcesPlot.updateOptions(t),o&&this.rotationTimeline.querySelector(".rotation-timeline-canvas")?.getContext("2d")?.putImageData(o,0,0),void this.onChartPickerSelectHandler()}const t=this.resultData.result.result.firstIterationDuration||1,a={theme:{mode:"dark"},series:[],colors:[],xaxis:{min:0,max:t,tickAmount:10,decimalsInFloat:1,labels:{show:!0},title:{text:"Time (s)"}},yaxis:[],chart:{events:{beforeResetZoom:()=>({xaxis:{min:0,max:t}})},toolbar:{show:!1}}};let i=[];a.tooltip={enabled:!0,custom:e=>{if(i[e.seriesIndex])return De(i[e.seriesIndex](e.dataPointIndex));throw new Error("No tooltip handler for series "+e.seriesIndex)}};const s=this.resultData.result.getRaidIndexedPlayers(this.resultData.filter);if(1==s.length){const e=s[0];this.rootElem.querySelector(".rotation-option").classList.remove("hide");this.rootElem.querySelector(".threat-option").classList.add("hide");try{this.updateRotationChart(e,t)}catch(o){console.log("Failed to update rotation chart: ",o)}const n=this.addDpsSeries(e,a,"");this.addDpsYAxis(n.maxDps,a),i.push(n.tooltipHandler),i.push(this.addManaSeries(e,a)),i.push(this.addThreatSeries(e,a,"")),i=i.filter(e=>!!e),this.addMajorCooldownAnnotations(e,a)}else{if("rotation"==this.chartPicker.value)return void(this.chartPicker.value="dps");this.rootElem.querySelector(".rotation-option").classList.add("hide");if(this.rootElem.querySelector(".threat-option").classList.remove("hide"),this.clearRotationChart(),"dps"==this.chartPicker.value){let e=0;s.forEach(t=>{const s=this.addDpsSeries(t,a,`var(--bs-${t.classColor}`);e=Math.max(e,s.maxDps),i.push(s.tooltipHandler)}),this.addDpsYAxis(e,a)}else{let e=0;s.forEach(t=>{i.push(this.addThreatSeries(t,a,t.classColor)),e=Math.max(e,t.maxThreat)}),this.addThreatYAxis(e,a)}}this.dpsResourcesPlot.updateOptions(a),this.rotationTimelineTimeRulerElem?.toBlob(()=>{this.cacheHandler.set(this.resultData.result.request.requestId,{dpsResourcesPlotOptions:a,rotationLabels:this.rotationLabels.cloneNode(!0),rotationTimeline:this.rotationTimeline.cloneNode(!0),rotationHiddenIdsContainer:this.rotationHiddenIdsContainer.cloneNode(!0),rotationTimelineTimeRulerElem:this.rotationTimelineTimeRulerElem?.cloneNode(!0),rotationTimelineTimeRulerImage:this.rotationTimelineTimeRulerElem?.getContext("2d")?.getImageData(0,0,this.rotationTimelineTimeRulerElem.width,this.rotationTimelineTimeRulerElem.height)})})}addDpsYAxis(e,t){const a=100*Math.ceil(e/100);t.yaxis.push({color:Nm,seriesName:"DPS",min:0,max:a,tickAmount:10,decimalsInFloat:0,title:{text:"DPS",style:{color:Nm}},axisBorder:{show:!0,color:Nm},axisTicks:{color:Nm},labels:{minWidth:30,style:{colors:[Nm]}}})}addThreatYAxis(e,t){const a=1e4*Math.ceil(e/1e4);t.yaxis.push({color:Gm,seriesName:oe.t("results_tab.details.timeline.tooltips.threat"),min:0,max:a,tickAmount:10,decimalsInFloat:0,title:{text:oe.t("results_tab.details.timeline.tooltips.threat"),style:{color:Gm}},axisBorder:{show:!0,color:Gm},axisTicks:{color:Gm},labels:{minWidth:30,style:{colors:[Gm]}}})}addDpsSeries(e,t,a){const i=e.dpsLogs.filter(e=>e.timestamp>=0);return t.colors.push(a||Nm),t.series.push({name:"DPS",type:"line",data:i.map(e=>({x:e.timestamp,y:e.dps}))}),{maxDps:i[Me(i.map(e=>e.dps))]?.dps,tooltipHandler:t=>{const s=i[t];return this.dpsTooltip(s,!0,e,a)}}}addManaSeries(e,t){const a=e.groupedResourceLogs[G.ResourceTypeMana].filter(e=>e.timestamp>=0);if(0==a.length)return null;const i=a[0].valueBefore;return t.colors.push(Om),t.series.push({name:"Mana",type:"line",data:a.map(e=>({x:e.timestamp,y:e.valueAfter}))}),t.yaxis.push({seriesName:"Mana",opposite:!0,min:0,max:i,tickAmount:10,title:{text:"Mana",style:{color:Om}},axisBorder:{show:!0,color:Om},axisTicks:{color:Om},labels:{minWidth:30,style:{colors:[Om]},formatter:e=>{const t=parseFloat(e);return`${t.toFixed(0)} (${(t/i*100).toFixed(0)}%)`}}}),e=>{const t=a[e];return this.resourceTooltip(t,i,!0)}}addThreatSeries(e,t,a){return t.colors.push(a||Gm),t.series.push({name:oe.t("results_tab.details.timeline.tooltips.threat"),type:"line",data:e.threatLogs.filter(e=>e.timestamp>=0).map(e=>({x:e.timestamp,y:e.threatAfter}))}),t=>{const i=e.threatLogs[t];return this.threatTooltip(i,!0,e,a)}}addMajorCooldownAnnotations(e,t){const a=e.majorCooldownLogs,i=e.majorCooldownAuraUptimeLogs,s=a.map((e,t)=>a.filter((a,i)=>i<t&&a.timestamp>e.timestamp-10).length),o=c(i,(e,t)=>e.actionId.equalsIgnoringTag(t.actionId));o.sort((e,t)=>pe(e.actionId.name,t.actionId.name));const n=i.map(e=>yc[o.findIndex(t=>t.actionId.equalsIgnoringTag(e.actionId))]);t.annotations={position:"back",xaxis:i.map((e,t)=>({x:e.gainedAt,x2:e.fadedAt,fillColor:n[t]})),points:a.map((e,t)=>({x:e.timestamp,y:0,image:{path:e.actionId.iconUrl,width:20,height:20,offsetY:-25*s[t]}}))}}clearRotationChart(){this.rotationLabels.replaceChildren(H("div",{className:"rotation-label-header"}));const e=U();this.rotationTimeline.replaceChildren(H("div",{className:"rotation-timeline-header"},H("canvas",{ref:e,className:"rotation-timeline-canvas"}))),this.rotationTimelineTimeRulerElem=e.value||null,this.rotationHiddenIdsContainer.replaceChildren(),this.hiddenIdsChangeEmitter=new te}updateRotationChart(e,t){const a=this.resultData.result.getTargets(this.resultData.filter);if(0==a.length)return;this.clearRotationChart();try{this.drawRotationTimeRuler(this.rotationTimeline.querySelector(".rotation-timeline-canvas"),t)}catch(l){console.log("Failed to draw rotation: ",l)}Le.forEach(a=>this.addResourceRow(a,e.groupedResourceLogs[a],t));const i=Object.values(ue(e.auraUptimeLogs,e=>e.actionId.toString()));i.sort((e,t)=>pe(e[0].actionId.name,t[0].actionId.name));const s=a.map(e=>Object.values(ue(e.auraUptimeLogs,e=>e.actionId.toString())).sort((e,t)=>pe(e[0].actionId.name,t[0].actionId.name))),o=i.concat(s[0]);Wm.forEach(e=>{const a=i.findIndex(t=>t?.[0].actionId.spellId===e);-1!==a&&this.addAuraRow(i[a],t)});const n=this.getSortedCastsByAbility(e);if(n.forEach(e=>this.addCastRow(e,o,t)),e.pets.length>0){const a=new Map;e.pets.forEach(e=>{this.getSortedCastsByAbility(e).length>0&&(a.has(e.name)||a.set(e.name,e))}),a.forEach(e=>{this.addSeparatorRow(t),this.addPetRow(e.name,t),Le.forEach(a=>this.addResourceRow(a,e.groupedResourceLogs[a],t));this.getSortedCastsByAbility(e).forEach(e=>this.addCastRow(e,o,t))})}const r=i.filter(e=>n.findIndex(t=>e[0].actionId&&(t[0].actionId.equalsIgnoringTag(e[0].actionId)||Wm.includes(e[0].actionId.anyId()))));r.length>0&&(this.addSeparatorRow(t),r.forEach(e=>this.addAuraRow(e,t))),a.forEach(e=>{const a=this.getSortedCastsByAbility(e);a.length>0&&(this.addSeparatorRow(t),this.addTargetRow(e.label,t),a.forEach(e=>this.addCastRow(e,o,t)))}),s.forEach((e,i)=>{e.length>0&&(this.addSeparatorRow(t),this.addTargetRow(a?.[i]?.label,t),e.forEach(e=>this.addAuraRow(e,t)))})}getSortedCastsByAbility(e){const t=e.getMeleeActions().map(e=>e.actionId),a=e.getSpellActions().map(e=>e.actionId),i=e=>{const i=Vm[e.anyId()];return null!=i?i:t.find(t=>t.equals(e))?Hm:a.find(t=>t.equals(e))?Um:Bm},s=Object.values(ue(e.castLogs,e=>jm.includes(e.actionId.spellId)?e.actionId.toStringIgnoringTag():e.actionId.toString()));return s.sort((e,t)=>{const a=i(e[0].actionId),s=i(t[0].actionId);return a!=s?a-s:e[0].actionId.anyId()==t[0].actionId.anyId()?e[0].actionId.tag-t[0].actionId.tag:pe(e[0].actionId.name,t[0].actionId.name)}),s}makeLabelElem(e,t,a){const i=jm.includes(e.spellId)?e.baseName:e.name,s=U(),o=U(),n=H("div",{className:xr("rotation-label rotation-row",t&&"rotation-label-hidden")},H("span",{ref:o,className:xr("fas",t?"fa-eye":"fa-eye-slash")}),H("a",{ref:s,className:"rotation-label-icon"}),H("span",{className:"rotation-label-text"},i)),r=()=>{if(t){const t=this.hiddenIds.findIndex(t=>t.equals(e));-1!=t&&this.hiddenIds.splice(t,1)}else this.hiddenIds.push(e);this.hiddenIdsChangeEmitter.emit(te.nextEventID())};o.value.addEventListener("click",r);const l=ie(o.value,{theme:"timeline-tooltip",placement:"bottom",content:t?"Show Row":"Hide Row"}),c=()=>{t==Boolean(this.hiddenIds.find(t=>t.equals(e)))?n.classList.remove("hide"):n.classList.add("hide")},h=this.hiddenIdsChangeEmitter.on(c);return c(),e.setBackgroundAndHref(s.value),e.setWowheadDataset(s.value,{useBuffAura:a}),this.addOnResetCallback(()=>{o.value?.removeEventListener("click",r),l.destroy(),h.dispose()}),n}makeRowElem(e,t){const a=H("div",{className:"rotation-timeline-row rotation-row",style:{width:this.timeToPx(t)}}),i=()=>{this.hiddenIds.find(t=>t.equals(e))?a.classList.add("hide"):a.classList.remove("hide")},s=this.hiddenIdsChangeEmitter.on(i);return i(),this.addOnResetCallback(()=>s.dispose()),a}addPetRow(e,t){const a=Lr.fromPetName(e),i=this.makeRowElem(a,t),s=document.createElement("div");this.rotationLabels.appendChild(s),a.fill().then(e=>{const t=jm.includes(e.spellId)?e.baseName:e.name,a=U(),i=H("div",{className:"rotation-label rotation-row"},H("a",{ref:a,className:"rotation-label-icon"}),H("span",{className:"rotation-label-text"},t));e.setBackgroundAndHref(a.value),s.appendChild(i)}),this.rotationTimeline.appendChild(i)}addTargetRow(e,t){const a=this.makeRowElem(Lr.fromEmpty(),t);this.rotationLabels.appendChild(H("div",null,H("div",{className:"rotation-label rotation-row"},H("span",{className:"rotation-label-text"},e)))),this.rotationTimeline.appendChild(a)}addSeparatorRow(e){const t=H("div",{className:"rotation-timeline-separator"});this.rotationLabels.appendChild(t.cloneNode()),t.style.width=this.timeToPx(e),this.rotationTimeline.appendChild(t)}addResourceRow(e,t,a){if(0==t.length)return;const i=function(e){return null==e.maxValue?t[0].valueBefore:e.maxValue};let s=Qr.get(e),o=Hr[e];e==G.ResourceTypeGenericResource&&this.secondaryResource&&(s=this.secondaryResource.name,o=this.secondaryResource.icon||"");const n=H("div",{className:"rotation-label rotation-row"},H("a",{className:"rotation-label-icon",style:{backgroundImage:`url('${o}')`}}),H("span",{className:"rotation-label-text"},s));this.rotationLabels.appendChild(n);const r=H("div",{className:"rotation-timeline-row rotation-row",style:{width:this.timeToPx(a)}});t.forEach((s,o)=>{const n=Qr.get(e).toLowerCase().replaceAll(" ","-"),l=H("div",{className:`rotation-timeline-resource series-color ${n}`,style:{left:this.timeToPx(s.timestamp),width:this.timeToPx((t[o+1]?.timestamp||a)-s.timestamp)}});if(Ym.includes(e))l.textContent=(s.valueAfter/i(s)*100).toFixed(0)+"%";else if(e==G.ResourceTypeEnergy||e==G.ResourceTypeFocus||e==G.ResourceTypeSolarEnergy||e==G.ResourceTypeLunarEnergy){const e=document.createElement("div");e.classList.add("rotation-timeline-resource-fill"),e.classList.add(n),e.style.height=(s.valueAfter/i(s)*100).toFixed(0)+"%",l.appendChild(e)}else l.textContent=Math.floor(s.valueAfter).toFixed(0);r.appendChild(l);const c=ie(l,{placement:"bottom",content:this.resourceTooltipElem(s,i(s),!1)});this.addOnResetCallback(()=>c.destroy())}),this.rotationTimeline.appendChild(r)}addCastRow(e,t,a){const i=e[0].actionId;this.rotationLabels.appendChild(this.makeLabelElem(i,!1)),this.rotationHiddenIdsContainer.appendChild(this.makeLabelElem(i,!0));const s=this.makeRowElem(i,a);e.forEach(e=>{const t=H("div",{className:"rotation-timeline-cast",style:{left:this.timeToPx(e.timestamp),minWidth:this.timeToPx(e.castTime+e.travelTime)}});if(s.appendChild(t),0!=e.travelTime){const a=H("div",{className:"rotation-timeline-travel-time",style:{left:this.timeToPx(e.castTime),minWidth:this.timeToPx(e.travelTime)}});t.appendChild(a)}if(e.damageDealtLogs.length>0){const a=e.damageDealtLogs[0];a.miss||a.dodge||a.parry?t.classList.add("outcome-miss"):a.glance||a.block||a.partialResist1_4||a.partialResist2_4||a.partialResist3_4?t.classList.add("outcome-partial"):a.crit?t.classList.add("outcome-crit"):t.classList.add("outcome-hit")}const a=i.toString(),o=zm.get(a)?.cloneNode();let n=o;n||(n=H("a",{className:"rotation-timeline-cast-icon"}),i.setBackground(n),zm.set(a,n)),t.appendChild(n);const r=0==e.travelTime?"":` + ${e.travelTime.toFixed(2)}s travel time`,l=e.totalDamage(),c=H("div",{className:"timeline-tooltip"},H("span",null,e.actionId.name," from ",e.timestamp.toFixed(2),"s to ",(e.timestamp+e.castTime).toFixed(2),"s (",e.castTime>0&&`${e.castTime.toFixed(2)}s, `," ",e.effectiveTime.toFixed(2),"s GCD Time)",r.length>0&&r),l>0&&H("span",null,"Total: ",l.toFixed(2)," (",(l/(e.effectiveTime||1)).toFixed(2)," DPET)"),e.damageDealtLogs.length>0&&H("ul",{className:"rotation-timeline-cast-damage-list"},e.damageDealtLogs.map(e=>H("li",null,H("span",null,e.timestamp.toFixed(2),"s - ",e.result()),e.source?.isTarget&&H("span",{className:"threat-metrics"}," ","(",e.threat.toFixed(1)," ",oe.t("results_tab.details.timeline.tooltips.threat"),")"))))),h=ie(t,{placement:"bottom",content:c});this.addOnResetCallback(()=>h.destroy()),e.damageDealtLogs.filter(e=>e.tick).forEach(e=>{const t=H("div",{className:"rotation-timeline-tick",style:{left:this.timeToPx(e.timestamp)}});s.appendChild(t);const a=H("div",{className:"timeline-tooltip"},H("span",null,e.timestamp.toFixed(2),"s - ",e.actionId.name," ",e.result()),e.source?.isTarget&&H("span",{className:"threat-metrics"}," ","(",e.threat.toFixed(1)," ",oe.t("results_tab.details.timeline.tooltips.threat"),")")),i=ie(t,{placement:"bottom",content:a});this.addOnResetCallback(()=>i.destroy())})}),t.filter(e=>jm.includes(i.spellId)?i.equalsIgnoringTag(Ur[e[0].actionId.spellId]??e[0].actionId):i.equals(Ur[e[0].actionId.spellId]??e[0].actionId)).forEach(e=>this.applyAuraUptimeLogsToRow(e,s,!0)),this.rotationTimeline.appendChild(s)}addAuraRow(e,t){const a=e[0].actionId,i=this.makeRowElem(a,t);this.rotationLabels.appendChild(this.makeLabelElem(a,!1,!0)),this.rotationHiddenIdsContainer.appendChild(this.makeLabelElem(a,!0,!0)),this.rotationTimeline.appendChild(i),this.applyAuraUptimeLogsToRow(e,i,!1)}applyAuraUptimeLogsToRow(e,t,a){e.forEach(e=>{const i=H("div",{className:"rotation-timeline-aura",style:{left:this.timeToPx(e.gainedAt),minWidth:this.timeToPx(e.fadedAt===e.gainedAt?.001:e.fadedAt-e.gainedAt)}});t.appendChild(i);const s=H("div",{className:"timeline-tooltip"},H("span",null,e.actionId.name,": ",e.gainedAt.toFixed(2),"s - ",e.fadedAt.toFixed(2),"s")),o=ie(i,{placement:"bottom",content:s});this.addOnResetCallback(()=>o.destroy()),e.stacksChange.forEach((t,s)=>{if(t.timestamp==e.fadedAt)return;const o=H("div",{className:"rotation-timeline-stacks-change",style:{left:this.timeToPx(t.timestamp-e.timestamp),width:this.timeToPx(e.stacksChange[s+1]?e.stacksChange[s+1].timestamp-t.timestamp:e.fadedAt-t.timestamp),textIndent:a?"30px":void 0}},String(t.newStacks));i.appendChild(o)})})}timeToPxValue(e){return 100*e}timeToPx(e){return this.timeToPxValue(e)+"px"}drawRotationTimeRuler(e,t){const a=30;e.width=this.timeToPxValue(t),e.height=a;const i=e.getContext("2d");i.strokeStyle="white",i.font="bold 14px SimDefaultFont",i.fillStyle="white",i.lineWidth=2,i.beginPath(),i.moveTo(0,a),i.lineTo(e.width,a);const s=1+Math.floor(10*t);for(let o=0;o<=s;o++){const e=.1*o;let s=this.timeToPxValue(e);0==o?(i.textAlign="left",s++):o%10==0&&e+1>t?(i.textAlign="right",s--):i.textAlign="center";let n=0;o%10==0?(n=15,i.fillText(e+"s",s,12)):n=o%5==0?7.5:3.75,i.moveTo(s,a),i.lineTo(s,a-n)}i.stroke()}dpsTooltip(e,t,a,i){return H("div",{className:"timeline-tooltip dps"},H("div",{className:"timeline-tooltip-header"},""!=i?H(de,null,H("img",{className:"timeline-tooltip-icon",src:"${player.iconUrl}"}),H("span",{className:"",style:"color: ${colorOverride}"},a.label),H("span",null," - ")):null,H("span",{className:"bold"},e.timestamp.toFixed(2),"s")),H("div",{className:"timeline-tooltip-body"},H("ul",{className:"timeline-dps-events"},e.damageLogs.map(e=>this.tooltipLogItem(e,e.result()))),H("div",{className:"timeline-tooltip-body-row"},H("span",{className:"series-color"},oe.t("results_tab.details.timeline.tooltips.dps"),": ",e.dps.toFixed(2)))),this.tooltipAurasSection(e))}threatTooltip(e,t,a,i){return H("div",{className:"timeline-tooltip threat"},H("div",{className:"timeline-tooltip-header"},""!=i?H(de,null,H("img",{className:"timeline-tooltip-icon",src:a.iconUrl}),H("span",{className:"",style:{color:i}},a.label),H("span",null," - ")):null,H("span",{className:"bold"},e.timestamp.toFixed(2),"s")),H("div",{className:"timeline-tooltip-body"},H("div",{className:"timeline-tooltip-body-row"},H("span",{className:"series-color"},oe.t("results_tab.details.timeline.tooltips.before"),": ",e.threatBefore.toFixed(1))),H("ul",{className:"timeline-threat-events"},e.logs.map(e=>this.tooltipLogItem(e,H(de,null,e.threat.toFixed(1)," ",oe.t("results_tab.details.timeline.tooltips.threat"))))),H("div",{className:"timeline-tooltip-body-row"},H("span",{className:"series-color"},oe.t("results_tab.details.timeline.tooltips.after"),": ",e.threatAfter.toFixed(1)))),t?this.tooltipAurasSection(e):null)}resourceTooltipElem(e,t,a){const i=Ym.includes(e.resourceType)?e=>`${e.toFixed(1)} (${(e/t*100).toFixed(0)}%)`:e=>`${e.toFixed(1)}`;return H("div",{className:`timeline-tooltip ${Qr.get(e.resourceType).toLowerCase().replaceAll(" ","-")}`},H("div",{className:"timeline-tooltip-header"},H("span",{className:"bold"},e.timestamp.toFixed(2),"s")),H("div",{className:"timeline-tooltip-body"},H("div",{className:"timeline-tooltip-body-row"},H("span",{className:"series-color"},oe.t("results_tab.details.timeline.tooltips.before"),": ",i(e.valueBefore))),H("ul",{className:"timeline-mana-events"},e.logs.map(e=>this.tooltipLogItemElem(e,H(de,null,e.resultString())))),H("div",{className:"timeline-tooltip-body-row"},H("span",{className:"series-color"},oe.t("results_tab.details.timeline.tooltips.after"),": ",i(e.valueAfter)))),a&&this.tooltipAurasSectionElem(e))}resourceTooltip(e,t,a){return this.resourceTooltipElem(e,t,a)}tooltipLogItem(e,t){return this.tooltipLogItemElem(e,t)}tooltipLogItemElem(e,t){return H("li",null,e.actionId&&e.actionId.iconUrl&&H("img",{className:"timeline-tooltip-icon",src:e.actionId.iconUrl}),e.actionId&&H("span",null,e.actionId.name),H("span",{className:"series-color"},t))}tooltipAurasSection(e){return 0==e.activeAuras.length?"":this.tooltipAurasSectionElem(e)}tooltipAurasSectionElem(e){return 0==e.activeAuras.length?H(de,null):H("div",{className:"timeline-tooltip-auras"},H("div",{className:"timeline-tooltip-body-row"},H("span",{className:"bold"},oe.t("results_tab.details.timeline.tooltips.active_auras"))),H("ul",{className:"timeline-active-auras"},e.activeAuras.map(e=>H("li",null,e.actionId.iconUrl&&H("img",{className:"timeline-tooltip-icon",src:e.actionId.iconUrl}),H("span",null,e.actionId.name)))))}update(){this.reset(),this.rendered||this.dpsResourcesPlot.render(),this.updatePlot(),this.rendered=!0}render(){this.rendered||this.update()}reset(){const e=this.prevResultData?.result.request.requestId;e&&!this.cacheHandler.get(e)||super.reset()}}const Hm=1,Um=2,Bm=3,Wm=[84840,84839,93098,93099,120267,124255,128938,115308,1247279,1247275,148022],Vm={[O.OtherActionMove]:0,[O.OtherActionAttack]:.01,[O.OtherActionShoot]:.5,48480:.1,48564:Hm+.1,48568:Hm+.2,48562:Hm+.3,48566:Hm+.1,48572:Hm+.2,49800:Hm+.51,52610:Hm+.52,48577:Hm+.53,48465:Um+.1,48461:Um+.2,53201:Um+.3,48463:Um+.4,48996:.1,53217:.6,53209:Hm+.1,53353:Hm+.11,53301:Hm+.1,1215485:Hm+.12,49050:Hm+.2,49048:Hm+.21,3044:Hm+.22,56641:Hm+.27,53351:Hm+.28,34490:Hm+.29,49001:Hm+.3,53238:Hm+.31,3674:Hm+.32,49067:Hm+.33,77767:Hm+.34,76672:Hm+.01,35395:Hm+.02,53595:Hm+.04,88263:Hm+.05,53385:Hm+.06,85256:Hm+.07,20271:Hm+.08,42463:Hm+.09,31803:Hm+.1,101423:Hm+.11,53600:Hm+.12,879:Hm+.15,26573:Hm+.16,119072:Hm+.17,24275:Hm+.18,114852:Hm+.19,114919:Hm+.19,114916:Hm+.19,114871:Hm+.2,119952:Hm+.2,146586:Hm+.2,84963:Um+.01,54428:Um+.02,498:Um+.03,66233:Um+.05,31884:Um+.06,114232:Um+.07,105809:Um+.08,86698:Um+.09,86704:Um+.1,20925:Um+.11,148039:Um+.11,65148:Um+.12,114039:Um+.13,48300:Um+.11,48125:Um+.12,48160:Um+.13,48135:Um+.14,48123:Um+.19,48127:Um+.2,48158:Um+.3,48156:Um+.4,6774:Hm+.1,8647:Hm+.2,48672:Hm+.3,57993:Hm+.3,48668:Hm+.4,48666:Hm+.5,48665:Hm+.6,48664:Hm+.7,48638:Hm+.5,51723:Hm+.8,57973:Um+.1,57968:Um+.2,8232:.11,8024:.12,8033:.12,17364:Hm+.1,60103:Hm+.2,49233:Um+.21,49231:Um+.22,49236:Um+.23,60043:Um+.31,49238:Um+.32,49271:Um+.33,61657:Um+.41,58734:Um+.42,58704:Um+.43,49281:Um+.51,49279:Um+.52,2825:Bm+.1,603:Um+.01,980:Um+.02,172:Um+.1,48181:Um+.2,30108:Um+.3,348:Um+.31,17962:Um+.32,50796:Um+.49,686:Um+.5,29722:Um+.51,6353:Um+.52,1120:Um+.6,1454:Um+.7,59672:Um+.8,104025:Um+.81,129476:Um+.81,47193:Um+.82,42842:Um+.01,47610:Um+.02,42897:Um+.02,42833:Um+.02,10:Um+.021,42208:Um+.022,42859:Um+.03,42891:Um+.1,42846:Um+.1,44572:Um+.1,44781:Um+.2,42914:Um+.2,55360:Um+.2,55362:Um+.21,12654:Um+.3,12472:Um+.4,11129:Um+.4,12042:Um+.4,11958:Um+.41,12043:Um+.41,31687:Um+.41,55342:Um+.5,33312:Um+.51,12051:Um+.52,44401:Um+.6,44448:Um+.6,44545:Um+.6,44549:Um+.61,12536:Um+.61,47520:.1,47450:.1,47475:Hm+.05,23881:Hm+.1,47486:Hm+.1,30356:Hm+.1,47498:Hm+.21,47467:Hm+.22,57823:Hm+.23,1680:Hm+.24,7384:Hm+.25,47471:Hm+.42,12867:Um+.51,58874:Um+.52,47296:Um+.53,46924:Hm+.61,46968:Hm+.61,118e3:Hm+.61,2565:Um+.62,112048:Um+.63,76857:Um+.64,1249459:Um+.65,71:Bm+.1,2457:Bm+.1,6673:Bm+.1,469:Bm+.1,49998:Hm+.01,45470:Hm+.02,77535:Hm+.03,49184:Hm+.04,49020:Hm+.05,49143:Hm+.1,45902:Hm+.15,50842:Hm+.2,47541:Hm+.25,43265:Hm+.25,63560:Hm+.25,50536:Hm+.25,57623:Hm+.25,45477:Hm+.3,45462:Hm+.3,114866:Hm+.31,130735:Hm+.31,130736:Hm+.31,114867:Hm+.32,51271:Hm+.35,45529:Hm+.35,47568:Hm+.35,49206:Hm+.35,46584:Hm+.35,55095:Hm+.4,55078:Hm+.4,50401:Hm+.5,50689:Bm+.1,48263:Bm+.1,48265:Bm+.1,120274:.02,120278:.03,100780:Hm+.01,100787:Hm+.02,100784:Hm+.03,130320:Hm+.04,113656:Hm+.05,117418:Hm+.06,101546:Hm+.07,107270:Hm+.08,116847:Hm+.07,148187:Hm+.08,115098:Um+.01,132467:Um+.011,132463:Um+.012,124098:Um+.01,124081:Um+.011,125033:Um+.011,124101:Um+.011,123986:Um+.01,148135:Um+.011,130654:Um+.012,1247275:Um+.02,115399:Um+.03,115288:Um+.04,123402:Um+.04,115295:Um+.04,126456:Um+.05,123904:Um+.06,115008:Um+.06,53307:Um+.931,54043:Um+.932,54758:Um+.933,42641:Um+.941,40536:Um+.942,41119:Um+.943,40771:Um+.944,120687:Bm+.945,114206:Bm+.946},jm=[5171,2098,1943,51690,32645,16511,121471],Ym=[G.ResourceTypeHealth,G.ResourceTypeMana];var qm=(e=>(e[e.RaidSim=1]="RaidSim",e[e.StatWeights=2]="StatWeights",e[e.All=15]="All",e))(qm||{});class Xm{constructor(){this.callbacks=[],this.triggered=!1}async trigger(){if(!this.triggered)return this.triggered=!0,await Promise.all(this.callbacks.map(e=>e()))}isTriggered(){return this.triggered}onTrigger(e){this.callbacks.push(e),this.triggered&&e()}}class $m{constructor(){this.running=new Map}registerRunning(e){const t={abort:new Xm};return this.running.set(t,{type:e,signals:t}),t}unregisterRunning(e){this.running.delete(e)}async abortType(e){for(const t of this.running.values())t.type&e&&await t.signals.abort.trigger()}}const Zm=(e,t)=>{const a=t.startsWith("/")?t.slice(1):t;gtag("event","page_view",{page_title:e,page_location:`${window.location.href}${a}`})},Km=({action:e,category:t,label:a,value:i,additionalData:s})=>{gtag("event",e,{event_category:t,event_label:a,event_value:void 0!==i?String(i):void 0,...s})};function Jm(e){const t=e.resultsViewer;let a=!1,i=!1;e.addAction(oe.t("sidebar.buttons.simulate"),"dps-action",async o=>{Km({action:"sim",category:"simulate",label:"simulate",value:e.sim.getIterations()});const n=o.target;n.disabled=!0,a||(a=!0,t.addAbortButton(async()=>{if(!i)try{i=!0,await e.sim.signalManager.abortType(qm.RaidSim)}catch(t){console.error("Error on sim abort!"),console.error(t)}finally{i=!1,a||(n.disabled=!1)}}),await e.runSim(e=>{s.setSimProgress(e)}),t.removeAbortButton(),i||(n.disabled=!1),a=!1)});const s=new eg(e);return e.sim.simResultEmitter.on((e,t)=>{s.setSimResult(e,t)}),s}const Qm=class e{constructor(e){this.currentChangeEmitter=new te,this.referenceChangeEmitter=new te,this.changeEmitter=new te,this.currentData=null,this.referenceData=null,this.resetCallbacks=[],this.simUI=e,[this.currentChangeEmitter,this.referenceChangeEmitter].forEach(e=>e.on(e=>this.changeEmitter.emit(e)))}setSimProgress(e){e.finalRaidResult&&e.finalRaidResult.error?this.simUI.resultsViewer.hideAll():this.simUI.resultsViewer.setContent(H("div",{className:"results-sim"},H("div",{className:"results-sim-dps damage-metrics"},H("span",{className:"topline-result-avg"},e.dps.toFixed(2))),this.simUI.isIndividualSim()&&H("div",{className:"results-sim-hps healing-metrics"},H("span",{className:"topline-result-avg"},e.hps.toFixed(2))),H("div",null,e.presimRunning?oe.t("sidebar.results.progress.presim_running"):`${e.completedIterations} / ${e.totalIterations}`,H("br",null),oe.t("sidebar.results.progress.iterations_complete"))))}setSimResult(t,a){this.currentData={simResult:a,settings:{raid:He.toJson(this.simUI.sim.raid.toProto()),encounter:Fe.toJson(this.simUI.sim.encounter.toProto())},raidProto:He.clone(a.request.raid||He.create()),encounterProto:Fe.clone(a.request.encounter||Fe.create())},this.currentChangeEmitter.emit(t),this.simUI.resultsViewer.setContent(H("div",{className:"results-sim"},e.makeToplineResultsContent(a,void 0,{asList:!0}),H("div",{className:"results-sim-reference"},H("button",{className:"results-sim-set-reference"},H("i",{className:`fa fa-map-pin fa-lg text-${this.simUI.config.cssScheme} me-2`}),oe.t("sidebar.results.reference.save_as_reference")),H("div",{className:"results-sim-reference-bar"},H("button",{className:"results-sim-reference-swap me-3"},H("i",{className:"fas fa-arrows-rotate me-1"}),oe.t("sidebar.results.reference.swap")),H("button",{className:"results-sim-reference-delete"},H("i",{className:"fa fa-times fa-lg me-1"}),oe.t("sidebar.results.reference.cancel"))))));const i=(e,t)=>{const a=this.simUI.resultsViewer.contentElem.querySelector(e);if(a){const e=ie(a,{content:t,placement:"right"});this.addOnResetCallback(()=>e.destroy())}};i(`.${e.resultMetricClasses.dps}`,oe.t("sidebar.results.metrics.dps.tooltip")),i(`.${e.resultMetricClasses.tto}`,oe.t("sidebar.results.metrics.tto.tooltip")),i(`.${e.resultMetricClasses.hps}`,oe.t("sidebar.results.metrics.hps.tooltip")),i(`.${e.resultMetricClasses.tps}`,oe.t("sidebar.results.metrics.tps.tooltip")),i(`.${e.resultMetricClasses.dtps}`,oe.t("sidebar.results.metrics.dtps.tooltip")),i(`.${e.resultMetricClasses.dur}`,oe.t("sidebar.results.metrics.dur.tooltip")),i(`.${e.resultMetricClasses.tmi}`,H(de,null,H("p",null,oe.t("sidebar.results.metrics.tmi.tooltip.title")),H("p",null,oe.t("sidebar.results.metrics.tmi.tooltip.description")),H("p",null,H("b",null,oe.t("sidebar.results.metrics.tmi.tooltip.note"))))),i(`.${e.resultMetricClasses.cod}`,H(de,null,H("p",null,oe.t("sidebar.results.metrics.cod.tooltip.title")),H("p",null,oe.t("sidebar.results.metrics.cod.tooltip.description")),H("p",null,oe.t("sidebar.results.metrics.cod.tooltip.note")))),this.simUI.isIndividualSim()||([...this.simUI.resultsViewer.contentElem.querySelectorAll(`.${e.resultMetricClasses.tto}`)].forEach(e=>e.remove()),[...this.simUI.resultsViewer.contentElem.querySelectorAll(`.${e.resultMetricClasses.hps}`)].forEach(e=>e.remove()),[...this.simUI.resultsViewer.contentElem.querySelectorAll(`.${e.resultMetricClasses.tps}`)].forEach(e=>e.remove()),[...this.simUI.resultsViewer.contentElem.querySelectorAll(`.${e.resultMetricClasses.dtps}`)].forEach(e=>e.remove()),[...this.simUI.resultsViewer.contentElem.querySelectorAll(`.${e.resultMetricClasses.tmi}`)].forEach(e=>e.remove()),[...this.simUI.resultsViewer.contentElem.querySelectorAll(`.${e.resultMetricClasses.cod}`)].forEach(e=>e.remove()));const s=this.simUI.resultsViewer.contentElem.querySelector(".results-sim-set-reference");if(s){const e=()=>{this.referenceData=this.currentData,this.referenceChangeEmitter.emit(te.nextEventID()),this.updateReference()};s.addEventListener("click",e);const t=ie(s,{content:oe.t("sidebar.results.reference.use_as_reference")});this.addOnResetCallback(()=>{t.destroy(),s?.removeEventListener("click",e)})}const o=this.simUI.resultsViewer.contentElem.querySelector(".results-sim-reference-swap");if(o){const e=()=>{te.freezeAllAndDo(()=>{if(this.currentData&&this.referenceData){const e=te.nextEventID(),t=this.currentData;this.currentData=this.referenceData,this.referenceData=t,this.simUI.sim.raid.fromProto(e,this.currentData.raidProto),this.simUI.sim.encounter.fromProto(e,this.currentData.encounterProto),this.setSimResult(e,this.currentData.simResult),this.referenceChangeEmitter.emit(e),this.updateReference()}})};o.addEventListener("click",e);const t=ie(o,{content:oe.t("sidebar.results.reference.swap_reference_with_current"),ignoreAttributes:!0});this.addOnResetCallback(()=>{t.destroy(),o?.removeEventListener("click",e)})}const n=this.simUI.resultsViewer.contentElem.querySelector(".results-sim-reference-delete");if(n){const e=()=>{this.referenceData=null,this.referenceChangeEmitter.emit(te.nextEventID()),this.updateReference()};n.addEventListener("click",e);const t=ie(n,{content:oe.t("sidebar.results.reference.remove_reference"),ignoreAttributes:!0});this.addOnResetCallback(()=>{t.destroy(),n?.removeEventListener("click",e)})}this.updateReference()}updateReference(){if(!this.referenceData||!this.currentData)return this.simUI.resultsViewer.contentElem.querySelector(".results-sim-reference")?.classList.remove("has-reference"),void this.simUI.resultsViewer.contentElem.querySelectorAll(".results-reference").forEach(e=>e.classList.add("hide"));this.simUI.resultsViewer.contentElem.querySelector(".results-sim-reference")?.classList.add("has-reference"),this.simUI.resultsViewer.contentElem.querySelectorAll(".results-reference").forEach(e=>e.classList.remove("hide")),this.formatToplineResult(`.${e.resultMetricClasses.dps} .results-reference-diff`,e=>e.raidMetrics.dps,2),this.simUI.isIndividualSim()?(this.formatToplineResult(`.${e.resultMetricClasses.hps} .results-reference-diff`,e=>e.raidMetrics.hps,2),this.formatToplineResult(`.${e.resultMetricClasses.tto} .results-reference-diff`,e=>e.getFirstPlayer().tto,2),this.formatToplineResult(`.${e.resultMetricClasses.tps} .results-reference-diff`,e=>e.getFirstPlayer().tps,2),this.formatToplineResult(`.${e.resultMetricClasses.dtps} .results-reference-diff`,e=>e.getFirstPlayer().dtps,2,!0),this.formatToplineResult(`.${e.resultMetricClasses.tmi} .results-reference-diff`,e=>e.getFirstPlayer().tmi,2,!0),this.formatToplineResult(`.${e.resultMetricClasses.cod} .results-reference-diff`,e=>e.getFirstPlayer().chanceOfDeath,2,!0,!0)):this.formatToplineResult(`.${e.resultMetricClasses.dtps} .results-reference-diff`,e=>d(e.getPlayers().map(e=>e.dtps.avg))/e.getPlayers().length,2,!0)}formatToplineResult(t,a,i,s,o){const n=this.simUI.resultsViewer.contentElem.querySelector(t);if(!n)return;const r=this.currentData.simResult,l=this.referenceData.simResult,c=a(r),h=a(l);if("number"==typeof c){Ue(n,h,c,i,s,void 0,!0)}else{const t=c,a=h,d=e.applyZTestTooltip(n,l.iterations,a.avg,a.stdev,r.iterations,t.avg,t.stdev,!!o);Ue(n,a.avg,t.avg,i,s,!d,!0)}}static applyZTestTooltip(e,t,a,i,s,o,n,r){const l=a-o,c=r?i:i/Math.sqrt(t),h=r?n:n/Math.sqrt(s),d=Math.sqrt(Math.pow(c,2)+Math.pow(h,2)),u=Math.abs(l/d),p=u>1.96;let m="";return m=p?`Difference is significantly different (Z = ${u.toFixed(3)}).`:`Difference is not significantly different (Z = ${u.toFixed(3)}).`,ie(e,{content:m,ignoreAttributes:!0}),p}getRunData(){return this.currentData?Be.create({run:this.currentData.simResult.toProto(),referenceRun:this.referenceData?.simResult.toProto()}):null}getCurrentData(){return this.currentData?{simResult:this.currentData.simResult,settings:structuredClone(this.currentData.settings),raidProto:this.currentData.raidProto,encounterProto:this.currentData.encounterProto}:null}getReferenceData(){return this.referenceData?{simResult:this.referenceData.simResult,settings:structuredClone(this.referenceData.settings),raidProto:this.referenceData.raidProto,encounterProto:this.referenceData.encounterProto}:null}static makeToplineResultsContent(e,t,a={}){const{showOutOfMana:i=!1}=a,s=e.getRaidIndexedPlayers(t),o=[];if(1===s.length){const a=s[0],i=[K.SpecBloodDeathKnight,K.SpecGuardianDruid,K.SpecBrewmasterMonk,K.SpecProtectionPaladin].includes(s[0].spec?.specID);if(null===a.getTargetIndex(t)){const{chanceOfDeath:e,dps:t,tps:s,dtps:n,tmi:r}=a;if(o.push({name:oe.t("sidebar.results.metrics.dps.label"),average:t.avg,stdev:t.stdev,classes:this.getResultsLineClasses("dps")}),o.push({name:oe.t("sidebar.results.metrics.tps.label"),average:s.avg,stdev:s.stdev,classes:this.getResultsLineClasses("tps")}),o.push({name:oe.t("sidebar.results.metrics.dtps.label"),average:n.avg,stdev:n.stdev,classes:this.getResultsLineClasses("dtps")}),i){const{hps:e}=a;o.push({name:oe.t("sidebar.results.metrics.hps.label"),average:e.avg,stdev:e.stdev,classes:this.getResultsLineClasses("hps")})}o.push({name:oe.t("sidebar.results.metrics.tmi.label"),average:r.avg,stdev:r.stdev,classes:this.getResultsLineClasses("tmi"),unit:"percentage"}),o.push({name:oe.t("sidebar.results.metrics.cod.label"),average:e.avg,stdev:e.stdev,classes:this.getResultsLineClasses("cod"),unit:"percentage"})}else{const s=e.getRaidIndexedActionMetrics(t);if(s.length){const{dps:e,tps:t}=Fl.merge(s);o.push({name:oe.t("sidebar.results.metrics.dps.label"),average:e,classes:this.getResultsLineClasses("dps")}),o.push({name:oe.t("sidebar.results.metrics.tps.label"),average:t,classes:this.getResultsLineClasses("tps")})}const n=e.getTargets(t).map(e=>e.actions).flat().map(e=>e.forTarget({player:a.unitIndex}));if(n.length){const{dps:e}=Fl.merge(n);o.push({name:oe.t("sidebar.results.metrics.dtps.label"),average:e,classes:this.getResultsLineClasses("dtps")})}i&&o.push({name:oe.t("sidebar.results.metrics.hps.label"),average:a.hps.avg,stdev:a.hps.stdev,classes:this.getResultsLineClasses("hps")})}i||(o.push({name:oe.t("sidebar.results.metrics.tto.label"),average:a.tto.avg,stdev:a.tto.stdev,classes:this.getResultsLineClasses("tto"),unit:"seconds"}),o.push({name:oe.t("sidebar.results.metrics.hps.label"),average:a.hps.avg,stdev:a.hps.stdev,classes:this.getResultsLineClasses("hps")}))}else{const a=e.raidMetrics.dps;o.push({name:oe.t("sidebar.results.metrics.dps.label"),average:a.avg,stdev:a.stdev,classes:this.getResultsLineClasses("dps")});const i=e.getTargets(t).map(e=>e.actions).flat().map(e=>e.forTarget(t));if(i.length){const e=Fl.merge(i);o.push({name:oe.t("sidebar.results.metrics.dtps.label"),average:e.dps,classes:this.getResultsLineClasses("dtps")})}const s=e.raidMetrics.hps;o.push({name:oe.t("sidebar.results.metrics.hps.label"),average:s.avg,stdev:s.stdev,classes:this.getResultsLineClasses("hps")})}if(e.request.encounter?.useHealth&&o.push({name:oe.t("sidebar.results.metrics.dur.label"),average:e.result.avgIterationDuration,classes:this.getResultsLineClasses("dur"),unit:"seconds"}),i){const t=s[0].secondsOomAvg,a=t/e.encounterMetrics.durationSeconds,i=a<.01?"safe":a<.05?"warning":"danger";o.push({name:oe.t("sidebar.results.metrics.oom.label"),average:t,classes:[this.getResultsLineClasses("oom"),i].join(" "),unit:"seconds"})}return a.asList?this.buildResultsList(o):this.buildResultsTable(o)}static getResultsLineClasses(e){const t=[this.resultMetricClasses[e]];return this.resultMetricCategories[e]&&t.push(this.metricsClasses[this.resultMetricCategories[e]]),t.join(" ")}static buildResultsTable(e){return H(de,null,H("table",{className:"metrics-table"},H("thead",{className:"metrics-table-header"},H("tr",{className:"metrics-table-header-row"},e.map(({name:e,classes:t})=>{const a=We(e)||e,i=H("th",{className:xr("metrics-table-header-cell",t)},a);return ie(i,{content:Ve(e)||e,ignoreAttributes:!0}),i}))),H("tbody",{className:"metrics-table-body"},H("tr",null,e.map(({average:e,stdev:t,classes:a,unit:i})=>{let s="",o=0;switch(i){case"percentage":s=Ce(e),o=2;break;case"seconds":s=se(e,{style:"unit",unit:"second",unitDisplay:"narrow"});break;default:s=se(e)}return H("td",{className:xr("text-center align-top",a)},H("div",{className:"topline-result-avg"},s),t?H("div",{className:"topline-result-stdev"},H("i",{className:"fas fa-plus-minus fa-xs"})," ",se(t,{maximumFractionDigits:o})):void 0,H("div",{className:"results-reference hide"},H("span",{className:"results-reference-diff"})," ",oe.t("sidebar.results.reference.vs_ref")))})))))}static buildResultsList(e){return H(de,null,e.map(e=>{const t="percentage"===e.unit?2:0,a=We(e.name)||e.name,i="tmi"===e.name||"cod"===e.name?"% ":" ";return H("div",{className:`results-metric ${e.classes}`},H("span",{className:"topline-result-avg"},e.average.toFixed(2),H("span",{className:"metric-label"},i,a)),e.stdev&&H("span",{className:"topline-result-stdev"},"(",H("i",{className:"fas fa-plus-minus fa-xs"}),e.stdev.toFixed(t),")"),H("div",{className:"results-reference hide"},H("span",{className:"results-reference-diff"})," ",oe.t("sidebar.results.reference.vs_ref")))}))}addOnResetCallback(e){this.resetCallbacks.push(e)}reset(){this.resetCallbacks.forEach(e=>e()),this.resetCallbacks=[]}};Qm.resultMetricCategories={dps:"damage",tps:"threat",dtps:"threat",tmi:"threat",cod:"threat",tto:"healing",hps:"healing"},Qm.resultMetricClasses={cod:"results-sim-cod",dps:"results-sim-dps",dtps:"results-sim-dtps",tmi:"results-sim-tmi",dur:"results-sim-dur",hps:"results-sim-hps",tps:"results-sim-tps",tto:"results-sim-tto",oom:"results-sim-oom"},Qm.metricsClasses={damage:"damage-metrics",demo:"demo-metrics",healing:"healing-metrics",threat:"threat-metrics"};let eg=Qm;class tg extends Ul{constructor(e){e.rootCssClass="topline-results-root",super(e),this.rootElem.classList.add("results-sim")}onSimResult(e){const t=[je,Ye,qe,Xe],a=e.result.getRaidIndexedPlayers(e.filter),i=eg.makeToplineResultsContent(e.result,e.filter,{showOutOfMana:1===a.length&&!!a[0].spec&&!t.some(e=>_e.getPlayerClass(a[0].spec)===e)});this.rootElem.replaceChildren(i)}}class ag extends F{constructor(e,t){super(null,"sticky-toolbar-root",e),new IntersectionObserver(([e])=>{e.target.classList.toggle("stuck",e.target.clientHeight>0&&e.intersectionRatio<1)},{rootMargin:t?`-${t.simHeader.rootElem.offsetHeight+1}px 0px 0px 0px`:"0px",threshold:[1]}).observe(this.rootElem)}}const ig=[{isActive:!0,targetId:"damageTab",label:oe.t("results_tab.details.tabs.damage"),classes:["damage-metrics-tab"]},{targetId:"healingTab",label:oe.t("results_tab.details.tabs.healing"),classes:["healing-metrics-tab"]},{targetId:"damageTakenTab",label:oe.t("results_tab.details.tabs.damage_taken"),classes:["threat-metrics-tab"]},{targetId:"buffsTab",label:oe.t("results_tab.details.tabs.buffs")},{targetId:"debuffsTab",label:oe.t("results_tab.details.tabs.debuffs")},{targetId:"castsTab",label:oe.t("results_tab.details.tabs.casts")},{targetId:"resourcesTab",label:oe.t("results_tab.details.tabs.resources")},{targetId:"timelineTab",label:oe.t("results_tab.details.tabs.timeline")},{targetId:"logTab",label:oe.t("results_tab.details.tabs.log")}];class sg extends F{constructor(e,t,a){super(e,"detailed-results-manager-root"),this.latestRun=null,this.latestDeathSeeds=[],this.recentlyEditedSeed=!1,this.currentSimResult=null,this.resultsEmitter=new te,this.simUI=t,this.rootDiv=H("div",{className:"dr-root dr-no-results"},H("div",{className:"dr-toolbar"},H("div",{className:"results-filter"}),H("div",{className:"tabs-filler"}),H("ul",{className:"nav nav-tabs",attributes:{role:"tablist"}},ig.map(({label:e,targetId:t,isActive:a,classes:i})=>H("li",{className:`nav-item dr-tab-tab ${i?.join(" ")||""}`,attributes:{role:"presentation"}},H("button",{className:"nav-link"+(a?" active":""),type:"button",attributes:{role:"tab","aria-controls":t,"aria-selected":!!a},dataset:{bsToggle:"tab",bsTarget:`#${t}`}},e))))),H("div",{className:"tab-content"},H("div",{id:"noResultsTab",className:"tab-pane dr-tab-content fade active show"},oe.t("results_tab.details.no_results")),H("div",{id:"damageTab",className:"tab-pane dr-tab-content damage-content fade active show"},H("div",{className:"dr-row topline-results"}),H("div",{className:"dr-row all-players-only"},H("div",{className:"player-damage-metrics"})),H("div",{className:"dr-row single-player-only"},H("div",{className:"damage-metrics"})),H("div",{className:"dr-row dps-histogram"})),H("div",{id:"healingTab",className:"tab-pane dr-tab-content healing-content fade"},H("div",{className:"dr-row topline-results"}),H("div",{className:"dr-row single-player-only"},H("div",{className:"healing-spell-metrics"})),H("div",{className:"dr-row hps-histogram"})),H("div",{id:"damageTakenTab",className:"tab-pane dr-tab-content damage-taken-content fade"},H("div",{className:"dr-row topline-results"}),H("div",{className:"dr-row all-players-only"},H("div",{className:"player-damage-taken-metrics"})),H("div",{className:"dr-row single-player-only"},H("div",{className:"dtps-metrics"})),H("div",{className:"dr-row damage-taken-histogram single-player-only"})),H("div",{id:"buffsTab",className:"tab-pane dr-tab-content buffs-content fade"},H("div",{className:"dr-row"},H("div",{className:"buff-aura-metrics"}))),H("div",{id:"debuffsTab",className:"tab-pane dr-tab-content debuffs-content fade"},H("div",{className:"dr-row"},H("div",{className:"debuff-aura-metrics"}))),H("div",{id:"castsTab",className:"tab-pane dr-tab-content casts-content fade"},H("div",{className:"dr-row"},H("div",{className:"cast-metrics"}))),H("div",{id:"resourcesTab",className:"tab-pane dr-tab-content resources-content fade"},H("div",{className:"dr-row"},H("div",{className:"resource-metrics"}))),H("div",{id:"timelineTab",className:"tab-pane dr-tab-content timeline-content fade"},H("div",{className:"dr-row"},H("div",{className:"timeline"}))),H("div",{id:"logTab",className:"tab-pane dr-tab-content log-content fade"},H("div",{className:"dr-row"},H("div",{className:"log"})))));const i=U(),s=U();this.rootElem.appendChild(H(de,null,H("div",{className:"detailed-results-controls-div"},H("button",{className:"detailed-results-1-iteration-button btn btn-primary",ref:i,disabled:t.disabled},oe.t("results_tab.details.sim_1_iteration")),H("button",{className:"detailed-results-death-iteration-button btn btn-primary",ref:s,disabled:!0},oe.t("results_tab.details.sim_1_death"))),this.rootDiv)),this.simUI.sim.settingsChangeEmitter.on(()=>this.updateSettings());const o=document.querySelector(".dr-toolbar");new ag(o,this.simUI),this.resultsFilter=new Tc({parent:this.rootElem.querySelector(".results-filter"),resultsEmitter:this.resultsEmitter}),[...this.rootElem.querySelectorAll(".topline-results")]?.forEach(e=>{new tg({parent:e,resultsEmitter:this.resultsEmitter})}),new ql({parent:this.rootElem.querySelector(".cast-metrics"),resultsEmitter:this.resultsEmitter}),new Zl({parent:this.rootElem.querySelector(".damage-metrics"),resultsEmitter:this.resultsEmitter}),new Ql({parent:this.rootElem.querySelector(".healing-spell-metrics"),resultsEmitter:this.resultsEmitter}),new Sc({parent:this.rootElem.querySelector(".resource-metrics"),resultsEmitter:this.resultsEmitter,secondaryResource:t?.player?.secondaryResource}),new vc({parent:this.rootElem.querySelector(".player-damage-metrics"),resultsEmitter:this.resultsEmitter},this.resultsFilter),new xc({parent:this.rootElem.querySelector(".player-damage-taken-metrics"),resultsEmitter:this.resultsEmitter},this.resultsFilter),new Yl({parent:this.rootElem.querySelector(".buff-aura-metrics"),resultsEmitter:this.resultsEmitter},!1),new Yl({parent:this.rootElem.querySelector(".debuff-aura-metrics"),resultsEmitter:this.resultsEmitter},!0),new Kl({parent:this.rootElem.querySelector(".dps-histogram"),resultsEmitter:this.resultsEmitter}),new Jl({parent:this.rootElem.querySelector(".dtps-metrics"),resultsEmitter:this.resultsEmitter});const n=new Fm({parent:this.rootElem.querySelector(".timeline"),resultsEmitter:this.resultsEmitter,secondaryResource:t?.player?.secondaryResource}),r=document.querySelector('button[data-bs-target="#timelineTab"]');r?.addEventListener("shown.bs.tab",()=>{n.render()}),new fc({parent:this.rootElem.querySelector(".log"),resultsEmitter:this.resultsEmitter}),this.rootElem.classList.add("hide-threat-metrics"),this.resultsFilter.changeEmitter.on(async()=>await this.updateResults(this.latestRun)),this.resultsEmitter.on((e,t)=>{t?.filter.player||0===t?.filter.player?(this.rootDiv.classList.remove("all-players"),this.rootDiv.classList.add("single-player")):(this.rootDiv.classList.add("all-players"),this.rootDiv.classList.remove("single-player"))});const l=i.value;l?.addEventListener("click",()=>{Km({action:"sim",category:"simulate",label:"once"}),this.simUI?.runSimOnce()});const c=s.value;c?.addEventListener("click",()=>{Km({action:"sim",category:"simulate",label:"death"}),this.latestDeathSeeds.length>1&&(this.simUI?.sim.setFixedRngSeed(te.nextEventID(),Number(this.latestDeathSeeds.pop())),this.recentlyEditedSeed=!0),this.simUI?.runSimOnce()}),a.currentChangeEmitter.on(async()=>{const e=a.getRunData();e&&(this.updateSettings(),await this.updateResults(e)),c.disabled=this.latestDeathSeeds.length<2})}updateSettings(){this.recentlyEditedSeed&&(this.simUI.sim.setFixedRngSeed(te.nextEventID(),0),this.recentlyEditedSeed=!1);const e=this.simUI?.sim.toProto();if(e){if(e.showDamageMetrics)this.rootElem.classList.remove("hide-damage-metrics");else{this.rootElem.classList.add("hide-damage-metrics");const e=document.getElementById("damageTab"),t=document.getElementById("healingTab");if(e.classList.contains("active")){e.classList.remove("active","show"),t.classList.add("active","show");const a=document.getElementsByClassName("dr-toolbar")[0];a.querySelector(".damage-metrics")?.children[0].classList.remove("active"),a.querySelector(".healing-metrics")?.children[0].classList.add("active")}}this.rootElem.classList[e.showThreatMetrics?"remove":"add"]("hide-threat-metrics"),this.rootElem.classList[e.showHealingMetrics?"remove":"add"]("hide-healing-metrics"),this.rootElem.classList[e.showExperimental?"remove":"add"]("hide-experimental")}}async updateResults(e){e?.run?.request?.requestId!==this.latestRun?.run?.request?.requestId&&(this.latestRun=e,this.currentSimResult=await Dl.fromProto(e?.run||ge.create()));const t=this.latestRun?.run?.result,a=t?.raidMetrics?.parties.map(e=>e.players).flat();if(a?.length){const e=a[0].deathSeeds;(e.length>1||0==this.latestDeathSeeds.length)&&(this.latestDeathSeeds=e)}const i=te.nextEventID();null==this.currentSimResult?(this.rootDiv.classList.add("dr-no-results"),this.resultsEmitter.emit(i,null)):(this.rootDiv.classList.remove("dr-no-results"),this.resultsEmitter.emit(i,{eventID:i,result:this.currentSimResult,filter:this.resultsFilter.getFilter()}))}}const og=e=>({max:e}),ng=e=>({min:e}),rg=(e,t,a)=>e.matrix[Math.imul(t,e.width)+a],lg=(e,t,a,i)=>{e.matrix[Math.imul(t,e.width)+a]=i},cg=e=>"function"==typeof e[Symbol.iterator]?e:Object.entries(e),hg=(e,t)=>{const a=Math.round(1/t);return Math.round((e+Number.EPSILON)*a)/a},dg=(e,t,a)=>{const i=rg(e,t,a),s=e.variableAtPosition[e.width+t],o=e.variableAtPosition[a];e.variableAtPosition[e.width+t]=o,e.variableAtPosition[a]=s,e.positionOfVariable[s]=a,e.positionOfVariable[o]=e.width+t;const n=[];for(let r=0;r<e.width;r++){const a=rg(e,t,r);Math.abs(a)>1e-16?(lg(e,t,r,a/i),n.push(r)):lg(e,t,r,0)}lg(e,t,a,1/i);for(let r=0;r<e.height;r++){if(r===t)continue;const s=rg(e,r,a);if(Math.abs(s)>1e-16){for(let a=0;a<n.length;a++){const i=n[a];lg(e,r,i,rg(e,r,i)-s*rg(e,t,i))}lg(e,r,a,-s/i)}}},ug=(e,t,a,i)=>{e.push([t.variableAtPosition[t.width+a],t.variableAtPosition[i]]);for(let s=6;s<=Math.trunc(e.length/2);s++){let t=!0;for(let a=0;a<s;a++){const i=e.length-1-a,[o,n]=e[i],[r,l]=e[i-s];if(o!==r||n!==l){t=!1;break}}if(t)return!0}return!1},pg=(e,t)=>{const a=[],{precision:i,maxPivots:s,checkCycles:o}=t;for(let n=0;n<s;n++){let t=0,s=i;for(let a=1;a<e.width;a++){const i=rg(e,0,a);i>s&&(s=i,t=a)}if(0===t)return["optimal",hg(rg(e,0,0),i)];let n=0,r=1/0;for(let a=1;a<e.height;a++){const s=rg(e,a,t);if(s<=i)continue;const o=rg(e,a,0)/s;if(o<r&&(n=a,r=o,o<=i))break}if(0===n)return["unbounded",t];if(o&&ug(a,e,n,t))return["cycled",NaN];dg(e,n,t)}return["cycled",NaN]},mg=(e,t)=>{const a=[],{precision:i,maxPivots:s,checkCycles:o}=t;for(let n=0;n<s;n++){let s=0,n=-i;for(let t=1;t<e.height;t++){const a=rg(e,t,0);a<n&&(n=a,s=t)}if(0===s)return pg(e,t);let r=0,l=-1/0;for(let t=1;t<e.width;t++){const a=rg(e,s,t);if(a<-i){const i=-rg(e,0,t)/a;i>l&&(l=i,r=t)}}if(0===r)return["infeasible",NaN];if(o&&ug(a,e,s,r))return["cycled",NaN];dg(e,s,r)}return["cycled",NaN]};var gg,fg,bg,yg={exports:{}},wg=yg.exports;function vg(){return gg||(gg=1,e=yg,function(){var t,a,i,s,o,n,r,l,c,h,d,u,p,m,g;i=Math.floor,h=Math.min,a=function(e,t){return e<t?-1:e>t?1:0},c=function(e,t,s,o,n){var r;if(null==s&&(s=0),null==n&&(n=a),s<0)throw new Error("lo must be non-negative");for(null==o&&(o=e.length);s<o;)n(t,e[r=i((s+o)/2)])<0?o=r:s=r+1;return[].splice.apply(e,[s,s-s].concat(t)),t},n=function(e,t,i){return null==i&&(i=a),e.push(t),m(e,0,e.length-1,i)},o=function(e,t){var i,s;return null==t&&(t=a),i=e.pop(),e.length?(s=e[0],e[0]=i,g(e,0,t)):s=i,s},l=function(e,t,i){var s;return null==i&&(i=a),s=e[0],e[0]=t,g(e,0,i),s},r=function(e,t,i){var s;return null==i&&(i=a),e.length&&i(e[0],t)<0&&(t=(s=[e[0],t])[0],e[0]=s[1],g(e,0,i)),t},s=function(e,t){var s,o,n,r,l,c;for(null==t&&(t=a),l=[],o=0,n=(r=function(){c=[];for(var t=0,a=i(e.length/2);0<=a?t<a:t>a;0<=a?t++:t--)c.push(t);return c}.apply(this).reverse()).length;o<n;o++)s=r[o],l.push(g(e,s,t));return l},p=function(e,t,i){var s;if(null==i&&(i=a),-1!==(s=e.indexOf(t)))return m(e,0,s,i),g(e,s,i)},d=function(e,t,i){var o,n,l,c,h;if(null==i&&(i=a),!(n=e.slice(0,t)).length)return n;for(s(n,i),l=0,c=(h=e.slice(t)).length;l<c;l++)o=h[l],r(n,o,i);return n.sort(i).reverse()},u=function(e,t,i){var n,r,l,d,u,p,m,g,f;if(null==i&&(i=a),10*t<=e.length){if(!(l=e.slice(0,t).sort(i)).length)return l;for(r=l[l.length-1],d=0,p=(m=e.slice(t)).length;d<p;d++)i(n=m[d],r)<0&&(c(l,n,0,null,i),l.pop(),r=l[l.length-1]);return l}for(s(e,i),f=[],u=0,g=h(t,e.length);0<=g?u<g:u>g;0<=g?++u:--u)f.push(o(e,i));return f},m=function(e,t,i,s){var o,n,r;for(null==s&&(s=a),o=e[i];i>t&&s(o,n=e[r=i-1>>1])<0;)e[i]=n,i=r;return e[i]=o},g=function(e,t,i){var s,o,n,r,l;for(null==i&&(i=a),o=e.length,l=t,n=e[t],s=2*t+1;s<o;)(r=s+1)<o&&!(i(e[s],e[r])<0)&&(s=r),e[t]=e[s],s=2*(t=s)+1;return e[t]=n,m(e,l,t,i)},t=function(){function e(e){this.cmp=null!=e?e:a,this.nodes=[]}return e.push=n,e.pop=o,e.replace=l,e.pushpop=r,e.heapify=s,e.updateItem=p,e.nlargest=d,e.nsmallest=u,e.prototype.push=function(e){return n(this.nodes,e,this.cmp)},e.prototype.pop=function(){return o(this.nodes,this.cmp)},e.prototype.peek=function(){return this.nodes[0]},e.prototype.contains=function(e){return-1!==this.nodes.indexOf(e)},e.prototype.replace=function(e){return l(this.nodes,e,this.cmp)},e.prototype.pushpop=function(e){return r(this.nodes,e,this.cmp)},e.prototype.heapify=function(){return s(this.nodes,this.cmp)},e.prototype.updateItem=function(e){return p(this.nodes,e,this.cmp)},e.prototype.clear=function(){return this.nodes=[]},e.prototype.empty=function(){return 0===this.nodes.length},e.prototype.size=function(){return this.nodes.length},e.prototype.clone=function(){var t;return(t=new e).nodes=this.nodes.slice(0),t},e.prototype.toArray=function(){return this.nodes.slice(0)},e.prototype.insert=e.prototype.push,e.prototype.top=e.prototype.peek,e.prototype.front=e.prototype.peek,e.prototype.has=e.prototype.contains,e.prototype.copy=e.prototype.clone,e}(),e.exports=t}.call(wg)),yg.exports;var e}const xg=Re(bg?fg:(bg=1,fg=vg())),Sg=(e,t)=>({matrix:new Float64Array(e),positionOfVariable:new Int32Array(t),variableAtPosition:new Int32Array(t)}),_g=(e,{matrix:t,positionOfVariable:a,variableAtPosition:i},s)=>{const{width:o,height:n}=e;t.set(e.matrix);for(let l=0;l<s.length;l++){const[a,i,r]=s[l],c=(n+l)*o,h=e.positionOfVariable[i];if(h<o)t[c]=a*r,t.fill(0,c+1,c+o),t[c+h]=a;else{const e=(h-o)*o;t[c]=a*(r-t[e]);for(let i=1;i<o;i++)t[c+i]=-a*t[e+i]}}a.set(e.positionOfVariable),i.set(e.variableAtPosition);const r=o+n+s.length;for(let l=o+n;l<r;l++)a[l]=l,i[l]=l;return{matrix:t.subarray(0,e.matrix.length+o*s.length),width:o,height:n+s.length,positionOfVariable:a.subarray(0,r),variableAtPosition:i.subarray(0,r)}},kg=(e,t)=>{let a=0,i=0,s=0;for(let o=0;o<t.length;o++){const n=t[o],r=e.positionOfVariable[n]-e.width;if(r<0)continue;const l=rg(e,r,0),c=Math.abs(l-Math.round(l));c>a&&(a=c,i=n,s=l)}return[i,s,a]},Cg=({tableau:e,sign:t,variables:a},i,s,{precision:o,includeZeroVariables:n})=>{if("optimal"===i||"timedout"===i&&!Number.isNaN(s)){const r=[];for(let t=0;t<a.length;t++){const[i]=a[t],s=e.positionOfVariable[t+1]-e.width,l=s>=0?rg(e,s,0):0;l>o?r.push([i,hg(l,o)]):n&&r.push([i,0])}return{status:i,result:-t*s,variables:r}}if("unbounded"===i){const i=e.variableAtPosition[s]-1;return{status:"unbounded",result:t*(1/0),variables:0<=i&&i<a.length?[[a[i][0],1/0]]:[]}}return{status:i,result:NaN,variables:[]}},Ig={precision:1e-8,checkCycles:!1,maxPivots:8192,tolerance:0,timeout:1/0,maxIterations:32768,includeZeroVariables:!1},Eg=(e,t)=>{const a=(e=>{const{objective:t}=e,a=cg(e.constraints),i=cg(e.variables),s=Array.isArray(i)?i:Array.from(i),o=[],n=[];for(let f=1;f<=s.length;f++){const[e]=s[f-1];o.push(f),n.push(f)}const r=new Map;for(const[f,b]of a){const e=r.get(f)??{row:NaN,lower:-1/0,upper:1/0};e.lower=Math.max(e.lower,b.equal??b.min??-1/0),e.upper=Math.min(e.upper,b.equal??b.max??1/0),r.has(f)||r.set(f,e)}let l=1;for(const f of r.values())f.row=l,l+=(Number.isFinite(f.lower)?1:0)+(Number.isFinite(f.upper)?1:0);const c=s.length+1,h=l+o.length,d=c+h,u=new Float64Array(c*h),p=new Int32Array(d),m=new Int32Array(d),g={matrix:u,width:c,height:h,positionOfVariable:p,variableAtPosition:m};for(let f=0;f<d;f++)p[f]=f,m[f]=f;for(let f=1;f<c;f++)for(const[e,a]of cg(s[f-1][1])){e===t&&lg(g,0,f,1*a);const i=r.get(e);null!=i&&(Number.isFinite(i.upper)?(lg(g,i.row,f,a),Number.isFinite(i.lower)&&lg(g,i.row+1,f,-a)):Number.isFinite(i.lower)&&lg(g,i.row,f,-a))}for(const f of r.values())Number.isFinite(f.upper)?(lg(g,f.row,0,f.upper),Number.isFinite(f.lower)&&lg(g,f.row+1,0,-f.lower)):Number.isFinite(f.lower)&&lg(g,f.row,0,-f.lower);for(let f=0;f<o.length;f++){const e=l+f;lg(g,e,0,1),lg(g,e,o[f],1)}return{tableau:g,sign:1,variables:s,integers:n}})(e),i={...Ig,...t},[s,o]=mg(a.tableau,i);if(0===a.integers.length||"optimal"!==s)return Cg(a,s,o,i);{const[e,t,s]=((e,t,a)=>{const{tableau:i,sign:s,integers:o}=e,{precision:n,maxIterations:r,tolerance:l,timeout:c}=a,[h,d,u]=kg(i,o);if(u<=n)return[e,"optimal",t];const p=new xg((e,t)=>e[0]-t[0]);p.push([t,[[-1,h,Math.ceil(d)]]]),p.push([t,[[1,h,Math.floor(d)]]]);const m=2*o.length,g=i.matrix.length+m*i.width,f=i.positionOfVariable.length+m;let b=Sg(g,f),y=Sg(g,f);const w=t*(1-s*l),v=c+Date.now();let x=Date.now()>=v,S=!1,_=1/0,k=i,C=0;for(;C<r&&!p.empty()&&_>=w&&!x;){const[e,t]=p.pop();if(e>_)break;const s=_g(i,b,t),[r,l]=mg(s,a);if("optimal"===r&&l<_){const[e,a,i]=kg(s,o);if(i<=n){S=!0,_=l,k=s;const e=y;y=b,b=e}else{const i=[],s=[];for(let a=0;a<t.length;a++){const o=t[a],[n,r]=o;r===e?n<0?s.push(o):i.push(o):(i.push(o),s.push(o))}s.push([1,e,Math.floor(a)]),i.push([-1,e,Math.ceil(a)]),p.push([l,i]),p.push([l,s])}}x=Date.now()>=v,C++}const I=(x||C>=r)&&!p.empty()&&_>=w?"timedout":S?"optimal":"infeasible";return[{...e,tableau:k},I,S?_:NaN]})(a,o,i);return Cg(e,t,s,i)}};class Tg extends F{constructor(e,t){const a=U();super(e,"copy-button",H("button",{className:`btn ${t.extraCssClasses?.join(" ")??""}`,ref:a},H("i",{className:"fas fa-copy me-1"}),t.text??oe.t("common.copy_button.default_text"))),this.config=t;const i=a.value;let s=!1;i.addEventListener("click",()=>{if(s)return;const e=this.config.getContent();if(null==navigator.clipboard)alert(e);else{s=!0,navigator.clipboard.writeText(e);const t=i.innerHTML;i.innerHTML=`<i class="fas fa-check me-1"></i>${oe.t("common.copy_button.copied")}`,setTimeout(()=>{i.innerHTML=t,s=!1},1500)}}),t.tooltip&&ie(i,{content:t.tooltip})}}class Ag extends nl{constructor(e,t,a){super(e,"enum-picker-root",t,a),this.selectElem=this.rootElem.appendChild(H("select",{id:a.id,className:"enum-picker-selector form-select"},a.values.map(e=>H("option",{value:String(e.value),title:e.tooltip},e.name)))),this.init(),this.selectElem.addEventListener("change",()=>{this.inputChanged(te.nextEventID())},{signal:this.signal})}getInputElem(){return this.selectElem}getInputValue(){return Number(this.selectElem.value)}setInputValue(e){this.selectElem.value=String(e)}}class Pg extends F{constructor(e,t,a){super(e,"saved-data-manager-root"),this.modObject=t,this.config=a,this.userData=[],this.presets=[],this.frozen=!1,a.extraCssClasses&&this.rootElem.classList.add(...a.extraCssClasses);const i=new $e(this.rootElem,"saved-data",{header:a.header}),s=U(),o=U(),n=U();i.bodyElement.replaceChildren(H("div",{ref:s,className:"saved-data-container"},H("div",{ref:o,className:"saved-data-presets hide"}),H("div",{ref:n,className:"saved-data-custom hide"}))),this.savedDataDiv=s.value,this.presetDataDiv=o.value,this.customDataDiv=n.value,a.presetsOnly||this.config.loadOnly||i.bodyElement.appendChild(this.buildCreateContainer())}addSavedData(e){const t=this.makeSavedData(e),a=e.isPreset?this.presets:this.userData,i=a.findIndex(t=>t.name===e.name);-1===i?(e.isPreset?(this.presetDataDiv.classList.remove("hide"),this.presetDataDiv.appendChild(t.elem)):(this.customDataDiv.classList.remove("hide"),this.customDataDiv.appendChild(t.elem)),a.push(t)):(a[i].elem.replaceWith(t.elem),a[i]=t)}makeSavedData(e){const t=U(),a=H("div",{className:"saved-data-set-chip badge rounded-pill"},H("button",{className:"saved-data-set-name"},e.name),!this.config.loadOnly&&!e.isPreset&&H("button",{ref:t,className:"saved-data-set-delete"},H("i",{className:"fa fa-times fa-lg"})));if(a?.addEventListener("click",()=>{this.config.setData(te.nextEventID(),this.modObject,e.data),e.onLoad?.(this.modObject),this.saveInput&&(this.saveInput.value=e.name),Km({action:"settings",category:"load",label:this.config.label})}),!this.config.loadOnly&&!e.isPreset&&t.value){const a=ie(t.value,{content:this.config.deleteTooltip||`Delete saved ${this.config.label}`});t.value.addEventListener("click",t=>{t.stopPropagation();if(!confirm(this.config.deleteConfirmMessage?this.config.deleteConfirmMessage.replace("{{name}}",e.name):`Delete saved ${this.config.label} '${e.name}'?`))return;a.destroy();const i=this.userData.findIndex(t=>t.name===e.name);this.userData[i].elem.remove(),this.userData.splice(i,1),this.saveUserData(),Km({action:"settings",category:"delete",label:this.config.label})})}e.tooltip&&ie(a,{content:e.tooltip,placement:"bottom"});const i=()=>{this.config.equals(e.data,this.config.getData(this.modObject))?(a.classList.add("active"),this.saveInput&&(this.saveInput.value=e.name)):a.classList.remove("active"),e.enableWhen&&!e.enableWhen(this.modObject)?a.classList.add("disabled"):a.classList.remove("disabled")};i();const s=this.config.changeEmitters.map(e=>e.on(i));return this.addOnDisposeCallback(()=>s.map(e=>e.dispose())),{name:e.name,data:e.data,elem:a,enableWhen:e.enableWhen,onLoad:e.onLoad}}saveUserData(){const e={};this.userData.forEach(t=>{e[t.name]=this.config.toJson(t.data)}),this.presets.length||this.presetDataDiv.classList.add("hide"),this.userData.length||this.customDataDiv.classList.add("hide"),window.localStorage.setItem(this.config.storageKey,JSON.stringify(e))}loadUserData(){const e=window.localStorage.getItem(this.config.storageKey);if(!e)return;let t;try{t=JSON.parse(e)}catch(a){console.warn("Invalid json for local storage value: ",e,a)}for(const i in t)try{this.addSavedData({name:i,data:this.config.fromJson(t[i])})}catch(a){console.warn("Failed parsing saved data: ",t[i],a)}}freeze(){this.frozen=!0,this.rootElem.classList.add("frozen")}buildCreateContainer(){const e=U(),t=U(),a=H("div",{className:"saved-data-create-container"},H("label",{className:"form-label"},this.config.nameLabel||oe.t("common.name")),H("input",{ref:t,className:"saved-data-save-input form-control",type:"text",placeholder:oe.t("common.name")}),H("button",{ref:e,className:"saved-data-save-button btn btn-primary"},this.config.saveButtonText||`Save ${this.config.label}`));return this.saveInput=t.value,e.value?.addEventListener("click",()=>{if(this.frozen)return;const e=this.saveInput?.value;e?e in this.presets?alert(this.config.nameExistsAlert?this.config.nameExistsAlert.replace("{{name}}",e):`${this.config.label} with name ${e} already exists.`):(this.addSavedData({name:e,data:this.config.getData(this.modObject)}),this.saveUserData(),Km({action:"settings",category:"save",label:this.config.label})):alert(this.config.chooseNameAlert||`Choose a label for your saved ${this.config.label}!`)}),a}}const Rg=(e,t,a)=>{const i=new Pg(e,t.player,{label:oe.t("sidebar.buttons.stat_weights.modal.ep"),nameLabel:oe.t("sidebar.buttons.stat_weights.title"),header:{title:oe.t("sidebar.buttons.stat_weights.saved_ep_weights.title")},storageKey:t.getSavedEPWeightsStorageKey(),getData:e=>Ze.create({epWeights:e.getEpWeights().toProto()}),setData:(e,t,a)=>{te.freezeAllAndDo(()=>{t.setEpWeights(e,n.fromProto(a.epWeights))})},changeEmitters:[t.player.epWeightsChangeEmitter],equals:(e,t)=>Ze.equals(e,t),toJson:e=>Ze.toJson(e),fromJson:e=>Ze.fromJson(e),...a});return t.sim.waitForInit().then(()=>{i.loadUserData(),t.individualConfig.presets.epWeights.forEach(({name:e,epWeights:t,enableWhen:a,onLoad:s})=>{i.addSavedData({name:e,isPreset:!0,data:Ze.create({epWeights:t.toProto()}),enableWhen:a,onLoad:s})})}),i};class Dg{constructor(e){const{title:t,variant:a,autoShow:i=!0,canClose:s=!0,body:o,additionalClasses:n,container:r,...l}=e||{};this.container=r||document.getElementById("toastContainer"),this.additionalClasses=n,this.title=t||"WowSims",this.variant=a||"info",this.body=o,this.canClose=s,this.element=this.template(),this.container.appendChild(this.element),this.instance=Ke.getOrCreateInstance(this.element,{delay:3e3,...l}),i&&this.instance.show(),this.element.addEventListener("hidden.bs.toast",()=>{this.destroy()})}destroy(){this.instance.dispose(),this.element.remove()}show(){this.instance.show()}hide(){this.instance.hide()}getVariantIcon(){switch(this.variant){case"info":return"fa-info-circle";case"success":return"fa-check-circle";case"error":return"fa-exclamation-circle";case"warning":return"fa-triangle-exclamation"}}template(){return H("div",{className:xr("toast position-relative bottom-0 end-0",`toast--${this.variant}`,this.additionalClasses),attributes:{role:"alert","aria-live":"assertive","aria-atomic":"true"}},H("div",{className:"toast-header"},H("i",{className:xr("d-block fas fa-2xl me-2",this.getVariantIcon())}),H("strong",{className:"me-auto"},this.title),this.canClose&&H("button",{className:"btn-close",attributes:{"aria-label":"Close"},dataset:{bsDismiss:"toast"},"aria-label":"Close"},H("i",{className:xr("fas fa-times fa-1xl",this.getVariantIcon())}))),H("div",{className:"toast-body"},this.body))}}const Mg=[ee.StatHitRating,ee.StatCritRating,ee.StatHasteRating,ee.StatExpertiseRating,ee.StatMasteryRating,ee.StatDodgeRating,ee.StatParryRating],Lg={[ee.StatMasteryRating]:()=>H(de,null,"Total ",H("strong",null,"percentage")),[ee.StatHasteRating]:()=>H(de,null,"Final percentage value ",H("strong",null,"including")," all buffs/gear.")},Ng=class e{static hasRoRo(e){return e.getGear().hasTrinketFromOptions([95802,94532,96546,96174,96918])}constructor(t,a,i){if(!e.relevantStats.includes(t))throw new Error("Forced highest stat must be either Crit, Haste, or Mastery!");this.player=a,this.forcedHighestStat=ne.fromStat(t),this.constrainedStats=e.relevantStats.filter(e=>e!==t).map(e=>ne.fromStat(e)),this.constraintKeys=this.constrainedStats.map(e=>this.forcedHighestStat.getShortName(i)+"Minus"+e.getShortName(i))}updateCoefficients(t,a,i){if(e.relevantStats.includes(a)){for(const[e,s]of this.constrainedStats.entries()){const o=this.constraintKeys[e],n=t.get(o)||0;this.forcedHighestStat.equalsStat(a)?t.set(o,n+i):s.equalsStat(a)&&t.set(o,n-i)}if(a!=ee.StatMasteryRating&&this.forcedHighestStat.equalsStat(ee.StatMasteryRating)&&this.player.getSpec()==K.SpecFeralDruid){const e="HasteMinusCrit",s=t.get(e)||0;a==ee.StatHasteRating?t.set(e,s+i):t.set(e,s-i)}}}updateConstraints(t,a,i){i=i.addStat(ee.StatMasteryRating,-this.player.getBaseMastery()*le);const s=this.player.getRaid()?.getBuffs();s&&(s.roarOfCourage||s.blessingOfMight||s.spiritBeastBlessing||s.graceOfAir)&&(i=i.addStat(ee.StatMasteryRating,-3e3));for(const[o,r]of this.constrainedStats.entries()){const s=(new n).withUnitStat(this.forcedHighestStat,1).withUnitStat(r,-1);let l=1-i.computeEP(s);const c=e.procTrinketOffsets.get(r.getStat());for(const e of a.getTrinkets()){if(!e)continue;const t=e.item.id;if(c.has(t)){l+=c.get(t);break}}t.set(this.constraintKeys[o],ng(l))}if(this.forcedHighestStat.equalsStat(ee.StatMasteryRating)&&this.player.getSpec()==K.SpecFeralDruid){const e=i.getStat(ee.StatCritRating)-i.getStat(ee.StatHasteRating)+1;t.set("HasteMinusCrit",ng(e))}}updateWeights(e){const t=Math.min(e.getUnitStat(this.constrainedStats[0]),e.getUnitStat(this.constrainedStats[1]));return e.withUnitStat(this.forcedHighestStat,Math.min(e.getUnitStat(this.forcedHighestStat),t-.01))}};Ng.relevantStats=[ee.StatCritRating,ee.StatHasteRating,ee.StatMasteryRating],Ng.procTrinketOffsets=new Map([[ee.StatCritRating,new Map([[69167,460],[68995,410]])],[ee.StatHasteRating,new Map([[69112,1730],[68927,1532]])],[ee.StatMasteryRating,new Map([])]]);let Og=Ng;class Gg{constructor(e,t){this._statCaps=new n,this.breakpointLimits=new n,this.useCustomEPValues=!1,this.useSoftCapBreakpoints=!0,this.softCapBreakpoints=[],this.statTooltips={},this.additionalSoftCapTooltipInformation={},this.includeGems=!1,this.includeEOTBPGemSocket=!1,this.freezeItemSlots=!1,this.frozenItemSlots=new Set,this.includeTimeout=!0,this.undershootCaps=new n,this.previousGear=null,this.previousReforges=new Map,this.currentReforges=new Map,this.relativeStatCapStat=-1,this.relativeStatCap=null,this.includeGemsChangeEmitter=new te("IncludeGems"),this.includeEOTBPGemSocketChangeEmitter=new te("IncludeEOTBPGemSocket"),this.includeTimeoutChangeEmitter=new te("IncludeTimeout"),this.statCapsChangeEmitter=new te("StatCaps"),this.useCustomEPValuesChangeEmitter=new te("UseCustomEPValues"),this.useSoftCapBreakpointsChangeEmitter=new te("UseSoftCapBreakpoints"),this.softCapBreakpointsChangeEmitter=new te("SoftCapBreakpoints"),this.breakpointLimitsChangeEmitter=new te("BreakpointLimits"),this.freezeItemSlotsChangeEmitter=new te("FreezeItemSlots"),this.undershootCapsChangeEmitter=new te("UndershootCaps"),this.relativeStatCapStatChangeEmitter=new te("RelativeStatCapStat"),this.simUI=e,this.player=e.player,this.playerClass=this.player.getClass(),this.isExperimental=t?.experimental,this.isHybridCaster=[K.SpecBalanceDruid,K.SpecShadowPriest,K.SpecElementalShaman,K.SpecMistweaverMonk].includes(this.player.getSpec()),this.isTankSpec=this.player.getPlayerSpec().isTankSpec,this.sim=e.sim,this.defaults=e.individualConfig.defaults,this.getEPDefaults=t?.getEPDefaults,this.updateSoftCaps=t?.updateSoftCaps,this.updateGearStatsModifier=t?.updateGearStatsModifier,this._softCapsConfig=this.defaults.softCapBreakpoints||[],this.statTooltips={...Lg,...t?.statTooltips},this.additionalSoftCapTooltipInformation={...t?.additionalSoftCapTooltipInformation},this.statSelectionPresets=t?.statSelectionPresets,this._statCaps=this.defaults.statCaps||new n,this.enableBreakpointLimits=!!t?.enableBreakpointLimits,this.relativeStatCapStat=t?.defaultRelativeStatCap??-1;const a={label:oe.t("sidebar.buttons.suggest_reforges.title"),cssClass:"suggest-reforges-action-button flex-grow-1",onClick:async({currentTarget:t})=>{Km({action:"settings",category:"reforging",label:"suggest_start"});const a=t;a&&(a.classList.add("loading"),a.disabled=!0);const i=e.player.getChallengeModeEnabled();try{performance.mark("reforge-optimization-start"),i&&e.player.setChallengeModeEnabled(te.nextEventID(),!1),await this.optimizeReforges(),this.onReforgeDone()}catch(s){this.onReforgeError(s)}finally{i&&e.player.setChallengeModeEnabled(te.nextEventID(),!0),performance.mark("reforge-optimization-end");const t=performance.measure("reforge-optimization-measure","reforge-optimization-start","reforge-optimization-end").duration;Km({action:"settings",category:"reforging",label:"suggest_duration",value:Math.ceil(t/1e3)}),a&&(a.classList.remove("loading"),a.disabled=!1)}}},i={cssClass:"suggest-reforges-button-settings",children:H(de,null,H("i",{className:"fas fa-cog"}))},{group:s,children:[o,r]}=e.addActionGroup([a,i],{cssClass:xr("suggest-reforges-settings-group",this.isExperimental&&!this.player.sim.getShowExperimental()&&"hide")});this.bindToggleExperimental(s),this.softCapsConfig?.length&&ie(o,{theme:"suggest-reforges-softcaps",placement:"bottom",maxWidth:310,interactive:!0,onShow:e=>e.setContent(this.buildReforgeButtonTooltip())}),ie(r,{placement:"bottom",content:oe.t("sidebar.buttons.suggest_reforges.tooltip")}),this.buildContextMenu(r),this.changeEmitter=te.onAny([this.includeGemsChangeEmitter,this.includeEOTBPGemSocketChangeEmitter,this.includeTimeoutChangeEmitter,this.statCapsChangeEmitter,this.useCustomEPValuesChangeEmitter,this.useSoftCapBreakpointsChangeEmitter,this.softCapBreakpointsChangeEmitter,this.breakpointLimitsChangeEmitter,this.freezeItemSlotsChangeEmitter,this.undershootCapsChangeEmitter,this.relativeStatCapStatChangeEmitter],"ReforgeSettingsChange"),te.onAny([this.useCustomEPValuesChangeEmitter,this.player.epWeightsChangeEmitter,this.statCapsChangeEmitter]).on(e=>{!this.useCustomEPValues||!this.player.hasCustomEPWeights()&&this._statCaps.equals(this.defaults.statCaps||new n)||this.setUseSoftCapBreakpoints(e,!1)}),this.player.gearChangeEmitter.on(e=>{this.setRelativeStatCap(e,this.relativeStatCapStat)})}bindToggleExperimental(e){const t=()=>e.classList[this.isExperimental&&!this.player.sim.getShowExperimental()?"add":"remove"]("hide");t(),this.player.sim.showExperimentalChangeEmitter.on(()=>{t()})}get softCapsConfig(){return this.updateSoftCaps?.(Je.cloneSoftCaps(this._softCapsConfig))||this._softCapsConfig}get softCapsConfigWithLimits(){if(!this.enableBreakpointLimits||!this.useSoftCapBreakpoints)return this.softCapsConfig;const e=Je.cloneSoftCaps(this.softCapsConfig);for(const[t,a]of this.breakpointLimits.asUnitStatArray()){if(!a)continue;const i=e.find(e=>e.unitStat.equals(t)),s=i?.breakpoints.some(e=>e==a);i&&s&&(i.breakpoints=i.breakpoints.filter(e=>e<=a),i.capType===J.TypeSoftCap&&(i.postCapEPs=i.postCapEPs.slice(0,i.breakpoints.length)))}return e}get preCapEPs(){let e=this.player.getEpWeights();return this.useCustomEPValues||(this.getEPDefaults?e=this.getEPDefaults?.(this.player):this.player.hasCustomEPWeights()&&(e=this.defaults.epWeights)),this.isHybridCaster&&(e=e.withStat(ee.StatSpirit,.01)),e}static checkWeights(e,t,a){let i=e;for(const s of[ee.StatHitRating,ee.StatCritRating,ee.StatHasteRating]){const o=ne.getChildren(s);if(o.map(t=>e.getPseudoStat(t)).some(e=>0!==e))i=i.withStat(s,0);else for(const n of o)if(Qe(n,t,a)){const t=ne.fromPseudoStat(n).convertPercentToRating(e.getStat(s));i=i.withPseudoStat(n,t),i=i.withStat(s,0);break}}return i}static includesCappedStat(e,t,a){for(const i of e.keys())if(i.includes("PseudoStat")){const e=T[i];if(Qe(e,t,a))return!0}else if(i.includes("Stat")){const e=ee[i];if(et(e,t,a))return!0}else if(i.includes("Minus"))return!0;return!1}static getCappedStatKeys(e,t,a){const i=[];for(const s of e.keys())if(s.includes("PseudoStat")){const e=T[s];Qe(e,t,a)&&i.push(s)}else if(s.includes("Stat")){const e=ee[s];et(e,t,a)&&i.push(s)}return i}buildReforgeButtonTooltip(){return H(de,null,H("p",null,oe.t("sidebar.buttons.suggest_reforges.breakpoints_implemented")),H("table",{className:"w-100"},H("tbody",null,this.softCapsConfigWithLimits?.map(({unitStat:e,breakpoints:t,capType:a,postCapEPs:i},s)=>H(de,null,H("tr",null,H("th",{className:"text-nowrap",colSpan:2},e.getShortName(this.playerClass)),H("td",{className:"text-end"},ol.get(a))),this.additionalSoftCapTooltipInformation[e.getRootStat()]&&H(de,null,H("tr",null,H("td",{colSpan:3},this.additionalSoftCapTooltipInformation[e.getRootStat()]?.())),H("tr",null,H("td",{colSpan:3,className:"pb-2"}))),H("tr",null,H("th",{className:"text-end"},H("em",null,"%")),H("th",{colSpan:2,className:"text-nowrap text-end"},H("em",null,oe.t("sidebar.buttons.suggest_reforges.post_cap_ep")))),t.map((t,s)=>H("tr",null,H("td",{className:"text-end"},this.breakpointValueToDisplayPercentage(t,e)),H("td",{colSpan:2,className:"text-end"},e.convertEpToRatingScale(a===J.TypeThreshold?i[0]:i[s]).toFixed(2)))),s!==this.softCapsConfigWithLimits.length-1&&H(de,null,H("tr",null,H("td",{colSpan:3,className:"border-bottom pb-2"})),H("tr",null,H("td",{colSpan:3,className:"pb-2"}))))))))}setStatCaps(e,t){this._statCaps=t,this.statCapsChangeEmitter.emit(e)}get statCaps(){return this.useCustomEPValues?this._statCaps:this.defaults.statCaps||new n}setUseCustomEPValues(e,t){t!==this.useCustomEPValues&&(this.useCustomEPValues=t,this.useCustomEPValuesChangeEmitter.emit(e))}setUseSoftCapBreakpoints(e,t){t!==this.useSoftCapBreakpoints&&(this.useSoftCapBreakpoints=t,this.useSoftCapBreakpointsChangeEmitter.emit(e))}setBreakpointLimits(e,t){this.breakpointLimits=t,this.breakpointLimitsChangeEmitter.emit(e)}setSoftCapBreakpoints(e,t){this.softCapBreakpoints=t,this.softCapBreakpointsChangeEmitter.emit(e)}setRelativeStatCap(e,t){this.relativeStatCapStat=t,-1!==this.relativeStatCapStat&&Og.hasRoRo(this.player)?this.relativeStatCap=new Og(this.relativeStatCapStat,this.player,this.playerClass):this.relativeStatCap=null,this.relativeStatCapStatChangeEmitter.emit(e)}setIncludeGems(e,t){this.includeGems!==t&&(this.includeGems=t,t&&this.setIncludeTimeout(e,!0),this.includeGemsChangeEmitter.emit(e))}setIncludeEOTBPGemSocket(e,t){this.includeEOTBPGemSocket!==t&&(this.includeEOTBPGemSocket=t,this.includeEOTBPGemSocketChangeEmitter.emit(e))}setFreezeItemSlots(e,t){this.freezeItemSlots!==t&&(this.freezeItemSlots=t,this.frozenItemSlots.clear(),this.freezeItemSlotsChangeEmitter.emit(e))}setFrozenItemSlot(e,t,a){this.getFrozenItemSlot(t)!==a&&(this.frozenItemSlots[a?"add":"delete"](t),this.freezeItemSlotsChangeEmitter.emit(e))}setFrozenItemSlots(e,t){this.frozenItemSlots.clear(),t.forEach(e=>this.frozenItemSlots.add(e)),this.freezeItemSlotsChangeEmitter.emit(e)}getFrozenItemSlot(e){return this.frozenItemSlots.has(e)}setIncludeTimeout(e,t){this.includeTimeout!==t&&(this.includeTimeout=t,this.includeTimeoutChangeEmitter.emit(e))}buildContextMenu(e){const t=ie(e,{interactive:!0,trigger:"click",theme:"reforge-optimiser-popover",placement:"right-start",onShow:e=>{Zm("Reforge Settings","reforge-settings");const t=new gc(null,this.player,{extraCssClasses:["mb-2"],id:"reforge-optimizer-enable-custom-ep-weights",label:oe.t("sidebar.buttons.suggest_reforges.use_custom"),inline:!0,changedEvent:()=>this.useCustomEPValuesChangeEmitter,getValue:()=>this.useCustomEPValues,setValue:(e,t,a)=>{Km({action:"settings",category:"reforging",label:"use_custom_ep",value:a}),this.setUseCustomEPValues(e,a)}});let a=null;this.softCapsConfig?.length&&(a=new gc(null,this.player,{extraCssClasses:["mb-2"],id:"reforge-optimizer-enable-soft-cap-breakpoints",label:oe.t("sidebar.buttons.suggest_reforges.use_soft_cap_breakpoints"),inline:!0,changedEvent:()=>this.useSoftCapBreakpointsChangeEmitter,getValue:()=>this.useSoftCapBreakpoints,setValue:(e,t,a)=>{Km({action:"settings",category:"reforging",label:"softcap_breakpoints",value:a}),this.setUseSoftCapBreakpoints(e,a)}}));const i=new Ag(null,this.player,{extraCssClasses:["mb-2"],id:"reforge-optimizer-force-stat-proc",label:oe.t("sidebar.buttons.suggest_reforges.force_stat_proc"),defaultValue:this.relativeStatCapStat,values:[{name:oe.t("sidebar.buttons.suggest_reforges.any"),value:-1},...[...Og.relevantStats].map(e=>({name:ne.fromStat(e).getShortName(this.playerClass),value:e}))],changedEvent:()=>te.onAny([this.relativeStatCapStatChangeEmitter,this.player.gearChangeEmitter]),getValue:()=>this.relativeStatCapStat,setValue:(e,t,a)=>{this.setRelativeStatCap(te.nextEventID(),a)},showWhen:()=>{const e=Og.hasRoRo(this.player);return e&&-1!==this.relativeStatCapStat?!this.relativeStatCap&&this.relativeStatCapStat&&(this.relativeStatCap=new Og(this.relativeStatCapStat,this.player,this.playerClass)):this.relativeStatCap=null,e}}),s=new gc(null,this.player,{extraCssClasses:["mb-2"],id:"reforge-optimizer-include-gems",label:oe.t("sidebar.buttons.suggest_reforges.include_gems"),labelTooltip:oe.t("sidebar.buttons.suggest_reforges.optimize_gems_tooltip"),inline:!0,changedEvent:()=>this.includeGemsChangeEmitter,getValue:()=>this.includeGems,setValue:(e,t,a)=>{Km({action:"settings",category:"reforging",label:"include_gems",value:a}),te.freezeAllAndDo(()=>{this.setIncludeGems(e,a),this.setIncludeEOTBPGemSocket(e,this.player.sim.getPhase()>=2)})}}),o=new gc(null,this.player,{extraCssClasses:["mb-2"],id:"reforge-optimizer-include-eotbp-socket",label:oe.t("sidebar.buttons.suggest_reforges.include_eotbp_socket"),labelTooltip:oe.t("sidebar.buttons.suggest_reforges.include_eotbp_socket_tooltip"),inline:!0,changedEvent:()=>te.onAny([this.includeGemsChangeEmitter,this.includeEOTBPGemSocketChangeEmitter,this.player.gearChangeEmitter]),getValue:()=>this.includeEOTBPGemSocket,showWhen:()=>this.includeGems&&this.player.hasEotBPItemEquipped(),setValue:(e,t,a)=>{this.setIncludeEOTBPGemSocket(e,a)}}),n=new gc(null,this.player,{extraCssClasses:["mb-2"],id:"reforge-optimizer-freeze-item-slots",label:oe.t("sidebar.buttons.suggest_reforges.freeze_item_slots"),labelTooltip:oe.t("sidebar.buttons.suggest_reforges.freeze_item_slots_tooltip"),inline:!0,changedEvent:()=>this.freezeItemSlotsChangeEmitter,getValue:()=>this.freezeItemSlots,setValue:(e,t,a)=>{Km({action:"settings",category:"reforging",label:"freeze_item_slots",value:a}),this.setFreezeItemSlots(e,a)}}),r=new gc(null,this.player,{extraCssClasses:["mb-2"],id:"reforge-optimizer-include-timeout",label:oe.t("sidebar.buttons.suggest_reforges.limit_execution_time"),labelTooltip:oe.t("sidebar.buttons.suggest_reforges.limit_execution_time_tooltip"),inline:!0,changedEvent:()=>te.onAny([this.includeTimeoutChangeEmitter,this.includeGemsChangeEmitter]),getValue:()=>this.includeTimeout,setValue:(e,t,a)=>{this.setIncludeTimeout(e,a)}}),l=U();e.setContent(H(de,null,t.rootElem,H("div",{ref:l,className:xr("mb-0",this.useCustomEPValues&&"hide")},H("p",null,oe.t("sidebar.buttons.suggest_reforges.enable_modification")),H("p",null,oe.t("sidebar.buttons.suggest_reforges.modify_in_editor")),H("p",null,oe.t("sidebar.buttons.suggest_reforges.hard_cap_info"))),this.buildCapsList({useCustomEPValuesInput:t,description:l.value}),a?.rootElem,i.rootElem,this.buildSoftCapBreakpointsLimiter({useSoftCapBreakpointsInput:a}),s.rootElem,o.rootElem,r.rootElem,n.rootElem,this.buildFrozenSlotsInputs(),this.buildEPWeightsToggle({useCustomEPValuesInput:t})))},onHidden:()=>{t.setContent(H(de,null))}})}buildFrozenSlotsInputs(){const e=this.player.getGear().getItemSlots(),t=Math.floor(e.length/2)+1,a=[];for(let i=0;i<t;i++)a.push(e.slice(2*i,2*(i+1)));const s=U(),o=H("table",{className:xr("mb-2",{"d-none":!this.freezeItemSlots}),ref:s},a.map(e=>{const t=U();return H("tr",{ref:t},e.map(e=>{const t=new gc(null,this.player,{id:"reforge-optimizer-freeze-"+i[e],label:tt(e),inline:!0,changedEvent:()=>this.freezeItemSlotsChangeEmitter,getValue:()=>this.getFrozenItemSlot(e)||!1,setValue:(t,a,i)=>{this.setFrozenItemSlot(t,e,i)}});return H("td",null,t.rootElem)}))}));return this.freezeItemSlotsChangeEmitter.on(()=>{s.value?.classList[this.freezeItemSlots?"remove":"add"]("d-none")}),o}buildCapsList({useCustomEPValuesInput:e,description:t}){const a={changedEvent:e=>te.onAny([this.useSoftCapBreakpointsChangeEmitter,this.statCapsChangeEmitter])},i=U(),s=U(),o=U(),r=H("table",{ref:i,className:xr("reforge-optimizer-stat-cap-table mb-2",!this.useCustomEPValues&&"hide")},H("thead",null,H("tr",null,H("th",{colSpan:4,className:"pb-3"},H("div",{className:"d-flex"},H("h6",{className:"content-block-title mb-0 me-1"},oe.t("sidebar.buttons.suggest_reforges.edit_stat_caps")),H("button",{ref:s,className:"d-inline"},H("i",{className:"fa-regular fa-circle-question"})),H("button",{ref:o,className:"d-inline ms-auto",onclick:()=>this.setStatCaps(te.nextEventID(),this.defaults.statCaps||new n)},H("i",{className:"fas fa-arrow-rotate-left"}))))),H("tr",null,H("th",null,oe.t("sidebar.buttons.suggest_reforges.stat")),H("th",{colSpan:3,className:"text-end"},"%"),H("th",{colSpan:1,className:"text-start"},"Max?"))),H("tbody",null,this.simUI.individualConfig.displayStats.map(t=>{if(!t.hasRootStat())return;const i=t.getRootStat();if(!Mg.includes(i))return;const s=U(),o=t.getShortName(this.player.getClass()),n={getValue:()=>this.toVisualUnitStatPercentage(this.statCaps.getUnitStat(t),t),setValue:(e,a,i)=>{this.setStatCaps(te.nextEventID(),this.statCaps.withUnitStat(t,this.toDefaultUnitStatValue(i,t)))}},r=new rl(null,this.player,{id:`reforge-optimizer-${o}-percentage`,float:!0,maxDecimalDigits:5,showZeroes:!1,positive:!0,extraCssClasses:["mb-0"],enableWhen:()=>this.isAllowedToOverrideStatCaps||!this.softCapsConfig.some(e=>e.unitStat.equals(t)),...a,...n}),l=new gc(null,this.player,{id:`reforge-optimizer-${o}-undershoot`,label:"",inline:!1,changedEvent:()=>this.undershootCapsChangeEmitter,getValue:()=>this.undershootCaps.getUnitStat(t)>0,setValue:(e,a,i)=>{this.undershootCaps=this.undershootCaps.withUnitStat(t,i?1:0)}}),c=this.statSelectionPresets?.find(e=>e.unitStat.equals(t))?.presets,h=c?new Ag(null,this.player,{id:`reforge-optimizer-${o}-presets`,extraCssClasses:["mb-0"],label:"",values:[{name:oe.t("sidebar.buttons.suggest_reforges.select_preset"),value:0},...[...c.keys()].map(e=>{const t=c.get(e);return{name:`${e} - ${t.toFixed(2)}%`,value:t}})].sort((e,t)=>e.value-t.value),enableWhen:()=>this.isAllowedToOverrideStatCaps||!this.softCapsConfig.some(e=>e.unitStat.equals(t)),...a,...n}):null,d=this.statTooltips[i],u=U(),p=H(de,null,H("tr",{ref:s,className:"reforge-optimizer-stat-cap-item"},H("td",null,H("div",{className:"reforge-optimizer-stat-cap-item-label"},o," ",d&&H("button",{ref:u,className:"d-inline"},H("i",{className:"fa-regular fa-circle-question"})))),H("td",{colSpan:3},r.rootElem),H("td",{colSpan:1,className:"text-end"},l.rootElem)),h&&H("tr",null,H("td",null),H("td",{colSpan:3},h.rootElem))),m=d?ie(u.value,{content:d}):null;return e.addOnDisposeCallback(()=>m?.destroy()),p})));if(s.value){const t=ie(s.value,{content:oe.t("sidebar.buttons.suggest_reforges.stat_caps_tooltip")});e.addOnDisposeCallback(()=>t.destroy())}if(o.value){const t=ie(o.value,{content:oe.t("sidebar.buttons.suggest_reforges.reset_to_defaults")});e.addOnDisposeCallback(()=>t.destroy())}const l=this.useCustomEPValuesChangeEmitter.on(()=>{i.value?.classList[this.useCustomEPValues?"remove":"add"]("hide"),t?.classList[this.useCustomEPValues?"add":"remove"]("hide")});return e.addOnDisposeCallback(()=>{r.remove(),l.dispose(),this.undershootCaps=new n}),r}buildEPWeightsToggle({useCustomEPValuesInput:e}){const t=["mt-3"];this.useCustomEPValues||t.push("hide");const a=Rg(null,this.simUI,{extraCssClasses:t,loadOnly:!0}),i=this.useCustomEPValuesChangeEmitter.on(()=>{const e=this.useCustomEPValues;a.rootElem?.classList[e?"remove":"add"]("hide")});return e.addOnDisposeCallback(()=>{a.dispose(),a.rootElem.remove(),i.dispose()}),H(de,null,a.rootElem,this.simUI.epWeightsModal&&H("button",{className:"btn btn-outline-primary mt-2",onclick:()=>{this.simUI.epWeightsModal?.open(),at()}},oe.t("sidebar.buttons.suggest_reforges.edit_weights")))}buildSoftCapBreakpointsLimiter({useSoftCapBreakpointsInput:e}){if(!this.enableBreakpointLimits||!e)return null;const t=U(),a=U(),i=H("table",{ref:t,className:xr("reforge-optimizer-stat-cap-table mb-2",!this.useSoftCapBreakpoints&&"hide")},H("thead",null,H("tr",null,H("th",{colSpan:3,className:"pb-3"},H("div",{className:"d-flex"},H("h6",{className:"content-block-title mb-0 me-1"},oe.t("sidebar.buttons.suggest_reforges.breakpoint_limit")),H("button",{ref:a,className:"d-inline"},H("i",{className:"fa-regular fa-circle-question"})))))),H("tbody",null,this.softCapsConfig.filter(e=>(e.capType===J.TypeThreshold||e.capType===J.TypeSoftCap)&&e.breakpoints.length>1).map(({breakpoints:e,unitStat:t})=>{if(!t.hasRootStat())return;const a=t.getRootStat();if(!Mg.includes(a))return;const i=U(),s=t.getShortName(this.player.getClass()),o=e?new Ag(null,this.player,{id:`reforge-optimizer-${s}-presets`,extraCssClasses:["mb-0"],label:"",values:[{name:oe.t("sidebar.buttons.suggest_reforges.no_limit_set"),value:0},...e.map(e=>({name:`${this.breakpointValueToDisplayPercentage(e,t)}%`,value:e}))].sort((e,t)=>e.value-t.value),changedEvent:e=>te.onAny([this.useSoftCapBreakpointsChangeEmitter]),getValue:()=>{let a=this.breakpointLimits.getUnitStat(t);return e.some(e=>e==a)||(a=0),a},setValue:(e,a,i)=>{this.setBreakpointLimits(e,this.breakpointLimits.withUnitStat(t,i))}}):null;if(!o?.rootElem)return null;return H(de,null,H("tr",{ref:i,className:"reforge-optimizer-stat-cap-item"},H("td",null,H("div",{className:"reforge-optimizer-stat-cap-item-label"},s)),H("td",{colSpan:2},o.rootElem)))})));if(a.value){const t=ie(a.value,{content:oe.t("sidebar.buttons.suggest_reforges.breakpoint_limit_tooltip")});e.addOnDisposeCallback(()=>t.destroy())}const s=this.useSoftCapBreakpointsChangeEmitter.on(()=>{const e=this.useSoftCapBreakpoints;t.value?.classList[e?"remove":"add"]("hide")});return e.addOnDisposeCallback(()=>{i.remove(),s?.dispose()}),i}get isAllowedToOverrideStatCaps(){return!(this.useSoftCapBreakpoints&&this.softCapsConfig)}get processedStatCaps(){let e=this.statCaps;return this.isAllowedToOverrideStatCaps||this.softCapsConfigWithLimits.forEach(({unitStat:t})=>{e=e.withUnitStat(t,0)}),e}async optimizeReforges(e){this.previousGear=this.player.getGear(),this.previousReforges=this.previousGear.getAllReforges();let t=this.previousGear.withoutReforges(this.player.canDualWield2H(),this.frozenItemSlots);this.includeGems&&(t=t.withoutGems(this.player.canDualWield2H(),this.frozenItemSlots,!0));const a=await this.updateGear(t);let i=a.computeStatCapsDelta(this.processedStatCaps);this.player.getSpec()==K.SpecGuardianDruid&&(i=i.withPseudoStat(T.PseudoStatMeleeHastePercent,i.getPseudoStat(T.PseudoStatMeleeHastePercent)/1.5));const s=this.computeReforgeSoftCaps(a);let o=Gg.checkWeights(this.preCapEPs,i,s);this.relativeStatCap&&(o=this.relativeStatCap.updateWeights(o));const n=this.buildYalpsVariables(t,o,i,s),r=this.buildYalpsConstraints(t,a);await this.solveModel(t,o,i,s,n,r,5e6,(this.includeTimeout?this.relativeStatCap?120:30:3600)/(e?4:1)),this.currentReforges=this.player.getGear().getAllReforges()}async updateGear(e){await this.player.setGearAsync(te.nextEventID(),e);let t=n.fromProto(this.player.getCurrentStats().finalStats);return t=t.addStat(ee.StatMasteryRating,this.player.getBaseMastery()*le),this.updateGearStatsModifier&&(t=this.updateGearStatsModifier(t)),t}computeReforgeSoftCaps(e){const t=[];return this.isAllowedToOverrideStatCaps||this.softCapsConfigWithLimits.slice().forEach(a=>{let i=a.postCapEPs.slice();const s=[];for(const t of a.breakpoints)s.push(e.computeGapToCap(a.unitStat,t));a.capType==J.TypeThreshold&&(s.reverse(),i=Array(s.length).fill(i[0])),t.push(new Je(a.unitStat,s,a.capType,i))}),t}buildYalpsVariables(e,a,s,o){const r=new Map,l=this.simUI.individualConfig.epStats,c=this.buildGemOptions(a,s,o);for(const h of e.getItemSlots()){const d=e.getEquippedItem(h);if(!d||this.getFrozenItemSlot(h))continue;const u=d.withDynamicStats();for(const e of this.player.getAvailableReforgings(u)){if(!l.includes(e.toStat)&&e.toStat!=ee.StatExpertiseRating)continue;const t=`${h}_${e.id}`,s=new Map;s.set(i[h],1),this.applyReforgeStat(s,e.fromStat,e.fromAmount,a),this.applyReforgeStat(s,e.toStat,e.toAmount,a),r.set(t,s)}if(!this.includeGems)continue;const p=d.item,m=d.curSocketColors(this.player.isBlacksmithing());this.includeEOTBPGemSocket||!kr(p)&&!_r(p)||m.pop();let g=m.length||1;g>1&&m[0]===t.GemColorMeta&&(g-=1);const f=new n(u.item.socketBonus).scale(1/g).getBuffedStats();let b=!1;const y=new Map;for(const[e,t]of f.entries())this.applyReforgeStat(y,e,t,a);Gg.includesCappedStat(y,s,o)&&g>1&&(b=!0);const w=new Map;w.set("matched",new Map),w.set("unmatched",new Map);for(const e of m.values()){if(![t.GemColorRed,t.GemColorBlue,t.GemColorYellow,t.GemColorPrismatic].includes(e))break;const a=w.get("matched"),i=c.get(e).at(-1);for(const[e,t]of i.coefficients.entries())a.set(e,(a.get(e)||0)+t);for(const[e,t]of y.entries())a.set(e,(a.get(e)||0)+t);const s=w.get("unmatched"),o=c.get(t.GemColorPrismatic).at(-1);for(const[e,t]of o.coefficients.entries())s.set(e,(s.get(e)||0)+t)}const v=this.updateReforgeScores(w,a);v.get("matched").get("score")>v.get("unmatched").get("score")&&(g>1||!Gg.includesCappedStat(v.get("matched"),s,o))&&(b=!0),m.forEach((e,i)=>{let s=[];if([t.GemColorPrismatic,t.GemColorCogwheel,t.GemColorShaTouched].includes(e))s.push(e);else{if(![t.GemColorRed,t.GemColorBlue,t.GemColorYellow].includes(e))return;s.push(e),b||s.push(t.GemColorPrismatic)}const o=`${h}_${i}`;for(const n of s)for(const i of c.get(n)){const s=`${o}_${i.gem.id}`,l=new Map(i.coefficients);if(l.set(o,1),rr(i.gem,e))for(const[e,t]of f.entries())this.applyReforgeStat(l,e,t,a);else if(i.isJC)continue;n==t.GemColorCogwheel&&l.set(`${i.gem.id}`,1),n==t.GemColorShaTouched&&l.set("ShaTouchedGem",1),i.isJC&&l.set("JewelcraftingGem",1),r.set(s,l)}})}return r}buildGemOptions(e,i,s){const o=new Map;if(!this.includeGems)return o;const n=this.player.hasProfession(a.Jewelcrafting),r=this.simUI.individualConfig.epStats;for(const l of[t.GemColorPrismatic,t.GemColorShaTouched,t.GemColorCogwheel,t.GemColorRed,t.GemColorBlue,t.GemColorYellow]){const c=this.player.getGems(l),h=new Array;let d=e;this.relativeStatCap&&(d=d.withUnitStat(this.relativeStatCap.forcedHighestStat,d.getUnitStat(this.relativeStatCap.constrainedStats[0])));for(const e of c){const t=e.requiredProfession==a.Jewelcrafting;if(t&&!n||t&&!this.isTankSpec&&!hr(e,[ee.StatStrength,ee.StatAgility,ee.StatIntellect])||this.isHybridCaster&&e.stats[ee.StatHitRating]||e.name.includes("Perfect")||!rr(e,l))continue;let i=!0;const s=new Map;for(const[a,n]of e.stats.entries())if(0!=n){if(!r.includes(a)&&a!=ee.StatExpertiseRating){i=!1;break}this.applyReforgeStat(s,a,n,d)}if(!i)continue;const o=new Map([["temp",s]]),c=this.updateReforgeScores(o,d);h.push({gem:e,isJC:t,coefficients:c.get("temp")})}h.sort((e,t)=>t.coefficients.get("score")-e.coefficients.get("score"));let u=this.isTankSpec?3:4;if(l==t.GemColorYellow&&!this.relativeStatCap){let e=!1;for(const t of[ee.StatCritRating,ee.StatHasteRating])for(const a of ne.getChildren(t))Qe(a,i,s)&&(e=!0);e||(u=1)}const p=new Array;let m=!1,g=!1,f=0;const b=new Map;for(const e of h){const a=Gg.getCappedStatKeys(e.coefficients,i,s);let o=!1;for(const t of a){const a=b.get(t)||0;a==u?o=!0:e.isJC||b.set(t,a+1)}if(e.isJC&&m||o||0!=a.length&&g||p.push(e),0==a.length&&l!=t.GemColorCogwheel)if(e.isJC)m=!0;else if(g=!0,f++,!this.relativeStatCap||3==f)break}o.set(l,p)}return o}applyReforgeStat(e,t,a,i){if(t==ee.StatSpirit&&this.player.getRace()==Y.RaceHuman&&(a*=1.03),(t==ee.StatSpirit&&this.isHybridCaster||t==ee.StatExpertiseRating)&&this.setPseudoStatCoefficient(e,T.PseudoStatSpellHitPercent,a/it),this.relativeStatCap?.updateCoefficients(e,t,a),0==i.getStat(t))for(const s of ne.getChildren(t))0!=i.getPseudoStat(s)&&this.setPseudoStatCoefficient(e,s,ne.fromPseudoStat(s).convertRatingToPercent(a));else this.setStatCoefficient(e,t,a)}setStatCoefficient(e,t,a){const i=e.get(ee[t])||0;e.set(ee[t],i+a)}setPseudoStatCoefficient(e,t,a){const i=e.get(T[t])||0;e.set(T[t],i+a)}buildYalpsConstraints(e,a){const s=new Map,o=this.includeGems?this.player.getGems(t.GemColorCogwheel):[];for(const t of e.getItemSlots())if(s.set(i[t],og(1)),this.includeGems){e.getEquippedItem(t)?.curSocketColors(this.player.isBlacksmithing()).forEach((e,a)=>{s.set(`${t}_${a}`,og(1))}),s.set("ShaTouchedGem",og(1)),s.set("JewelcraftingGem",og(2));for(const e of o)e.unique&&s.set(`${e.id}`,og(1))}return this.relativeStatCap&&this.relativeStatCap.updateConstraints(s,e,a),s}async solveModel(e,t,a,i,s,o,n,r){const l=this.updateReforgeScores(s,t),c={objective:"score",constraints:o,variables:l},h={timeout:1e3*r,maxIterations:n,tolerance:.01},d=Date.now(),u=Eg(c,h),p=(Date.now()-d)/1e3;if(isNaN(u.result)||"timedout"==u.status&&n<4e6&&p<r){if(n>4e6||p>r)throw"infeasible"==u.status?"The specified stat caps are impossible to achieve. Consider changing any upper bound stat caps to lower bounds instead.":"timedout"==u.status&&this.includeTimeout?'Solver timed out before finding a feasible solution. Consider un-checking "Limit execution time" in the Reforge settings.':u.status;return await this.solveModel(e,t,a,i,s,o,10*n,r-p)}const m=await this.applyLPSolution(e,u),[g,f,b]=this.checkCaps(u,a,i,l,o,t);return g?(await st(100),await this.solveModel(m,b,a,i,l,f,n,r-p)):u.result}updateReforgeScores(e,t){const a=new Map;for(const[i,s]of e.entries()){let e=0;const o=new Map;for(const[a,i]of s.entries())if(o.set(a,i),a.includes("PseudoStat")){const s=T[a];e+=t.getPseudoStat(s)*i}else if(a.includes("Stat")){const s=ee[a];e+=t.getStat(s)*i}o.set("score",e),a.set(i,o)}return a}async applyLPSolution(e,t){let a=e.withoutReforges(this.player.canDualWield2H(),this.frozenItemSlots);this.includeGems&&(a=a.withoutGems(this.player.canDualWield2H(),this.frozenItemSlots,!0));for(const[i,s]of t.variables){const e=i.split("_"),t=parseInt(e[0]),s=a.getEquippedItem(t);if(s){if(e.length>2){const i=parseInt(e[1]),s=parseInt(e[2]);a=a.withGem(t,i,this.sim.db.lookupGem(s));continue}const i=parseInt(e[1]);a=a.withEquippedItem(t,s.withReforge(this.sim.db.getReforgeById(i)),this.player.canDualWield2H())}}return this.includeGems&&(a=this.minimizeRegems(a)),await this.updateGear(a),a}checkCaps(e,t,a,i,s,o){let r=new n;for(const[n,d]of e.variables)for(const[e,t]of i.get(n).entries())if(e.includes("PseudoStat")){const a=T[e];r=r.addPseudoStat(a,t)}else if(e.includes("Stat")){const a=ee[e];r=r.addStat(a,t)}let l=!1;const c=new Map(s);let h=o;for(const[n,d]of r.asUnitStatArray()){const e=t.getUnitStat(n),a=n.getKey();0!==e&&d>e&&!s.has(a)&&(l=!0,this.undershootCaps.getUnitStat(n)?c.set(a,og(e)):(c.set(a,ng(e)),h=h.withUnitStat(n,0)))}for(;!l&&a.length>0;){const e=a[0],t=e.unitStat,i=t.getKey(),s=r.getUnitStat(t);let o=0;for(const a of e.breakpoints){if(s>a){c.set(i,ng(a)),h=h.withUnitStat(t,e.postCapEPs[o]),l=!0;break}o++}e.capType==J.TypeSoftCap&&(e.breakpoints=e.breakpoints.slice(o+1),e.postCapEPs=e.postCapEPs.slice(o+1)),e.capType!=J.TypeThreshold&&0!=e.breakpoints.length||a.shift()}return[l,c,h]}minimizeRegems(e){const t=this.previousGear;if(!t)return e;const a=this.player.isBlacksmithing(),i=[];for(const s of e.getItemSlots()){const o=e.getEquippedItem(s),n=t.getEquippedItem(s);if(!o||!n)continue;const r=o.curGems(a),l=n.curGems(a);for(const[t,c]of o.curSocketColors(a).entries()){const o=`${s}_${t}`;if(!i.includes(o)&&(i.push(o),r[t]&&l[t]&&r[t].id!==l[t].id&&(!rr(r[t],c)||rr(l[t],c))))for(const[n,c]of e.findGem(l[t],a)){if(this.frozenItemSlots.has(n))continue;const o=`${n}_${c}`;if(i.includes(o))continue;const h=e.getEquippedItem(n).curSocketColors(a)[c];if(!rr(l[t],h)||rr(r[t],h)){i.push(o),e=(e=e.withGem(s,t,l[t])).withGem(n,c,r[t]);break}}}}return e}get baseMastery(){return this.player.getBaseMastery()*le}toVisualTotalMasteryPercentage(e,t){return t-this.baseMastery<=0?e=0:e*=this.player.getMasteryPerPointModifier(),e}toVisualUnitStatPercentage(e,t){const a=e;let i=t.convertDefaultUnitsToPercent(a);return t.equalsStat(ee.StatMasteryRating)&&(i=this.toVisualTotalMasteryPercentage(i,a)),i}toDefaultUnitStatValue(e,t){let a=t.convertPercentToDefaultUnits(e);return t.equalsStat(ee.StatMasteryRating)&&(a/=this.player.getMasteryPerPointModifier()),a}breakpointValueToDisplayPercentage(e,t){return t.equalsStat(ee.StatMasteryRating)?(e/le*this.player.getMasteryPerPointModifier()).toFixed(2):t.convertDefaultUnitsToPercent(e).toFixed(2)}onReforgeDone(){const e=this.player.getGear().getItemSlots(),t=new Map;for(const o of e){const e=this.previousReforges.get(o),a=this.currentReforges.get(o);_.equals(e?.reforge,a?.reforge)||t.set(o,a)}const a=t.size,i=U(),s=H(de,null,H("p",{className:"mb-0"},oe.t("gear_tab.reforge_success.title")),H("ul",null,[...t].map(([e,t])=>{if(t){const a=tt(e),{fromStat:i,toStat:s}=t,o=ot(i),n=ot(s);return H("li",null,a,": ",o,"  ",n)}return H("li",null,tt(e),": ",oe.t("gear_tab.reforge_success.removed_reforge"))})),H("div",{ref:i}));if(a){const e=nt.toJson(this.simUI.toProto());e&&new Tg(i.value,{extraCssClasses:["btn-outline-primary"],getContent:()=>JSON.stringify(e),text:oe.t("gear_tab.reforge_success.copy_to_reforge_lite")})}Km({action:"settings",category:"reforging",label:"suggest_success"}),new Dg({variant:"success",body:a?s:H(de,null,oe.t("gear_tab.reforge_success.no_changes")),delay:a?5e3:3e3})}onReforgeError(e){this.previousGear&&this.updateGear(this.previousGear),Km({action:"settings",category:"reforging",label:"suggest_error",value:e}),new Dg({variant:"error",body:H(de,null,oe.t("sidebar.buttons.suggest_reforges.reforge_optimization_failed"),H("p",null),H("p",null,H("b",null,"Reason for failure:")," ",H("i",null,e))),delay:1e4})}fromProto(e,t){te.freezeAllAndDo(()=>{this.setUseCustomEPValues(e,t.useCustomEpValues),this.setStatCaps(e,n.fromProto(t.statCaps)),this.setUseSoftCapBreakpoints(e,t.useSoftCapBreakpoints),this.setIncludeTimeout(e,t.includeTimeout),this.setIncludeGems(e,t.includeGems),this.setIncludeEOTBPGemSocket(e,t.includeEotbGemSocket),this.setFreezeItemSlots(e,t.freezeItemSlots),this.setFrozenItemSlots(e,t.frozenItemSlots),this.setBreakpointLimits(e,n.fromProto(t.breakpointLimits)),t.relativeStatCapStat&&this.setRelativeStatCap(e,ne.fromProto(t.relativeStatCapStat).getStat())})}toProto(){return rt.create({useCustomEpValues:this.useCustomEPValues,useSoftCapBreakpoints:this.useSoftCapBreakpoints,includeTimeout:this.includeTimeout,includeGems:this.includeGems,includeEotbGemSocket:this.includeEOTBPGemSocket,freezeItemSlots:this.freezeItemSlots,frozenItemSlots:[...this.frozenItemSlots],breakpointLimits:this.breakpointLimits.toProto(),relativeStatCapStat:this.relativeStatCap?.forcedHighestStat.toProto(),statCaps:this.statCaps.toProto()})}applyDefaults(e){te.freezeAllAndDo(()=>{this.setUseCustomEPValues(e,!1),this.setUseSoftCapBreakpoints(e,!!this.simUI.individualConfig.defaults.softCapBreakpoints?.length),this.setIncludeTimeout(e,!0),this.setIncludeGems(e,!1),this.setIncludeEOTBPGemSocket(e,!1),this.setFreezeItemSlots(e,!1),this.setStatCaps(e,this.simUI.individualConfig.defaults.statCaps||new n),this.setBreakpointLimits(e,this.simUI.individualConfig.defaults.breakpointLimits||new n),this.setSoftCapBreakpoints(e,this.simUI.individualConfig.defaults.softCapBreakpoints||[]),this.setRelativeStatCap(e,this.relativeStatCapStat)})}}const zg=({children:e,buttonClassName:t,linkRef:a,...i})=>"href"in i&&i.href?H("a",{ref:a,href:i.href,target:"_blank",className:xr(t)},e):H("button",{type:"button",ref:a,className:xr(t)},e),Fg=({ref:e,linkRef:t,iconRef:a,icon:i,className:s,children:o,...n})=>H("div",{ref:e,className:"sim-toolbar-item"},H(zg,{linkRef:t,className:xr(s),...n},i&&H("i",{ref:a,className:i}),o)),Hg=H("ul",{className:"text-start ps-3 mb-0"});class Ug extends F{constructor(e){super(e,"results-viewer"),this.warnings=[],this.warningsTooltip=null;const t=U(),a=U(),i=U(),s=U();this.rootElem.appendChild(H(de,null,H("div",{ref:t,className:"results-pending"},H("div",{className:"loader"})),H("div",{ref:a,className:"results-content"}),H("div",{ref:s,className:"button-zone text-center"}),H("div",{ref:i,className:"warning-zone text-center"}))),this.pendingElem=t.value,this.contentElem=a.value,this.warningElem=i.value,this.buttonWrapperElem=s.value,this.warningsLink=this.addWarningsLink(),this.updateWarnings(),this.hideAll()}addWarningLink({parent:e,tooltip:t,classes:a,text:i,...s}){const o=U();return e.appendChild(H(Fg,{linkRef:o,buttonClassName:a,...s},i)),t&&(this.warningsTooltip=ie(o.value,{appendTo:"parent",content:t,placement:"bottom",inlinePositioning:!0,plugins:[lt]})),o.value}addWarningsLink(){return this.addWarningLink({parent:this.warningElem,icon:"fas fa-exclamation-triangle fa-3x",tooltip:Hg,classes:"warning link-warning"})}addWarning(e){this.warnings.push(e),e.updateOn.on(()=>this.updateWarnings()),this.updateWarnings()}updateWarnings(){const e=this.warnings.map(e=>e.getContent()).flat().filter(e=>""!==e),t=this.warningsTooltip?.props.content?.cloneNode(!0)||H(de,null);t&&(t.innerHTML=""),t.appendChild(H(de,null,e?.map(e=>H("li",null,e)))),this.warningsLink.parentElement?.classList?.[e.length?"remove":"add"]("hide"),this.warningsTooltip?.setContent(t)}hideAll(){this.contentElem.style.display="none",this.pendingElem.style.display="none",this.buttonWrapperElem.style.display="none"}setPending(){this.contentElem.style.display="none",this.pendingElem.style.display="block"}setContent(e){"string"==typeof e?this.contentElem.innerHTML=e:this.contentElem.replaceChildren(e),this.contentElem.style.display="block",this.pendingElem.style.display="none"}addAbortButton(e){const t=U();this.buttonWrapperElem.replaceChildren(H("button",{ref:t,className:"sim-abort-button",onclick:a=>{t.value&&(t.value.disabled=!0,t.value.innerText="Stopping..."),e?.(a)}},H("i",{className:"fa fa-times fa-lg me-1"}),"Stop")),this.buttonWrapperElem.style.display="block"}removeAbortButton(){this.buttonWrapperElem.replaceChildren(),this.buttonWrapperElem.style.display="none"}}class Bg extends F{constructor(e,t,a){super(e,"sim-tab"),this.rootElem.classList.add(a.identifier),this.simUI=t,this.config=a,this.rootElem.id=this.config.identifier,this.rootElem.classList.add("tab-pane","fade"),0==e.childNodes.length&&this.rootElem.classList.add("active","show"),this.navItem=this.buildNavItem(),this.navLink=this.navItem.children[0],this.contentContainer=document.createElement("div"),this.contentContainer.classList.add("tab-pane-content-container"),this.rootElem.appendChild(this.contentContainer),this.simUI.simHeader.addSimTabLink(this),this.navItem.addEventListener("click",()=>{Zm(a.title,a.identifier)})}buildNavItem(){const e=document.createElement("fragment");return e.innerHTML=`\n\t\t\t<li class="${this.config.identifier} nav-item" role="presentation">\n\t\t\t\t<button\n\t\t\t\t\tclass="nav-link"\n\t\t\t\t\ttype="button"\n\t\t\t\t\tdata-bs-toggle="tab"\n\t\t\t\t\tdata-bs-target="#${this.config.identifier}"\n\t\t\t\t\trole="tab"\n\t\t\t\t\taria-controls="${this.config.identifier}"\n\t\t\t\t>${this.config.title}</button>\n\t\t\t</li>\n\t\t`,e.children[0]}buildColumn(e,t){const a=document.createElement("div");return a.classList.add("tab-panel-col",`${t}-${e}`),a}}const Wg=()=>H("p",{className:"mb-0"},"Want to help out by providing additional information? Contact us on our Discord!"),Vg=H("p",{className:"mb-0"},"Please select a random suffix"),jg=H(de,null,H("p",{className:"fw-bold"},"This item effect (on-use or proc) is not implemented!"),H("p",null,"We are working hard on gathering all the old resources to allow for an initial implementation."),H(Wg,null)),Yg=H(de,null,H("p",null,"This item ",H("span",{className:"fw-bold"},"is")," implemented, but detailed proc behavior will be confirmed on PTR."),H(Wg,null)),qg=H(de,null,"The equip/use effect on this item will not be implemented!"),Xg=new Map([...[].map(e=>[e,{[K.SpecUnknown]:qg}]),...[95346,95347,95344].map(e=>[e,{[K.SpecUnknown]:Yg}]),...[77530,81136,84373,84835,85028,88585,91149,91150,91502,93454,94364,94525,95763,96135,96507,96879,98785,99807,100034,100245,100594,101038,101102,101135,101179,101247,102247,102294,102295,102299,102302,102303,102304,102305,102308,102309,102310,102311,102650,102847,103180,103377,103678,104313,104463,104478,104553,104576,104584,104611,104613,104616,104619,104636,104652,104712,104727,104802,104825,104833,104860,104862,104865,104868,104885,104901,104961,104976,105051,105074,105082,105109,105111,105114,105117,105134,105150,105210,105225,105300,105323,105331,105358,105360,105363,105366,105383,105399,105459,105474,105549,105572,105580,105607,105609,105612,105615,105632,105648].map(e=>[e,{[K.SpecUnknown]:jg}]),...[94523,95665,96037,96409,96781].map(e=>[e,{[K.SpecUnknown]:H(de,null,H("p",null,"The Agility proc on this trinket has been implemented, but the Voodoo Gnomes are ",H("span",{className:"fw-bold"},"not")," implemented. The DPS gain of these is around ~40 DPS."))}])]),$g=new Map([[2,"Not yet implemented"],[4,"Not yet implemented"]]),Zg=new Map([[1182,new Map([[2,"Implementation needs testing on PTR"],[4,"Not yet implemented"]])],[1196,null]]);let Kg=null;async function Jg(e){return(await(null==Kg&&(Kg=fetch("/mop/assets/enchants/descriptions.json").then(e=>e.json()).then(e=>{const t={};for(const a in e)t[parseInt(a)]=e[a];return t})),Kg))[e.effectId]||e.name}function Qg(e){return e.effectId+"-"+e.type}class ef extends F{constructor(e,t){super(null,"item-notice"),this.tooltip=null,this.rootElem.classList.add("d-inline"),this.itemId=t.itemId,this.player=e,this.additionalNoticeData=t.additionalNoticeData,this.hasNotice&&this.template&&this.rootElem.appendChild(this.template),this.addOnDisposeCallback(()=>{this.tooltip?.destroy(),this.rootElem?.remove()})}get hasNotice(){return Xg.has(this.itemId)||!!this.additionalNoticeData}get noticeContent(){if(!this.hasNotice)return null;const e=Xg.get(this.itemId),t=e?.[K.SpecUnknown],a=e?.[this.player.getSpec()],i=[];return a?i.push(a?.cloneNode(!0)):t&&i.push(t?.cloneNode(!0)),this.additionalNoticeData&&i.push(this.additionalNoticeData.cloneNode(!0)),i.length?H(de,null,i.map(e=>e)):null}get template(){if(!this.hasNotice)return null;const e=this.noticeContent;if(!e)return null;const t=U(),a=H("button",{ref:t,className:"warning fa fa-exclamation-triangle fa-xl me-2"});return this.tooltip=ie(t.value,{content:e}),a}static registerSetBonusNotices(e){Zg.forEach((t,a)=>{const i=t||$g,s=H(de,null,H("p",{className:"mb-1"}," This item set has the following warnings:"),H("ul",{className:"mb-0"},Array.from(i.keys()).map(e=>H("li",null,e.toFixed(0),"-piece: ",i.get(e)))));for(const o of e.getItemIdsForSet(a))Xg.set(o,{[K.SpecUnknown]:s})})}}class tf{constructor(e){this.tooltip=null,this.config=e,this.item=e.item,this.attachTooltip()}attachTooltip(){const e={trigger:"mouseenter",triggerTarget:this.config.tippyElement,interactive:!0,interactiveBorder:10,offset:[0,5],animation:!1,placement:"bottom",theme:"tooltip-quick-swap",content:()=>this.buildList(),onCreate:e=>{e.popper.addEventListener("click",()=>e.hide())},onShow:e=>{at({exclude:e})},...this.config.tippyConfig};this.tooltip=ie(this.config.tippyElement,e)}update(e){this.config={...this.config,...e},e.item&&(this.item=e.item),this.tooltip?.setContent(this.buildList())}buildList(){return af(this.config)}}const af=e=>{const t=e.getItems(e.item);return H(de,null,H("h3",{className:"tooltip-quick-swap__title h6 text-center"},e.title),t.length?H("ul",{className:"tooltip-quick-swap__list"},t.map(t=>{const a=U(),i=U(),s=U(),o=H("li",{className:"tooltip-quick-swap__list-item"},H("a",{ref:a,href:"javascript:void(0)",className:"tooltip-quick-swap__anchor d-flex align-items-center "+(t.active?" active":""),onclick:a=>{a?.preventDefault(),e.onItemClick(t.item)}},H("img",{ref:i,alt:t.item.name,className:"tooltip-quick-swap__icon gem-icon flex-shrink-0"}),H("span",{ref:s,className:"tooltip-quick-swap__label text-start"},t.item.name)));return s.value&&jr(s.value,t.item.quality),("spellId"in t.item?Lr.fromSpellId(t.item.spellId):Lr.fromItemId(t.item.id)).fill().then(e=>{e.setWowheadHref(a.value),i.value.src=e.iconUrl}),o})):H("p",{className:"tooltip-quick-swap__empty"},e.emptyMessage),e.footerButton&&H("div",{className:"tooltip-quick-swap__footer d-flex justify-content-center"},H("button",{onclick:e.footerButton.onClick,className:"btn btn-sm btn-primary"},e.footerButton.label)))},sf={[i.ItemSlotHead]:"/mop/assets/item_slots/head.jpg",[i.ItemSlotNeck]:"/mop/assets/item_slots/neck.jpg",[i.ItemSlotShoulder]:"/mop/assets/item_slots/shoulders.jpg",[i.ItemSlotBack]:"/mop/assets/item_slots/shirt.jpg",[i.ItemSlotChest]:"/mop/assets/item_slots/chest.jpg",[i.ItemSlotWrist]:"/mop/assets/item_slots/wrists.jpg",[i.ItemSlotHands]:"/mop/assets/item_slots/hands.jpg",[i.ItemSlotWaist]:"/mop/assets/item_slots/waist.jpg",[i.ItemSlotLegs]:"/mop/assets/item_slots/legs.jpg",[i.ItemSlotFeet]:"/mop/assets/item_slots/feet.jpg",[i.ItemSlotFinger1]:"/mop/assets/item_slots/finger.jpg",[i.ItemSlotFinger2]:"/mop/assets/item_slots/finger.jpg",[i.ItemSlotTrinket1]:"/mop/assets/item_slots/trinket.jpg",[i.ItemSlotTrinket2]:"/mop/assets/item_slots/trinket.jpg",[i.ItemSlotMainHand]:"/mop/assets/item_slots/mainhand.jpg",[i.ItemSlotOffHand]:"/mop/assets/item_slots/offhand.jpg"};function of(e){return sf[e]}const nf=e=>H("small",{className:"heroic-label"},"(",e,")"),rf=(e,t,a)=>{const i=U(),s=U(),o=H("a",{ref:s,className:"gem-socket-container",href:"javascript:void(0)",dataset:{socketIdx:a}},H("img",{ref:i,className:"gem-icon "+(t?"":"hide")}),H("img",{className:"socket-icon",src:fr(e)}));return t&&Lr.fromItemId(t.id).fill().then(e=>{e.setWowheadHref(s.value),i.value.src=e.iconUrl}),o};class lf extends F{constructor(e,t,a){super(e,"gear-picker-root");const s=U(),o=U();this.rootElem.appendChild(H(de,null,H("div",{ref:s,className:"gear-picker-left tab-panel-col"}),H("div",{ref:o,className:"gear-picker-right tab-panel-col"})));const n=[i.ItemSlotHead,i.ItemSlotNeck,i.ItemSlotShoulder,i.ItemSlotBack,i.ItemSlotChest,i.ItemSlotWrist,i.ItemSlotMainHand,i.ItemSlotOffHand].map(e=>new hf(s.value,this,t,a,e)),r=[i.ItemSlotHands,i.ItemSlotWaist,i.ItemSlotLegs,i.ItemSlotFeet,i.ItemSlotFinger1,i.ItemSlotFinger2,i.ItemSlotTrinket1,i.ItemSlotTrinket2].map(e=>new hf(o.value,this,t,a,e));this.itemPickers=n.concat(r).sort((e,t)=>e.slot-t.slot),this.selectorModal=new wk(t.rootElem,t,a,this,{id:"gear-picker-selector-modal"})}}class cf extends F{constructor(e,t,a){super(e,"item-picker-root",t),this.notice=null,this.socketsElem=[],this.player=a;const i=U(),s=U(),o=U(),n=U(),r=U(),l=U(),c=U(),h=U();this.rootElem.appendChild(H(de,null,H("div",{className:"item-picker-icon-wrapper"},H("span",{className:"item-picker-ilvl",ref:n}),H("a",{ref:i,className:"item-picker-icon",href:"javascript:void(0)",attributes:{role:"button"}}),H("div",{ref:h,className:"item-picker-sockets-container"})),H("div",{className:"item-picker-labels-container"},H("div",{ref:s,className:"item-picker-name-row d-flex gap-1"},H("a",{ref:o,className:"item-picker-name-container",href:"javascript:void(0)",attributes:{role:"button"}})),H("a",{ref:r,className:"item-picker-enchant hide",href:"javascript:void(0)",attributes:{role:"button"}}),H("a",{ref:l,className:"item-picker-tinker hide",href:"javascript:void(0)",attributes:{role:"button"}}),H("a",{ref:c,className:"item-picker-reforge hide",href:"javascript:void(0)",attributes:{role:"button"}})))),this.iconElem=i.value,this.nameContainerElem=s.value,this.nameElem=o.value,this.ilvlElem=n.value,this.reforgeElem=c.value,this.enchantElem=r.value,this.tinkerElem=l.value,this.socketsContainerElem=h.value}clear(e){this.abortController?.abort(),this.nameElem.removeAttribute("data-wowhead"),this.nameElem.removeAttribute("href"),this.notice?.dispose(),this.notice=null,this.iconElem.removeAttribute("data-wowhead"),this.iconElem.removeAttribute("href"),this.enchantElem.removeAttribute("data-wowhead"),this.enchantElem.removeAttribute("href"),this.tinkerElem.removeAttribute("data-wowhead"),this.tinkerElem.removeAttribute("href"),this.enchantElem.classList.add("hide"),this.reforgeElem.classList.add("hide"),this.iconElem.style.backgroundImage=`url('${of(e)}')`,this.enchantElem.replaceChildren(),this.tinkerElem.replaceChildren(),this.reforgeElem.replaceChildren(),this.socketsContainerElem.replaceChildren(),this.nameElem.replaceChildren(),this.ilvlElem.replaceChildren(),this.socketsElem=[]}update(e){this.abortController=new AbortController,this.signal=this.abortController.signal;const t=H("span",{className:"item-picker-name"},e.item.name),a=!!e.hasRandomSuffixOptions(),i=!!e.randomSuffix;this.nameElem.replaceChildren(t),this.ilvlElem.replaceChildren(H(de,null,e.ilvl.toString(),!(e.upgrade===x.ChallengeMode||!e.ilvlFromBase)&&H("span",{className:"item-quality-uncommon"},"+",e.ilvlFromBase))),i&&(t.textContent+=" "+ct(e.randomSuffix.name)),e.item.nameDescription&&this.nameElem.appendChild(nf(e.item.nameDescription)),this.notice=new ef(this.player,{itemId:e.item.id,additionalNoticeData:a&&!i?Vg:void 0}),this.notice.hasNotice&&this.nameContainerElem.appendChild(this.notice.rootElem);const s=e.withDynamicStats().getReforgeData();if(s){const e=ot(s.reforge?.fromStat),t=ot(s.reforge?.toStat);this.reforgeElem.innerText=oe.t("gear_tab.gear_picker.reforge_text",{fromAmount:Math.abs(s.fromAmount),fromStat:e,toAmount:s.toAmount,toStat:t}),this.reforgeElem.classList.remove("hide")}else this.reforgeElem.innerText="",this.reforgeElem.classList.add("hide");jr(this.nameElem,e.item.quality),this.player.setWowheadData(e,this.iconElem),this.player.setWowheadData(e,this.nameElem),e.asActionId().fill(void 0,{signal:this.signal}).then(e=>{this.signal?.aborted||(e.setBackgroundAndHref(this.iconElem),e.setWowheadHref(this.nameElem))}),e.enchant?(Jg(e.enchant).then(e=>{this.enchantElem.textContent=e}),e.enchant.spellId?(this.enchantElem.href=Lr.makeSpellUrl(e.enchant.spellId),Lr.makeSpellTooltipData(e.enchant.spellId).then(e=>{this.enchantElem.dataset.wowhead=e})):(this.enchantElem.href=Lr.makeItemUrl(e.enchant.itemId),Lr.makeItemTooltipData(e.enchant.itemId).then(e=>{this.enchantElem.dataset.wowhead=e})),this.enchantElem.dataset.whtticon="false",this.enchantElem.classList.remove("hide")):this.enchantElem.classList.add("hide"),e.tinker?(Jg(e.tinker).then(e=>{this.tinkerElem.textContent=e}),e.tinker.spellId?(this.tinkerElem.href=Lr.makeSpellUrl(e.tinker.spellId),Lr.makeSpellTooltipData(e.tinker.spellId).then(e=>{this.tinkerElem.dataset.wowhead=e})):(this.enchantElem.href=Lr.makeItemUrl(e.tinker.itemId),Lr.makeItemTooltipData(e.tinker.itemId).then(e=>{this.tinkerElem.dataset.wowhead=e})),this.tinkerElem.dataset.whtticon="false",this.tinkerElem.classList.remove("hide")):this.tinkerElem.classList.add("hide"),e.allSocketColors().forEach((t,a)=>{const i=rf(t,e.gems[a],a);if(a===e.numPossibleSockets-1&&e.couldHaveExtraSocket()){const e=()=>{i.classList[this.player.isBlacksmithing()?"remove":"add"]("hide")};this.player.professionChangeEmitter.on(e),e()}this.socketsElem.push(i),this.socketsContainerElem.appendChild(i)})}}class hf extends F{constructor(e,t,a,i,s){super(e,"item-picker-root"),this.onUpdateCallbacks=[],this._equippedItem=null,this.quickSwapEnchantPopover=null,this.quickSwapGemPopover=[],this.gearPicker=t,this.simUI=a,this.player=i,this.slot=s,this.itemElem=new cf(e,this.rootElem,i),this.item=i.getEquippedItem(s),i.sim.waitForInit().then(()=>{const e=e=>{e.preventDefault(),this.openSelectorModal(bk.Items)};this.itemElem.iconElem.addEventListener("click",e),this.itemElem.nameElem.addEventListener("click",e),this.itemElem.reforgeElem.addEventListener("click",e=>{e.preventDefault(),this.openSelectorModal(bk.Reforging)}),this.itemElem.tinkerElem.addEventListener("click",e=>{e.preventDefault(),this.openSelectorModal(bk.Tinkers)}),this.addQuickEnchantHelpers()}),i.gearChangeEmitter.on(()=>{this.item=this.player.getEquippedItem(this.slot),this._equippedItem&&(this._equippedItem!==this.quickSwapEnchantPopover?.item&&this.quickSwapEnchantPopover?.update({item:this._equippedItem}),this.addQuickGemHelpers())}),i.sim.filtersChangeEmitter.on(()=>{this._equippedItem&&(this.quickSwapEnchantPopover?.update({item:this._equippedItem}),this.quickSwapGemPopover.forEach(e=>e.update({item:this._equippedItem})))}),i.sim.showQuickSwapChangeEmitter.on(()=>{this.quickSwapEnchantPopover?.tooltip?.[this.player.sim.getShowQuickSwap()?"enable":"disable"](),this.quickSwapGemPopover.forEach(e=>e.tooltip?.[this.player.sim.getShowQuickSwap()?"enable":"disable"]())}),i.professionChangeEmitter.on(()=>{this._equippedItem&&this.player.setWowheadData(this._equippedItem,this.itemElem.iconElem)})}createGearData(){return{equipItem:(e,t)=>{this.player.equipItem(e,this.slot,t)},getEquippedItem:()=>this.player.getEquippedItem(this.slot)?.withChallengeMode(this.player.getChallengeModeEnabled()).withDynamicStats()||null,changeEvent:this.player.gearChangeEmitter}}get item(){return this._equippedItem}set item(e){this.itemElem.clear(this.slot),this.quickSwapGemPopover=[],this.itemElem.nameElem.textContent=tt(this.slot),jr(this.itemElem.nameElem,null),e&&this.itemElem.update(e),this._equippedItem=e,this.onUpdateCallbacks.forEach(e=>e())}onUpdate(e){this.onUpdateCallbacks.push(e)}openSelectorModal(e){this.gearPicker.selectorModal.openTab(this.slot,e,this.createGearData())}addQuickGemHelpers(){if(!this._equippedItem)return;const e=e=>this.openSelectorModal(`Gem${e+1}`);this.itemElem.socketsElem?.forEach(t=>{const a=Number(t.dataset.socketIdx)||0;t.addEventListener("click",t=>{t.preventDefault(),e(0)});const i=((e,t,a,i,s,o)=>new tf({title:oe.t("gear_tab.gear_picker.quick_popovers.favorite_gems.title"),emptyMessage:oe.t("gear_tab.gear_picker.quick_popovers.favorite_gems.empty_message"),tippyElement:t,tippyConfig:{appendTo:document.querySelector(".sim-ui")},item:a,getItems:t=>{const a=e.sim.getFilters().favoriteGems,i=t.curSocketColors(e.isBlacksmithing())[s];return e.getGems(i).filter(e=>a.includes(e.id)).sort((e,t)=>e.color>t.color?1:-1).map(e=>({item:e,active:t.gems[s]?.id===e.id}))},onItemClick:t=>{e.equipItem(te.nextEventID(),i,a.withGem(t,s))},footerButton:{label:oe.t("gear_tab.gear_picker.quick_popovers.favorite_gems.open_gems"),onClick:o}}))(this.player,t,this._equippedItem,this.slot,a,()=>e(a));this.player.sim.getShowQuickSwap()||i.tooltip?.disable(),this.quickSwapGemPopover.push(i)})}addQuickEnchantHelpers(){if(!this._equippedItem)return;const e=()=>this.openSelectorModal(bk.Enchants);var t,a,i,s,o;this.itemElem.enchantElem.addEventListener("click",t=>{t?.preventDefault(),e()}),this.quickSwapEnchantPopover=(t=this.player,a=this.itemElem.enchantElem,i=this._equippedItem,s=this.slot,o=e,new tf({title:oe.t("gear_tab.gear_picker.quick_popovers.favorite_enchants.title"),emptyMessage:oe.t("gear_tab.gear_picker.quick_popovers.favorite_enchants.empty_message"),tippyElement:a,tippyConfig:{appendTo:document.querySelector(".sim-ui")},item:i,getItems:e=>{const a=t.sim.db.getEnchants(s),i=t.sim.getFilters().favoriteEnchants,o=i?.map(e=>{const[t,i]=e.split("-").map(Number);return a.find(e=>e.effectId===t&&e.type===i)}).filter(e=>!!e);return o.map(t=>({item:t,active:e.enchant?.effectId===t.effectId}))},onItemClick:e=>{t.equipItem(te.nextEventID(),s,i.withEnchant(e))},footerButton:{label:oe.t("gear_tab.gear_picker.quick_popovers.favorite_enchants.open_enchants"),onClick:o}})),this.player.sim.getShowQuickSwap()||this.quickSwapEnchantPopover.tooltip?.disable()}}class df extends F{constructor(e,t,a,i,s,o){super(e,"bulk-item-picker"),this.simUI=t,this.bulkUI=a,this.bulkSlot=s,this.index=o,this.item=i,this.itemElem=new cf(e,this.rootElem,t.player),this.abortController=new AbortController,this.signal=this.abortController.signal,this.isEditable()||(this.rootElem.classList.add("bulk-item-picker-equipped"),e.insertAdjacentElement("afterbegin",this.rootElem)),this.addActions(),this.simUI.sim.waitForInit().then(()=>this.setItem(i)),this.addOnDisposeCallback(()=>this.rootElem.remove());const n=()=>{this.bulkUI.frozenItems.get(this.bulkSlot)?.equals(this.item)?(this.rootElem.classList.remove("bulk-item-picker-equipped"),this.rootElem.classList.add("bulk-item-picker-frozen")):(this.rootElem.classList.remove("bulk-item-picker-frozen"),this.rootElem.classList.add("bulk-item-picker-equipped"))};n(),te.onAny([this.bulkUI.settingsChangedEmitter,this.bulkUI.itemsChangedEmitter]).on(()=>n())}setItem(e){this.itemElem.clear(i.ItemSlotHead),this.itemElem.update(e),this.item=e,this.setupHandlers()}isEditable(){return this.index>=0}setupHandlers(){const e=M(this.item.item)[0],t=!!this.simUI.sim.db.getEnchants(e).length,a=this.item?.item?this.simUI.player.getAvailableReforgings(this.item):[],i=t=>{t.preventDefault(),this.isEditable()&&this.bulkUI.selectorModal.openTab(e,bk.Items,this.createGearData())},s=(t,a)=>{if(t.preventDefault(),!this.isEditable())return;let i=bk.Gem1;1===a&&(i=bk.Gem2),2===a&&(i=bk.Gem3),this.bulkUI.selectorModal.openTab(e,i,this.createGearData())};this.itemElem.iconElem.addEventListener("click",i,{signal:this.signal}),this.itemElem.nameElem.addEventListener("click",i,{signal:this.signal}),this.itemElem.enchantElem.addEventListener("click",a=>{a.preventDefault(),this.isEditable()&&t&&this.bulkUI.selectorModal.openTab(e,bk.Enchants,this.createGearData())},{signal:this.signal}),this.itemElem.reforgeElem.addEventListener("click",t=>{t.preventDefault(),this.isEditable()&&a.length&&this.bulkUI.selectorModal.openTab(e,bk.Reforging,this.createGearData())},{signal:this.signal}),this.itemElem.socketsElem.forEach((e,t)=>e.addEventListener("click",e=>s(e,t),{signal:this.signal}))}createGearData(){const e=new te;return{equipItem:(t,a)=>{a&&(this.bulkUI.updateItem(this.index,a.asSpec()),e.emit(te.nextEventID()))},getEquippedItem:()=>this.item,changeEvent:e}}addActions(){const e=U();if(this.itemElem.rootElem.appendChild(H("div",{className:"item-picker-actions-container"},this.isEditable()&&H("button",{className:"btn btn-link link-danger item-picker-actions-btn",ref:e},H("i",{className:"fas fa-times"})))),e.value){const t=e.value;ie(t,{content:oe.t("bulk_tab.picker.remove_tooltip")});const a=()=>this.bulkUI.removeItemByIndex(this.index);t.addEventListener("click",a),this.addOnDisposeCallback(()=>t.removeEventListener("click",a))}}}class uf extends $e{constructor(e,t,a,i){super(e,"bulk-item-picker-group-root",{header:{title:ht(i)}}),this.pickers=new Map;const s=dt(i);this.rootElem.classList.add(`gear-group-${s.replace(/_/g,"-")}`),this.simUI=t,this.bulkUI=a,this.bulkSlot=i,this.addEmptyElement()}has(e){return!!this.pickers.get(e)}add(e,t,a=!1){this.pickers.size||this.bodyElement.replaceChildren();if(Array.from(this.pickers.values()).some(e=>this.bulkSlot!=ut.ItemSlotHandWeapon&&e.item.id===t.id||0!=e.item._item.limitCategory&&e.item._item.limitCategory===t._item.limitCategory))a||new Dg({delay:1e3,variant:"error",body:H(de,null,oe.t("bulk_tab.search.item_unique",{itemName:t._item.name}))});else{if(this.pickers.has(e)){this.pickers.get(e).dispose(),this.pickers.delete(e)}this.pickers.set(e,new df(this.bodyElement,this.simUI,this.bulkUI,t,this.bulkSlot,e)),a||new Dg({delay:1e3,variant:"success",body:H(de,null,oe.t("bulk_tab.search.item_added",{itemName:t._item.name}))})}}update(e,t){const a=this.pickers.get(e);a?a.setItem(t):new Dg({variant:"error",body:oe.t("bulk_tab.picker.failed_update")})}remove(e,t=!1){const a=this.pickers.get(e);a?(a.dispose(),this.pickers.delete(e),this.pickers.size||this.addEmptyElement(),t||new Dg({delay:1e3,variant:"success",body:H(de,null,oe.t("bulk_tab.search.item_removed",{itemName:a.item._item.name}))})):t||new Dg({variant:"error",body:oe.t("bulk_tab.picker.failed_remove")})}addEmptyElement(){this.bodyElement.appendChild(H("span",null,oe.t("bulk_tab.picker.no_items")))}}class pf extends $e{constructor(e,t,a){super(e,"bulk-item-search-root",{header:{title:oe.t("bulk_tab.search.title")}}),this.filtersChangeEmitter=new te,this.allItems=[],this._searchString="",this.minIlvl=0,this.maxIlvl=0,this.simUI=t,this.bulkUI=a,this.abortController=new AbortController,this.signal=this.abortController.signal;const i=U(),s=U(),o=U(),n=U(),r=U();this.bodyElement.appendChild(H("div",{className:"bulk-gear-search-container",ref:i},H("div",{className:"d-flex flex-column"},H("label",{className:"form-label",htmlFor:"bulkGearSearch"},oe.t("common.name")),H("div",{className:"input-group"},H("input",{id:"bulkGearSearch",className:"form-control",type:"text",placeholder:oe.t("common.search"),ref:s}),H("button",{className:"btn btn-link cancel-bulk-gear-search-btn hide",ref:o,type:"button"},H("i",{className:"fas fa-times"}))),H("ul",{ref:n,className:"bulk-gear-search-results dropdown-menu no-hover"})),H("div",{className:"bulk-gear-search-ilvl-filters",ref:r}))),this.inputElem=s.value,this.cancelSearchElem=o.value,this.searchResultElem=n.value,ie(this.cancelSearchElem,{content:oe.t("bulk_tab.search.clear_search")}),this.cancelSearchElem.addEventListener("click",()=>{this.searchString=""}),new rl(r.value,this,{id:"bulkGearSearchMinIlvl",label:oe.t("bulk_tab.search.min_ilvl"),showZeroes:!1,changedEvent:e=>this.filtersChangeEmitter,getValue:e=>this.minIlvl,setValue:(e,t,a)=>{this.minIlvl=a,this.filtersChangeEmitter.emit(e)}}),r.value.appendChild(H("span",{className:"ilvl-filters-separator"},"-")),new rl(r.value,this,{id:"bulkGearSearchMaxIlvl",label:oe.t("bulk_tab.search.max_ilvl"),showZeroes:!1,changedEvent:e=>this.filtersChangeEmitter,getValue:e=>this.maxIlvl,setValue:(e,t,a)=>{this.maxIlvl=a,this.filtersChangeEmitter.emit(e)}}),this.simUI.sim.waitForInit().then(()=>{this.allItems=this.simUI.sim.db.getAllItems().filter(e=>pt(e,this.simUI.player.getPlayerSpec(),void 0)).sort((e,t)=>{const a=e.scalingOptions?.[x.Base].ilvl||e.ilvl,i=t.scalingOptions?.[x.Base].ilvl||t.ilvl;return a<i?1:i<a?-1:0}),this.filtersChangeEmitter.on(()=>{this.performSearch()}),s.value.addEventListener("input",()=>{this.searchString=s.value.value})})}get searchString(){return this._searchString}set searchString(e){this._searchString=e,this.inputElem.value=e,this.filtersChangeEmitter.emit(te.nextEventID())}performSearch(){if(!this.searchString.length)return this.cancelSearchElem.classList.add("hide"),void this.searchResultElem.classList.remove("show");const e=this.searchString.split(" "),t=H(de,null);let a=0;this.allItems.forEach(i=>{const s=i.scalingOptions?.[x.Base].ilvl||i.ilvl;if(0!=this.maxIlvl&&this.maxIlvl<s)return!1;if(0!=this.minIlvl&&this.minIlvl>s)return!1;let n=!0;const r=i.name.toLowerCase(),l=i.setName.toLowerCase();if(e.forEach(e=>{const t=e.toLowerCase();return!(!r.includes(t)&&!l.includes(t))||(n=!1,!1)}),n&&a++,n&&a<=21){const e=U(),a=U(),n=U();t.appendChild(H("li",null,H("a",{className:"dropdown-item bulk-item-search-item",dataset:{itemId:i.id.toString()},ref:e,target:"_blank"},H("div",{className:"bulk-item-search-item-icon-wrapper"},H("span",{className:"item-picker-ilvl"},s),H("div",{className:"bulk-item-search-item-icon",ref:a})),H("div",{className:"d-flex flex-column gap-1 ps-2"},H("div",{className:"d-flex flex-wrap flex-column flex-xxl-row column-gap-1"},H("span",{ref:n},i.name),i.nameDescription&&nf(i.nameDescription),i.factionRestriction===mt.HORDE_ONLY&&H("span",{className:"faction-horde"},"(H)"),i.factionRestriction===mt.ALLIANCE_ONLY&&H("span",{className:"faction-alliance"},"(A)")),H("small",null,ht(gt.get(M(i)[0]))))))),Lr.fromItem(i).fill().then(t=>{t.setBackground(a.value),t.setWowheadHref(e.value)}),jr(n.value,i.quality),e.value.addEventListener("click",e=>{e.preventDefault(),this.bulkUI.addItem(o.create({id:i.id}))},{signal:this.signal})}}),this.searchResultElem.replaceChildren(H(de,null,t,a>21&&H("li",{className:"bulk-item-search-item bulk-item-search-results-note"},oe.t("bulk_tab.search.showing_results",{max:21,total:a})),0===a&&H("li",{className:"bulk-item-search-item bulk-item-search-results-note"},oe.t("bulk_tab.search.no_results")))),this.searchResultElem.classList.add("show"),this.cancelSearchElem.classList.remove("hide")}}class mf extends F{constructor(e,t,a,s){super(e,"bulk-sim-result-root"),this.simUI=t;const n=this.simUI.sim.getIterations(),r=a.gear.equals(s.gear),l=U(),c=U(),h=U();if(this.rootElem.appendChild(H(de,null,H("div",{className:"results-sim"},H("div",{className:"results-sim-dps damage-metrics"},H("span",{className:"topline-result-avg"},this.formatDps(a.dpsMetrics.avg)),H("div",{className:"results-reference"},r?H("span",{className:"fw-bold"},oe.t("bulk_tab.results.current_gear")):H("span",{ref:c,className:"results-reference-diff"})))),H("div",{ref:h,className:"bulk-gear-combo"}),H("div",{className:"bulk-results-actions"},H("button",{ref:l,className:xr("btn btn-primary bulk-equip-btn",r&&"d-none")},oe.t("bulk_tab.results.equip_button"))))),r)return;if(c.value){const e=eg.applyZTestTooltip(c.value,n,a.dpsMetrics.avg,a.dpsMetrics.stdev,n,s.dpsMetrics.avg,s.dpsMetrics.stdev,!1);Ue(c.value,s.dpsMetrics.avg,a.dpsMetrics.avg,2,void 0,!e,!0)}l.value?.addEventListener("click",()=>{t.player.setGear(te.nextEventID(),a.gear),t.simHeader.activateTab("gear-tab"),new Dg({variant:"success",body:oe.t("bulk_tab.results.gear_equipped")})});const d=H(de,null),u=a.gear.asSpec(),p=s.gear.asSpec();for(const[m,g]of u.items.entries()){const e=H("div",{className:"bulk-result-item"});g.id!=p.items[m].id?e.style.border="3px solid red":e.style.border="3px solid transparent";const a=new cf(d,e,t.player);if(0!=g.id&&(!o.equals(g,p.items[m])||(!(![i.ItemSlotFinger1,i.ItemSlotTrinket1].includes(m)||o.equals(u.items[m+1],p.items[m+1]))||!(![i.ItemSlotFinger2,i.ItemSlotTrinket2].includes(m)||o.equals(u.items[m-1],p.items[m-1]))))){const e=t.sim.db.lookupItemSpec(g);a.update(e)}else a.clear(m);d.appendChild(e)}h.value.appendChild(d)}formatDps(e){return se(e)}}class gf extends Wr{constructor(e,t,a,i,s){super(e,"selector-modal",{disposeOnClose:!1,size:"xl"}),this.simUI=t,this.onSelect=i,this.onRemove=s,this.socketColor=a,this.ilist=null,window.scrollTo({top:0}),this.header.insertAdjacentElement("afterbegin",H("h6",{className:"selector-modal-title mb-3"},oe.t("bulk_tab.gem_selector.title")));const o=U();this.body.appendChild(H("div",{ref:o,className:"tab-content selector-modal-tab-content"})),this.contentElem=o.value}show(){if(!this.ilist){this.ilist=new fk("bulk-tab-gem-selector",this.contentElem,this.simUI,i.ItemSlotHead,bk.Gem1,this.simUI.player,bk.Gem1,{equipItem:(e,t)=>{},getEquippedItem:()=>null,changeEvent:new te},this.simUI.player.getGems(this.socketColor).map(e=>({item:e,id:e.id,actionId:Lr.fromItemId(e.id),name:e.name,quality:e.quality,phase:e.phase,nameDescription:"",baseEP:this.simUI.player.computeStatsEP(new n(e.stats)),ignoreEPFilter:!0,onEquip:ft})),this.socketColor,e=>this.simUI.player.computeGemEP(e),()=>null,this.onRemove,this.onSelect),this.ilist.sizeRefresh();const e=()=>this.ilist?.applyFilters(),t=this.simUI.sim.phaseChangeEmitter.on(e),a=this.simUI.sim.filtersChangeEmitter.on(e);this.addOnDisposeCallback(()=>{t.dispose(),a.dispose(),this.ilist?.dispose()})}this.open()}}var ff=(e=>(e[e.Gear=0]="Gear",e[e.Talents=1]="Talents",e[e.Rotation=2]="Rotation",e[e.Consumes=3]="Consumes",e[e.Miscellaneous=4]="Miscellaneous",e[e.External=5]="External",e[e.Encounter=6]="Encounter",e[e.UISettings=7]="UISettings",e))(ff||{});const bf=(()=>{const e=new Map;return e.set(0,"g"),e.set(1,"t"),e.set(2,"r"),e.set(3,"c"),e.set(4,"m"),e.set(5,"x"),e.set(6,"e"),e.set(7,"u"),e})();class yf extends Wr{constructor(e,t){super(e,"importer",{title:t.title,footer:!0,disposeOnClose:!1}),this.allowFileUpload=t.allowFileUpload||!1;const a="upload-input-"+t.title.toLowerCase().replaceAll(" ","-"),i=U(),s=U(),o=U(),n=U();this.body.replaceChildren(H("div",null,H("div",{ref:i,className:"import-description"}),H("textarea",{ref:s,className:"importer-textarea form-control",attributes:{spellcheck:!1}}))),this.footer.appendChild(H("div",{className:"d-flex gap-2"},this.allowFileUpload&&H("label",{htmlFor:a,className:"importer-button btn btn-primary upload-button"},H("i",{className:"fas fa-file-arrow-up me-1"}),oe.t("import.json.upload_button")),H("input",{ref:n,type:"file",id:a,className:"importer-upload-input d-none",hidden:!0}),H("button",{ref:o,className:"importer-button btn btn-primary import-button"},H("i",{className:"fa fa-download me-1"}),oe.t("import.json.import_button")))),this.descriptionElem=i.value,this.textElem=s.value,this.allowFileUpload&&n.value&&n.value.addEventListener("change",async e=>{this.textElem.textContent=await e.target.files[0].text()}),this.importButton=o.value,this.importButton.addEventListener("click",async e=>{try{await this.onImport(this.textElem.value||"")}catch(t){new Dg({variant:"error",body:`Import error: ${t?.message||t}`})}})}open(){const e=this.header?.title.toLowerCase().replaceAll(" ","-");Zm(this.header.title,`/import/${e}`),super.open()}}const wf=class extends yf{constructor(e,t,a){super(e,a),this.simUI=t}async finishIndividualImport(e,{charClass:t,race:a,equipmentSpec:i,talentsStr:s,glyphs:o,professions:n,missingEnchants:r=[],missingItems:l=[]}){if(t!=e.player.getClass())throw new Error(`Wrong Class! Expected ${e.player.getPlayerClass().friendlyName} but found ${$r.get(t)}!`);await Ar.loadLeftoversIfNecessary(i);const c=e.sim.db.lookupEquipmentSpec(i),h=te.nextEventID();te.freezeAllAndDo(()=>{e.player.setRace(h,a),e.player.setGear(h,c),s&&"--"!=s&&e.player.setTalentsString(h,s),o&&e.player.setGlyphs(h,o),n.length>0&&e.player.setProfessions(h,n)}),this.close(),0==l.length&&0==r.length?new Dg({variant:"success",body:"Import successful!"}):new Dg({variant:"info",body:"Import successful, but the following IDs were not found in the sim database:"+(0==l.length?"":"\n\nItems: "+l.join(", "))+(0==r.length?"":"\n\nEnchants: "+r.join(", "))})}};wf.DEFAULT_CATEGORIES=e(ff).filter(e=>e!=ff.UISettings),wf.CATEGORY_PARAM="i";let vf=wf;class xf extends vf{constructor(e,t,a){super(e,t,{title:bt("bulk_tab.import_modal.title"),allowFileUpload:!0}),this.bulkUI=a,this.descriptionElem.appendChild(H(de,null,H("p",null,bt("bulk_tab.import_modal.description_line1")),H("p",null,bt("bulk_tab.import_modal.description_line2"))))}async onImport(e){try{const t=s.fromJsonString(e,{ignoreUnknownFields:!0});if(t?.items?.length>0){const e=await Ar.loadLeftoversIfNecessary(t),a=t.items.filter(t=>t.id>0&&e.lookupItemSpec(t));a.length>0&&this.bulkUI.addItems(a)}this.close()}catch(t){console.warn(t),alert(t.toString())}}}const Sf={id:0,name:oe.t("talents_tab.glyphs.empty"),description:"",iconUrl:"https://wow.zamimg.com/images/wow/icons/medium/inventoryslot_empty.jpg",quality:null,spellId:0};class _f extends F{constructor(e,t,a){super(e,"glyphs-picker-root"),this.majorGlyphPickers=[],this.minorGlyphPickers=[],this.glyphsConfig=a,this.player=t;const i=Object.keys(a.majorGlyphs).map(e=>Number(e)),s=Object.keys(a.minorGlyphs).map(e=>Number(e)),o=new $e(this.rootElem,"major-glyphs",{header:{title:oe.t("talents_tab.glyphs.major"),extraCssClasses:["border-0"]}}),n=new $e(this.rootElem,"minor-glyphs",{header:{title:oe.t("talents_tab.glyphs.minor"),extraCssClasses:["border-0"]}});this.selectorModal=new Cf(this.rootElem.closest(".individual-sim-ui")),Ar.get().then(e=>{const a=i.map(t=>this.getGlyphData(t,e)),r=s.map(t=>this.getGlyphData(t,e));a.sort((e,t)=>pe(e.name,t.name)),r.sort((e,t)=>pe(e.name,t.name)),this.majorGlyphPickers=["major1","major2","major3"].map(e=>new kf(o.bodyElement,{label:"Major",player:t,selectorModal:this.selectorModal,glyphOptions:a,glyphField:e})),this.minorGlyphPickers=["minor1","minor2","minor3"].map(e=>new kf(n.bodyElement,{label:"Minor",player:t,selectorModal:this.selectorModal,glyphOptions:r,glyphField:e}))})}getGlyphData(e,t){const a=this.glyphsConfig.majorGlyphs[e]?"major":"minor",i="major"===a?this.glyphsConfig.majorGlyphs[e]:this.glyphsConfig.minorGlyphs[e],s=`${yt(this.player.getClass())}.${a}.${i.name.toLowerCase().replace(/[':]/g,"").replace(/[\s-]+/g,"_")}`;return{id:e,name:oe.t(`${s}.name`,{ns:"glyphs"}),description:oe.t(`${s}.description`,{ns:"glyphs"}),iconUrl:i.iconUrl,quality:W.ItemQualityCommon,spellId:t.glyphItemToSpellId(e)}}}class kf extends nl{constructor(e,{player:t,selectorModal:a,glyphOptions:i,glyphField:s}){super(e,"glyph-picker-root",t,{id:`glyph-picker-glyph-${s}`,inline:!0,changedEvent:e=>e.glyphsChangeEmitter,getValue:e=>e.getGlyphs()[s],setValue:(e,t,a)=>{const i=t.getGlyphs();i[s]=a,t.setGlyphs(e,i)}}),this.rootElem.classList.add("item-picker-root"),this.player=t,this.glyphOptions=i,this.selectedGlyph=Sf;const o=U(),n=U(),r=U();this.rootElem.appendChild(H("a",{ref:o,attributes:{role:"button"},className:"glyph-link"},H("img",{ref:n,className:"item-picker-icon"}),H("div",{className:"item-picker-labels-container"},H("span",{ref:r,className:"item-picker-name-container"})))),this.anchorElem=o.value,this.iconElem=n.value,this.nameElem=r.value,this.anchorElem.addEventListener("click",e=>{e.preventDefault(),a.openTab(this,i)},{signal:this.signal}),this.init()}getInputElem(){return this.iconElem}getInputValue(){return this.selectedGlyph?.id??0}setInputValue(e){this.selectedGlyph=this.glyphOptions.find(t=>t.id==e),this.selectedGlyph?(this.selectedGlyph.spellId?(this.anchorElem.href=Lr.makeSpellUrl(this.selectedGlyph.spellId),Lr.makeSpellTooltipData(this.selectedGlyph.spellId).then(e=>{this.anchorElem.dataset.wowhead=e,this.anchorElem.dataset.whtticon="false"})):(this.anchorElem.href=Lr.makeItemUrl(this.selectedGlyph.id),Lr.makeItemTooltipData(this.selectedGlyph.id).then(e=>{this.anchorElem.dataset.wowhead=e,this.anchorElem.dataset.whtticon="false"})),this.iconElem.src=this.selectedGlyph.iconUrl,this.nameElem.textContent=this.selectedGlyph.name):this.clear()}clear(){this.anchorElem.removeAttribute("data-wowhead"),this.anchorElem.removeAttribute("href"),this.iconElem.src=Sf.iconUrl,this.nameElem.textContent=Sf.name}}class Cf extends Wr{constructor(e){super(e,"glyph-modal",{title:oe.t("talents_tab.glyphs.modal.title"),disposeOnClose:!1}),this.listItems=[],this.glyphOptions=[],this.glyphPicker=null;const t=U(),a=U();this.body.appendChild(H(de,null,H("div",{className:"input-root"},H("input",{ref:a,className:"selector-modal-search form-control",type:"text",placeholder:oe.t("common.search")})),H("ul",{ref:t,className:"selector-modal-list"}))),this.list=t.value,this.search=a.value,this.search.addEventListener("input",()=>this.applyFilters())}openTab(e,t){this.setData(e,t),this.applyFilters(),this.open()}setData(e,t){this.glyphPicker=e,this.list.innerHTML="",this.listItems=[],this.glyphOptions=[Sf,...t];const a=this.glyphOptions.map((e,t)=>{const a=U(),i=U(),s=U(),o=H("li",{className:"selector-modal-list-item",dataset:{idx:String(t)}},H("a",{ref:a,className:"selector-modal-list-item-link"},H("img",{ref:i,className:"selector-modal-list-item-icon"}),H("label",{ref:s,className:"selector-modal-list-item-name"},e.name),H("span",{className:"selector-modal-list-item-description"},e.description)));return a.value&&(e.spellId?a.value.href=Lr.makeSpellUrl(e.spellId):a.value.href=Lr.makeItemUrl(e.id),a.value.addEventListener("click",t=>{t.preventDefault(),this.glyphPicker?.setValue(te.nextEventID(),e.id)})),i.value&&(i.value.src=e.iconUrl),s.value&&jr(s.value,e.quality),o});this.listItems=a,this.list.appendChild(H(de,null,this.listItems)),this.glyphPicker.player.glyphsChangeEmitter.on(()=>{this.applyFilters()})}applyFilters(){if(!this.glyphPicker)return;const e=this.glyphPicker.selectedGlyph?.id??0;this.listItems.forEach(t=>{const a=parseInt(t.dataset.idx),i=this.glyphOptions[a];t.classList[i.id==e?"add":"remove"]("active")}),this.listItems.map(e=>{const t=parseInt(e.dataset.idx),a=this.glyphOptions[t];let i="remove";if(this.search.value.length>0){const e=this.search.value.toLowerCase().split(" "),t=a.name.toLowerCase();e.forEach(e=>{t.includes(e)||"remove"!==i||(i="add")})}e.classList[i]("d-none")})}}class If extends nl{constructor(e,t,a){super(e,"talents-picker-root",t,{...a}),this.modObject=t,this.config=a;const i=U(),s=U(),o=U();this.rootElem.appendChild(H("div",{className:"talents-picker-inner",ref:i},H("div",{className:"talents-picker-header"},H("div",{className:"talents-picker-actions",ref:s})),H("div",{id:"talents",className:"talents-picker-list",ref:o})));const n=o.value;new Tg(s.value,{extraCssClasses:["btn-sm","btn-outline-primary","copy-talents"],getContent:()=>t.getTalentsString(),text:oe.t("talents_tab.copy_button.label"),tooltip:oe.t("talents_tab.copy_button.tooltip")}),this.tree=new Ef(n,this.config.tree,this,a.playerSpec),this.tree.rows.forEach(e=>e.forEach(e=>e.setSelected(!1))),this.isPlayer()&&new _f(this.rootElem,this.modObject,Qf[this.modObject.getClass()]),this.init()}getInputElem(){return this.rootElem}getInputValue(){return this.tree.getTalentsString()}setInputValue(e){this.tree.setTalentsString(e)}isPlayer(){return!!this.modObject?.playerClass}}class Ef extends F{constructor(e,t,a,i){super(e,"talent-tree-picker-root"),this.picker=a;const s=U();this.rows=t.talents.reduce((e,t)=>(e[t.location.rowIdx]||(e[t.location.rowIdx]=[]),e[t.location.rowIdx][t.location.colIdx]=new Tf(null,t,this),e),[]),this.rootElem.replaceChildren(H(de,null,H("div",{className:"talent-tree-header"},H("img",{src:this.getTreeIcon(i),className:"talent-tree-icon"}),H("span",{className:"talent-tree-title"},wt(_e.fromProto(i))),H("button",{ref:s,className:"talent-tree-reset btn link-danger"},H("i",{className:"fa fa-times"}))),H("div",{className:"talent-tree-background",style:{backgroundImage:`url('${t.backgroundUrl}')`}}),H("div",{className:"talent-tree-main"},this.rows.map((e,t)=>H("div",{className:"talent-tree-row"},H("div",{className:"talent-tree-level"},15*(t+1)),e.map(e=>e.rootElem))))));const o=s.value;ie(o,{content:oe.t("talents_tab.reset_button.tooltip")}),o.addEventListener("click",e=>this.resetPoints())}getTalent(e){const t=this.rows[e.rowIdx].find(t=>t.getCol()==e.colIdx);if(!t)throw new Error("No talent found with location: "+e);return t}getTalentsString(){return Array.from(Array(6),(e,t)=>{const a=this.rows[t].find(e=>e.getRow()==t&&e.isSelected());return a?a.getCol()+1:0}).join("")}setTalentsString(e){const t=e.split("").map(Number);this.rows.forEach((e,a)=>e.forEach(e=>{e.setSelected(e.getCol()+1===t[a])}))}resetPoints(){this.rows.forEach(e=>e.forEach(e=>e.setSelected(!1))),this.picker.inputChanged(te.nextEventID())}getTreeIcon(e){return _e.fromProto(e).getIcon("medium")}}class Tf extends F{constructor(e,t,a){super(e,"talent-picker-root",document.createElement("a")),this.config=t,this.tree=a,this.zIdx=0;const i=U();this.rootElem.replaceChildren(H(de,null,H("div",{ref:i,className:"talent-picker-icon"}),H("div",{className:"talent-picker-label",dataset:{whtticon:!1}},oe.t(`${yt(this.tree.picker.modObject.getClass())}.${String(t.fieldName)}`,{ns:"talents"})||t.fancyName))),this.icon=i.value,this.rootElem.addEventListener("click",e=>{e.preventDefault()}),this.rootElem.addEventListener("contextmenu",e=>{e.preventDefault()}),this.rootElem.addEventListener("touchmove",e=>{null!=this.longTouchTimer&&(clearTimeout(this.longTouchTimer),this.longTouchTimer=void 0)}),this.rootElem.addEventListener("touchstart",e=>{e.preventDefault(),this.longTouchTimer=window.setTimeout(()=>{this.setSelected(!1),this.tree.picker.inputChanged(te.nextEventID()),this.longTouchTimer=void 0},750)}),this.rootElem.addEventListener("touchend",e=>{e.preventDefault(),null!=this.longTouchTimer&&(clearTimeout(this.longTouchTimer),this.longTouchTimer=void 0,this.setSelected(!0),this.tree.picker.inputChanged(te.nextEventID()))}),this.rootElem.addEventListener("mousedown",e=>{const t=!vt(e);this.setSelected(t),this.tree.picker.inputChanged(te.nextEventID())})}get zIndex(){return this.zIdx}set zIndex(e){this.zIdx=e,this.rootElem.style.zIndex=String(this.zIdx)}getRow(){return this.config.location.rowIdx}getCol(){return this.config.location.colIdx}isSelected(){return"true"===this.rootElem.dataset.selected}setSelected(e){if(e){const e=this.tree.rows[this.getRow()].find(e=>e.getCol()!==this.getCol()&&e.isSelected());e?.isSelected()&&e.setSelected(!1)}this.rootElem.dataset.selected=String(e),Lr.fromSpellId(this.config.spellId).fill().then(e=>{e.setWowheadHref(this.rootElem),this.icon.style.backgroundImage=`url('${e.iconUrl}')`})}}function Af(e){return e.talents.forEach((t,a)=>{if(0!=a){const i=e.talents[a-1];if(t.location.rowIdx<i.location.rowIdx||t.location.rowIdx==i.location.rowIdx&&t.location.colIdx<=i.location.colIdx)throw new Error(`Out-of-order talent: ${String(t.fancyName)}`)}}),e}const Pf=Af({backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/cata/TODO.jpg",talents:[{fieldName:"roilingBlood",fancyName:"Roiling Blood",location:{rowIdx:0,colIdx:0},spellId:108170},{fieldName:"plagueLeech",fancyName:"Plague Leech",location:{rowIdx:0,colIdx:1},spellId:123693},{fieldName:"unholyBlight",fancyName:"Unholy Blight",location:{rowIdx:0,colIdx:2},spellId:115989},{fieldName:"lichborne",fancyName:"Lichborne",location:{rowIdx:1,colIdx:0},spellId:49039},{fieldName:"antimagicZone",fancyName:"Anti-Magic Zone",location:{rowIdx:1,colIdx:1},spellId:51052},{fieldName:"purgatory",fancyName:"Purgatory",location:{rowIdx:1,colIdx:2},spellId:114556},{fieldName:"deathsAdvance",fancyName:"Death's Advance",location:{rowIdx:2,colIdx:0},spellId:96268},{fieldName:"chilblains",fancyName:"Chilblains",location:{rowIdx:2,colIdx:1},spellId:50041},{fieldName:"asphyxiate",fancyName:"Asphyxiate",location:{rowIdx:2,colIdx:2},spellId:108194},{fieldName:"deathPact",fancyName:"Death Pact",location:{rowIdx:3,colIdx:0},spellId:48743},{fieldName:"deathSiphon",fancyName:"Death Siphon",location:{rowIdx:3,colIdx:1},spellId:108196},{fieldName:"conversion",fancyName:"Conversion",location:{rowIdx:3,colIdx:2},spellId:119975},{fieldName:"bloodTap",fancyName:"Blood Tap",location:{rowIdx:4,colIdx:0},spellId:45529},{fieldName:"runicEmpowerment",fancyName:"Runic Empowerment",location:{rowIdx:4,colIdx:1},spellId:81229},{fieldName:"runicCorruption",fancyName:"Runic Corruption",location:{rowIdx:4,colIdx:2},spellId:51462},{fieldName:"gorefiendsGrasp",fancyName:"Gorefiend's Grasp",location:{rowIdx:5,colIdx:0},spellId:108199},{fieldName:"remorselessWinter",fancyName:"Remorseless Winter",location:{rowIdx:5,colIdx:1},spellId:108200},{fieldName:"desecratedGround",fancyName:"Desecrated Ground",location:{rowIdx:5,colIdx:2},spellId:108201}]}),Rf={majorGlyphs:{[St.GlyphOfAntiMagicShell]:{name:"Glyph of Anti-Magic Shell",description:"Causes your Anti-Magic Shell to absorb all incoming magical damage, up to the absorption limit.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_antimagicshell.jpg"},[St.GlyphOfUnholyFrenzy]:{name:"Glyph of Unholy Frenzy",description:"Causes your Unholy Frenzy to no longer deal damage to the affected target.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_unholyfrenzy.jpg"},[St.GlyphOfIceboundFortitude]:{name:"Glyph of Icebound Fortitude",description:"Reduces the cooldown of your Icebound Fortitude by 50%, but also reduces its duration by 75%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_deathknight_iceboundfortitude.jpg"},[St.GlyphOfChainsOfIce]:{name:"Glyph of Chains of Ice",description:"Your Chains of Ice also causes 143 Frost damage, with additional damage depending on your attack power.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_frost_chainsofice.jpg"},[St.GlyphOfDeathGrip]:{name:"Glyph of Death Grip",description:"Increases the range of your Death Grip ability by 5 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_deathknight_strangulate.jpg"},[St.GlyphOfDeathAndDecay]:{name:"Glyph of Death and Decay",description:"Your Death and Decay also reduces the movement speed of enemies within its radius by 50%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_deathanddecay.jpg"},[St.GlyphOfShiftingPresences]:{name:"Glyph of Shifting Presences",description:"You retain 70% of your Runic Power when switching Presences.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_deathknight_bloodpresence.jpg"},[St.GlyphOfIcyTouch]:{name:"Glyph of Icy Touch",description:"Your Icy Touch dispels one helpful Magic effect from the target.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_deathknight_icetouch.jpg"},[St.GlyphOfEnduringInfection]:{name:"Glyph of Enduring Infection",description:"Your diseases are undispellable, but their damage dealt is reduced by 15%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_creature_disease_05.jpg"},[St.GlyphOfPestilence]:{name:"Glyph of Pestilence",description:"Increases the radius of your Pestilence effect by 5 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_plaguecloud.jpg"},[St.GlyphOfMindFreeze]:{name:"Glyph of Mind Freeze",description:"Reduces the cooldown of your Mind Freeze ability by 1 sec, but also raises its cost by 10 Runic Power.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_deathknight_mindfreeze.jpg"},[St.GlyphOfStrangulate]:{name:"Glyph of Strangulate",description:"Increases the Silence duration of your Strangulate ability by 2 sec when used on a target who is casting a spell.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_soulleech_3.jpg"},[St.GlyphOfPillarOfFrost]:{name:"Glyph of Pillar of Frost",description:"Empowers your Pillar of Frost, making you immune to all effects that cause loss of control of your character, but also reduces your movement speed by 70% while the ability is active.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_deathknight_pillaroffrost.jpg"},[St.GlyphOfVampiricBlood]:{name:"Glyph of Vampiric Blood",description:"Increases the bonus healing received while your Vampiric Blood is active by an additional 15%, but your Vampiric Blood no longer grants you health.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_lifedrain.jpg"},[St.GlyphOfUnholyCommand]:{name:"Glyph of Unholy Command",description:"Immediately finishes the cooldown of your Death Grip upon dealing a killing blow to a target that grants experience or honor.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_skull.jpg"},[St.GlyphOfOutbreak]:{name:"Glyph of Outbreak",description:"Your Outbreak spell no longer has a cooldown, but now costs 30 Runic Power.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_deathvortex.jpg"},[St.GlyphOfDancingRuneWeapon]:{name:"Glyph of Dancing Rune Weapon",description:"Increases your threat generation by 100% while your Dancing Rune Weapon is active, but reduces its damage dealt by 25%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_sword_07.jpg"},[St.GlyphOfDarkSimulacrum]:{name:"Glyph of Dark Simulacrum",description:"Reduces the cooldown of Dark Simulacrum by 30 sec and increases its duration by 4 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_consumemagic.jpg"},[St.GlyphOfDeathCoil]:{name:"Glyph of Death Coil",description:"Your Death Coil spell is now usable on all allies. When cast on a non-undead ally, Death Coil shrouds them with a protective barrier that absorbs up to 168 damage.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_deathcoil.jpg"},[St.GlyphOfDarkSuccor]:{name:"Glyph of Dark Succor",description:"When you kill an enemy that yields experience or honor, while in Frost or Unholy Presence, your next Death Strike within 15s is free and will restore at least 20% of your maximum health.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_deathknight_butcher2.jpg"},[St.GlyphOfSwiftDeath]:{name:"Glyph of Swift Death",description:"The haste effect granted by Soul Reaper now also increases your movement speed by 30% for the duration.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_deathknight_soulreaper.jpg"},[St.GlyphOfLoudHorn]:{name:"Glyph of Loud Horn",description:"Your Horn of Winter now generates an additional 10 Runic Power, but the cooldown is increased by 100%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_horn_04.jpg"},[St.GlyphOfRegenerativeMagic]:{name:"Glyph of Regenerative Magic",description:"If Anti-Magic Shell expires after its full duration, the cooldown is reduced by up to 50%, based on the amount of damage absorbtion remaining.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_antimagicshell.jpg"},[St.GlyphOfFesteringBlood]:{name:"Glyph of Festering Blood",description:"Blood Boil will now treat all targets as though they have Blood Plague or Frost Fever applied.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_yorsahj_bloodboil_green.jpg"}},minorGlyphs:{[xt.GlyphOfTheGeist]:{name:"Glyph of the Geist",description:"Your Raise Dead spell summons a geist instead of a ghoul.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_animatedead.jpg"},[xt.GlyphOfDeathsEmbrace]:{name:"Glyph of Death's Embrace",description:"Your Death Coil refunds 20 Runic Power when used to heal an allied minion, but will no longer trigger Blood Tap when used this way.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_deathcoil.jpg"},[xt.GlyphOfHornOfWinter]:{name:"Glyph of Horn of Winter",description:"When used outside of combat, your Horn of Winter ability causes a brief, localized snow flurry.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_horn_02.jpg"},[xt.GlyphOfArmyOfTheDead]:{name:"Glyph of Army of the Dead",description:"The ghouls summoned by your Army of the Dead no longer taunt their target.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_deathknight_armyofthedead.jpg"},[xt.GlyphOfFoulMenagerie]:{name:"Glyph of Foul Menagerie",description:"Causes your Army of the Dead spell to summon an assortment of undead minions.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_deathknight_armyofthedead.jpg"},[xt.GlyphOfPathOfFrost]:{name:"Glyph of Path of Frost",description:"Your Path of Frost ability allows you to fall from a greater distance without suffering damage.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_deathknight_pathoffrost.jpg"},[xt.GlyphOfResilientGrip]:{name:"Glyph of Resilient Grip",description:"When your Death Grip ability fails because its target is immune, its cooldown is reset.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/warlock_curse_shadow.jpg"},[xt.GlyphOfDeathGate]:{name:"Glyph of Death Gate",description:"Reduces the cast time of your Death Gate spell by 60%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_arcane_teleportundercity.jpg"},[xt.GlyphOfCorpseExplosion]:{name:"Glyph of Corpse Explosion",description:"Teaches you the ability Corpse Explosion.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_corpseexplode.jpg"},[xt.GlyphOfTranquilGrip]:{name:"Glyph of Tranquil Grip",description:"Your Death Grip spell no longer taunts the target.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_envelopingshadows.jpg"},[xt.GlyphOfTheSkeleton]:{name:"Glyph of the Skeleton",description:"Your Raise Dead spell summons a skeleton instead of a ghoul.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_bone_humanskull_01.jpg"},[xt.GlyphOfTheLongWinter]:{name:"Glyph of the Long Winter",description:"The effect of your Horn of Winter now lasts for 1 hour.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_deathknight_remorselesswinters.jpg"}}},Df=Af({backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/cata/TODO.jpg",talents:[{fieldName:"felineSwiftness",fancyName:"Feline Swiftness",location:{rowIdx:0,colIdx:0},spellId:131768},{fieldName:"displacerBeast",fancyName:"Displacer Beast",location:{rowIdx:0,colIdx:1},spellId:102280},{fieldName:"wildCharge",fancyName:"Wild Charge",location:{rowIdx:0,colIdx:2},spellId:102401},{fieldName:"yserasGift",fancyName:"Ysera's Gift",location:{rowIdx:1,colIdx:0},spellId:145108},{fieldName:"renewal",fancyName:"Renewal",location:{rowIdx:1,colIdx:1},spellId:108238},{fieldName:"cenarionWard",fancyName:"Cenarion Ward",location:{rowIdx:1,colIdx:2},spellId:102351},{fieldName:"faerieSwarm",fancyName:"Faerie Swarm",location:{rowIdx:2,colIdx:0},spellId:106707},{fieldName:"massEntanglement",fancyName:"Mass Entanglement",location:{rowIdx:2,colIdx:1},spellId:102359},{fieldName:"typhoon",fancyName:"Typhoon",location:{rowIdx:2,colIdx:2},spellId:132469},{fieldName:"soulOfTheForest",fancyName:"Soul of the Forest",location:{rowIdx:3,colIdx:0},spellId:114107},{fieldName:"incarnation",fancyName:"Incarnation",location:{rowIdx:3,colIdx:1},spellId:106731},{fieldName:"forceOfNature",fancyName:"Force of Nature",location:{rowIdx:3,colIdx:2},spellId:106737},{fieldName:"disorientingRoar",fancyName:"Disorienting Roar",location:{rowIdx:4,colIdx:0},spellId:99},{fieldName:"ursolsVortex",fancyName:"Ursol's Vortex",location:{rowIdx:4,colIdx:1},spellId:102793},{fieldName:"mightyBash",fancyName:"Mighty Bash",location:{rowIdx:4,colIdx:2},spellId:5211},{fieldName:"heartOfTheWild",fancyName:"Heart of the Wild",location:{rowIdx:5,colIdx:0},spellId:108288},{fieldName:"dreamOfCenarius",fancyName:"Dream of Cenarius",location:{rowIdx:5,colIdx:1},spellId:108373},{fieldName:"naturesVigil",fancyName:"Nature's Vigil",location:{rowIdx:5,colIdx:2},spellId:124974}]}),Mf={majorGlyphs:{[kt.GlyphOfFrenziedRegeneration]:{name:"Glyph of Frenzied Regeneration",description:"For 6s after activating Frenzied Regeneration, healing effects on you are 40% more powerful. However, your Frenzied Regeneration now always costs 50 Rage and no longer converts Rage into health.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_bullrush.jpg"},[kt.GlyphOfMaul]:{name:"Glyph of Maul",description:"Your Maul ability now hits 1 additional target for 50% damage.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_maul.jpg"},[kt.GlyphOfOmens]:{name:"Glyph of Omens",description:"While you are not in an Eclipse, the following abilities now grant 10 Solar or Lunar Energy: Entangling Roots, Cyclone, Faerie Fire, Faerie Swarm, Mass Entanglement, Typhoon, Disorienting Roar, Ursol's Vortex, and Mighty Bash.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_vehicle_sonicshockwave.jpg"},[kt.GlyphOfShred]:{name:"Glyph of Shred",description:"While Berserk or Tiger's Fury is active, Shred has no positional requirement.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_vampiricaura.jpg"},[kt.GlyphOfProwl]:{name:"Glyph of Prowl",description:"Reduces the movement penalty of Prowl by 100%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_prowl.jpg"},[kt.GlyphOfPounce]:{name:"Glyph of Pounce",description:"Increases the range of your Pounce by 8 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_supriseattack.jpg"},[kt.GlyphOfStampede]:{name:"Glyph of Stampede",description:"You can now cast Stampeding Roar without being in Bear Form or Cat Form.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_druid_stampedingroar_cat.jpg"},[kt.GlyphOfInnervate]:{name:"Glyph of Innervate",description:"When Innervate is cast on a target other than the caster, both the caster and target will benefit, but at 40% reduced effect.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_lightning.jpg"},[kt.GlyphOfRebirth]:{name:"Glyph of Rebirth",description:"Players resurrected by Rebirth are returned to life with 100% health.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_reincarnation.jpg"},[kt.GlyphOfRegrowth]:{name:"Glyph of Regrowth",description:"Increases the critical strike chance of your Regrowth by 40%, but removes the periodic component of the spell.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_resistnature.jpg"},[kt.GlyphOfRejuvenation]:{name:"Glyph of Rejuvenation",description:"When you have Rejuvenation active on three or more targets, the cast time of your Nourish spell is reduced by 30%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_rejuvenation.jpg"},[kt.GlyphOfHealingTouch]:{name:"Glyph of Healing Touch",description:"When you cast Healing Touch, the cooldown on your Nature's Swiftness is reduced by 3 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_healingtouch.jpg"},[kt.GlyphOfEfflorescence]:{name:"Glyph of Efflorescence",description:"The Efflorescence effect is now caused by your Wild Mushroom instead of by Swiftmend, and lasts as long as the Wild Mushroom is active. Additionally, increases the healing done by Swiftmend by 20%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_healingtouch.jpg"},[kt.GlyphOfGuidedStars]:{name:"Glyph of Guided Stars",description:"Your Starfall only hits targets affected by your Moonfire or Sunfire.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_mage_arcanebarrage.jpg"},[kt.GlyphOfHurricane]:{name:"Glyph of Hurricane",description:"Your Hurricane and Astral Storm abilities now also slow the movement speed of their victims by 50%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_cyclone.jpg"},[kt.GlyphOfSkullBash]:{name:"Glyph of Skull Bash",description:"Increases the duration of your Skull Bash interrupt by 2 sec, but increases the cooldown by 5 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_bone_taurenskull_01.jpg"},[kt.GlyphOfNaturesGrasp]:{name:"Glyph of Nature's Grasp",description:"Reduces the cooldown of Nature's Grasp by 45 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_natureswrath.jpg"},[kt.GlyphOfSavagery]:{name:"Glyph of Savagery",description:"Savage Roar can now be used with 0 combo points, resulting in a 12s duration.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_skinteeth.jpg"},[kt.GlyphOfEntanglingRoots]:{name:"Glyph of Entangling Roots",description:"Reduces the cast time of your Entangling Roots by 0.2 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_stranglevines.jpg"},[kt.GlyphOfBlooming]:{name:"Glyph of Blooming",description:"Increases the bloom heal of your Lifebloom when it expires by 50%, but its duration is reduced by 5 sec and your Healing Touch, Nourish, and Regrowth abilities no longer refresh the duration.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_protectionformnature.jpg"},[kt.GlyphOfDash]:{name:"Glyph of Dash",description:"Reduces the cooldown of your Dash ability by 60 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_dash.jpg"},[kt.GlyphOfMasterShapeshifter]:{name:"Glyph of Master Shapeshifter",description:"Reduces the mana cost of all shapeshifts by 100%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_mastershapeshifter.jpg"},[kt.GlyphOfSurvivalInstincts]:{name:"Glyph of Survival Instincts",description:"Reduces the cooldown of Survival Instincts by 60 sec, but reduces its duration by 50%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_tigersroar.jpg"},[kt.GlyphOfWildGrowth]:{name:"Glyph of Wild Growth",description:"Wild Growth can affect 1 additional target, but its cooldown is increased by 2 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_flourish.jpg"},[kt.GlyphOfMightOfUrsoc]:{name:"Glyph of Might of Ursoc",description:"Increases the health gain from Might of Ursoc by 20%, but increases the cooldown by 2 min.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_druid_mightofursoc.jpg"},[kt.GlyphOfStampedingRoar]:{name:"Glyph of Stampeding Roar",description:"Increases the radius of Stampeding Roar by 30 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_druid_stamedingroar.jpg"},[kt.GlyphOfCyclone]:{name:"Glyph of Cyclone",description:"Increases the range of your Cyclone spell by 5 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_earthbind.jpg"},[kt.GlyphOfBarkskin]:{name:"Glyph of Barkskin",description:"Reduces the chance you'll be critically hit by 25% while Barkskin is active.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_stoneclawtotem.jpg"},[kt.GlyphOfFerociousBite]:{name:"Glyph of Ferocious Bite",description:"Your Ferocious Bite ability heals you for 2% of your maximum health for each 10 Energy used.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_ferociousbite.jpg"},[kt.GlyphOfFaeSilence]:{name:"Glyph of Fae Silence",description:"Faerie Fire used in Bear Form also silences the target for 3s, but triggers a 15 sec cooldown.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_challangingroar.jpg"},[kt.GlyphOfFaerieFire]:{name:"Glyph of Faerie Fire",description:"Increases the range of your Faerie Fire by 10 yds.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_faeriefire.jpg"},[kt.GlyphOfCatForm]:{name:"Glyph of Cat Form",description:"Increases healing done to you by 20% while in Cat Form.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_catform.jpg"}},minorGlyphs:{[_t.GlyphOfTheStag]:{name:"Glyph of the Stag",description:"Your Travel Form can now be used as a mount by party members. This glyph is disabled while Glyph of the Cheetah is active.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/trade_archaeology_antleredcloakclasp.jpg"},[_t.GlyphOfTheOrca]:{name:"Glyph of the Orca",description:"Your Aquatic Form now appears as an Orca.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_aquaticform.jpg"},[_t.GlyphOfAquaticForm]:{name:"Glyph of Aquatic Form",description:"Increases your swim speed by 50% while in Aquatic Form.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_enchant_essencemagiclarge.jpg"},[_t.GlyphOfGrace]:{name:"Glyph of Grace",description:"Feline Grace reduces falling damage even while not in Cat Form.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_feather_01.jpg"},[_t.GlyphOfTheChameleon]:{name:"Glyph of the Chameleon",description:"Each time you shapeshift into Cat Form or Bear Form, your shapeshifted form will have a random hair color.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_mastershapeshifter.jpg"},[_t.GlyphOfCharmWoodlandCreature]:{name:"Glyph of Charm Woodland Creature",description:"Teaches you the ability Charm Woodland Creature.\r\n\r\n Allows the Druid to befriend an ambient creature, which will follow the Druid for 1hr.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_rabbit.jpg"},[_t.GlyphOfStars]:{name:"Glyph of Stars",description:"Your Moonkin Form now appears as Astral Form, conferring all the same benefits, but appearing as an astrally enhanced version of your normal humanoid form.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/achievement_boss_algalon_01.jpg"},[_t.GlyphOfThePredator]:{name:"Glyph of the Predator",description:"Your Track Humanoids ability now also tracks beasts.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_tracking.jpg"},[_t.GlyphOfTheTreant]:{name:"Glyph of the Treant",description:"Teaches you the ability Treant Form.\r\n\r\n Shapeshift into Treant Form.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_treeoflife.jpg"},[_t.GlyphOfTheCheetah]:{name:"Glyph of the Cheetah",description:"Your Travel Form appears as a Cheetah. This glyph will prevent Glyph of the Stag from functioning.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_hunter_catlikereflexes.jpg"},[_t.GlyphOfFocus]:{name:"Glyph of Focus",description:"Reduces Starfall's radius by 50%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_arcane_arcanepotency.jpg"},[_t.GlyphOfTheSproutingMushroom]:{name:"Glyph of the Sprouting Mushroom",description:"Your Wild Mushroom spell can now be placed on the ground instead of underneath a target.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_druid_wildmushroom.jpg"},[_t.GlyphOfOneWithNature]:{name:"Glyph of One with Nature",description:"Grants you the ability to teleport to a random natural location.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_manatree.jpg"}}},Lf=Af({backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/cata/TODO.jpg",talents:[{fieldName:"posthaste",fancyName:"Posthaste",location:{rowIdx:0,colIdx:0},spellId:109215},{fieldName:"narrowEscape",fancyName:"Narrow Escape",location:{rowIdx:0,colIdx:1},spellId:109298},{fieldName:"crouchingTigerHiddenChimera",fancyName:"Crouching Tiger, Hidden Chimera",location:{rowIdx:0,colIdx:2},spellId:118675},{fieldName:"bindingShot",fancyName:"Binding Shot",location:{rowIdx:1,colIdx:0},spellId:109248},{fieldName:"wyvernSting",fancyName:"Wyvern Sting",location:{rowIdx:1,colIdx:1},spellId:19386},{fieldName:"intimidation",fancyName:"Intimidation",location:{rowIdx:1,colIdx:2},spellId:19577},{fieldName:"exhilaration",fancyName:"Exhilaration",location:{rowIdx:2,colIdx:0},spellId:109304},{fieldName:"aspectOfTheIronHawk",fancyName:"Aspect of the Iron Hawk",location:{rowIdx:2,colIdx:1},spellId:109260},{fieldName:"spiritBond",fancyName:"Spirit Bond",location:{rowIdx:2,colIdx:2},spellId:109212},{fieldName:"fervor",fancyName:"Fervor",location:{rowIdx:3,colIdx:0},spellId:82726},{fieldName:"direBeast",fancyName:"Dire Beast",location:{rowIdx:3,colIdx:1},spellId:120679},{fieldName:"thrillOfTheHunt",fancyName:"Thrill of the Hunt",location:{rowIdx:3,colIdx:2},spellId:109306},{fieldName:"aMurderOfCrows",fancyName:"A Murder of Crows",location:{rowIdx:4,colIdx:0},spellId:131894},{fieldName:"blinkStrikes",fancyName:"Blink Strikes",location:{rowIdx:4,colIdx:1},spellId:130392},{fieldName:"lynxRush",fancyName:"Lynx Rush",location:{rowIdx:4,colIdx:2},spellId:120697},{fieldName:"glaiveToss",fancyName:"Glaive Toss",location:{rowIdx:5,colIdx:0},spellId:117050},{fieldName:"powershot",fancyName:"Powershot",location:{rowIdx:5,colIdx:1},spellId:109259},{fieldName:"barrage",fancyName:"Barrage",location:{rowIdx:5,colIdx:2},spellId:120360}]}),Nf={majorGlyphs:{[It.GlyphOfCamouflage]:{name:"Glyph of Camouflage",description:"Your Camouflage ability now provides stealth even while moving, but your movement speed while Camouflage is active is reduced by 50%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_hunter_displacement.jpg"},[It.GlyphOfLiberation]:{name:"Glyph of Liberation",description:"When you Disengage, you are healed for 5% of your total health.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/achievement_bg_returnxflags_def_wsg.jpg"},[It.GlyphOfMending]:{name:"Glyph of Mending",description:"Your Mend Pet now heals every 1 sec, and heals for an additional 25% of your pet's health over its duration.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_bandage_15.jpg"},[It.GlyphOfDistractingShot]:{name:"Glyph of Distracting Shot",description:"Your Distracting Shot now distracts the target to attack your pet instead of you.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_arcane_blink.jpg"},[It.GlyphOfEndlessWrath]:{name:"Glyph of Endless Wrath",description:"While Bestial Wrath is active, your pet cannot be killed, but can still be damaged.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_ferociousbite.jpg"},[It.GlyphOfDeterrence]:{name:"Glyph of Deterrence",description:"Increases the damage reduction granted by Deterrence by 20%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_whirlwind.jpg"},[It.GlyphOfDisengage]:{name:"Glyph of Disengage",description:"Increases the distance you travel when you Disengage.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_feint.jpg"},[It.GlyphOfFreezingTrap]:{name:"Glyph of Freezing Trap",description:"When your Freezing Trap breaks, the victim's movement speed is reduced by 70% for 4s.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_frost_chainsofice.jpg"},[It.GlyphOfIceTrap]:{name:"Glyph of Ice Trap",description:"Increases the radius of the effect from your Ice Trap by 2 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_hunter_icetrap.jpg"},[It.GlyphOfMisdirection]:{name:"Glyph of Misdirection",description:"When you use Misdirection on your pet, the cooldown on your Misdirection is reset.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_hunter_misdirection.jpg"},[It.GlyphOfExplosiveTrap]:{name:"Glyph of Explosive Trap",description:"Your Explosive Trap no longer deals damage, instead knocking enemies back from the trap when it explodes.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_fire_selfdestruct.jpg"},[It.GlyphOfAnimalBond]:{name:"Glyph of Animal Bond",description:"While your pet is active, all healing done to you and your pet is increased by 10%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_demoralizingroar.jpg"},[It.GlyphOfNoEscape]:{name:"Glyph of No Escape",description:"Increases the ranged critical strike chance of all of your attacks on targets affected by your Freezing Trap by 100%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_hunter_pointofnoescape.jpg"},[It.GlyphOfPathfinding]:{name:"Glyph of Pathfinding",description:"Increases the speed bonus of your Aspect of the Cheetah and Aspect of the Pack by 8%, and increases your speed while mounted by 10%. The mounted movement speed increase does not stack with other effects.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_hunter_pathfinding2.jpg"},[It.GlyphOfSnakeTrap]:{name:"Glyph of Snake Trap",description:"Snakes from your Snake Trap take 90% reduced damage from area of effect attacks.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_hunter_snaketrap.jpg"},[It.GlyphOfAimedShot]:{name:"Glyph of Aimed Shot",description:"Your Aimed Shot can now be used while moving.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_spear_07.jpg"},[It.GlyphOfMendPet]:{name:"Glyph of Mend Pet",description:"Gives your Mend Pet ability a 100% chance of cleansing 1 Curse, Disease, Magic or Poison effect from your pet each tick.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_hunter_mendpet.jpg"},[It.GlyphOfSolace]:{name:"Glyph of Solace",description:"Your Freezing Trap and Scatter Shot also remove all damage over time effects from their targets.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_frost_frostshock.jpg"},[It.GlyphOfChimeraShot]:{name:"Glyph of Chimera Shot",description:"Increases the healing you receive from Chimera Shot by an additional 2% of your maximum health.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_hunter_chimerashot2.jpg"},[It.GlyphOfTranquilizingShot]:{name:"Glyph of Tranquilizing Shot",description:"Your Tranquilizing Shot no longer costs Focus, but has a 10 sec cooldown.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_drowsy.jpg"},[It.GlyphOfMastersCall]:{name:"Glyph of Master's Call",description:"Increases the duration of your Master's Call by 4.0 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_hunter_masterscall.jpg"},[It.GlyphOfScatterShot]:{name:"Glyph of Scatter Shot",description:"Increases the range of Scatter Shot by 3 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_golemstormbolt.jpg"},[It.GlyphOfMirroredBlades]:{name:"Glyph of Mirrored Blades",description:"When attacked by a spell while in Deterrence, you have a 100% chance to reflect it back at the attacker.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_weapon_shortblade_99.jpg"},[It.GlyphOfBlackIce]:{name:"Glyph of Black Ice",description:"While you move through the area affected by your Ice Trap you gain 50% movement speed.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_hunter_blackicetrap.jpg"},[It.GlyphOfTheLeanPack]:{name:"Glyph of the Lean Pack",description:"Reduces the radius of Aspect of the Pack by 33 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_hunter_aspectmastery.jpg"},[It.GlyphOfEnduringDeceit]:{name:"Glyph of Enduring Deceit",description:"Camouflage also reduces spell damage taken by 10%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_hunter_camouflage.jpg"}},minorGlyphs:{[Ct.GlyphOfAspects]:{name:"Glyph of Aspects",description:"Each time you activate a new Aspect, an animal companion representing that Aspect will follow you for 15s.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_hunter_aspectmastery.jpg"},[Ct.GlyphOfTameBeast]:{name:"Glyph of Tame Beast",description:"Reduces the time required to complete Tame Beast by 4 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_hunter_beasttaming.jpg"},[Ct.GlyphOfRevivePet]:{name:"Glyph of Revive Pet",description:"Reduces the pushback suffered from damaging attacks while casting Revive Pet by 100%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_hunter_beastsoothe.jpg"},[Ct.GlyphOfLesserProportion]:{name:"Glyph of Lesser Proportion",description:"Slightly reduces the size of your pet.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_hunter_bestialdiscipline.jpg"},[Ct.GlyphOfFireworks]:{name:"Glyph of Fireworks",description:"Teaches you the ability Fireworks.\r\n\r\n Launch fireworks from your gun, bow or crossbow.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_missilelargecluster_red.jpg"},[Ct.GlyphOfAspectOfThePack]:{name:"Glyph of Aspect of the Pack",description:"Increases the range of your Aspect of the Pack ability by 15 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_mount_whitetiger.jpg"},[Ct.GlyphOfStampedeHunter]:{name:"Glyph of Stampede",description:"Your Stampede no longer summons pets from your stable, and instead uses copies of your current pet.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_hunter_bestialdiscipline.jpg"},[Ct.GlyphOfAspectOfTheCheetah]:{name:"Glyph of Aspect of the Cheetah",description:"Your Aspect of the Cheetah no longer causes you to be dazed when struck. Instead, the effect is cancelled and all your Aspects are placed on a 4 sec cooldown.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_mount_jungletiger.jpg"},[Ct.GlyphOfAspectOfTheBeast]:{name:"Glyph of Aspect of the Beast",description:"Teaches you the ability Aspect of the Beast.\r\n\r\n The Hunter takes on the aspects of a beast, becoming untrackable. Only one Aspect can be active at a time.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_mount_pinktiger.jpg"},[Ct.GlyphOfDirection]:{name:"Glyph of Direction",description:"Causes your Misdirection target to appear larger.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_hunter_markedfordeath.jpg"},[Ct.GlyphOfMarking]:{name:"Glyph of Marking",description:"Your Hunter's Mark ability now places a bullseye on your target instead of its usual visual.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_hunter_mastermarksman.jpg"},[Ct.GlyphOfFetch]:{name:"Glyph of Fetch",description:"Teaches you the ability Fetch.\r\n\r\n Command your pet to retrieve the loot from a nearby corpse within 40 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_bone_01.jpg"},[Ct.GlyphOfFocusedFire]:{name:"Glyph of Focused Fire",description:"Focus Fire charges apply a visual to you for each charge active.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_hunter_aspectmastery.jpg"},[Ct.GlyphOfChameleon]:{name:"Glyph of Chameleon",description:"Focus Fire charges apply a visual to you for each charge active.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_hunter_aspectmastery.jpg"}}},Of=Af({backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/cata/TODO.jpg",talents:[{fieldName:"presenceOfMind",fancyName:"Presence of Mind",location:{rowIdx:0,colIdx:0},spellId:12043},{fieldName:"blazingSpeed",fancyName:"Blazing Speed",location:{rowIdx:0,colIdx:1},spellId:108843},{fieldName:"iceFloes",fancyName:"Ice Floes",location:{rowIdx:0,colIdx:2},spellId:108839},{fieldName:"temporalShield",fancyName:"Temporal Shield",location:{rowIdx:1,colIdx:0},spellId:115610},{fieldName:"flameglow",fancyName:"Flameglow",location:{rowIdx:1,colIdx:1},spellId:140468},{fieldName:"iceBarrier",fancyName:"Ice Barrier",location:{rowIdx:1,colIdx:2},spellId:11426},{fieldName:"ringOfFrost",fancyName:"Ring of Frost",location:{rowIdx:2,colIdx:0},spellId:113724},{fieldName:"iceWard",fancyName:"Ice Ward",location:{rowIdx:2,colIdx:1},spellId:111264},{fieldName:"frostjaw",fancyName:"Frostjaw",location:{rowIdx:2,colIdx:2},spellId:102051},{fieldName:"greaterInvisibility",fancyName:"Greater Invisibility",location:{rowIdx:3,colIdx:0},spellId:110959},{fieldName:"cauterize",fancyName:"Cauterize",location:{rowIdx:3,colIdx:1},spellId:86949},{fieldName:"coldSnap",fancyName:"Cold Snap",location:{rowIdx:3,colIdx:2},spellId:11958},{fieldName:"netherTempest",fancyName:"Nether Tempest",location:{rowIdx:4,colIdx:0},spellId:114923},{fieldName:"livingBomb",fancyName:"Living Bomb",location:{rowIdx:4,colIdx:1},spellId:44457},{fieldName:"frostBomb",fancyName:"Frost Bomb",location:{rowIdx:4,colIdx:2},spellId:112948},{fieldName:"invocation",fancyName:"Invocation",location:{rowIdx:5,colIdx:0},spellId:114003},{fieldName:"runeOfPower",fancyName:"Rune of Power",location:{rowIdx:5,colIdx:1},spellId:116011},{fieldName:"incantersWard",fancyName:"Incanter's Ward",location:{rowIdx:5,colIdx:2},spellId:1463}]}),Gf={majorGlyphs:{[Tt.GlyphOfArcaneExplosion]:{name:"Glyph of Arcane Explosion",description:"Increases the radius of your Arcane Explosion by 5 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_wispsplode.jpg"},[Tt.GlyphOfBlink]:{name:"Glyph of Blink",description:"Increases the distance you travel with the Blink spell by 8 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_arcane_blink.jpg"},[Tt.GlyphOfEvocation]:{name:"Glyph of Evocation",description:"Your Evocation ability also causes you to regain 60% of your health over its duration.\r\n\r\n With the Invocation talent, you instead gain 10% of your health upon completing an Evocation.\r\n\r\n With the Rune of Power talent, you gain 1% of your health per second while standing in your own Rune of Power.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_purge.jpg"},[Tt.GlyphOfCombustion]:{name:"Glyph of Combustion",description:"Increases the direct damage, the duration of the damage over time effect and the cooldown of Combustion by 100%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_fire_sealoffire.jpg"},[Tt.GlyphOfFrostNova]:{name:"Glyph of Frost Nova",description:"Reduces the cooldown of Frost Nova by 5 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_frost_frostnova.jpg"},[Tt.GlyphOfIceBlock]:{name:"Glyph of Ice Block",description:"When Ice Block terminates, it triggers an instant free Frost Nova and makes you immune to all spells for 3s.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_frost_frost.jpg"},[Tt.GlyphOfSplittingIce]:{name:"Glyph of Splitting Ice",description:"Your Ice Lance and Icicles now hit 1 additional target for 50% damage.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_frost_frostblast.jpg"},[Tt.GlyphOfConeOfCold]:{name:"Glyph of Cone of Cold",description:"Increases the damage done by Cone of Cold by 200%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_frost_glacier.jpg"},[Tt.GlyphOfRapidDisplacement]:{name:"Glyph of Rapid Displacement",description:"Blink now has 2 charges, gaining a charge every 15 sec, but no longer frees the caster from stuns and bonds.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_arcane_blink.jpg"},[Tt.GlyphOfManaGem]:{name:"Glyph of Mana Gem",description:"Your Conjure Mana Gem spell now creates a Brilliant Mana Gem, which holds up to 10 charges.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_jewelcrafting_gem_05.jpg"},[Tt.GlyphOfPolymorph]:{name:"Glyph of Polymorph",description:"Your Polymorph spell also removes all damage over time effects from the target.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_polymorph.jpg"},[Tt.GlyphOfIcyVeins]:{name:"Glyph of Icy Veins",description:"Your Icy Veins causes your Frostbolt, Frostfire Bolt, Ice Lance, and your Water Elemental's Waterbolt spells to split into 3 smaller bolts that each do 40% damage, instead of increasing spell casting speed.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_frost_coldhearted.jpg"},[Tt.GlyphOfSpellsteal]:{name:"Glyph of Spellsteal",description:"Spellsteal now also heals you for 5% of your maximum health when it successfully steals a spell.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_arcane_arcane02.jpg"},[Tt.GlyphOfFrostfireBolt]:{name:"Glyph of Frostfire Bolt",description:"Reduces the cast time of Frostfire Bolt by 0.5 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_mage_frostfirebolt.jpg"},[Tt.GlyphOfRemoveCurse]:{name:"Glyph of Remove Curse",description:"Increases the damage you deal by 5% for 10s after you successfully remove a curse.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_removecurse.jpg"},[Tt.GlyphOfArcanePower]:{name:"Glyph of Arcane Power",description:"Increases the duration and cooldown of Arcane Power by 100%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_lightning.jpg"},[Tt.GlyphOfWaterElemental]:{name:"Glyph of Water Elemental",description:"Increases the health of your Water Elemental by 40%, and allows it to cast while moving. When in Assist mode and in combat, commanding your Water Elemental to Follow will cause it to stay near you and autocast Waterbolt when your target is in range.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_frost_summonwaterelemental_2.jpg"},[Tt.GlyphOfSlow]:{name:"Glyph of Slow",description:"Your Arcane Blast spell applies the Slow spell to any target it damages if no target is currently affected by your Slow.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_slow.jpg"},[Tt.GlyphOfDeepFreeze]:{name:"Glyph of Deep Freeze",description:"Your Deep Freeze spell is no longer on the global cooldown, but its duration is reduced by 1 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_mage_deepfreeze.jpg"},[Tt.GlyphOfCounterspell]:{name:"Glyph of Counterspell",description:"Your Counterspell can now be cast while casting or channeling other spells, but its cooldown is increased by 4 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_frost_iceshock.jpg"},[Tt.GlyphOfInfernoBlast]:{name:"Glyph of Inferno Blast",description:"Your Inferno Blast spell spreads Pyroblast, Ignite, and Combustion to 1 additional target.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_mage_infernoblast.jpg"},[Tt.GlyphOfArmors]:{name:"Glyph of Armors",description:"Reduces the cast time of your Frost Armor, Mage Armor, and Molten Armor spells by 1.5 sec, and increases the defensive effect of each Armor by an additional 10%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_frost_frostarmor02.jpg"}},minorGlyphs:{[Et.GlyphOfLooseMana]:{name:"Glyph of Loose Mana",description:"Your Mana Gem now restores mana over 6 sec, rather than instantly.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_gem_sapphire_02.jpg"},[Et.GlyphOfMomentum]:{name:"Glyph of Momentum",description:"Your Blink spell teleports you in the direction you are moving instead of the direction you are facing.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_arcane_blink.jpg"},[Et.GlyphOfCrittermorph]:{name:"Glyph of Crittermorph",description:"When cast on critters, your Polymorph spells now last 24hrs and can be cast on multiple targets.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_doublepolymorph2.jpg"},[Et.GlyphOfThePorcupine]:{name:"Glyph of the Porcupine",description:"Your Polymorph spell polymorphs the target into a porcupine instead.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_magic_polymorphpig.jpg"},[Et.GlyphOfConjureFamiliar]:{name:"Glyph of Conjure Familiar",description:"Teaches you the ability Conjure Familiar.\r\n\r\n Conjures a familiar stone, containing either an Arcane, Fiery, or Icy Familiar.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_elementalabsorption.jpg"},[Et.GlyphOfTheMonkey]:{name:"Glyph of the Monkey",description:"Your Polymorph spell polymorphs the target into a monkey instead.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_hunter_aspectofthemonkey.jpg"},[Et.GlyphOfThePenguin]:{name:"Glyph of the Penguin",description:"Your Polymorph spell polymorphs the target into a penguin instead.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_penguinpet.jpg"},[Et.GlyphOfTheBearCub]:{name:"Glyph of the Bear Cub",description:"Your Polymorph spell polymorphs the target into a polar bear cub instead.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_pet_babyblizzardbear.jpg"},[Et.GlyphOfArcaneLanguage]:{name:"Glyph of Arcane Language",description:"Your Arcane Brilliance spell allows you to comprehend your allies' racial languages.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_fish_68.jpg"},[Et.GlyphOfIllusion]:{name:"Glyph of Illusion",description:"Teaches you the ability Illusion.\r\n\r\n Transforms the Mage to look like someone else for 2min.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_mask_01.jpg"},[Et.GlyphOfMirrorImage]:{name:"Glyph of Mirror Image",description:"Your Mirror Images cast Arcane Blast or Fireball instead of Frostbolt depending on your primary talent tree.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_magic_lesserinvisibilty.jpg"},[Et.GlyphOfRapidTeleportation]:{name:"Glyph of Rapid Teleportation",description:"After casting a Mage Teleport spell, or entering a Mage Portal, your movement speed is increased by 70% for 1min.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_arcane_portaldalaran.jpg"},[Et.GlyphOfDiscreetMagic]:{name:"Glyph of Discreet Magic",description:"Your Nether Tempest, Living Bomb, Frost Bomb, Arcane Barrage, and Inferno Blast no longer affect targets more than 5 yds away from their primary target.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_enchant_essencemagicsmall.jpg"},[Et.GlyphOfTheUnboundElemental]:{name:"Glyph of the Unbound Elemental",description:"Your Water Elemental is replaced by an Unbound Water Elemental.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_frost_summonwaterelemental.jpg"},[Et.GlyphOfEvaporation]:{name:"Glyph of Evaporation",description:"Reduces the size of your Water Elemental by 40%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_elemental_mote_water01.jpg"},[Et.GlyphOfCondensation]:{name:"Glyph of Condensation",description:"Increases the size of your Water Elemental by 40%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_volatilewater.jpg"}}},zf=Af({backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/cata/TODO.jpg",talents:[{fieldName:"celerity",fancyName:"Celerity",location:{rowIdx:0,colIdx:0},spellId:115173},{fieldName:"tigersLust",fancyName:"Tiger's Lust",location:{rowIdx:0,colIdx:1},spellId:116841},{fieldName:"momentum",fancyName:"Momentum",location:{rowIdx:0,colIdx:2},spellId:115174},{fieldName:"chiWave",fancyName:"Chi Wave",location:{rowIdx:1,colIdx:0},spellId:115098},{fieldName:"zenSphere",fancyName:"Zen Sphere",location:{rowIdx:1,colIdx:1},spellId:124081},{fieldName:"chiBurst",fancyName:"Chi Burst",location:{rowIdx:1,colIdx:2},spellId:123986},{fieldName:"powerStrikes",fancyName:"Power Strikes",location:{rowIdx:2,colIdx:0},spellId:121817},{fieldName:"ascension",fancyName:"Ascension",location:{rowIdx:2,colIdx:1},spellId:115396},{fieldName:"chiBrew",fancyName:"Chi Brew",location:{rowIdx:2,colIdx:2},spellId:115399},{fieldName:"ringOfPeace",fancyName:"Ring of Peace",location:{rowIdx:3,colIdx:0},spellId:116844},{fieldName:"chargingOxWave",fancyName:"Charging Ox Wave",location:{rowIdx:3,colIdx:1},spellId:119392},{fieldName:"legSweep",fancyName:"Leg Sweep",location:{rowIdx:3,colIdx:2},spellId:119381},{fieldName:"healingElixirs",fancyName:"Healing Elixirs",location:{rowIdx:4,colIdx:0},spellId:122280},{fieldName:"dampenHarm",fancyName:"Dampen Harm",location:{rowIdx:4,colIdx:1},spellId:122278},{fieldName:"diffuseMagic",fancyName:"Diffuse Magic",location:{rowIdx:4,colIdx:2},spellId:122783},{fieldName:"rushingJadeWind",fancyName:"Rushing Jade Wind",location:{rowIdx:5,colIdx:0},spellId:116847},{fieldName:"invokeXuenTheWhiteTiger",fancyName:"Invoke Xuen, the White Tiger",location:{rowIdx:5,colIdx:1},spellId:123904},{fieldName:"chiTorpedo",fancyName:"Chi Torpedo",location:{rowIdx:5,colIdx:2},spellId:115008}]}),Ff={majorGlyphs:{[Pt.GlyphOfRapidRolling]:{name:"Glyph of Rapid Rolling",description:"For 5s seconds after using Roll or Chi Torpedo, your next Roll or Chi Torpedo will go 30% farther.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_monk_roll.jpg"},[Pt.GlyphOfTranscendence]:{name:"Glyph of Transcendence",description:"Reduces the cooldown of your Transcendence: Transfer spell by 5 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/monk_ability_transcendence.jpg"},[Pt.GlyphOfBreathOfFire]:{name:"Glyph of Breath of Fire",description:"When you use Breath of Fire on targets afflicted with your Dizzying Haze, they become Disoriented for 3s.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_monk_breathoffire.jpg"},[Pt.GlyphOfClash]:{name:"Glyph of Clash",description:"Increases the range of your Clash ability by 10 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_monk_clashingoxcharge.jpg"},[Pt.GlyphOfEnduringHealingSphere]:{name:"Glyph of Enduring Healing Sphere",description:"Increases the duration of your Healing Spheres by 3 minutes.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_monk_healthsphere.jpg"},[Pt.GlyphOfGuard]:{name:"Glyph of Guard",description:"Increases the amount your Guard absorbs by 10%, but your Guard can only absorb magical damage.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_monk_guard.jpg"},[Pt.GlyphOfManaTea]:{name:"Glyph of Mana Tea",description:"Your Mana Tea is instant instead of channeled and consumes two stacks when used, but causes a 10 sec cooldown.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/monk_ability_cherrymanatea.jpg"},[Pt.GlyphOfZenMeditation]:{name:"Glyph of Zen Meditation",description:"You can now channel Zen Meditation while moving.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_monk_zenmeditation.jpg"},[Pt.GlyphOfRenewingMists]:{name:"Glyph of Renewing Mists",description:"Your Renewing Mist travels to the furthest injured target within 40 yards rather than the closest injured target within 20 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_monk_renewingmists.jpg"},[Pt.GlyphOfSpinningCraneKick]:{name:"Glyph of Spinning Crane Kick",description:"You move at full speed while channeling Spinning Crane Kick.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_monk_cranekick_new.jpg"},[Pt.GlyphOfSurgingMist]:{name:"Glyph of Surging Mist",description:"Your Surging Mist no longer requires a target, and instead heals the lowest health target within 40 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_monk_surgingmist.jpg"},[Pt.GlyphOfTouchOfDeath]:{name:"Glyph of Touch of Death",description:"Your Touch of Death no longer has a Chi cost, but the cooldown is increased by 2 minutes.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_monk_touchofdeath.jpg"},[Pt.GlyphOfNimbleBrew]:{name:"Glyph of Nimble Brew",description:"Clearing an effect with Nimble Brew heals you for 10% of your maximum health.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_monk_nimblebrew.jpg"},[Pt.GlyphOfAfterlife]:{name:"Glyph of Afterlife",description:"Increases the chance to summon a Healing Sphere when you kill an enemy while gaining experience or honor to 100%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_priest_finalprayer.jpg"},[Pt.GlyphOfFistsOfFury]:{name:"Glyph of Fists of Fury",description:"When channeling Fists of Fury, your parry chance is increased by 100%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/monk_ability_fistoffury.jpg"},[Pt.GlyphOfFortifyingBrew]:{name:"Glyph of Fortifying Brew",description:"Your Fortifying Brew reduces damage taken by an additional 5%, but increases your health by 10% rather than 20%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_monk_fortifyingale_new.jpg"},[Pt.GlyphOfLeerOfTheOx]:{name:"Glyph of Leer of the Ox",description:"Teaches you the spell Leer of the Ox.\r\n\r\n |CFFFFFFFFLeer of the Ox|R\r\n Your Ox Statue stirs hatred in the target, reducing their movement speed by 50% and causing them to attack your Black Ox Statue for 8s. The statue must be within 40 yards of the target.\r\n\r\n Requires Black Ox Statue to be active.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_monk_leeroftheox.jpg"},[Pt.GlyphOfLifeCocoon]:{name:"Glyph of Life Cocoon",description:"Life Cocoon can now be cast while stunned.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_monk_chicocoon.jpg"},[Pt.GlyphOfFortuitousSpheres]:{name:"Glyph of Fortuitous Spheres",description:"Falling below 25% health will automatically summon a healing sphere near you at no cost. This effect cannot occur more often than once every 30 seconds.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_monk_healthsphere.jpg"},[Pt.GlyphOfParalysis]:{name:"Glyph of Paralysis",description:"Your Paralysis ability also removes all damage over time effects from the target.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_monk_paralysis.jpg"},[Pt.GlyphOfSparring]:{name:"Glyph of Sparring",description:"While Sparring, you also have a 5% chance to deflect spells from attackers in front of you, stacking up to 3 times.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_monk_sparring.jpg"},[Pt.GlyphOfDetox]:{name:"Glyph of Detox",description:"Detox heals your target for 5% when it successfully removes a harmful effect.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_dispelmagic.jpg"},[Pt.GlyphOfTouchOfKarma]:{name:"Glyph of Touch of Karma",description:"Your Touch of Karma now has a 25 yard range.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_monk_touchofkarma.jpg"},[Pt.GlyphOfTargetedExpulsion]:{name:"Glyph of Targeted Expulsion",description:"Outside of Battlegrounds and Arenas:\r\n Your Uplift no longer costs Chi, but instead costs 10% Mana.\r\n\r\n Inside of Battlegrounds and Arenas:\r\n Expel Harm can now be used on other allies, but the healing is reduced by 50% on them.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_monk_expelharm.jpg"}},minorGlyphs:{[At.GlyphOfSpinningFireBlossom]:{name:"Glyph of Spinning Fire Blossom",description:"Your Spinning Fire Blossom requires an enemy target rather than traveling in front of you, but is no longer capable of rooting targets.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_monk_explodingjadeblossom.jpg"},[At.GlyphOfCracklingTigerLightning]:{name:"Glyph of Crackling Tiger Lightning",description:"Your Crackling Jade Lightning visual is altered to the color of the White Tiger celestial.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_monk_cracklingjadelightning.jpg"},[At.GlyphOfFlyingSerpentKick]:{name:"Glyph of Flying Serpent Kick",description:"Your Flying Serpent Kick automatically ends when you fly into an enemy, triggering the area of effect damage and snare.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_monk_flyingdragonkick.jpg"},[At.GlyphOfHonor]:{name:"Glyph of Honor",description:"You honorably bow after each successful Touch of Death.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/pandarenracial_innerpeace.jpg"},[At.GlyphOfJab]:{name:"Glyph of Jab",description:"You always will attack with hands and fist with Jab, even with non-fist weapons equipped.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_monk_jab.jpg"},[At.GlyphOfRisingTigerKick]:{name:"Glyph of Rising Tiger Kick",description:"Your Rising Sun Kick's visual is altered to the color of the White Tiger.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_monk_risingsunkick.jpg"},[At.GlyphOfSpiritRoll]:{name:"Glyph of Spirit Roll",description:"You can cast Roll or Chi Torpedo while dead as a spirit.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_guardianspirit.jpg"},[At.GlyphOfFightingPose]:{name:"Glyph of Fighting Pose",description:"Your spirit now appears in a fighting pose when using Transcendence.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_monk_dpsstance.jpg"},[At.GlyphOfWaterRoll]:{name:"Glyph of Water Roll",description:"You can Roll or Chi Torpedo over water.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_monk_roll.jpg"},[At.GlyphOfZenFlight]:{name:"Glyph of Zen Flight",description:"Teaches you the spell Zen Flight. Zen Flight requires a Flight Master's License in order to be cast.\r\n\r\n |CFFFFFFFFZen Flight|R\r\n You fly through the air at a quick speed on a meditative cloud.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_monk_zenflight.jpg"},[At.GlyphOfBlackoutKick]:{name:"Glyph of Blackout Kick",description:"Your Blackout Kick always deals 20% additional damage over 4s regardless of positioning but you're unable to trigger the healing effect.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_monk_blackoutkick.jpg"}}},Hf=Af({backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/cata/TODO.jpg",talents:[{fieldName:"speedOfLight",fancyName:"Speed of Light",location:{rowIdx:0,colIdx:0},spellId:85499},{fieldName:"longArmOfTheLaw",fancyName:"Long Arm of the Law",location:{rowIdx:0,colIdx:1},spellId:87172},{fieldName:"pursuitOfJustice",fancyName:"Pursuit of Justice",location:{rowIdx:0,colIdx:2},spellId:26023},{fieldName:"fistOfJustice",fancyName:"Fist of Justice",location:{rowIdx:1,colIdx:0},spellId:105593},{fieldName:"repentance",fancyName:"Repentance",location:{rowIdx:1,colIdx:1},spellId:20066},{fieldName:"evilIsAPointOfView",fancyName:"Evil is a Point of View",location:{rowIdx:1,colIdx:2},spellId:110301},{fieldName:"selflessHealer",fancyName:"Selfless Healer",location:{rowIdx:2,colIdx:0},spellId:85804},{fieldName:"eternalFlame",fancyName:"Eternal Flame",location:{rowIdx:2,colIdx:1},spellId:114163},{fieldName:"sacredShield",fancyName:"Sacred Shield",location:{rowIdx:2,colIdx:2},spellId:20925},{fieldName:"handOfPurity",fancyName:"Hand of Purity",location:{rowIdx:3,colIdx:0},spellId:114039},{fieldName:"unbreakableSpirit",fancyName:"Unbreakable Spirit",location:{rowIdx:3,colIdx:1},spellId:114154},{fieldName:"clemency",fancyName:"Clemency",location:{rowIdx:3,colIdx:2},spellId:105622},{fieldName:"holyAvenger",fancyName:"Holy Avenger",location:{rowIdx:4,colIdx:0},spellId:105809},{fieldName:"sanctifiedWrath",fancyName:"Sanctified Wrath",location:{rowIdx:4,colIdx:1},spellId:53376},{fieldName:"divinePurpose",fancyName:"Divine Purpose",location:{rowIdx:4,colIdx:2},spellId:86172},{fieldName:"holyPrism",fancyName:"Holy Prism",location:{rowIdx:5,colIdx:0},spellId:114165},{fieldName:"lightsHammer",fancyName:"Light's Hammer",location:{rowIdx:5,colIdx:1},spellId:114158},{fieldName:"executionSentence",fancyName:"Execution Sentence",location:{rowIdx:5,colIdx:2},spellId:114157}]}),Uf={majorGlyphs:{[Dt.GlyphOfDoubleJeopardy]:{name:"Glyph of Double Jeopardy",description:"Judging a target increases the damage of your next Judgment by 20%, but only if used on a different second target.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_righteousfury.jpg"},[Dt.GlyphOfDevotionAura]:{name:"Glyph of Devotion Aura",description:"Devotion Aura no longer affects party or raid members, but the cooldown is reduced by 60 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_auramastery.jpg"},[Dt.GlyphOfHolyWrath]:{name:"Glyph of Holy Wrath",description:"Your Holy Wrath now also stuns Elementals, Dragonkin, and Aberrations.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_weaponmastery.jpg"},[Dt.GlyphOfDivineProtection]:{name:"Glyph of Divine Protection",description:"Reduces the magical damage reduction of your Divine Protection to 20% but adds 20% physical damage reduction.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_divineprotection.jpg"},[Dt.GlyphOfTemplarsVerdict]:{name:"Glyph of Templar's Verdict",description:"You take 10% less damage for 6s after dealing damage with Templar's Verdict or Exorcism.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_paladin_templarsverdict.jpg"},[Dt.GlyphOfAvengingWrath]:{name:"Glyph of Avenging Wrath",description:"While Avenging Wrath is active, you are healed for 1% of your maximum health every 0.0 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_avenginewrath.jpg"},[Dt.GlyphOfConsecration]:{name:"Glyph of Consecration",description:"You can now target Consecration anywhere within 25 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_innerfire.jpg"},[Dt.GlyphOfFocusedShield]:{name:"Glyph of Focused Shield",description:"Your Avenger's Shield hits 2 fewer targets, but for 30% more damage.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_avengersshield.jpg"},[Dt.GlyphOfBurdenOfGuilt]:{name:"Glyph of Burden of Guilt",description:"Your Judgment hits fill your target with doubt and remorse, reducing movement speed by 50% for 2s.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/achievement_bg_topdps.jpg"},[Dt.GlyphOfBlindingLight]:{name:"Glyph of Blinding Light",description:"Your Blinding Light now knocks down targets for 3s instead of Blinding them.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_paladin_blindinglight.jpg"},[Dt.GlyphOfFinalWrath]:{name:"Glyph of Final Wrath",description:"Your Holy Wrath does an additional 50% damage to targets with less than 20% health.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_blessedresillience.jpg"},[Dt.GlyphOfWordOfGlory]:{name:"Glyph of Word of Glory",description:"Increases your damage by 3% per Holy Power spent after you cast Word of Glory or Eternal Flame on a friendly target. Lasts 6s.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_helmet_96.jpg"},[Dt.GlyphOfIllumination]:{name:"Glyph of Illumination",description:"Your Holy Shock criticals grant 1% mana return, but Holy Insight returns 10% less mana.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_pureofheart.jpg"},[Dt.GlyphOfHarshWords]:{name:"Glyph of Harsh Words",description:"Your Word of Glory can now also be used on enemy targets, causing Holy damage approximately equal to the amount it would have healed.\r\n\r\n Does not work with Eternal Flame.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_helmet_96.jpg"},[Dt.GlyphOfDivinity]:{name:"Glyph of Divinity",description:"Increases the cooldown of your Lay on Hands by 0 min but causes it to give you 10% of your maximum mana.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_layonhands.jpg"},[Dt.GlyphOfLightOfDawn]:{name:"Glyph of Light of Dawn",description:"Light of Dawn affects 2 fewer targets, but heals each target for 25% more.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_paladin_lightofdawn.jpg"},[Dt.GlyphOfBlessedLife]:{name:"Glyph of Blessed Life",description:"You have a 50% chance to gain a charge of Holy Power whenever you are affected by a Stun, Fear or Immobilize effect.\r\n\r\n This effect cannot occur more than once every 20 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_healingaura.jpg"},[Dt.GlyphOfFlashOfLight]:{name:"Glyph of Flash of Light",description:"When you Flash of Light a target, it increases your next heal done to that target within 7s by 10%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_flashheal.jpg"},[Dt.GlyphOfDenounce]:{name:"Glyph of Denounce",description:"Your Holy Shocks reduce the cast time of your next Denounce by 0.5 sec. This effect stacks up to 3 times.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_purifyingpower.jpg"},[Dt.GlyphOfDazingShield]:{name:"Glyph of Dazing Shield",description:"Your Avenger's Shield now also dazes targets for 10s.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_avengersshield.jpg"},[Dt.GlyphOfImmediateTruth]:{name:"Glyph of Immediate Truth",description:"Increases the instant damage done by Seal of Truth by 40%, but decreases the damage done by Censure by 50%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_sealofvengeance.jpg"},[Dt.GlyphOfBeaconOfLight]:{name:"Glyph of Beacon of Light",description:"Removes the global cooldown on Beacon of Light.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_paladin_beaconoflight.jpg"},[Dt.GlyphOfHammerOfTheRighteous]:{name:"Glyph of Hammer of the Righteous",description:"The physical damage reduction caused by Hammer of the Righteous now lasts 50% longer.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_paladin_hammeroftherighteous.jpg"},[Dt.GlyphOfDivineStorm]:{name:"Glyph of Divine Storm",description:"Your Divine Storm also heals you for 5% of your maximum health.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_paladin_divinestorm.jpg"},[Dt.GlyphOfTheAlabasterShield]:{name:"Glyph of the Alabaster Shield",description:"Your successful blocks increase the damage of your next Shield of the Righteous by 10%. Stacks up to 1 times.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/trade_archaeology_stoneshield.jpg"},[Dt.GlyphOfDivinePlea]:{name:"Glyph of Divine Plea",description:"Divine Plea returns 50% less mana but has a 50% shorter cooldown.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_aspiration.jpg"},[Dt.GlyphOfHolyShock]:{name:"Glyph of Holy Shock",description:"Decreases the healing of Holy Shock by 50% but increases its damage by 50%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_searinglight.jpg"},[Dt.GlyphOfInquisition]:{name:"Glyph of Inquisition",description:"When you land a killing blow on an opponent that yields experience or honor, the duration of your Inquisition is increased by 30 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_paladin_inquisition.jpg"},[Dt.GlyphOfProtectorOfTheInnocent]:{name:"Glyph of Protector of the Innocent",description:"When you use Word of Glory to heal another target, it also heals you for 20% of the amount.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_paladin_protectoroftheinnocent.jpg"},[Dt.GlyphOfTheBattleHealer]:{name:"Glyph of the Battle Healer",description:"Melee attacks from Seal of Insight heal the most wounded member of your raid or party for 30% of the normal heal instead of you.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_vindication.jpg"},[Dt.GlyphOfMassExorcism]:{name:"Glyph of Mass Exorcism",description:"Reduces the range of Exorcism to melee range, but causes 25% damage to all enemies within 8 yards of the primary target.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_excorcism_02.jpg"},[Dt.GlyphOfDivineShield]:{name:"Glyph of Divine Shield",description:"Removing harmful effects with Divine Shield heals you for 10% for each effect removed. This heal cannot exceed 50% of your maximum health.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_divineshield.jpg"},[Dt.GlyphOfHandOfSacrifice]:{name:"Glyph of Hand of Sacrifice",description:"Hand of Sacrifice no longer redirects damage to the Paladin.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_sealofsacrifice.jpg"}},minorGlyphs:{[Rt.GlyphOfTheLuminousCharger]:{name:"Glyph of the Luminous Charger",description:"Your Paladin class mounts glow with holy light.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_crusaderaura.jpg"},[Rt.GlyphOfTheMountedKing]:{name:"Glyph of the Mounted King",description:"Mounting one of your Paladin class mounts automatically casts Blessing of Kings on you.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_magic_greaterblessingofkings.jpg"},[Rt.GlyphOfContemplation]:{name:"Glyph of Contemplation",description:"Teaches you the ability Contemplation.\r\n\r\n Allows you a moment of peace as you kneel in quiet contemplation to ponder the nature of the Light.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_relics_libramofhope.jpg"},[Rt.GlyphOfWingedVengeance]:{name:"Glyph of Winged Vengeance",description:"Your Avenging Wrath depicts 4 wings.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_revivechampion.jpg"},[Rt.GlyphOfSealOfBlood]:{name:"Glyph of Seal of Blood",description:"Your Seal of Truth now uses the Seal of Blood visual.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_sealofvengeance.jpg"},[Rt.GlyphOfFireFromTheHeavens]:{name:"Glyph of Fire From the Heavens",description:"Your Judgment and Hammer of Wrath criticals call down fire from the sky.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_mage_firestarter.jpg"},[Rt.GlyphOfFocusedWrath]:{name:"Glyph of Focused Wrath",description:"Holy Wrath only affects one target.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_weaponmastery.jpg"},[Rt.GlyphOfTheFallingAvenger]:{name:"Glyph of the Falling Avenger",description:"You slow fall during Avenging Wrath.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_magic_featherfall.jpg"},[Rt.GlyphOfTheRighteousRetreat]:{name:"Glyph of the Righteous Retreat",description:"During Divine Shield, you can invoke your Hearthstone 50% faster.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/achievement_guildperk_hastyhearth.jpg"},[Rt.GlyphOfBladedJudgment]:{name:"Glyph of Bladed Judgment",description:"Your Judgment spell depicts an axe or sword instead of a hammer, if you have an axe or sword equipped.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_axe_1h_cataclysm_c_01.jpg"},[Rt.GlyphOfTheExorcist]:{name:"Glyph of the Exorcist",description:"Exorcism will now appear to remove the evil from its target.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_excorcism.jpg"},[Rt.GlyphOfPillarOfLight]:{name:"Glyph of Pillar of Light",description:"Critical heals on other players display a small pillar of light at their location briefly.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_surgeoflight.jpg"}}},Bf=Af({backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/cata/TODO.jpg",talents:[{fieldName:"voidTendrils",fancyName:"Void Tendrils",location:{rowIdx:0,colIdx:0},spellId:108920},{fieldName:"psyfiend",fancyName:"Psyfiend",location:{rowIdx:0,colIdx:1},spellId:108921},{fieldName:"dominateMind",fancyName:"Dominate Mind",location:{rowIdx:0,colIdx:2},spellId:605},{fieldName:"bodyAndSoul",fancyName:"Body and Soul",location:{rowIdx:1,colIdx:0},spellId:64129},{fieldName:"angelicFeather",fancyName:"Angelic Feather",location:{rowIdx:1,colIdx:1},spellId:121536},{fieldName:"phantasm",fancyName:"Phantasm",location:{rowIdx:1,colIdx:2},spellId:108942},{fieldName:"fromDarknessComesLight",fancyName:"From Darkness, Comes Light",location:{rowIdx:2,colIdx:0},spellId:109186},{fieldName:"mindbender",fancyName:"Mindbender",location:{rowIdx:2,colIdx:1},spellId:123040},{fieldName:"solaceAndInsanity",fancyName:"Solace and Insanity",location:{rowIdx:2,colIdx:2},spellId:139139},{fieldName:"desperatePrayer",fancyName:"Desperate Prayer",location:{rowIdx:3,colIdx:0},spellId:19236},{fieldName:"spectralGuise",fancyName:"Spectral Guise",location:{rowIdx:3,colIdx:1},spellId:112833},{fieldName:"angelicBulwark",fancyName:"Angelic Bulwark",location:{rowIdx:3,colIdx:2},spellId:108945},{fieldName:"twistOfFate",fancyName:"Twist of Fate",location:{rowIdx:4,colIdx:0},spellId:109142},{fieldName:"powerInfusion",fancyName:"Power Infusion",location:{rowIdx:4,colIdx:1},spellId:10060},{fieldName:"divineInsight",fancyName:"Divine Insight",location:{rowIdx:4,colIdx:2},spellId:109175},{fieldName:"cascade",fancyName:"Cascade",location:{rowIdx:5,colIdx:0},spellId:121135},{fieldName:"divineStar",fancyName:"Divine Star",location:{rowIdx:5,colIdx:1},spellId:110744},{fieldName:"halo",fancyName:"Halo",location:{rowIdx:5,colIdx:2},spellId:120517}]}),Wf={majorGlyphs:{[Lt.GlyphOfCircleOfHealing]:{name:"Glyph of Circle of Healing",description:"Your Circle of Healing spell heals 1 additional target, but its mana cost is increased by 35%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_circleofrenewal.jpg"},[Lt.GlyphOfPurify]:{name:"Glyph of Purify",description:"Your Purify spell also heals your target for 5% of maximum health when you successfully dispel a magical effect or disease.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_dispelmagic.jpg"},[Lt.GlyphOfFade]:{name:"Glyph of Fade",description:"Your Fade ability now also reduces all damage taken by 10%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_magic_lesserinvisibilty.jpg"},[Lt.GlyphOfFearWard]:{name:"Glyph of Fear Ward",description:"Reduces the cooldown of Fear Ward by 60 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_excorcism.jpg"},[Lt.GlyphOfInnerSanctum]:{name:"Glyph of Inner Sanctum",description:"Spell damage taken is reduced by 6% while within Inner Fire, and the movement speed bonus of your Inner Will is increased by 6%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/priest_icon_innewill.jpg"},[Lt.GlyphOfHolyNova]:{name:"Glyph of Holy Nova",description:"Teaches you the ability Holy Nova.\r\n\r\n Causes an explosion of holy light around the caster, causing 2477 Holy damage to all enemy targets within 10 yards and healing up to 5 targets within 10 yards for 525.\r\n\r\n Healing is divided among the number of targets healed. These effects cause no threat.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_holynova.jpg"},[Lt.GlyphOfInnerFire]:{name:"Glyph of Inner Fire",description:"Increases the armor gained from your Inner Fire spell by 50%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_innerfire.jpg"},[Lt.GlyphOfDeepWells]:{name:"Glyph of Deep Wells",description:"Increases the total amount of charges of your Lightwell by 2.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_summonlightwell.jpg"},[Lt.GlyphOfMassDispel]:{name:"Glyph of Mass Dispel",description:"Causes your Mass Dispel to be potent enough to remove Magic effects that are normally undispellable.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_arcane_massdispel.jpg"},[Lt.GlyphOfPsychicHorror]:{name:"Glyph of Psychic Horror",description:"Reduces the cooldown of your Psychic Horror by -10.0 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_psychichorrors.jpg"},[Lt.GlyphOfHolyFire]:{name:"Glyph of Holy Fire",description:"Increases the range of your Holy Fire, Smite, and Power Word: Solace spells by 10 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_searinglight.jpg"},[Lt.GlyphOfWeakenedSoul]:{name:"Glyph of Weakened Soul",description:"Reduces the duration of the Weakened Soul effect caused by Power Word: Shield by 2 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_ashestoashes.jpg"},[Lt.GlyphOfPowerWordShield]:{name:"Glyph of Power Word: Shield",description:"20% of the absorb from your Power Word: Shield spell is converted into healing.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_powerwordshield.jpg"},[Lt.GlyphOfSpiritOfRedemption]:{name:"Glyph of Spirit of Redemption",description:"Increases the duration of Spirit of Redemption by 10 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_enchant_essenceeternallarge.jpg"},[Lt.GlyphOfPsychicScream]:{name:"Glyph of Psychic Scream",description:"Targets of your Psychic Scream and your Psyfiend's Psychic Terror now tremble in place instead of fleeing in fear.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_psychicscream.jpg"},[Lt.GlyphOfRenew]:{name:"Glyph of Renew",description:"Your Renew heals for 33% more each time it heals, but its duration is reduced by 3 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_renew.jpg"},[Lt.GlyphOfScourgeImprisonment]:{name:"Glyph of Scourge Imprisonment",description:"Reduces the cast time of your Shackle Undead by 1.0 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_crusade.jpg"},[Lt.GlyphOfMindBlast]:{name:"Glyph of Mind Blast",description:"When you critically hit with your Mind Blast, you cause the target to be unable to move for 4s.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_unholyfrenzy.jpg"},[Lt.GlyphOfDispelMagic]:{name:"Glyph of Dispel Magic",description:"Your Dispel Magic spell also damages your target for 4937 Holy damage when you successfully dispel a magical effect.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_nullifydisease.jpg"},[Lt.GlyphOfSmite]:{name:"Glyph of Smite",description:"Your Smite spell inflicts an additional 20% damage against targets afflicted by Power Word: Solace, but that additional damage does not get transferred by Atonement.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_holysmite.jpg"},[Lt.GlyphOfPrayerOfMending]:{name:"Glyph of Prayer of Mending",description:"The first charge of your Prayer of Mending heals for an additional 60% but your Prayer of Mending has 1 fewer charge.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_prayerofmendingtga.jpg"},[Lt.GlyphOfLevitate]:{name:"Glyph of Levitate",description:"Increases your movement speed while Levitating and for 10 sec afterward by 15%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_priest_pathofdevout.jpg"},[Lt.GlyphOfReflectiveShield]:{name:"Glyph of Reflective Shield",description:"Causes 70% of the damage you absorb with Power Word: Shield to reflect back at the attacker. This damage causes no threat.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_priest_reflectiveshield.jpg"},[Lt.GlyphOfDispersion]:{name:"Glyph of Dispersion",description:"Reduces the cooldown on Dispersion by 15 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_dispersion.jpg"},[Lt.GlyphOfLeapOfFaith]:{name:"Glyph of Leap of Faith",description:"Your Leap of Faith spell now also clears all movement impairing effects from your target.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/priest_spell_leapoffaith_a.jpg"},[Lt.GlyphOfPenance]:{name:"Glyph of Penance",description:"Increases the mana cost of Penance by 20% but allows Penance to be cast while moving.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_penance.jpg"},[Lt.GlyphOfFocusedMending]:{name:"Glyph of Focused Mending",description:"Causes your Prayer of Mending to only bounce between the target and the caster.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_healingfocus.jpg"},[Lt.GlyphOfMindSpike]:{name:"Glyph of Mind Spike",description:"Your successful non-instant Mind Spikes, reduce the cast time of your next Mind Blast within 9s by 50%. This effect can stack up to 2 times.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_priest_mindspike.jpg"},[Lt.GlyphOfBindingHeal]:{name:"Glyph of Binding Heal",description:"Your Binding Heal spell now heals a third friendly target within 20 yards, but costs 35% more mana.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_blindingheal.jpg"},[Lt.GlyphOfMindFlay]:{name:"Glyph of Mind Flay",description:"Your Mind Flay spell no longer slows your victim's movement speed. Instead, each time Mind Flay deals damage you will be granted 15% increased movement speed for 5s, stacking up to 3 times.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_siphonmana.jpg"},[Lt.GlyphOfShadowWordDeath]:{name:"Glyph of Shadow Word: Death",description:"Your Shadow Word: Death can now be cast at any time, but deals 25% damage against targets above 20% health and does not generate a Shadow Orb when used against them.\r\n\r\n Casting Shadow Word: Death now also does damage to you equivalent to the damage it would do to an enemy above 20% health.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_demonicfortitude.jpg"},[Lt.GlyphOfVampiricEmbrace]:{name:"Glyph of Vampiric Embrace",description:"Your Vampiric Embrace converts an additional 50% of the damage you deal into healing, but the duration is reduced by 5 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_unsummonbuilding.jpg"},[Lt.GlyphOfLightspring]:{name:"Glyph of Lightspring",description:"Your Lightwell no longer automatically heals nearby targets, but can be clicked by players to deal 50% more healing than normal.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_summonlightwell.jpg"},[Lt.GlyphOfLightwell]:{name:"Glyph of Lightwell",description:"Your Lightwell no longer automatically heals nearby targets, but can be clicked by players to deal 50% more healing than normal.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_summonlightwell.jpg"}},minorGlyphs:{[Mt.GlyphOfShadowRavens]:{name:"Glyph of Shadow Ravens",description:"Your Shadow Orbs now appear as Shadow Ravens.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_priest_shadoworbs.jpg"},[Mt.GlyphOfBorrowedTime]:{name:"Glyph of Borrowed Time",description:"Your Borrowed Time is now displayed visually.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_borrowedtime.jpg"},[Mt.GlyphOfShackleUndead]:{name:"Glyph of Shackle Undead",description:"Changes the appearance of your Shackle Undead.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_slow.jpg"},[Mt.GlyphOfDarkArchangel]:{name:"Glyph of Dark Archangel",description:"When you apply Devouring Plague to a target, you take on the form of a Dark Archangel for 8s.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_summonvoidwalker.jpg"},[Mt.GlyphOfShadow]:{name:"Glyph of Shadow",description:"Alters the appearance of your Shadowform to be less transparent.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_shadowform.jpg"},[Mt.GlyphOfTheHeavens]:{name:"Glyph of the Heavens",description:"Your Levitate targets will appear to be riding on a cloud for the duration of the spell.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_elemental_primal_air.jpg"},[Mt.GlyphOfConfession]:{name:"Glyph of Confession",description:"Teaches you the ability Confession.\r\n\r\n Compels a friendly target to confess a secret.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_soothingkiss.jpg"},[Mt.GlyphOfHolyResurrection]:{name:"Glyph of Holy Resurrection",description:"Your resurrection target appears bathed in holy light for the duration of the Resurrection cast.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_surgeoflight.jpg"},[Mt.GlyphOfTheValkyr]:{name:"Glyph of the Val'kyr",description:"While Spirit of Redemption is active, you now appear as a Val'kyr.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/achievement_boss_svalasorrowgrave.jpg"},[Mt.GlyphOfShadowyFriends]:{name:"Glyph of Shadowy Friends",description:"Your Shadowform extends to your non-combat pets.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_antishadow.jpg"},[Mt.GlyphOfAngels]:{name:"Glyph of Angels",description:"Your heal spells momentarily grant you angelic wings.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_priest_archangel.jpg"},[Mt.GlyphOfTheSha]:{name:"Glyph of the Sha",description:"Transforms your Shadowfiend and Mindbender into a Sha Beast.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_hand_1h_shaclaw.jpg"},[Mt.GlyphOfShiftedAppearances]:{name:"Glyph of Shifted Appearances",description:"Void Shift causes you and your target to exchange appearances for several seconds.\r\n\r\n Does not affect mounted players.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_priest_voidshift.jpg"},[Mt.GlyphOfInspiredHymns]:{name:"Glyph of Inspired Hymns",description:"While channeling Hymns, a spirit appears above you.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_divinehymn.jpg"}}},Vf=Af({backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/cata/TODO.jpg",talents:[{fieldName:"nightstalker",fancyName:"Nightstalker",location:{rowIdx:0,colIdx:0},spellId:14062},{fieldName:"subterfuge",fancyName:"Subterfuge",location:{rowIdx:0,colIdx:1},spellId:108208},{fieldName:"shadowFocus",fancyName:"Shadow Focus",location:{rowIdx:0,colIdx:2},spellId:108209},{fieldName:"deadlyThrow",fancyName:"Deadly Throw",location:{rowIdx:1,colIdx:0},spellId:26679},{fieldName:"nerveStrike",fancyName:"Nerve Strike",location:{rowIdx:1,colIdx:1},spellId:108210},{fieldName:"combatReadiness",fancyName:"Combat Readiness",location:{rowIdx:1,colIdx:2},spellId:74001},{fieldName:"cheatDeath",fancyName:"Cheat Death",location:{rowIdx:2,colIdx:0},spellId:31230},{fieldName:"leechingPoison",fancyName:"Leeching Poison",location:{rowIdx:2,colIdx:1},spellId:108211},{fieldName:"elusiveness",fancyName:"Elusiveness",location:{rowIdx:2,colIdx:2},spellId:79008},{fieldName:"cloakAndDagger",fancyName:"Cloak and Dagger",location:{rowIdx:3,colIdx:0},spellId:138106},{fieldName:"shadowstep",fancyName:"Shadowstep",location:{rowIdx:3,colIdx:1},spellId:36554},{fieldName:"burstOfSpeed",fancyName:"Burst of Speed",location:{rowIdx:3,colIdx:2},spellId:108212},{fieldName:"preyOnTheWeak",fancyName:"Prey on the Weak",location:{rowIdx:4,colIdx:0},spellId:131511},{fieldName:"paralyticPoison",fancyName:"Paralytic Poison",location:{rowIdx:4,colIdx:1},spellId:108215},{fieldName:"dirtyTricks",fancyName:"Dirty Tricks",location:{rowIdx:4,colIdx:2},spellId:108216},{fieldName:"shurikenToss",fancyName:"Shuriken Toss",location:{rowIdx:5,colIdx:0},spellId:114014},{fieldName:"markedForDeath",fancyName:"Marked for Death",location:{rowIdx:5,colIdx:1},spellId:137619},{fieldName:"anticipation",fancyName:"Anticipation",location:{rowIdx:5,colIdx:2},spellId:114015}]}),jf={majorGlyphs:{[Ot.GlyphOfShadowWalk]:{name:"Glyph of Shadow Walk",description:"Your Shadow Walk ability also increases your stealth detection while active.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_envelopingshadows.jpg"},[Ot.GlyphOfAmbush]:{name:"Glyph of Ambush",description:"Increases the range of Ambush by 5 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_ambush.jpg"},[Ot.GlyphOfBladeFlurry]:{name:"Glyph of Blade Flurry",description:"Your attacks have a 30% higher chance of applying Non-Lethal poisons while Blade Flurry is active.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_punishingblow.jpg"},[Ot.GlyphOfSharpKnives]:{name:"Glyph of Sharp Knives",description:"Your Fan of Knives also damages the armor of its victims, applying 1 application of the Weakened Armor effect to each target.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_stone_sharpeningstone_05.jpg"},[Ot.GlyphOfRecuperate]:{name:"Glyph of Recuperate",description:"Increases the healing of your Recuperate ability by an additional 1.0% of your maximum health.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_recuperate.jpg"},[Ot.GlyphOfEvasion]:{name:"Glyph of Evasion",description:"Increases the duration of Evasion by 5 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_shadowward.jpg"},[Ot.GlyphOfRecovery]:{name:"Glyph of Recovery",description:"While Recuperate is active, you receive 20% increased healing from other sources.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_sturdyrecuperate.jpg"},[Ot.GlyphOfExposeArmor]:{name:"Glyph of Expose Armor",description:"Your Expose Armor ability causes three applications of Weakened Armor.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_riposte.jpg"},[Ot.GlyphOfFeint]:{name:"Glyph of Feint",description:"Increases the duration of Feint by 2 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_feint.jpg"},[Ot.GlyphOfGarrote]:{name:"Glyph of Garrote",description:"Increases the duration of your Garrote ability's silence effect by 1.0 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_garrote.jpg"},[Ot.GlyphOfGouge]:{name:"Glyph of Gouge",description:"Your Gouge ability no longer requires that the target be facing you.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_gouge.jpg"},[Ot.GlyphOfSmokeBomb]:{name:"Glyph of Smoke Bomb",description:"Increases the duration of your Smoke Bomb by 2 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_smoke.jpg"},[Ot.GlyphOfCheapShot]:{name:"Glyph of Cheap Shot",description:"Increases the duration of your Cheap Shot by 0.5 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_cheapshot.jpg"},[Ot.GlyphOfHemorraghingVeins]:{name:"Glyph of Hemorraghing Veins",description:"Your Sanguinary Veins ability now also increases damage done to targets affected by your Hemorrhage.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_holy_sealofsacrifice.jpg"},[Ot.GlyphOfKick]:{name:"Glyph of Kick",description:"Increases the cooldown of your Kick ability by 4 sec, but this cooldown is reduced by 6 sec when your Kick successfully interrupts a spell.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_kick.jpg"},[Ot.GlyphOfRedirect]:{name:"Glyph of Redirect",description:"Reduces the cooldown of Redirect by 50 seconds.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_redirect.jpg"},[Ot.GlyphOfShiv]:{name:"Glyph of Shiv",description:"Reduces the cooldown of your Shiv ability by 3 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_throwingknife_04.jpg"},[Ot.GlyphOfSprint]:{name:"Glyph of Sprint",description:"Increases the movement speed of your Sprint ability by an additional 30%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_sprint.jpg"},[Ot.GlyphOfVendetta]:{name:"Glyph of Vendetta",description:"Reduces the damage bonus of your Vendetta ability by 5% but increases its duration by 10 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_deadliness.jpg"},[Ot.GlyphOfStealth]:{name:"Glyph of Stealth",description:"Reduces the cooldown of your Stealth ability by 4 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_stealth.jpg"},[Ot.GlyphOfDeadlyMomentum]:{name:"Glyph of Deadly Momentum",description:"When you land a killing blow on an opponent that yields experience or honor, your Slice and Dice and Recuperate abilities are refreshed to their original duration.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_deadlymomentum.jpg"},[Ot.GlyphOfCloakOfShadows]:{name:"Glyph of Cloak of Shadows",description:"While Cloak of Shadows is active, you take 40% less physical damage.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_nethercloak.jpg"},[Ot.GlyphOfVanish]:{name:"Glyph of Vanish",description:"Increases the duration of your Vanish effect by 2 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_vanish.jpg"},[Ot.GlyphOfBlind]:{name:"Glyph of Blind",description:"Your Blind ability also removes all damage over time effects from the target that would cause Blind to break early.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_mindsteal.jpg"}},minorGlyphs:{[Nt.GlyphOfDecoy]:{name:"Glyph of Decoy",description:"When you Vanish, you leave behind a brief illusion that very closely resembles you.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_vanish.jpg"},[Nt.GlyphOfDetection]:{name:"Glyph of Detection",description:"Teaches you the ability Detection.\r\n\r\n Focus intently on trying to detect certain creatures.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_spy.jpg"},[Nt.GlyphOfHemorrhage]:{name:"Glyph of Hemorrhage",description:"Your Hemorrhage ability only causes lingering damage over time to targets that were already afflicted by a Bleed effect.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_lifedrain.jpg"},[Nt.GlyphOfPickPocket]:{name:"Glyph of Pick Pocket",description:"Increases the range of your Pick Pocket ability by 5 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_bag_11.jpg"},[Nt.GlyphOfDistract]:{name:"Glyph of Distract",description:"Increases the range of your Distract ability by 5 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_distract.jpg"},[Nt.GlyphOfPickLock]:{name:"Glyph of Pick Lock",description:"Reduces the cast time of your Pick Lock ability by 100%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_moonkey.jpg"},[Nt.GlyphOfSafeFall]:{name:"Glyph of Safe Fall",description:"Increases the distance your Safe Fall ability allows you to fall without taking damage.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_feather_01.jpg"},[Nt.GlyphOfBlurredSpeed]:{name:"Glyph of Blurred Speed",description:"Enables you to walk on water while your Sprint ability is active.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_sprint.jpg"},[Nt.GlyphOfPoisons]:{name:"Glyph of Poisons",description:"You apply poisons to your weapons 50% faster.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/trade_brewpoison.jpg"},[Nt.GlyphOfKillingSpree]:{name:"Glyph of Killing Spree",description:"Your Killing Spree returns you to your starting location when the effect ends.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_murderspree.jpg"},[Nt.GlyphOfTricksOfTheTrade]:{name:"Glyph of Tricks of the Trade",description:"Your Tricks of the Trade ability no longer costs Energy, but also no longer increases the damage dealt by the target.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_tricksofthetrade.jpg"},[Nt.GlyphOfDisguise]:{name:"Glyph of Disguise",description:"When you Pick Pocket a humanoid enemy, you also copy their appearance for 5min. Your disguise will unravel upon entering combat.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_disguise.jpg"},[Nt.GlyphOfHeadhunting]:{name:"Glyph of Headhunting",description:"Your Throw and Deadly Throw abilities will now throw axes regardless of your currently equipped weapon.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_throwingaxe_03.jpg"},[Nt.GlyphOfImprovedDistraction]:{name:"Glyph of Improved Distraction",description:"Distract now summons a decoy at the target location.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_distract.jpg"}}},Yf=Af({backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/cata/TODO.jpg",talents:[{fieldName:"naturesGuardian",fancyName:"Nature's Guardian",location:{rowIdx:0,colIdx:0},spellId:30884},{fieldName:"stoneBulwarkTotem",fancyName:"Stone Bulwark Totem",location:{rowIdx:0,colIdx:1},spellId:108270},{fieldName:"astralShift",fancyName:"Astral Shift",location:{rowIdx:0,colIdx:2},spellId:108271},{fieldName:"frozenPower",fancyName:"Frozen Power",location:{rowIdx:1,colIdx:0},spellId:63374},{fieldName:"earthgrabTotem",fancyName:"Earthgrab Totem",location:{rowIdx:1,colIdx:1},spellId:51485},{fieldName:"windwalkTotem",fancyName:"Windwalk Totem",location:{rowIdx:1,colIdx:2},spellId:108273},{fieldName:"callOfTheElements",fancyName:"Call of the Elements",location:{rowIdx:2,colIdx:0},spellId:108285},{fieldName:"totemicPersistence",fancyName:"Totemic Persistence",location:{rowIdx:2,colIdx:1},spellId:108284},{fieldName:"totemicProjection",fancyName:"Totemic Projection",location:{rowIdx:2,colIdx:2},spellId:108287},{fieldName:"elementalMastery",fancyName:"Elemental Mastery",location:{rowIdx:3,colIdx:0},spellId:16166},{fieldName:"ancestralSwiftness",fancyName:"Ancestral Swiftness",location:{rowIdx:3,colIdx:1},spellId:16188},{fieldName:"echoOfTheElements",fancyName:"Echo of the Elements",location:{rowIdx:3,colIdx:2},spellId:108283},{fieldName:"rushingStreams",fancyName:"Rushing Streams",location:{rowIdx:4,colIdx:0},spellId:147074},{fieldName:"ancestralGuidance",fancyName:"Ancestral Guidance",location:{rowIdx:4,colIdx:1},spellId:108281},{fieldName:"conductivity",fancyName:"Conductivity",location:{rowIdx:4,colIdx:2},spellId:108282},{fieldName:"unleashedFury",fancyName:"Unleashed Fury",location:{rowIdx:5,colIdx:0},spellId:117012},{fieldName:"primalElementalist",fancyName:"Primal Elementalist",location:{rowIdx:5,colIdx:1},spellId:117013},{fieldName:"elementalBlast",fancyName:"Elemental Blast",location:{rowIdx:5,colIdx:2},spellId:117014}]}),qf={majorGlyphs:{[zt.GlyphOfUnstableEarth]:{name:"Glyph of Unstable Earth",description:"Causes your Earthquake spell to also reduce the movement speed of affected targets by 40% for 3s.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shaman_earthquake.jpg"},[zt.GlyphOfChainLightning]:{name:"Glyph of Chain Lightning",description:"Your Chain Lightning spell now strikes 2 additional targets, but deals 10% less damage.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_chainlightning.jpg"},[zt.GlyphOfSpiritWalk]:{name:"Glyph of Spirit Walk",description:"Reduces the cooldown of your Spirit Walk ability by 25%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_tracking.jpg"},[zt.GlyphOfCapacitorTotem]:{name:"Glyph of Capacitor Totem",description:"Reduces the charging time of your Capacitor Totem by 2 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_brilliance.jpg"},[zt.GlyphOfPurge]:{name:"Glyph of Purge",description:"Your Purge dispels 1 additional Magic effect but has a 6 sec cooldown.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_purge.jpg"},[zt.GlyphOfFireElementalTotem]:{name:"Glyph of Fire Elemental Totem",description:"Reduces the cooldown and duration of your Fire Elemental Totem by 50%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_fire_elemental_totem.jpg"},[zt.GlyphOfFireNova]:{name:"Glyph of Fire Nova",description:"Increases the radius of your Fire Nova spell by 5 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shaman_firenova.jpg"},[zt.GlyphOfFlameShock]:{name:"Glyph of Flame Shock",description:"When your Flame Shock deals damage, it heals you for 30% of the damage dealt.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_fire_flameshock.jpg"},[zt.GlyphOfWindShear]:{name:"Glyph of Wind Shear",description:"Increases the school lockout duration of Wind Shear by 1 sec, but also increases the cooldown by 3 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_cyclone.jpg"},[zt.GlyphOfHealingStreamTotem]:{name:"Glyph of Healing Stream Totem",description:"When your Healing Stream Totem heals an ally, it also reduces their Fire, Frost, and Nature damage taken by 10% for 6s.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_spear_04.jpg"},[zt.GlyphOfHealingWave]:{name:"Glyph of Healing Wave",description:"Your Healing Wave also heals you for 20% of the healing effect when you heal someone else.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_healingwavegreater.jpg"},[zt.GlyphOfTotemicRecall]:{name:"Glyph of Totemic Recall",description:"Causes your Totemic Recall ability to return the full mana cost of any recalled totems.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shaman_totemrecall.jpg"},[zt.GlyphOfTelluricCurrents]:{name:"Glyph of Telluric Currents",description:"Causes your Lightning Bolt to restore 2% of your mana when it strikes an enemy.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_lightning_lightningbolt01.jpg"},[zt.GlyphOfGroundingTotem]:{name:"Glyph of Grounding Totem",description:"Instead of absorbing a spell, your Grounding Totem reflects the next harmful spell back at its caster, but the cooldown of your Grounding Totem is increased by 20 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_groundingtotem.jpg"},[zt.GlyphOfSpiritwalkersGrace]:{name:"Glyph of Spiritwalker's Grace",description:"Increases the duration of your Spiritwalker's Grace by 5 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shaman_spiritwalkersgrace.jpg"},[zt.GlyphOfWaterShield]:{name:"Glyph of Water Shield",description:"Increases the mana generated reactively by your Water Shield when you are attacked by 50%, but reduces the passive mana generation by 15%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_shaman_watershield.jpg"},[zt.GlyphOfCleansingWaters]:{name:"Glyph of Cleansing Waters",description:"When you dispel a harmful Magic or Curse effect from an ally, you also heal the target for 5% of your maximum health.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_regeneration_02.jpg"},[zt.GlyphOfFrostShock]:{name:"Glyph of Frost Shock",description:"Decreases the cooldown incurred by your Frost Shock by 2 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_frost_frostshock.jpg"},[zt.GlyphOfChaining]:{name:"Glyph of Chaining",description:"Increases the jump distance of your Chain Heal spell by 100%, but gives the spell a 2 sec cooldown.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_druid_empoweredtouch.jpg"},[zt.GlyphOfHealingStorm]:{name:"Glyph of Healing Storm",description:"Each application of Maelstrom Weapon also increases your direct healing done by 20%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shaman_maelstromweapon.jpg"},[zt.GlyphOfGhostWolf]:{name:"Glyph of Ghost Wolf",description:"While in Ghost Wolf form, you are less hindered by effects that would reduce movement speed.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_spiritwolf.jpg"},[zt.GlyphOfThunder]:{name:"Glyph of Thunder",description:"Reduces the cooldown on Thunderstorm by 10 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shaman_thunderstorm.jpg"},[zt.GlyphOfFeralSpirit]:{name:"Glyph of Feral Spirit",description:"Increases the healing done by your Feral Spirits' Spirit Hunt by 40%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shaman_feralspirit.jpg"},[zt.GlyphOfRiptide]:{name:"Glyph of Riptide",description:"Removes the cooldown of Riptide, but reduces the initial direct healing by 75%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_riptide.jpg"},[zt.GlyphOfShamanisticRage]:{name:"Glyph of Shamanistic Rage",description:"Activating your Shamanistic Rage ability also cleanses you of all dispellable harmful Magic effects.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_shamanrage.jpg"},[zt.GlyphOfHex]:{name:"Glyph of Hex",description:"Reduces the cooldown of your Hex spell by 10 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shaman_hex.jpg"},[zt.GlyphOfTotemicVigor]:{name:"Glyph of Totemic Vigor",description:"Increases the health of your totems by 5% of your maximum health.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_relics_totemofrebirth.jpg"},[zt.GlyphOfLightningShield]:{name:"Glyph of Lightning Shield",description:"When your Lightning Shield is triggered, you take 10% less damage for 6s.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_lightningshield.jpg"},[zt.GlyphOfPurging]:{name:"Glyph of Purging",description:"Successfully Purging a target now grants a stack of Maelstrom Weapon.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shaman_improvedreincarnation.jpg"},[zt.GlyphOfEternalEarth]:{name:"Glyph of Eternal Earth",description:"Your Lightning Bolt has a chance to add a charge to your currently active Earth Shield. This cannot cause Earth Shield to exceed 9 charges.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shaman_improvedearthshield.jpg"}},minorGlyphs:{[Gt.GlyphOfTheLakestrider]:{name:"Glyph of the Lakestrider",description:"You automatically gain Water Walking while you are in Ghost Wolf form.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_frost_windwalkon.jpg"},[Gt.GlyphOfLavaLash]:{name:"Glyph of Lava Lash",description:"Your Lava Lash ability no longer spreads Flame Shock to nearby targets.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_shaman_lavalash.jpg"},[Gt.GlyphOfAstralRecall]:{name:"Glyph of Astral Recall",description:"Reduces the cooldown of your Astral Recall spell by 5 minutes.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_astralrecal.jpg"},[Gt.GlyphOfFarSight]:{name:"Glyph of Far Sight",description:"Your Far Sight spell may be used indoors.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_farsight.jpg"},[Gt.GlyphOfTheSpectralWolf]:{name:"Glyph of the Spectral Wolf",description:"Alters the appearance of your Ghost Wolf transformation, causing it to resemble a large, spectral wolf.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_mount_whitedirewolf.jpg"},[Gt.GlyphOfTotemicEncirclement]:{name:"Glyph of Totemic Encirclement",description:"When you cast a totem spell, you also place unempowered totems for any elements that are not currently active. These totems have 5 health and produce no other effects.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_shaman_totemrelocation.jpg"},[Gt.GlyphOfThunderstorm]:{name:"Glyph of Thunderstorm",description:"Removes the knockback effect from your Thunderstorm spell.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shaman_thunderstorm.jpg"},[Gt.GlyphOfDeluge]:{name:"Glyph of Deluge",description:"Your Chain Heal now has a watery appearance.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_healingwavegreater.jpg"},[Gt.GlyphOfSpiritRaptors]:{name:"Glyph of Spirit Raptors",description:"Your Spirit Wolves are replaced with Spirit Raptors.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/trade_archaeology_dinosaurskeleton.jpg"},[Gt.GlyphOfLingeringAncestors]:{name:"Glyph of Lingering Ancestors",description:"Resurrecting someone with Ancestral Spirit causes a ghostly ancestor to follow them around for a short time.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shaman_ancestralawakening.jpg"},[Gt.GlyphOfSpiritWolf]:{name:"Glyph of Spirit Wolf",description:"Ghost Wolf can be now be used while you are a ghost.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_spiritwolf.jpg"},[Gt.GlyphOfFlamingSerpent]:{name:"Glyph of Flaming Serpent",description:"Your Searing Totem now resembles Vol'jin's Serpent Ward.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_guardianward.jpg"},[Gt.GlyphOfTheCompy]:{name:"Glyph of the Compy",description:"Your Hex now transforms enemies into a Compy.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_hunter_pet_raptor.jpg"},[Gt.GlyphOfElementalFamiliars]:{name:"Glyph of Elemental Familiars",description:"Summons a random Fire, Water, or Nature familiar. Familiars of different types have a tendency to fight each other.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_pet_pandarenelemental.jpg"},[Gt.GlyphOfAstralFixation]:{name:"Glyph of Astral Fixation",description:"Astral Recall now takes you to your capital's Earthshrine.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_astralrecalgroup.jpg"},[Gt.GlyphOfRainOfFrogs]:{name:"Glyph of Rain of Frogs",description:"You summon a rain storm of frogs at your targeted location.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_pet_toad_blue.jpg"}}},Xf=Af({backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/cata/TODO.jpg",talents:[{fieldName:"darkRegeneration",fancyName:"Dark Regeneration",location:{rowIdx:0,colIdx:0},spellId:108359},{fieldName:"soulLeech",fancyName:"Soul Leech",location:{rowIdx:0,colIdx:1},spellId:108370},{fieldName:"harvestLife",fancyName:"Harvest Life",location:{rowIdx:0,colIdx:2},spellId:108371},{fieldName:"demonicBreath",fancyName:"Demonic Breath",location:{rowIdx:1,colIdx:0},spellId:47897},{fieldName:"mortalCoil",fancyName:"Mortal Coil",location:{rowIdx:1,colIdx:1},spellId:6789},{fieldName:"shadowfury",fancyName:"Shadowfury",location:{rowIdx:1,colIdx:2},spellId:30283},{fieldName:"soulLink",fancyName:"Soul Link",location:{rowIdx:2,colIdx:0},spellId:108415},{fieldName:"sacrificialPact",fancyName:"Sacrificial Pact",location:{rowIdx:2,colIdx:1},spellId:108416},{fieldName:"darkBargain",fancyName:"Dark Bargain",location:{rowIdx:2,colIdx:2},spellId:110913},{fieldName:"bloodHorror",fancyName:"Blood Horror",location:{rowIdx:3,colIdx:0},spellId:111397},{fieldName:"burningRush",fancyName:"Burning Rush",location:{rowIdx:3,colIdx:1},spellId:111400},{fieldName:"unboundWill",fancyName:"Unbound Will",location:{rowIdx:3,colIdx:2},spellId:108482},{fieldName:"grimoireOfSupremacy",fancyName:"Grimoire of Supremacy",location:{rowIdx:4,colIdx:0},spellId:108499},{fieldName:"grimoireOfService",fancyName:"Grimoire of Service",location:{rowIdx:4,colIdx:1},spellId:108501},{fieldName:"grimoireOfSacrifice",fancyName:"Grimoire of Sacrifice",location:{rowIdx:4,colIdx:2},spellId:108503},{fieldName:"archimondesDarkness",fancyName:"Archimonde's Darkness",location:{rowIdx:5,colIdx:0},spellId:108505},{fieldName:"kiljaedensCunning",fancyName:"Kil'jaeden's Cunning",location:{rowIdx:5,colIdx:1},spellId:137587},{fieldName:"mannorothsFury",fancyName:"Mannoroth's Fury",location:{rowIdx:5,colIdx:2},spellId:108508}]}),$f={majorGlyphs:{[Ht.GlyphOfConflagrate]:{name:"Glyph of Conflagrate",description:"Conflagrate no longer requires Immolate to snare the target.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_fire_fireball.jpg"},[Ht.GlyphOfSiphonLife]:{name:"Glyph of Siphon Life",description:"Your Immolate spell will heal you for 0.5% of your maximum health when dealing periodic damage.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_requiem.jpg"},[Ht.GlyphOfFear]:{name:"Glyph of Fear",description:"Your Fear causes the target to tremble in place instead of fleeing in fear.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_possession.jpg"},[Ht.GlyphOfDemonTraining]:{name:"Glyph of Demon Training",description:"Improves your demon's special abilities:\r\n\r\n Your Fel Imp 's Firebolt cast time is reduced by 50% and fires in bursts of three.\r\n\r\n Increases your Voidlord 's total armor by 10%.\r\n\r\n Your Shivarra and Archincubus 's Mesmerizes ability also removes all damage over time effects from the target.\r\n\r\n When your Observer uses Clone Magic, you will also be healed for that amount.\r\n\r\n Increases your Wrathguard 's total health by 20%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_summonfelhunter.jpg"},[Ht.GlyphOfHealthstone]:{name:"Glyph of Healthstone",description:"You receive 100% more healing from using a healthstone, but the health is restored over 10 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_stone_04.jpg"},[Ht.GlyphOfCurseOfTheElements]:{name:"Glyph of Curse of the Elements",description:"Curse of the Elements hits 2 additional nearby targets.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/warlock_curse_shadow.jpg"},[Ht.GlyphOfImpSwarm]:{name:"Glyph of Imp Swarm",description:"Teaches you the ability Imp Swarm.\r\n Requires Demonology.\r\n\r\n |Tinterface/icons/ability_warlock_impoweredimp.blp:24|t Imp Swarm\r\n Summons 4 Wild Imps from the Twisting Nether to attack the target.\r\n\r\n The Wild Imps passive effect is disabled while Imp Swarm is on cooldown. Imp Swarm's cooldown is reduced by spell haste. Also increases Wild Imp's cooldown by 4 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warlock_impoweredimp.jpg"},[Ht.GlyphOfHavoc]:{name:"Glyph of Havoc",description:"Havoc gains 3 additional charges, but the cooldown is increased by 35 seconds.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warlock_baneofhavoc.jpg"},[Ht.GlyphOfSoulstone]:{name:"Glyph of Soulstone",description:"Players resurrected by Soulstone are returned to life with 100% health.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_orb_04.jpg"},[Ht.GlyphOfUnstableAffliction]:{name:"Glyph of Unstable Affliction",description:"Reduces the cast time of Unstable Affliction by 25%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_unstableaffliction_3.jpg"},[Ht.GlyphOfSoulConsumption]:{name:"Glyph of Soul Consumption",description:"Your Drain Soul restores 20% of your total health after you kill a target that yields experience or honor. You restore 20% of your total health after you kill a target in Demon Form that yields experience or honor. You restore 20% of your total health after you kill a target with Chaos Bolt that yields experience or honor.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warlock_soulsiphon.jpg"},[Ht.GlyphOfCurseOfExhaustion]:{name:"Glyph of Curse of Exhaustion",description:"Curse of Exhaustion now reduces the targets movement speed by 30%, lasts half as long and has a 10 second cooldown.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_grimward.jpg"},[Ht.GlyphOfDrainLife]:{name:"Glyph of Drain Life",description:"Increases the healing of your Drain Life by 30%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_lifedrain02.jpg"},[Ht.GlyphOfDemonHunting]:{name:"Glyph of Demon Hunting",description:"Requires Demonology.\r\n\r\n Teaches you the ability Dark Apotheosis.\r\n\r\n Dark Apotheosis\r\n You imbue yourself with demonic energies, reducing physical damage taken by 10.00%, reduces magic damage taken by 15%, and allows the use of various demonic abilities.\r\n\r\n In addition, Soulshatter becomes Provocation which taunts your target, Twilight Ward becomes Fury Ward which will absorb all schools of damage, Shadow Bolt becomes Demonic Slash, and Fear becomes Sleep.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_metamorphosis.jpg"},[Ht.GlyphOfEmberTap]:{name:"Glyph of Ember Tap",description:"Ember Tap heals you for an additional 5% of your health, but the health is restored over 10 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_ember.jpg"},[Ht.GlyphOfDemonicCircle]:{name:"Glyph of Demonic Circle",description:"Reduces the cooldown on Demonic Circle by 4 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_demoniccircleteleport.jpg"},[Ht.GlyphOfUnendingResolve]:{name:"Glyph of Unending Resolve",description:"The damage reduction of Unending Resolve is reduced by 20%, but the cooldown is reduced by 60 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_demonictactics.jpg"},[Ht.GlyphOfLifeTap]:{name:"Glyph of Life Tap",description:"Your Life Tap no longer consumes health, but instead absorbs 0 healing received. This effect stacks.\r\n\r\n The absorb lasts 30 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_burningspirit.jpg"},[Ht.GlyphOfEternalResolve]:{name:"Glyph of Eternal Resolve",description:"Outside of Battlegrounds and Arenas:\r\n Increases the duration of Unstable Affliction, Corruption, Doom, and Agony by 50%, and reduces their damage by 20%.\r\n\r\n Inside of Battlegrounds and Arenas:\r\n Unending Resolve can no longer be activated, but passively provides 10% damage reduction from all sources.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_demonictactics.jpg"},[Ht.GlyphOfSupernova]:{name:"Glyph of Supernova",description:"When you are killed, all enemies within 8 yards take damage equal to 10% of your maximum health per Burning Ember held.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_fire_ragnaros_supernova.jpg"}},minorGlyphs:{[Ft.GlyphOfHandOfGuldan]:{name:"Glyph of Hand of Gul'dan",description:"Your Hand of Gul'dan can now be targeted at a location.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warlock_handofguldan.jpg"},[Ft.GlyphOfVerdantSpheres]:{name:"Glyph of Verdant Spheres",description:"Your Soul Shards are transformed into Verdant Spheres.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_misc_enchantedpearlb.jpg"},[Ft.GlyphOfNightmares]:{name:"Glyph of Nightmares",description:"Your Felsteed and Dreadsteed can cross water while running and leave a trail of flames.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_mount_nightmarehorse.jpg"},[Ft.GlyphOfFelguard]:{name:"Glyph of Felguard",description:"Your Felguard will equip a random two-handed axe, sword or polearm from your backpack.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_summonfelguard.jpg"},[Ft.GlyphOfHealthFunnel]:{name:"Glyph of Health Funnel",description:"Your Health Funnel instantly restores 15% of your demon's health, but has a 10 sec. cooldown.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_lifedrain.jpg"},[Ft.GlyphOfSubtlety]:{name:"Glyph of Subtlety",description:"Your Soul Shards no longer display while out of combat.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_masterofsubtlety.jpg"},[Ft.GlyphOfShadowBolt]:{name:"Glyph of Shadow Bolt",description:"Splits your Shadow Bolt into three smaller attacks.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_shadowbolt.jpg"},[Ft.GlyphOfCarrionSwarm]:{name:"Glyph of Carrion Swarm",description:"Your Carrion Swarm no longer knocks targets back.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warlock_demonicpower.jpg"},[Ft.GlyphOfFallingMeteor]:{name:"Glyph of Falling Meteor",description:"If you use Demonic Leap while falling, you slam into the ground rapidly and will not die from falling damage.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_fire_meteorstorm.jpg"},[Ft.GlyphOfUnendingBreath]:{name:"Glyph of Unending Breath",description:"Increases the swim speed of targets affected by your Unending Breath spell by 20%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_demonbreath.jpg"},[Ft.GlyphOfEyeOfKilrogg]:{name:"Glyph of Eye of Kilrogg",description:"Your Eye of Kilrogg is no longer stealthed and can now place your Demonic Circle. The casting Warlock must be within line of sight of the Eye of Kilrogg to place the Demonic Circle.\r\n\r\n In addition, the movement speed of your Eye of Kilrogg is increased by 50% and allows it to fly in areas where flying mounts are enabled.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_evileye.jpg"},[Ft.GlyphOfSubjugateDemon]:{name:"Glyph of Subjugate Demon",description:"Reduces the cast time of your Subjugate Demon spell by 50%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_enslavedemon.jpg"},[Ft.GlyphOfSoulwell]:{name:"Glyph of Soulwell",description:"Your soulwell glows with an eerie light.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_shadesofdarkness.jpg"},[Ft.GlyphOfCrimsonBanish]:{name:"Glyph of Crimson Banish",description:"Your Banish spell is now red.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_cripple.jpg"},[Ft.GlyphOfGatewayAttunement]:{name:"Glyph of Gateway Attunement",description:"Demonic Gateways will automatically activate when you step near them.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_warlock_demonicportal_green.jpg"}}},Zf=Af({backgroundUrl:"https://wow.zamimg.com/images/wow/talents/backgrounds/cata/TODO.jpg",talents:[{fieldName:"juggernaut",fancyName:"Juggernaut",location:{rowIdx:0,colIdx:0},spellId:103826},{fieldName:"doubleTime",fancyName:"Double Time",location:{rowIdx:0,colIdx:1},spellId:103827},{fieldName:"warbringer",fancyName:"Warbringer",location:{rowIdx:0,colIdx:2},spellId:103828},{fieldName:"enragedRegeneration",fancyName:"Enraged Regeneration",location:{rowIdx:1,colIdx:0},spellId:55694},{fieldName:"secondWind",fancyName:"Second Wind",location:{rowIdx:1,colIdx:1},spellId:29838},{fieldName:"impendingVictory",fancyName:"Impending Victory",location:{rowIdx:1,colIdx:2},spellId:103840},{fieldName:"staggeringShout",fancyName:"Staggering Shout",location:{rowIdx:2,colIdx:0},spellId:107566},{fieldName:"piercingHowl",fancyName:"Piercing Howl",location:{rowIdx:2,colIdx:1},spellId:12323},{fieldName:"disruptingShout",fancyName:"Disrupting Shout",location:{rowIdx:2,colIdx:2},spellId:102060},{fieldName:"bladestorm",fancyName:"Bladestorm",location:{rowIdx:3,colIdx:0},spellId:46924},{fieldName:"shockwave",fancyName:"Shockwave",location:{rowIdx:3,colIdx:1},spellId:46968},{fieldName:"dragonRoar",fancyName:"Dragon Roar",location:{rowIdx:3,colIdx:2},spellId:118e3},{fieldName:"massSpellReflection",fancyName:"Mass Spell Reflection",location:{rowIdx:4,colIdx:0},spellId:114028},{fieldName:"safeguard",fancyName:"Safeguard",location:{rowIdx:4,colIdx:1},spellId:114029},{fieldName:"vigilance",fancyName:"Vigilance",location:{rowIdx:4,colIdx:2},spellId:114030},{fieldName:"avatar",fancyName:"Avatar",location:{rowIdx:5,colIdx:0},spellId:107574},{fieldName:"bloodbath",fancyName:"Bloodbath",location:{rowIdx:5,colIdx:1},spellId:12292},{fieldName:"stormBolt",fancyName:"Storm Bolt",location:{rowIdx:5,colIdx:2},spellId:107570}]}),Kf={majorGlyphs:{[Bt.GlyphOfLongCharge]:{name:"Glyph of Long Charge",description:"Increases the range of your Charge ability by 5 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_charge.jpg"},[Bt.GlyphOfUnendingRage]:{name:"Glyph of Unending Rage",description:"Increases your maximum Rage by 20.0.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_intensifyrage.jpg"},[Bt.GlyphOfEnragedSpeed]:{name:"Glyph of Enraged Speed",description:"While Enraged, you move 20% faster.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_racial_bloodrage.jpg"},[Bt.GlyphOfHinderingStrikes]:{name:"Glyph of Hindering Strikes",description:"Your Heroic Strike and Cleave now also reduce the target's movement speed by 50% for 8s.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_cleave.jpg"},[Bt.GlyphOfHeavyRepercussions]:{name:"Glyph of Heavy Repercussions",description:"While your Shield Block is active, your Shield Slam hits for an additional 50% damage.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_defend.jpg"},[Bt.GlyphOfBloodthirst]:{name:"Glyph of Bloodthirst",description:"Increases the healing of Bloodthirst by 100%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_bloodlust.jpg"},[Bt.GlyphOfRudeInterruption]:{name:"Glyph of Rude Interruption",description:"Successfully interrupting a spell with Pummel increases your damage by 6% for 20s.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_commandingshout.jpg"},[Bt.GlyphOfGagOrder]:{name:"Glyph of Gag Order",description:"Your Pummel and Heroic Throw also silence the target for 3s. Does not work against players.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_axe_66.jpg"},[Bt.GlyphOfBlitz]:{name:"Glyph of Blitz",description:"Your Charge also roots and snares an additional 2 nearby targets.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_victoryrush.jpg"},[Bt.GlyphOfMortalStrike]:{name:"Glyph of Mortal Strike",description:"When your Mortal Strike is affecting a target, healing effects on you are increased by 10%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_savageblow.jpg"},[Bt.GlyphOfDieByTheSword]:{name:"Glyph of Die by the Sword",description:"While Die by the Sword is active, using Overpower increases its duration by 1 sec and using Wild Strike increases its duration by 0.5 sec per use.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_challange.jpg"},[Bt.GlyphOfHamstring]:{name:"Glyph of Hamstring",description:"When you spend Rage to apply Hamstring, the Rage cost of your next Hamstring is reduced by 100%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_shockwave.jpg"},[Bt.GlyphOfHoldTheLine]:{name:"Glyph of Hold the Line",description:"Improves the damage of your next Revenge by 50% following a successful parry.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_revenge.jpg"},[Bt.GlyphOfShieldSlam]:{name:"Glyph of Shield Slam",description:"Your Shield Slam now dispels 1 magical effect.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_shield_05.jpg"},[Bt.GlyphOfHoarseVoice]:{name:"Glyph of Hoarse Voice",description:"Reduces the cooldown and Rage generation of your Battle and Commanding Shout by 50%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_battleshout.jpg"},[Bt.GlyphOfSweepingStrikes]:{name:"Glyph of Sweeping Strikes",description:"When you hit a target with Sweeping Strikes, you gain 1.0 Rage.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_slicedice.jpg"},[Bt.GlyphOfResonatingPower]:{name:"Glyph of Resonating Power",description:"Increases the damage and cooldown of Thunder Clap by 50%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_thunderclap.jpg"},[Bt.GlyphOfVictoryRush]:{name:"Glyph of Victory Rush",description:"Increases the total healing provided by your Victory Rush by 50%.\r\n This glyph has no effect if combined with the Impending Victory talent.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_devastate.jpg"},[Bt.GlyphOfRagingWind]:{name:"Glyph of Raging Wind",description:"Your Raging Blow hits increase the damage of your next Whirlwind by 10%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_hunter_swiftstrike.jpg"},[Bt.GlyphOfWhirlwind]:{name:"Glyph of Whirlwind",description:"Increases the radius of Whirlwind by 4 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_whirlwind.jpg"},[Bt.GlyphOfDeathFromAbove]:{name:"Glyph of Death From Above",description:"Reduces the cooldown on Heroic Leap by 15 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_heroicleap.jpg"},[Bt.GlyphOfVictoriousThrow]:{name:"Glyph of Victorious Throw",description:"Increases the range of Victory Rush and Impending Victory by 15 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_warrior_wildstrike.jpg"},[Bt.GlyphOfSpellReflection]:{name:"Glyph of Spell Reflection",description:"Reduces the cooldown on Spell Reflection by 5 sec.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_shieldreflection.jpg"},[Bt.GlyphOfShieldWall]:{name:"Glyph of Shield Wall",description:"Shield Wall now reduces damage taken by an additional 20%, but its cooldown is increased by 2 min.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_shieldwall.jpg"},[Bt.GlyphOfColossusSmash]:{name:"Glyph of Colossus Smash",description:"Your Colossus Smash also applies the Sunder Armor effect to your target.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_colossussmash.jpg"},[Bt.GlyphOfBullRush]:{name:"Glyph of Bull Rush",description:"Your Charge generates 15 additional Rage.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/achievement_character_tauren_male.jpg"},[Bt.GlyphOfRecklessness]:{name:"Glyph of Recklessness",description:"Decreases the critical chance of Recklessness by 12% but increases its duration by 50%.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_criticalstrike.jpg"},[Bt.GlyphOfIncite]:{name:"Glyph of Incite",description:"Using Demoralizing Shout makes your next 3 Heroic Strike or Cleave abilities free.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_incite.jpg"},[Bt.GlyphOfImpalingThrows]:{name:"Glyph of Impaling Throws",description:"Heroic Throw now leaves an axe in the target, which can be retrieved by moving within 5 yards of the target to finish the cooldown of Heroic Throw. This effect will only occur when Heroic Throw is cast from more than 10 yards away from the target.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_axe_05.jpg"},[Bt.GlyphOfTheExecutor]:{name:"Glyph of the Executor",description:"Killing an enemy with Execute grants you 30 rage.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/warrior_talent_icon_lambstotheslaughter.jpg"}},minorGlyphs:{[Ut.GlyphOfMysticShout]:{name:"Glyph of Mystic Shout",description:"Your Battle Shout and Commanding Shout cause you to hover in the air for 1s.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_battleshout.jpg"},[Ut.GlyphOfBloodcurdlingShout]:{name:"Glyph of Bloodcurdling Shout",description:"Your Battle Shout and Commanding Shout terrify small animals.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_furiousresolve.jpg"},[Ut.GlyphOfGushingWound]:{name:"Glyph of Gushing Wound",description:"Your Deep Wounds are even bloodier than normal.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_backstab.jpg"},[Ut.GlyphOfMightyVictory]:{name:"Glyph of Mighty Victory",description:"When your Victory Rush or Impending Victory heal you, you grow slightly larger.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_devastate.jpg"},[Ut.GlyphOfBloodyHealing]:{name:"Glyph of Bloody Healing",description:"Increases the healing you receive from bandages by 20% while your Deep Wounds is active.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_backstab.jpg"},[Ut.GlyphOfIntimidatingShout]:{name:"Glyph of Intimidating Shout",description:"All targets of your Intimidating Shout now tremble in place instead of fleeing in fear.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_golemthunderclap.jpg"},[Ut.GlyphOfThunderStrike]:{name:"Glyph of Thunder Strike",description:"Your Thunder Clap visual includes a lightning strike.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_thunderclap.jpg"},[Ut.GlyphOfCrowFeast]:{name:"Glyph of Crow Feast",description:"Your Execute critical strikes summon a flock of carrion birds.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/inv_sword_48.jpg"},[Ut.GlyphOfBurningAnger]:{name:"Glyph of Burning Anger",description:"You get so angry when Enraged that you catch on fire.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_shadow_unholyfrenzy.jpg"},[Ut.GlyphOfTheBlazingTrail]:{name:"Glyph of the Blazing Trail",description:"Your Charge leaves a trail of fire in its wake. If you're going to Charge why not do it with some style?",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_fire_burningspeed.jpg"},[Ut.GlyphOfTheRagingWhirlwind]:{name:"Glyph of the Raging Whirlwind",description:"Whirlwind gives you 15 rage over 6s, but for that time you no longer generate rage from autoattacks.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/spell_nature_unleashedrage.jpg"},[Ut.GlyphOfTheSubtleDefender]:{name:"Glyph of the Subtle Defender",description:"Removes the threat generation bonus from Defensive Stance.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_shieldguard.jpg"},[Ut.GlyphOfTheWatchfulEye]:{name:"Glyph of the Watchful Eye",description:"Intervene will now target the party or raid member with the lowest health within 25 yards.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_rogue_bloodyeye.jpg"},[Ut.GlyphOfTheWeaponmaster]:{name:"Glyph of the Weaponmaster",description:"Your Shout abilities cause the appearance of your weapon to change to that of a random weapon from your primary bag for 10min.",iconUrl:"https://wow.zamimg.com/images/wow/icons/large/ability_warrior_weaponmastery.jpg"}}},Jf={[q.ClassUnknown]:null,[q.ClassExtra1]:null,[q.ClassExtra2]:null,[q.ClassExtra3]:null,[q.ClassExtra4]:null,[q.ClassExtra5]:null,[q.ClassExtra6]:null,[q.ClassDeathKnight]:Pf,[q.ClassDruid]:Df,[q.ClassShaman]:Yf,[q.ClassHunter]:Lf,[q.ClassMage]:Of,[q.ClassMonk]:zf,[q.ClassRogue]:Vf,[q.ClassPaladin]:Hf,[q.ClassPriest]:Bf,[q.ClassWarlock]:Xf,[q.ClassWarrior]:Zf},Qf={[q.ClassUnknown]:{majorGlyphs:[],minorGlyphs:[]},[q.ClassExtra1]:{majorGlyphs:[],minorGlyphs:[]},[q.ClassExtra2]:{majorGlyphs:[],minorGlyphs:[]},[q.ClassExtra3]:{majorGlyphs:[],minorGlyphs:[]},[q.ClassExtra4]:{majorGlyphs:[],minorGlyphs:[]},[q.ClassExtra5]:{majorGlyphs:[],minorGlyphs:[]},[q.ClassExtra6]:{majorGlyphs:[],minorGlyphs:[]},[q.ClassDeathKnight]:Rf,[q.ClassDruid]:Mf,[q.ClassShaman]:qf,[q.ClassHunter]:Nf,[q.ClassMage]:Gf,[q.ClassMonk]:Ff,[q.ClassRogue]:jf,[q.ClassPaladin]:Uf,[q.ClassPriest]:Wf,[q.ClassWarlock]:$f,[q.ClassWarrior]:Kf};function eb(e,t){return function(e,t,a){const{talents:i}=a,s=t.split("").map(Number);return i.forEach(t=>{e[t.fieldName]=!1}),s.forEach((t,a)=>{const s=Number(t)-1,o=i.find(e=>e.location.rowIdx==a&&e.location.colIdx==s);o&&(e[o.fieldName]=!0)}),e}(Wt[e.specID].talentsCreate(),t,Jf[e.classID])}const tb=class e extends vf{constructor(e,t){super(e,t,{title:oe.t("import.addon.title"),allowFileUpload:!0});const a=U();this.descriptionElem.appendChild(H("div",null,H("p",null,oe.t("import.addon.description")," ",H("a",{href:"https://www.curseforge.com/wow/addons/wowsimsexporter",target:"_blank"},oe.t("import.addon.addon_link")),"."),H("p",null,oe.t("import.addon.feature_description")),H("p",null,oe.t("import.addon.instructions")),H("div",{ref:a}))),a.value&&new Dg({title:oe.t("import.addon.reforge_warning.title"),body:H("div",null,oe.t("import.addon.reforge_warning.message")),additionalClasses:["toast-import-warning"],container:a.value,variant:"warning",canClose:!1,autoShow:!0,autohide:!1})}async onImport(t){let i;try{i=JSON.parse(t)}catch{throw new Error("Please use a valid Addon export.")}let o=await e.WSE_VERSION;o&&(i.version||"")!=o&&new Dg({variant:"warning",body:`Addon is not up to date. Addon version : '${i.version}', Latest version : '${o}'`});const n=Zr(i.class||"");if(n==q.ClassUnknown)throw new Error("Could not parse Class!");const r=Xr(i.race||"");if(r==Y.RaceUnknown)throw new Error("Could not parse Race!");const l=i.professions.map(e=>function(e){const t=e.toLowerCase();for(const[a,i]of Kr)if(i.toLowerCase()==t)return a;return a.ProfessionUnknown}(e.name));l.forEach((e,t)=>{if(e==a.ProfessionUnknown)throw new Error(`Could not parse profession '${i.professions[t]}'`)});const c=i.talents||"",h=Qf[n],d=await Ar.get(),u=i.glyphs.major.map(e=>ib(e,d,h.majorGlyphs)),p=i.glyphs.minor.map(e=>ib(e,d,h.minorGlyphs)),m=Vt.create({major1:u[0]||0,major2:u[1]||0,major3:u[2]||0,minor1:p[0]||0,minor2:p[1]||0,minor3:p[2]||0}),g=i.gear;g.items=g.items.filter(e=>null!=e),delete g.version,g.items.forEach(e=>{e.gems&&(e.gems=e.gems.map(e=>e||0))});const f=s.fromJson(g);this.finishIndividualImport(this.simUI,{charClass:n,race:r,equipmentSpec:f,talentsStr:c,glyphs:m,professions:l})}};tb.WSE_VERSION=fetch("https://api.github.com/repos/wowsims/exporter/releases/latest").then(e=>e.json().then(e=>e.tag_name)).catch(e=>null);let ab=tb;function ib(e,t,a){return"string"==typeof e?function(e,t){if(!e)return 0;for(const a in t)if(t[a].name==e)return parseInt(a);throw new Error(`Unknown glyph name '${e}'`)}(e,a):t.glyphSpellToItemId(e.spellID)}class sb extends vf{constructor(e,t){super(e,t,{title:oe.t("import.json.title"),allowFileUpload:!0}),this.descriptionElem.appendChild(H("div",null,H("p",null,oe.t("import.json.description")),H("p",null,oe.t("import.json.instructions"))))}async onImport(e){let t=null;try{t=nt.fromJsonString(e,{ignoreUnknownFields:!0})}catch{throw new Error(oe.t("import.json.error_invalid_json"))}t.player?.equipment&&await Ar.loadLeftoversIfNecessary(t.player.equipment),this.simUI.isWithinRaidSim?t.player&&this.simUI.player.fromProto(te.nextEventID(),t.player):this.simUI.fromProto(te.nextEventID(),t),this.close()}}
/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */function ob(e){let t=e.length;for(;--t>=0;)e[t]=0}const nb=256,rb=286,lb=30,cb=15,hb=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),db=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),ub=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),pb=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),mb=new Array(576);ob(mb);const gb=new Array(60);ob(gb);const fb=new Array(512);ob(fb);const bb=new Array(256);ob(bb);const yb=new Array(29);ob(yb);const wb=new Array(lb);function vb(e,t,a,i,s){this.static_tree=e,this.extra_bits=t,this.extra_base=a,this.elems=i,this.max_length=s,this.has_stree=e&&e.length}let xb,Sb,_b;function kb(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}ob(wb);const Cb=e=>e<256?fb[e]:fb[256+(e>>>7)],Ib=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},Eb=(e,t,a)=>{e.bi_valid>16-a?(e.bi_buf|=t<<e.bi_valid&65535,Ib(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=a-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=a)},Tb=(e,t,a)=>{Eb(e,a[2*t],a[2*t+1])},Ab=(e,t)=>{let a=0;do{a|=1&e,e>>>=1,a<<=1}while(--t>0);return a>>>1},Pb=(e,t,a)=>{const i=new Array(16);let s,o,n=0;for(s=1;s<=cb;s++)n=n+a[s-1]<<1,i[s]=n;for(o=0;o<=t;o++){let t=e[2*o+1];0!==t&&(e[2*o]=Ab(i[t]++,t))}},Rb=e=>{let t;for(t=0;t<rb;t++)e.dyn_ltree[2*t]=0;for(t=0;t<lb;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},Db=e=>{e.bi_valid>8?Ib(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},Mb=(e,t,a,i)=>{const s=2*t,o=2*a;return e[s]<e[o]||e[s]===e[o]&&i[t]<=i[a]},Lb=(e,t,a)=>{const i=e.heap[a];let s=a<<1;for(;s<=e.heap_len&&(s<e.heap_len&&Mb(t,e.heap[s+1],e.heap[s],e.depth)&&s++,!Mb(t,i,e.heap[s],e.depth));)e.heap[a]=e.heap[s],a=s,s<<=1;e.heap[a]=i},Nb=(e,t,a)=>{let i,s,o,n,r=0;if(0!==e.sym_next)do{i=255&e.pending_buf[e.sym_buf+r++],i+=(255&e.pending_buf[e.sym_buf+r++])<<8,s=e.pending_buf[e.sym_buf+r++],0===i?Tb(e,s,t):(o=bb[s],Tb(e,o+nb+1,t),n=hb[o],0!==n&&(s-=yb[o],Eb(e,s,n)),i--,o=Cb(i),Tb(e,o,a),n=db[o],0!==n&&(i-=wb[o],Eb(e,i,n)))}while(r<e.sym_next);Tb(e,256,t)},Ob=(e,t)=>{const a=t.dyn_tree,i=t.stat_desc.static_tree,s=t.stat_desc.has_stree,o=t.stat_desc.elems;let n,r,l,c=-1;for(e.heap_len=0,e.heap_max=573,n=0;n<o;n++)0!==a[2*n]?(e.heap[++e.heap_len]=c=n,e.depth[n]=0):a[2*n+1]=0;for(;e.heap_len<2;)l=e.heap[++e.heap_len]=c<2?++c:0,a[2*l]=1,e.depth[l]=0,e.opt_len--,s&&(e.static_len-=i[2*l+1]);for(t.max_code=c,n=e.heap_len>>1;n>=1;n--)Lb(e,a,n);l=o;do{n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Lb(e,a,1),r=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=r,a[2*l]=a[2*n]+a[2*r],e.depth[l]=(e.depth[n]>=e.depth[r]?e.depth[n]:e.depth[r])+1,a[2*n+1]=a[2*r+1]=l,e.heap[1]=l++,Lb(e,a,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const a=t.dyn_tree,i=t.max_code,s=t.stat_desc.static_tree,o=t.stat_desc.has_stree,n=t.stat_desc.extra_bits,r=t.stat_desc.extra_base,l=t.stat_desc.max_length;let c,h,d,u,p,m,g=0;for(u=0;u<=cb;u++)e.bl_count[u]=0;for(a[2*e.heap[e.heap_max]+1]=0,c=e.heap_max+1;c<573;c++)h=e.heap[c],u=a[2*a[2*h+1]+1]+1,u>l&&(u=l,g++),a[2*h+1]=u,h>i||(e.bl_count[u]++,p=0,h>=r&&(p=n[h-r]),m=a[2*h],e.opt_len+=m*(u+p),o&&(e.static_len+=m*(s[2*h+1]+p)));if(0!==g){do{for(u=l-1;0===e.bl_count[u];)u--;e.bl_count[u]--,e.bl_count[u+1]+=2,e.bl_count[l]--,g-=2}while(g>0);for(u=l;0!==u;u--)for(h=e.bl_count[u];0!==h;)d=e.heap[--c],d>i||(a[2*d+1]!==u&&(e.opt_len+=(u-a[2*d+1])*a[2*d],a[2*d+1]=u),h--)}})(e,t),Pb(a,c,e.bl_count)},Gb=(e,t,a)=>{let i,s,o=-1,n=t[1],r=0,l=7,c=4;for(0===n&&(l=138,c=3),t[2*(a+1)+1]=65535,i=0;i<=a;i++)s=n,n=t[2*(i+1)+1],++r<l&&s===n||(r<c?e.bl_tree[2*s]+=r:0!==s?(s!==o&&e.bl_tree[2*s]++,e.bl_tree[32]++):r<=10?e.bl_tree[34]++:e.bl_tree[36]++,r=0,o=s,0===n?(l=138,c=3):s===n?(l=6,c=3):(l=7,c=4))},zb=(e,t,a)=>{let i,s,o=-1,n=t[1],r=0,l=7,c=4;for(0===n&&(l=138,c=3),i=0;i<=a;i++)if(s=n,n=t[2*(i+1)+1],!(++r<l&&s===n)){if(r<c)do{Tb(e,s,e.bl_tree)}while(0!==--r);else 0!==s?(s!==o&&(Tb(e,s,e.bl_tree),r--),Tb(e,16,e.bl_tree),Eb(e,r-3,2)):r<=10?(Tb(e,17,e.bl_tree),Eb(e,r-3,3)):(Tb(e,18,e.bl_tree),Eb(e,r-11,7));r=0,o=s,0===n?(l=138,c=3):s===n?(l=6,c=3):(l=7,c=4)}};let Fb=!1;const Hb=(e,t,a,i)=>{Eb(e,0+(i?1:0),3),Db(e),Ib(e,a),Ib(e,~a),a&&e.pending_buf.set(e.window.subarray(t,t+a),e.pending),e.pending+=a};var Ub={_tr_init:e=>{Fb||((()=>{let e,t,a,i,s;const o=new Array(16);for(a=0,i=0;i<28;i++)for(yb[i]=a,e=0;e<1<<hb[i];e++)bb[a++]=i;for(bb[a-1]=i,s=0,i=0;i<16;i++)for(wb[i]=s,e=0;e<1<<db[i];e++)fb[s++]=i;for(s>>=7;i<lb;i++)for(wb[i]=s<<7,e=0;e<1<<db[i]-7;e++)fb[256+s++]=i;for(t=0;t<=cb;t++)o[t]=0;for(e=0;e<=143;)mb[2*e+1]=8,e++,o[8]++;for(;e<=255;)mb[2*e+1]=9,e++,o[9]++;for(;e<=279;)mb[2*e+1]=7,e++,o[7]++;for(;e<=287;)mb[2*e+1]=8,e++,o[8]++;for(Pb(mb,287,o),e=0;e<lb;e++)gb[2*e+1]=5,gb[2*e]=Ab(e,5);xb=new vb(mb,hb,257,rb,cb),Sb=new vb(gb,db,0,lb,cb),_b=new vb(new Array(0),ub,0,19,7)})(),Fb=!0),e.l_desc=new kb(e.dyn_ltree,xb),e.d_desc=new kb(e.dyn_dtree,Sb),e.bl_desc=new kb(e.bl_tree,_b),e.bi_buf=0,e.bi_valid=0,Rb(e)},_tr_stored_block:Hb,_tr_flush_block:(e,t,a,i)=>{let s,o,n=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,a=4093624447;for(t=0;t<=31;t++,a>>>=1)if(1&a&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<nb;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),Ob(e,e.l_desc),Ob(e,e.d_desc),n=(e=>{let t;for(Gb(e,e.dyn_ltree,e.l_desc.max_code),Gb(e,e.dyn_dtree,e.d_desc.max_code),Ob(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*pb[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),s=e.opt_len+3+7>>>3,o=e.static_len+3+7>>>3,o<=s&&(s=o)):s=o=a+5,a+4<=s&&-1!==t?Hb(e,t,a,i):4===e.strategy||o===s?(Eb(e,2+(i?1:0),3),Nb(e,mb,gb)):(Eb(e,4+(i?1:0),3),((e,t,a,i)=>{let s;for(Eb(e,t-257,5),Eb(e,a-1,5),Eb(e,i-4,4),s=0;s<i;s++)Eb(e,e.bl_tree[2*pb[s]+1],3);zb(e,e.dyn_ltree,t-1),zb(e,e.dyn_dtree,a-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,n+1),Nb(e,e.dyn_ltree,e.dyn_dtree)),Rb(e),i&&Db(e)},_tr_tally:(e,t,a)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=a,0===t?e.dyn_ltree[2*a]++:(e.matches++,t--,e.dyn_ltree[2*(bb[a]+nb+1)]++,e.dyn_dtree[2*Cb(t)]++),e.sym_next===e.sym_end),_tr_align:e=>{Eb(e,2,3),Tb(e,256,mb),(e=>{16===e.bi_valid?(Ib(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}};var Bb=(e,t,a,i)=>{let s=65535&e,o=e>>>16&65535,n=0;for(;0!==a;){n=a>2e3?2e3:a,a-=n;do{s=s+t[i++]|0,o=o+s|0}while(--n);s%=65521,o%=65521}return s|o<<16};const Wb=new Uint32Array((()=>{let e,t=[];for(var a=0;a<256;a++){e=a;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[a]=e}return t})());var Vb=(e,t,a,i)=>{const s=Wb,o=i+a;e^=-1;for(let n=i;n<o;n++)e=e>>>8^s[255&(e^t[n])];return-1^e},jb={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Yb={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:qb,_tr_stored_block:Xb,_tr_flush_block:$b,_tr_tally:Zb,_tr_align:Kb}=Ub,{Z_NO_FLUSH:Jb,Z_PARTIAL_FLUSH:Qb,Z_FULL_FLUSH:ey,Z_FINISH:ty,Z_BLOCK:ay,Z_OK:iy,Z_STREAM_END:sy,Z_STREAM_ERROR:oy,Z_DATA_ERROR:ny,Z_BUF_ERROR:ry,Z_DEFAULT_COMPRESSION:ly,Z_FILTERED:cy,Z_HUFFMAN_ONLY:hy,Z_RLE:dy,Z_FIXED:uy,Z_DEFAULT_STRATEGY:py,Z_UNKNOWN:my,Z_DEFLATED:gy}=Yb,fy=258,by=262,yy=42,wy=113,vy=666,xy=(e,t)=>(e.msg=jb[t],t),Sy=e=>2*e-(e>4?9:0),_y=e=>{let t=e.length;for(;--t>=0;)e[t]=0},ky=e=>{let t,a,i,s=e.w_size;t=e.hash_size,i=t;do{a=e.head[--i],e.head[i]=a>=s?a-s:0}while(--t);t=s,i=t;do{a=e.prev[--i],e.prev[i]=a>=s?a-s:0}while(--t)};let Cy=(e,t,a)=>(t<<e.hash_shift^a)&e.hash_mask;const Iy=e=>{const t=e.state;let a=t.pending;a>e.avail_out&&(a=e.avail_out),0!==a&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+a),e.next_out),e.next_out+=a,t.pending_out+=a,e.total_out+=a,e.avail_out-=a,t.pending-=a,0===t.pending&&(t.pending_out=0))},Ey=(e,t)=>{$b(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Iy(e.strm)},Ty=(e,t)=>{e.pending_buf[e.pending++]=t},Ay=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},Py=(e,t,a,i)=>{let s=e.avail_in;return s>i&&(s=i),0===s?0:(e.avail_in-=s,t.set(e.input.subarray(e.next_in,e.next_in+s),a),1===e.state.wrap?e.adler=Bb(e.adler,t,s,a):2===e.state.wrap&&(e.adler=Vb(e.adler,t,s,a)),e.next_in+=s,e.total_in+=s,s)},Ry=(e,t)=>{let a,i,s=e.max_chain_length,o=e.strstart,n=e.prev_length,r=e.nice_match;const l=e.strstart>e.w_size-by?e.strstart-(e.w_size-by):0,c=e.window,h=e.w_mask,d=e.prev,u=e.strstart+fy;let p=c[o+n-1],m=c[o+n];e.prev_length>=e.good_match&&(s>>=2),r>e.lookahead&&(r=e.lookahead);do{if(a=t,c[a+n]===m&&c[a+n-1]===p&&c[a]===c[o]&&c[++a]===c[o+1]){o+=2,a++;do{}while(c[++o]===c[++a]&&c[++o]===c[++a]&&c[++o]===c[++a]&&c[++o]===c[++a]&&c[++o]===c[++a]&&c[++o]===c[++a]&&c[++o]===c[++a]&&c[++o]===c[++a]&&o<u);if(i=fy-(u-o),o=u-fy,i>n){if(e.match_start=t,n=i,i>=r)break;p=c[o+n-1],m=c[o+n]}}}while((t=d[t&h])>l&&0!==--s);return n<=e.lookahead?n:e.lookahead},Dy=e=>{const t=e.w_size;let a,i,s;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-by)&&(e.window.set(e.window.subarray(t,t+t-i),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),ky(e),i+=t),0===e.strm.avail_in)break;if(a=Py(e.strm,e.window,e.strstart+e.lookahead,i),e.lookahead+=a,e.lookahead+e.insert>=3)for(s=e.strstart-e.insert,e.ins_h=e.window[s],e.ins_h=Cy(e,e.ins_h,e.window[s+1]);e.insert&&(e.ins_h=Cy(e,e.ins_h,e.window[s+3-1]),e.prev[s&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=s,s++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<by&&0!==e.strm.avail_in)},My=(e,t)=>{let a,i,s,o=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,n=0,r=e.strm.avail_in;do{if(a=65535,s=e.bi_valid+42>>3,e.strm.avail_out<s)break;if(s=e.strm.avail_out-s,i=e.strstart-e.block_start,a>i+e.strm.avail_in&&(a=i+e.strm.avail_in),a>s&&(a=s),a<o&&(0===a&&t!==ty||t===Jb||a!==i+e.strm.avail_in))break;n=t===ty&&a===i+e.strm.avail_in?1:0,Xb(e,0,0,n),e.pending_buf[e.pending-4]=a,e.pending_buf[e.pending-3]=a>>8,e.pending_buf[e.pending-2]=~a,e.pending_buf[e.pending-1]=~a>>8,Iy(e.strm),i&&(i>a&&(i=a),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+i),e.strm.next_out),e.strm.next_out+=i,e.strm.avail_out-=i,e.strm.total_out+=i,e.block_start+=i,a-=i),a&&(Py(e.strm,e.strm.output,e.strm.next_out,a),e.strm.next_out+=a,e.strm.avail_out-=a,e.strm.total_out+=a)}while(0===n);return r-=e.strm.avail_in,r&&(r>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=r&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-r,e.strm.next_in),e.strstart),e.strstart+=r,e.insert+=r>e.w_size-e.insert?e.w_size-e.insert:r),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),n?4:t!==Jb&&t!==ty&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(s=e.window_size-e.strstart,e.strm.avail_in>s&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,s+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),s>e.strm.avail_in&&(s=e.strm.avail_in),s&&(Py(e.strm,e.window,e.strstart,s),e.strstart+=s,e.insert+=s>e.w_size-e.insert?e.w_size-e.insert:s),e.high_water<e.strstart&&(e.high_water=e.strstart),s=e.bi_valid+42>>3,s=e.pending_buf_size-s>65535?65535:e.pending_buf_size-s,o=s>e.w_size?e.w_size:s,i=e.strstart-e.block_start,(i>=o||(i||t===ty)&&t!==Jb&&0===e.strm.avail_in&&i<=s)&&(a=i>s?s:i,n=t===ty&&0===e.strm.avail_in&&a===i?1:0,Xb(e,e.block_start,a,n),e.block_start+=a,Iy(e.strm)),n?3:1)},Ly=(e,t)=>{let a,i;for(;;){if(e.lookahead<by){if(Dy(e),e.lookahead<by&&t===Jb)return 1;if(0===e.lookahead)break}if(a=0,e.lookahead>=3&&(e.ins_h=Cy(e,e.ins_h,e.window[e.strstart+3-1]),a=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==a&&e.strstart-a<=e.w_size-by&&(e.match_length=Ry(e,a)),e.match_length>=3)if(i=Zb(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=Cy(e,e.ins_h,e.window[e.strstart+3-1]),a=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!==--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=Cy(e,e.ins_h,e.window[e.strstart+1]);else i=Zb(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(Ey(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===ty?(Ey(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Ey(e,!1),0===e.strm.avail_out)?1:2},Ny=(e,t)=>{let a,i,s;for(;;){if(e.lookahead<by){if(Dy(e),e.lookahead<by&&t===Jb)return 1;if(0===e.lookahead)break}if(a=0,e.lookahead>=3&&(e.ins_h=Cy(e,e.ins_h,e.window[e.strstart+3-1]),a=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==a&&e.prev_length<e.max_lazy_match&&e.strstart-a<=e.w_size-by&&(e.match_length=Ry(e,a),e.match_length<=5&&(e.strategy===cy||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){s=e.strstart+e.lookahead-3,i=Zb(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=s&&(e.ins_h=Cy(e,e.ins_h,e.window[e.strstart+3-1]),a=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!==--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,i&&(Ey(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(i=Zb(e,0,e.window[e.strstart-1]),i&&Ey(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=Zb(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===ty?(Ey(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Ey(e,!1),0===e.strm.avail_out)?1:2};function Oy(e,t,a,i,s){this.good_length=e,this.max_lazy=t,this.nice_length=a,this.max_chain=i,this.func=s}const Gy=[new Oy(0,0,0,0,My),new Oy(4,4,8,4,Ly),new Oy(4,5,16,8,Ly),new Oy(4,6,32,32,Ly),new Oy(4,4,16,16,Ny),new Oy(8,16,32,32,Ny),new Oy(8,16,128,128,Ny),new Oy(8,32,128,256,Ny),new Oy(32,128,258,1024,Ny),new Oy(32,258,258,4096,Ny)];function zy(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=gy,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),_y(this.dyn_ltree),_y(this.dyn_dtree),_y(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),_y(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),_y(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Fy=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==yy&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==wy&&t.status!==vy?1:0},Hy=e=>{if(Fy(e))return xy(e,oy);e.total_in=e.total_out=0,e.data_type=my;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?yy:wy,e.adler=2===t.wrap?0:1,t.last_flush=-2,qb(t),iy},Uy=e=>{const t=Hy(e);var a;return t===iy&&((a=e.state).window_size=2*a.w_size,_y(a.head),a.max_lazy_match=Gy[a.level].max_lazy,a.good_match=Gy[a.level].good_length,a.nice_match=Gy[a.level].nice_length,a.max_chain_length=Gy[a.level].max_chain,a.strstart=0,a.block_start=0,a.lookahead=0,a.insert=0,a.match_length=a.prev_length=2,a.match_available=0,a.ins_h=0),t},By=(e,t,a,i,s,o)=>{if(!e)return oy;let n=1;if(t===ly&&(t=6),i<0?(n=0,i=-i):i>15&&(n=2,i-=16),s<1||s>9||a!==gy||i<8||i>15||t<0||t>9||o<0||o>uy||8===i&&1!==n)return xy(e,oy);8===i&&(i=9);const r=new zy;return e.state=r,r.strm=e,r.status=yy,r.wrap=n,r.gzhead=null,r.w_bits=i,r.w_size=1<<r.w_bits,r.w_mask=r.w_size-1,r.hash_bits=s+7,r.hash_size=1<<r.hash_bits,r.hash_mask=r.hash_size-1,r.hash_shift=~~((r.hash_bits+3-1)/3),r.window=new Uint8Array(2*r.w_size),r.head=new Uint16Array(r.hash_size),r.prev=new Uint16Array(r.w_size),r.lit_bufsize=1<<s+6,r.pending_buf_size=4*r.lit_bufsize,r.pending_buf=new Uint8Array(r.pending_buf_size),r.sym_buf=r.lit_bufsize,r.sym_end=3*(r.lit_bufsize-1),r.level=t,r.strategy=o,r.method=a,Uy(e)};var Wy={deflateInit:(e,t)=>By(e,t,gy,15,8,py),deflateInit2:By,deflateReset:Uy,deflateResetKeep:Hy,deflateSetHeader:(e,t)=>Fy(e)||2!==e.state.wrap?oy:(e.state.gzhead=t,iy),deflate:(e,t)=>{if(Fy(e)||t>ay||t<0)return e?xy(e,oy):oy;const a=e.state;if(!e.output||0!==e.avail_in&&!e.input||a.status===vy&&t!==ty)return xy(e,0===e.avail_out?ry:oy);const i=a.last_flush;if(a.last_flush=t,0!==a.pending){if(Iy(e),0===e.avail_out)return a.last_flush=-1,iy}else if(0===e.avail_in&&Sy(t)<=Sy(i)&&t!==ty)return xy(e,ry);if(a.status===vy&&0!==e.avail_in)return xy(e,ry);if(a.status===yy&&0===a.wrap&&(a.status=wy),a.status===yy){let t=gy+(a.w_bits-8<<4)<<8,i=-1;if(i=a.strategy>=hy||a.level<2?0:a.level<6?1:6===a.level?2:3,t|=i<<6,0!==a.strstart&&(t|=32),t+=31-t%31,Ay(a,t),0!==a.strstart&&(Ay(a,e.adler>>>16),Ay(a,65535&e.adler)),e.adler=1,a.status=wy,Iy(e),0!==a.pending)return a.last_flush=-1,iy}if(57===a.status)if(e.adler=0,Ty(a,31),Ty(a,139),Ty(a,8),a.gzhead)Ty(a,(a.gzhead.text?1:0)+(a.gzhead.hcrc?2:0)+(a.gzhead.extra?4:0)+(a.gzhead.name?8:0)+(a.gzhead.comment?16:0)),Ty(a,255&a.gzhead.time),Ty(a,a.gzhead.time>>8&255),Ty(a,a.gzhead.time>>16&255),Ty(a,a.gzhead.time>>24&255),Ty(a,9===a.level?2:a.strategy>=hy||a.level<2?4:0),Ty(a,255&a.gzhead.os),a.gzhead.extra&&a.gzhead.extra.length&&(Ty(a,255&a.gzhead.extra.length),Ty(a,a.gzhead.extra.length>>8&255)),a.gzhead.hcrc&&(e.adler=Vb(e.adler,a.pending_buf,a.pending,0)),a.gzindex=0,a.status=69;else if(Ty(a,0),Ty(a,0),Ty(a,0),Ty(a,0),Ty(a,0),Ty(a,9===a.level?2:a.strategy>=hy||a.level<2?4:0),Ty(a,3),a.status=wy,Iy(e),0!==a.pending)return a.last_flush=-1,iy;if(69===a.status){if(a.gzhead.extra){let t=a.pending,i=(65535&a.gzhead.extra.length)-a.gzindex;for(;a.pending+i>a.pending_buf_size;){let s=a.pending_buf_size-a.pending;if(a.pending_buf.set(a.gzhead.extra.subarray(a.gzindex,a.gzindex+s),a.pending),a.pending=a.pending_buf_size,a.gzhead.hcrc&&a.pending>t&&(e.adler=Vb(e.adler,a.pending_buf,a.pending-t,t)),a.gzindex+=s,Iy(e),0!==a.pending)return a.last_flush=-1,iy;t=0,i-=s}let s=new Uint8Array(a.gzhead.extra);a.pending_buf.set(s.subarray(a.gzindex,a.gzindex+i),a.pending),a.pending+=i,a.gzhead.hcrc&&a.pending>t&&(e.adler=Vb(e.adler,a.pending_buf,a.pending-t,t)),a.gzindex=0}a.status=73}if(73===a.status){if(a.gzhead.name){let t,i=a.pending;do{if(a.pending===a.pending_buf_size){if(a.gzhead.hcrc&&a.pending>i&&(e.adler=Vb(e.adler,a.pending_buf,a.pending-i,i)),Iy(e),0!==a.pending)return a.last_flush=-1,iy;i=0}t=a.gzindex<a.gzhead.name.length?255&a.gzhead.name.charCodeAt(a.gzindex++):0,Ty(a,t)}while(0!==t);a.gzhead.hcrc&&a.pending>i&&(e.adler=Vb(e.adler,a.pending_buf,a.pending-i,i)),a.gzindex=0}a.status=91}if(91===a.status){if(a.gzhead.comment){let t,i=a.pending;do{if(a.pending===a.pending_buf_size){if(a.gzhead.hcrc&&a.pending>i&&(e.adler=Vb(e.adler,a.pending_buf,a.pending-i,i)),Iy(e),0!==a.pending)return a.last_flush=-1,iy;i=0}t=a.gzindex<a.gzhead.comment.length?255&a.gzhead.comment.charCodeAt(a.gzindex++):0,Ty(a,t)}while(0!==t);a.gzhead.hcrc&&a.pending>i&&(e.adler=Vb(e.adler,a.pending_buf,a.pending-i,i))}a.status=103}if(103===a.status){if(a.gzhead.hcrc){if(a.pending+2>a.pending_buf_size&&(Iy(e),0!==a.pending))return a.last_flush=-1,iy;Ty(a,255&e.adler),Ty(a,e.adler>>8&255),e.adler=0}if(a.status=wy,Iy(e),0!==a.pending)return a.last_flush=-1,iy}if(0!==e.avail_in||0!==a.lookahead||t!==Jb&&a.status!==vy){let i=0===a.level?My(a,t):a.strategy===hy?((e,t)=>{let a;for(;;){if(0===e.lookahead&&(Dy(e),0===e.lookahead)){if(t===Jb)return 1;break}if(e.match_length=0,a=Zb(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,a&&(Ey(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===ty?(Ey(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Ey(e,!1),0===e.strm.avail_out)?1:2})(a,t):a.strategy===dy?((e,t)=>{let a,i,s,o;const n=e.window;for(;;){if(e.lookahead<=fy){if(Dy(e),e.lookahead<=fy&&t===Jb)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(s=e.strstart-1,i=n[s],i===n[++s]&&i===n[++s]&&i===n[++s])){o=e.strstart+fy;do{}while(i===n[++s]&&i===n[++s]&&i===n[++s]&&i===n[++s]&&i===n[++s]&&i===n[++s]&&i===n[++s]&&i===n[++s]&&s<o);e.match_length=fy-(o-s),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(a=Zb(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(a=Zb(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),a&&(Ey(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===ty?(Ey(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Ey(e,!1),0===e.strm.avail_out)?1:2})(a,t):Gy[a.level].func(a,t);if(3!==i&&4!==i||(a.status=vy),1===i||3===i)return 0===e.avail_out&&(a.last_flush=-1),iy;if(2===i&&(t===Qb?Kb(a):t!==ay&&(Xb(a,0,0,!1),t===ey&&(_y(a.head),0===a.lookahead&&(a.strstart=0,a.block_start=0,a.insert=0))),Iy(e),0===e.avail_out))return a.last_flush=-1,iy}return t!==ty?iy:a.wrap<=0?sy:(2===a.wrap?(Ty(a,255&e.adler),Ty(a,e.adler>>8&255),Ty(a,e.adler>>16&255),Ty(a,e.adler>>24&255),Ty(a,255&e.total_in),Ty(a,e.total_in>>8&255),Ty(a,e.total_in>>16&255),Ty(a,e.total_in>>24&255)):(Ay(a,e.adler>>>16),Ay(a,65535&e.adler)),Iy(e),a.wrap>0&&(a.wrap=-a.wrap),0!==a.pending?iy:sy)},deflateEnd:e=>{if(Fy(e))return oy;const t=e.state.status;return e.state=null,t===wy?xy(e,ny):iy},deflateSetDictionary:(e,t)=>{let a=t.length;if(Fy(e))return oy;const i=e.state,s=i.wrap;if(2===s||1===s&&i.status!==yy||i.lookahead)return oy;if(1===s&&(e.adler=Bb(e.adler,t,a,0)),i.wrap=0,a>=i.w_size){0===s&&(_y(i.head),i.strstart=0,i.block_start=0,i.insert=0);let e=new Uint8Array(i.w_size);e.set(t.subarray(a-i.w_size,a),0),t=e,a=i.w_size}const o=e.avail_in,n=e.next_in,r=e.input;for(e.avail_in=a,e.next_in=0,e.input=t,Dy(i);i.lookahead>=3;){let e=i.strstart,t=i.lookahead-2;do{i.ins_h=Cy(i,i.ins_h,i.window[e+3-1]),i.prev[e&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=e,e++}while(--t);i.strstart=e,i.lookahead=2,Dy(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,e.next_in=n,e.input=r,e.avail_in=o,i.wrap=s,iy},deflateInfo:"pako deflate (from Nodeca project)"};const Vy=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var jy=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const a=t.shift();if(a){if("object"!=typeof a)throw new TypeError(a+"must be non-object");for(const t in a)Vy(a,t)&&(e[t]=a[t])}}return e},Yy=e=>{let t=0;for(let i=0,s=e.length;i<s;i++)t+=e[i].length;const a=new Uint8Array(t);for(let i=0,s=0,o=e.length;i<o;i++){let t=e[i];a.set(t,s),s+=t.length}return a};let qy=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(Bk){qy=!1}const Xy=new Uint8Array(256);for(let j=0;j<256;j++)Xy[j]=j>=252?6:j>=248?5:j>=240?4:j>=224?3:j>=192?2:1;Xy[254]=Xy[254]=1;var $y=e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,a,i,s,o,n=e.length,r=0;for(s=0;s<n;s++)a=e.charCodeAt(s),55296==(64512&a)&&s+1<n&&(i=e.charCodeAt(s+1),56320==(64512&i)&&(a=65536+(a-55296<<10)+(i-56320),s++)),r+=a<128?1:a<2048?2:a<65536?3:4;for(t=new Uint8Array(r),o=0,s=0;o<r;s++)a=e.charCodeAt(s),55296==(64512&a)&&s+1<n&&(i=e.charCodeAt(s+1),56320==(64512&i)&&(a=65536+(a-55296<<10)+(i-56320),s++)),a<128?t[o++]=a:a<2048?(t[o++]=192|a>>>6,t[o++]=128|63&a):a<65536?(t[o++]=224|a>>>12,t[o++]=128|a>>>6&63,t[o++]=128|63&a):(t[o++]=240|a>>>18,t[o++]=128|a>>>12&63,t[o++]=128|a>>>6&63,t[o++]=128|63&a);return t},Zy=(e,t)=>{const a=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let i,s;const o=new Array(2*a);for(s=0,i=0;i<a;){let t=e[i++];if(t<128){o[s++]=t;continue}let n=Xy[t];if(n>4)o[s++]=65533,i+=n-1;else{for(t&=2===n?31:3===n?15:7;n>1&&i<a;)t=t<<6|63&e[i++],n--;n>1?o[s++]=65533:t<65536?o[s++]=t:(t-=65536,o[s++]=55296|t>>10&1023,o[s++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&qy)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let a="";for(let i=0;i<t;i++)a+=String.fromCharCode(e[i]);return a})(o,s)},Ky=(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let a=t-1;for(;a>=0&&128==(192&e[a]);)a--;return a<0||0===a?t:a+Xy[e[a]]>t?a:t};var Jy=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const Qy=Object.prototype.toString,{Z_NO_FLUSH:ew,Z_SYNC_FLUSH:tw,Z_FULL_FLUSH:aw,Z_FINISH:iw,Z_OK:sw,Z_STREAM_END:ow,Z_DEFAULT_COMPRESSION:nw,Z_DEFAULT_STRATEGY:rw,Z_DEFLATED:lw}=Yb;function cw(e){this.options=jy({level:nw,method:lw,chunkSize:16384,windowBits:15,memLevel:8,strategy:rw},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Jy,this.strm.avail_out=0;let a=Wy.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(a!==sw)throw new Error(jb[a]);if(t.header&&Wy.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?$y(t.dictionary):"[object ArrayBuffer]"===Qy.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,a=Wy.deflateSetDictionary(this.strm,e),a!==sw)throw new Error(jb[a]);this._dict_set=!0}}function hw(e,t){const a=new cw(t);if(a.push(e,!0),a.err)throw a.msg||jb[a.err];return a.result}cw.prototype.push=function(e,t){const a=this.strm,i=this.options.chunkSize;let s,o;if(this.ended)return!1;for(o=t===~~t?t:!0===t?iw:ew,"string"==typeof e?a.input=$y(e):"[object ArrayBuffer]"===Qy.call(e)?a.input=new Uint8Array(e):a.input=e,a.next_in=0,a.avail_in=a.input.length;;)if(0===a.avail_out&&(a.output=new Uint8Array(i),a.next_out=0,a.avail_out=i),(o===tw||o===aw)&&a.avail_out<=6)this.onData(a.output.subarray(0,a.next_out)),a.avail_out=0;else{if(s=Wy.deflate(a,o),s===ow)return a.next_out>0&&this.onData(a.output.subarray(0,a.next_out)),s=Wy.deflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===sw;if(0!==a.avail_out){if(o>0&&a.next_out>0)this.onData(a.output.subarray(0,a.next_out)),a.avail_out=0;else if(0===a.avail_in)break}else this.onData(a.output)}return!0},cw.prototype.onData=function(e){this.chunks.push(e)},cw.prototype.onEnd=function(e){e===sw&&(this.result=Yy(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var dw={Deflate:cw,deflate:hw,deflateRaw:function(e,t){return(t=t||{}).raw=!0,hw(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,hw(e,t)}};const uw=16209;var pw=function(e,t){let a,i,s,o,n,r,l,c,h,d,u,p,m,g,f,b,y,w,v,x,S,_,k,C;const I=e.state;a=e.next_in,k=e.input,i=a+(e.avail_in-5),s=e.next_out,C=e.output,o=s-(t-e.avail_out),n=s+(e.avail_out-257),r=I.dmax,l=I.wsize,c=I.whave,h=I.wnext,d=I.window,u=I.hold,p=I.bits,m=I.lencode,g=I.distcode,f=(1<<I.lenbits)-1,b=(1<<I.distbits)-1;e:do{p<15&&(u+=k[a++]<<p,p+=8,u+=k[a++]<<p,p+=8),y=m[u&f];t:for(;;){if(w=y>>>24,u>>>=w,p-=w,w=y>>>16&255,0===w)C[s++]=65535&y;else{if(!(16&w)){if(64&w){if(32&w){I.mode=16191;break e}e.msg="invalid literal/length code",I.mode=uw;break e}y=m[(65535&y)+(u&(1<<w)-1)];continue t}for(v=65535&y,w&=15,w&&(p<w&&(u+=k[a++]<<p,p+=8),v+=u&(1<<w)-1,u>>>=w,p-=w),p<15&&(u+=k[a++]<<p,p+=8,u+=k[a++]<<p,p+=8),y=g[u&b];;){if(w=y>>>24,u>>>=w,p-=w,w=y>>>16&255,16&w){if(x=65535&y,w&=15,p<w&&(u+=k[a++]<<p,p+=8,p<w&&(u+=k[a++]<<p,p+=8)),x+=u&(1<<w)-1,x>r){e.msg="invalid distance too far back",I.mode=uw;break e}if(u>>>=w,p-=w,w=s-o,x>w){if(w=x-w,w>c&&I.sane){e.msg="invalid distance too far back",I.mode=uw;break e}if(S=0,_=d,0===h){if(S+=l-w,w<v){v-=w;do{C[s++]=d[S++]}while(--w);S=s-x,_=C}}else if(h<w){if(S+=l+h-w,w-=h,w<v){v-=w;do{C[s++]=d[S++]}while(--w);if(S=0,h<v){w=h,v-=w;do{C[s++]=d[S++]}while(--w);S=s-x,_=C}}}else if(S+=h-w,w<v){v-=w;do{C[s++]=d[S++]}while(--w);S=s-x,_=C}for(;v>2;)C[s++]=_[S++],C[s++]=_[S++],C[s++]=_[S++],v-=3;v&&(C[s++]=_[S++],v>1&&(C[s++]=_[S++]))}else{S=s-x;do{C[s++]=C[S++],C[s++]=C[S++],C[s++]=C[S++],v-=3}while(v>2);v&&(C[s++]=C[S++],v>1&&(C[s++]=C[S++]))}break}if(64&w){e.msg="invalid distance code",I.mode=uw;break e}y=g[(65535&y)+(u&(1<<w)-1)]}}break}}while(a<i&&s<n);v=p>>3,a-=v,p-=v<<3,u&=(1<<p)-1,e.next_in=a,e.next_out=s,e.avail_in=a<i?i-a+5:5-(a-i),e.avail_out=s<n?n-s+257:257-(s-n),I.hold=u,I.bits=p};const mw=15,gw=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),fw=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),bw=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),yw=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var ww=(e,t,a,i,s,o,n,r)=>{const l=r.bits;let c,h,d,u,p,m,g=0,f=0,b=0,y=0,w=0,v=0,x=0,S=0,_=0,k=0,C=null;const I=new Uint16Array(16),E=new Uint16Array(16);let T,A,P,R=null;for(g=0;g<=mw;g++)I[g]=0;for(f=0;f<i;f++)I[t[a+f]]++;for(w=l,y=mw;y>=1&&0===I[y];y--);if(w>y&&(w=y),0===y)return s[o++]=20971520,s[o++]=20971520,r.bits=1,0;for(b=1;b<y&&0===I[b];b++);for(w<b&&(w=b),S=1,g=1;g<=mw;g++)if(S<<=1,S-=I[g],S<0)return-1;if(S>0&&(0===e||1!==y))return-1;for(E[1]=0,g=1;g<mw;g++)E[g+1]=E[g]+I[g];for(f=0;f<i;f++)0!==t[a+f]&&(n[E[t[a+f]]++]=f);if(0===e?(C=R=n,m=20):1===e?(C=gw,R=fw,m=257):(C=bw,R=yw,m=0),k=0,f=0,g=b,p=o,v=w,x=0,d=-1,_=1<<w,u=_-1,1===e&&_>852||2===e&&_>592)return 1;for(;;){T=g-x,n[f]+1<m?(A=0,P=n[f]):n[f]>=m?(A=R[n[f]-m],P=C[n[f]-m]):(A=96,P=0),c=1<<g-x,h=1<<v,b=h;do{h-=c,s[p+(k>>x)+h]=T<<24|A<<16|P}while(0!==h);for(c=1<<g-1;k&c;)c>>=1;if(0!==c?(k&=c-1,k+=c):k=0,f++,0===--I[g]){if(g===y)break;g=t[a+n[f]]}if(g>w&&(k&u)!==d){for(0===x&&(x=w),p+=b,v=g-x,S=1<<v;v+x<y&&(S-=I[v+x],!(S<=0));)v++,S<<=1;if(_+=1<<v,1===e&&_>852||2===e&&_>592)return 1;d=k&u,s[d]=w<<24|v<<16|p-o}}return 0!==k&&(s[p+k]=g-x<<24|64<<16),r.bits=w,0};const{Z_FINISH:vw,Z_BLOCK:xw,Z_TREES:Sw,Z_OK:_w,Z_STREAM_END:kw,Z_NEED_DICT:Cw,Z_STREAM_ERROR:Iw,Z_DATA_ERROR:Ew,Z_MEM_ERROR:Tw,Z_BUF_ERROR:Aw,Z_DEFLATED:Pw}=Yb,Rw=16180,Dw=16190,Mw=16191,Lw=16192,Nw=16194,Ow=16199,Gw=16200,zw=16206,Fw=16209,Hw=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function Uw(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Bw=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<Rw||t.mode>16211?1:0},Ww=e=>{if(Bw(e))return Iw;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=Rw,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,_w},Vw=e=>{if(Bw(e))return Iw;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Ww(e)},jw=(e,t)=>{let a;if(Bw(e))return Iw;const i=e.state;return t<0?(a=0,t=-t):(a=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?Iw:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=a,i.wbits=t,Vw(e))},Yw=(e,t)=>{if(!e)return Iw;const a=new Uw;e.state=a,a.strm=e,a.window=null,a.mode=Rw;const i=jw(e,t);return i!==_w&&(e.state=null),i};let qw,Xw,$w=!0;const Zw=e=>{if($w){qw=new Int32Array(512),Xw=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(ww(1,e.lens,0,288,qw,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;ww(2,e.lens,0,32,Xw,0,e.work,{bits:5}),$w=!1}e.lencode=qw,e.lenbits=9,e.distcode=Xw,e.distbits=5},Kw=(e,t,a,i)=>{let s;const o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),i>=o.wsize?(o.window.set(t.subarray(a-o.wsize,a),0),o.wnext=0,o.whave=o.wsize):(s=o.wsize-o.wnext,s>i&&(s=i),o.window.set(t.subarray(a-i,a-i+s),o.wnext),(i-=s)?(o.window.set(t.subarray(a-i,a),0),o.wnext=i,o.whave=o.wsize):(o.wnext+=s,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=s))),0};var Jw={inflateReset:Vw,inflateReset2:jw,inflateResetKeep:Ww,inflateInit:e=>Yw(e,15),inflateInit2:Yw,inflate:(e,t)=>{let a,i,s,o,n,r,l,c,h,d,u,p,m,g,f,b,y,w,v,x,S,_,k=0;const C=new Uint8Array(4);let I,E;const T=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Bw(e)||!e.output||!e.input&&0!==e.avail_in)return Iw;a=e.state,a.mode===Mw&&(a.mode=Lw),n=e.next_out,s=e.output,l=e.avail_out,o=e.next_in,i=e.input,r=e.avail_in,c=a.hold,h=a.bits,d=r,u=l,_=_w;e:for(;;)switch(a.mode){case Rw:if(0===a.wrap){a.mode=Lw;break}for(;h<16;){if(0===r)break e;r--,c+=i[o++]<<h,h+=8}if(2&a.wrap&&35615===c){0===a.wbits&&(a.wbits=15),a.check=0,C[0]=255&c,C[1]=c>>>8&255,a.check=Vb(a.check,C,2,0),c=0,h=0,a.mode=16181;break}if(a.head&&(a.head.done=!1),!(1&a.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",a.mode=Fw;break}if((15&c)!==Pw){e.msg="unknown compression method",a.mode=Fw;break}if(c>>>=4,h-=4,S=8+(15&c),0===a.wbits&&(a.wbits=S),S>15||S>a.wbits){e.msg="invalid window size",a.mode=Fw;break}a.dmax=1<<a.wbits,a.flags=0,e.adler=a.check=1,a.mode=512&c?16189:Mw,c=0,h=0;break;case 16181:for(;h<16;){if(0===r)break e;r--,c+=i[o++]<<h,h+=8}if(a.flags=c,(255&a.flags)!==Pw){e.msg="unknown compression method",a.mode=Fw;break}if(57344&a.flags){e.msg="unknown header flags set",a.mode=Fw;break}a.head&&(a.head.text=c>>8&1),512&a.flags&&4&a.wrap&&(C[0]=255&c,C[1]=c>>>8&255,a.check=Vb(a.check,C,2,0)),c=0,h=0,a.mode=16182;case 16182:for(;h<32;){if(0===r)break e;r--,c+=i[o++]<<h,h+=8}a.head&&(a.head.time=c),512&a.flags&&4&a.wrap&&(C[0]=255&c,C[1]=c>>>8&255,C[2]=c>>>16&255,C[3]=c>>>24&255,a.check=Vb(a.check,C,4,0)),c=0,h=0,a.mode=16183;case 16183:for(;h<16;){if(0===r)break e;r--,c+=i[o++]<<h,h+=8}a.head&&(a.head.xflags=255&c,a.head.os=c>>8),512&a.flags&&4&a.wrap&&(C[0]=255&c,C[1]=c>>>8&255,a.check=Vb(a.check,C,2,0)),c=0,h=0,a.mode=16184;case 16184:if(1024&a.flags){for(;h<16;){if(0===r)break e;r--,c+=i[o++]<<h,h+=8}a.length=c,a.head&&(a.head.extra_len=c),512&a.flags&&4&a.wrap&&(C[0]=255&c,C[1]=c>>>8&255,a.check=Vb(a.check,C,2,0)),c=0,h=0}else a.head&&(a.head.extra=null);a.mode=16185;case 16185:if(1024&a.flags&&(p=a.length,p>r&&(p=r),p&&(a.head&&(S=a.head.extra_len-a.length,a.head.extra||(a.head.extra=new Uint8Array(a.head.extra_len)),a.head.extra.set(i.subarray(o,o+p),S)),512&a.flags&&4&a.wrap&&(a.check=Vb(a.check,i,p,o)),r-=p,o+=p,a.length-=p),a.length))break e;a.length=0,a.mode=16186;case 16186:if(2048&a.flags){if(0===r)break e;p=0;do{S=i[o+p++],a.head&&S&&a.length<65536&&(a.head.name+=String.fromCharCode(S))}while(S&&p<r);if(512&a.flags&&4&a.wrap&&(a.check=Vb(a.check,i,p,o)),r-=p,o+=p,S)break e}else a.head&&(a.head.name=null);a.length=0,a.mode=16187;case 16187:if(4096&a.flags){if(0===r)break e;p=0;do{S=i[o+p++],a.head&&S&&a.length<65536&&(a.head.comment+=String.fromCharCode(S))}while(S&&p<r);if(512&a.flags&&4&a.wrap&&(a.check=Vb(a.check,i,p,o)),r-=p,o+=p,S)break e}else a.head&&(a.head.comment=null);a.mode=16188;case 16188:if(512&a.flags){for(;h<16;){if(0===r)break e;r--,c+=i[o++]<<h,h+=8}if(4&a.wrap&&c!==(65535&a.check)){e.msg="header crc mismatch",a.mode=Fw;break}c=0,h=0}a.head&&(a.head.hcrc=a.flags>>9&1,a.head.done=!0),e.adler=a.check=0,a.mode=Mw;break;case 16189:for(;h<32;){if(0===r)break e;r--,c+=i[o++]<<h,h+=8}e.adler=a.check=Hw(c),c=0,h=0,a.mode=Dw;case Dw:if(0===a.havedict)return e.next_out=n,e.avail_out=l,e.next_in=o,e.avail_in=r,a.hold=c,a.bits=h,Cw;e.adler=a.check=1,a.mode=Mw;case Mw:if(t===xw||t===Sw)break e;case Lw:if(a.last){c>>>=7&h,h-=7&h,a.mode=zw;break}for(;h<3;){if(0===r)break e;r--,c+=i[o++]<<h,h+=8}switch(a.last=1&c,c>>>=1,h-=1,3&c){case 0:a.mode=16193;break;case 1:if(Zw(a),a.mode=Ow,t===Sw){c>>>=2,h-=2;break e}break;case 2:a.mode=16196;break;case 3:e.msg="invalid block type",a.mode=Fw}c>>>=2,h-=2;break;case 16193:for(c>>>=7&h,h-=7&h;h<32;){if(0===r)break e;r--,c+=i[o++]<<h,h+=8}if((65535&c)!=(c>>>16^65535)){e.msg="invalid stored block lengths",a.mode=Fw;break}if(a.length=65535&c,c=0,h=0,a.mode=Nw,t===Sw)break e;case Nw:a.mode=16195;case 16195:if(p=a.length,p){if(p>r&&(p=r),p>l&&(p=l),0===p)break e;s.set(i.subarray(o,o+p),n),r-=p,o+=p,l-=p,n+=p,a.length-=p;break}a.mode=Mw;break;case 16196:for(;h<14;){if(0===r)break e;r--,c+=i[o++]<<h,h+=8}if(a.nlen=257+(31&c),c>>>=5,h-=5,a.ndist=1+(31&c),c>>>=5,h-=5,a.ncode=4+(15&c),c>>>=4,h-=4,a.nlen>286||a.ndist>30){e.msg="too many length or distance symbols",a.mode=Fw;break}a.have=0,a.mode=16197;case 16197:for(;a.have<a.ncode;){for(;h<3;){if(0===r)break e;r--,c+=i[o++]<<h,h+=8}a.lens[T[a.have++]]=7&c,c>>>=3,h-=3}for(;a.have<19;)a.lens[T[a.have++]]=0;if(a.lencode=a.lendyn,a.lenbits=7,I={bits:a.lenbits},_=ww(0,a.lens,0,19,a.lencode,0,a.work,I),a.lenbits=I.bits,_){e.msg="invalid code lengths set",a.mode=Fw;break}a.have=0,a.mode=16198;case 16198:for(;a.have<a.nlen+a.ndist;){for(;k=a.lencode[c&(1<<a.lenbits)-1],f=k>>>24,b=k>>>16&255,y=65535&k,!(f<=h);){if(0===r)break e;r--,c+=i[o++]<<h,h+=8}if(y<16)c>>>=f,h-=f,a.lens[a.have++]=y;else{if(16===y){for(E=f+2;h<E;){if(0===r)break e;r--,c+=i[o++]<<h,h+=8}if(c>>>=f,h-=f,0===a.have){e.msg="invalid bit length repeat",a.mode=Fw;break}S=a.lens[a.have-1],p=3+(3&c),c>>>=2,h-=2}else if(17===y){for(E=f+3;h<E;){if(0===r)break e;r--,c+=i[o++]<<h,h+=8}c>>>=f,h-=f,S=0,p=3+(7&c),c>>>=3,h-=3}else{for(E=f+7;h<E;){if(0===r)break e;r--,c+=i[o++]<<h,h+=8}c>>>=f,h-=f,S=0,p=11+(127&c),c>>>=7,h-=7}if(a.have+p>a.nlen+a.ndist){e.msg="invalid bit length repeat",a.mode=Fw;break}for(;p--;)a.lens[a.have++]=S}}if(a.mode===Fw)break;if(0===a.lens[256]){e.msg="invalid code -- missing end-of-block",a.mode=Fw;break}if(a.lenbits=9,I={bits:a.lenbits},_=ww(1,a.lens,0,a.nlen,a.lencode,0,a.work,I),a.lenbits=I.bits,_){e.msg="invalid literal/lengths set",a.mode=Fw;break}if(a.distbits=6,a.distcode=a.distdyn,I={bits:a.distbits},_=ww(2,a.lens,a.nlen,a.ndist,a.distcode,0,a.work,I),a.distbits=I.bits,_){e.msg="invalid distances set",a.mode=Fw;break}if(a.mode=Ow,t===Sw)break e;case Ow:a.mode=Gw;case Gw:if(r>=6&&l>=258){e.next_out=n,e.avail_out=l,e.next_in=o,e.avail_in=r,a.hold=c,a.bits=h,pw(e,u),n=e.next_out,s=e.output,l=e.avail_out,o=e.next_in,i=e.input,r=e.avail_in,c=a.hold,h=a.bits,a.mode===Mw&&(a.back=-1);break}for(a.back=0;k=a.lencode[c&(1<<a.lenbits)-1],f=k>>>24,b=k>>>16&255,y=65535&k,!(f<=h);){if(0===r)break e;r--,c+=i[o++]<<h,h+=8}if(b&&!(240&b)){for(w=f,v=b,x=y;k=a.lencode[x+((c&(1<<w+v)-1)>>w)],f=k>>>24,b=k>>>16&255,y=65535&k,!(w+f<=h);){if(0===r)break e;r--,c+=i[o++]<<h,h+=8}c>>>=w,h-=w,a.back+=w}if(c>>>=f,h-=f,a.back+=f,a.length=y,0===b){a.mode=16205;break}if(32&b){a.back=-1,a.mode=Mw;break}if(64&b){e.msg="invalid literal/length code",a.mode=Fw;break}a.extra=15&b,a.mode=16201;case 16201:if(a.extra){for(E=a.extra;h<E;){if(0===r)break e;r--,c+=i[o++]<<h,h+=8}a.length+=c&(1<<a.extra)-1,c>>>=a.extra,h-=a.extra,a.back+=a.extra}a.was=a.length,a.mode=16202;case 16202:for(;k=a.distcode[c&(1<<a.distbits)-1],f=k>>>24,b=k>>>16&255,y=65535&k,!(f<=h);){if(0===r)break e;r--,c+=i[o++]<<h,h+=8}if(!(240&b)){for(w=f,v=b,x=y;k=a.distcode[x+((c&(1<<w+v)-1)>>w)],f=k>>>24,b=k>>>16&255,y=65535&k,!(w+f<=h);){if(0===r)break e;r--,c+=i[o++]<<h,h+=8}c>>>=w,h-=w,a.back+=w}if(c>>>=f,h-=f,a.back+=f,64&b){e.msg="invalid distance code",a.mode=Fw;break}a.offset=y,a.extra=15&b,a.mode=16203;case 16203:if(a.extra){for(E=a.extra;h<E;){if(0===r)break e;r--,c+=i[o++]<<h,h+=8}a.offset+=c&(1<<a.extra)-1,c>>>=a.extra,h-=a.extra,a.back+=a.extra}if(a.offset>a.dmax){e.msg="invalid distance too far back",a.mode=Fw;break}a.mode=16204;case 16204:if(0===l)break e;if(p=u-l,a.offset>p){if(p=a.offset-p,p>a.whave&&a.sane){e.msg="invalid distance too far back",a.mode=Fw;break}p>a.wnext?(p-=a.wnext,m=a.wsize-p):m=a.wnext-p,p>a.length&&(p=a.length),g=a.window}else g=s,m=n-a.offset,p=a.length;p>l&&(p=l),l-=p,a.length-=p;do{s[n++]=g[m++]}while(--p);0===a.length&&(a.mode=Gw);break;case 16205:if(0===l)break e;s[n++]=a.length,l--,a.mode=Gw;break;case zw:if(a.wrap){for(;h<32;){if(0===r)break e;r--,c|=i[o++]<<h,h+=8}if(u-=l,e.total_out+=u,a.total+=u,4&a.wrap&&u&&(e.adler=a.check=a.flags?Vb(a.check,s,u,n-u):Bb(a.check,s,u,n-u)),u=l,4&a.wrap&&(a.flags?c:Hw(c))!==a.check){e.msg="incorrect data check",a.mode=Fw;break}c=0,h=0}a.mode=16207;case 16207:if(a.wrap&&a.flags){for(;h<32;){if(0===r)break e;r--,c+=i[o++]<<h,h+=8}if(4&a.wrap&&c!==(4294967295&a.total)){e.msg="incorrect length check",a.mode=Fw;break}c=0,h=0}a.mode=16208;case 16208:_=kw;break e;case Fw:_=Ew;break e;case 16210:return Tw;default:return Iw}return e.next_out=n,e.avail_out=l,e.next_in=o,e.avail_in=r,a.hold=c,a.bits=h,(a.wsize||u!==e.avail_out&&a.mode<Fw&&(a.mode<zw||t!==vw))&&Kw(e,e.output,e.next_out,u-e.avail_out),d-=e.avail_in,u-=e.avail_out,e.total_in+=d,e.total_out+=u,a.total+=u,4&a.wrap&&u&&(e.adler=a.check=a.flags?Vb(a.check,s,u,e.next_out-u):Bb(a.check,s,u,e.next_out-u)),e.data_type=a.bits+(a.last?64:0)+(a.mode===Mw?128:0)+(a.mode===Ow||a.mode===Nw?256:0),(0===d&&0===u||t===vw)&&_===_w&&(_=Aw),_},inflateEnd:e=>{if(Bw(e))return Iw;let t=e.state;return t.window&&(t.window=null),e.state=null,_w},inflateGetHeader:(e,t)=>{if(Bw(e))return Iw;const a=e.state;return 2&a.wrap?(a.head=t,t.done=!1,_w):Iw},inflateSetDictionary:(e,t)=>{const a=t.length;let i,s,o;return Bw(e)?Iw:(i=e.state,0!==i.wrap&&i.mode!==Dw?Iw:i.mode===Dw&&(s=1,s=Bb(s,t,a,0),s!==i.check)?Ew:(o=Kw(e,t,a,a),o?(i.mode=16210,Tw):(i.havedict=1,_w)))},inflateInfo:"pako inflate (from Nodeca project)"};var Qw=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const ev=Object.prototype.toString,{Z_NO_FLUSH:tv,Z_FINISH:av,Z_OK:iv,Z_STREAM_END:sv,Z_NEED_DICT:ov,Z_STREAM_ERROR:nv,Z_DATA_ERROR:rv,Z_MEM_ERROR:lv}=Yb;function cv(e){this.options=jy({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(15&t.windowBits||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Jy,this.strm.avail_out=0;let a=Jw.inflateInit2(this.strm,t.windowBits);if(a!==iv)throw new Error(jb[a]);if(this.header=new Qw,Jw.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=$y(t.dictionary):"[object ArrayBuffer]"===ev.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(a=Jw.inflateSetDictionary(this.strm,t.dictionary),a!==iv)))throw new Error(jb[a])}function hv(e,t){const a=new cv(t);if(a.push(e),a.err)throw a.msg||jb[a.err];return a.result}cv.prototype.push=function(e,t){const a=this.strm,i=this.options.chunkSize,s=this.options.dictionary;let o,n,r;if(this.ended)return!1;for(n=t===~~t?t:!0===t?av:tv,"[object ArrayBuffer]"===ev.call(e)?a.input=new Uint8Array(e):a.input=e,a.next_in=0,a.avail_in=a.input.length;;){for(0===a.avail_out&&(a.output=new Uint8Array(i),a.next_out=0,a.avail_out=i),o=Jw.inflate(a,n),o===ov&&s&&(o=Jw.inflateSetDictionary(a,s),o===iv?o=Jw.inflate(a,n):o===rv&&(o=ov));a.avail_in>0&&o===sv&&a.state.wrap>0&&0!==e[a.next_in];)Jw.inflateReset(a),o=Jw.inflate(a,n);switch(o){case nv:case rv:case ov:case lv:return this.onEnd(o),this.ended=!0,!1}if(r=a.avail_out,a.next_out&&(0===a.avail_out||o===sv))if("string"===this.options.to){let e=Ky(a.output,a.next_out),t=a.next_out-e,s=Zy(a.output,e);a.next_out=t,a.avail_out=i-t,t&&a.output.set(a.output.subarray(e,e+t),0),this.onData(s)}else this.onData(a.output.length===a.next_out?a.output:a.output.subarray(0,a.next_out));if(o!==iv||0!==r){if(o===sv)return o=Jw.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(0===a.avail_in)break}}return!0},cv.prototype.onData=function(e){this.chunks.push(e)},cv.prototype.onEnd=function(e){e===iv&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Yy(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var dv={Inflate:cv,inflate:hv,inflateRaw:function(e,t){return(t=t||{}).raw=!0,hv(e,t)},ungzip:hv};const{Deflate:uv,deflate:pv,deflateRaw:mv,gzip:gv}=dw,{Inflate:fv,inflate:bv,inflateRaw:yv,ungzip:wv}=dv;var vv={Deflate:uv,deflate:pv,deflateRaw:mv,gzip:gv,Inflate:fv,inflate:bv,inflateRaw:yv,ungzip:wv,constants:Yb};class xv{static tryParseUrlLocation(e){let t=e.hash;if(t.length<=1)return null;t=t.substring(1);const a=atob(t),i=new Uint8Array(a.length);for(let l=0;l<i.length;l++)i[l]=a.charCodeAt(l);const s=vv.inflate(i),o=nt.fromBinary(s);let n=vf.DEFAULT_CATEGORIES;const r=new URLSearchParams(window.location.search);if(r.has(vf.CATEGORY_PARAM)){n=r.get(vf.CATEGORY_PARAM).split("").map(e=>[...bf.entries()].find(t=>t[1]==e)).filter(e=>e).map(e=>e[0])}return{settings:o,categories:n}}}const Sv="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";function _v(e){if(!e.length)return 0;let t=0,a=1,i=e[0];for(;(32&i)>0;)a++,i<<=1;const s=63>>a;let o=e.shift()&s;a--;for(let n=1;n<=a;n++)t+=1<<5*n,o=o<<6|(e.shift()||0);return o+t}function kv(e){const t={classId:"",raceId:"",genderId:0,level:0,specIndex:0,talentString:"",glyphs:[],items:[]},a=/^([a-z-]+)\/([a-z-]+)(?:\/([a-zA-Z0-9_-]+))?$/.exec(e);if(!a)return t;t.classId=a[1],t.raceId=a[2];let i=a[3];if(!i)return t;const s=Sv.indexOf(i.substring(0,1));if(i=i.substring(1),!i.length)return t;const o=[];for(let n=0;n<i.length;n++)o.push(Sv.indexOf(i.substring(n,n+1)));if(s>4)return t;s>=2&&_v(o);{const e=_v(o)-1;e>=0&&(t.genderId=e)}{const e=_v(o);e&&(t.level=e)}{s>=4&&(t.specIndex=_v(o));const e=[Cv(o)];let a=_v(o);for(;a-- >0;){const t=_v(o);e.push(o.splice(0,t).map(e=>Sv[e]).join(""))}const[i,n]=e;t.talentString=i,t.glyphs=function(e){const t=Array(6).fill(0);if(!e)return t;const a=Sv.indexOf(e.substring(0,1)),i=e.substring(1);if(!i.length)return t;if(0!==a)return t;const s=[];for(let n=0;n<i.length;n++)s.push(Sv.indexOf(i.substring(n,n+1)));const o=191;for(;s.length>1;){const e=_v(s),a=_v(s);e>o||(t[e]=a)}return t}(n)}{let e=_v(o);for(;e--;){const e={};let a=!1,i=!1,n=!1,r=0,l=0;switch(s){case 0:{const e=o.shift();a=!!(e>>5&1),r=e>>2&7,l=3&e;break}case 1:case 2:{const e=_v(o);a=!!(e>>6&1),n=!!(e>>5&1),r=e>>2&7,l=3&e;break}default:{const e=_v(o);a=!!(e>>7&1),i=!!(e>>6&1),n=!!(e>>5&1),r=e>>2&7,l=3&e;break}}if(e.slotId=_v(o),e.itemId=_v(o),a){let t=_v(o);const a=1&t;t>>=1,a&&(t*=-1),e.randomEnchantId=t}for(i&&(e.upgradeRank=_v(o)),n&&(e.reforge=_v(o));r--;)(e.gemItemIds??(e.gemItemIds=[])).push(_v(o));for(;l--;)(e.enchantIds??(e.enchantIds=[])).push(_v(o));(t.items??(t.items=[])).push(e)}}return t}function Cv(e){let t="",a=_v(e);for(;0!==a;)t+=""+(3&a),a>>=2;return t}const Iv=class e extends vf{constructor(e,t){super(e,t,{title:oe.t("import.wowhead.title"),allowFileUpload:!0});const a=U();this.descriptionElem.appendChild(H("div",null,H("p",null,oe.t("import.wowhead.description")," ",H("a",{href:"https://www.wowhead.com/mop-classic/gear-planner",target:"_blank"},oe.t("import.wowhead.gear_planner_link")),"."),H("p",null,oe.t("import.wowhead.feature_description")),H("p",null,oe.t("import.wowhead.instructions")),H("div",{ref:a}))),a.value&&new Dg({title:oe.t("import.wowhead.tinker_warning.title"),body:H("div",null,oe.t("import.wowhead.tinker_warning.message")),additionalClasses:["toast-import-warning"],container:a.value,variant:"warning",canClose:!1,autoShow:!0,autohide:!1})}async onImport(t){if(!t.match(/www\.wowhead\.com\/mop-classic\/gear-planner\/([a-z\-]+)\/([a-z\-]+)\/([a-zA-Z0-9_\-]+)/))throw new Error(oe.t("import.wowhead.error_invalid_url",{url:t}));const i=[],n=[],r=[],l=function(e){const t=e.match(/mop-classic\/gear-planner\/(.+)/);if(!t)throw new Error(`Invalid WCL URL ${e}, must look like "https://www.wowhead.com/mop-classic/gear-planner/CLASS/RACE/XXXX"`);return kv(t[1])}(t),c=l.glyphs,h=Zr(l.classId.replaceAll("-",""));if(h==q.ClassUnknown)throw new Error(oe.t("import.wowhead.error_cannot_parse_class",{classId:l.classId}));const d=Xr((e=>{const t=e.startsWith("alliance-")?" (A)":void 0,a=e.startsWith("horde-")?" (H)":void 0;return e.replaceAll("alliance","").replaceAll("horde","").replaceAll("-","")+(t??a??"")})(l.raceId));if(d==Y.RaceUnknown)throw new Error(oe.t("import.wowhead.error_cannot_parse_race",{raceId:l.raceId}));const u=s.create();l.items.forEach(t=>{const s=this.simUI.sim.db.getItemById(t.itemId);if(!s)return void i.push(t.itemId);const l=o.create();l.id=t.itemId;const c=t.slotId;t.enchantIds?.length&&t.enchantIds.forEach(e=>{const t=this.simUI.sim.db.enchantSpellIdToEnchant(e),i=t?.requiredProfession===a.Engineering;t?i?(l.tinker=t.effectId,r.includes(a.Engineering)||r.push(a.Engineering)):l.enchant=t.effectId:n.push(e)}),t.gemItemIds&&(l.gems=t.gemItemIds),t.randomEnchantId&&(l.randomSuffix=t.randomEnchantId),t.reforge&&(l.reforging=t.reforge),t.upgradeRank&&s&&(l.upgradeStep=s.scalingOptions[t.upgradeRank]?t.upgradeRank:Object.keys(s.scalingOptions).length-2);null!=Object.entries(e.slotIDs).find(e=>e[1]==c)&&u.items.push(l)});const p=Vt.create({major1:this.simUI.sim.db.glyphSpellToItemId(c[0]),major2:this.simUI.sim.db.glyphSpellToItemId(c[1]),major3:this.simUI.sim.db.glyphSpellToItemId(c[2]),minor1:this.simUI.sim.db.glyphSpellToItemId(c[3]),minor2:this.simUI.sim.db.glyphSpellToItemId(c[4]),minor3:this.simUI.sim.db.glyphSpellToItemId(c[5])});this.finishIndividualImport(this.simUI,{charClass:h,race:d,equipmentSpec:u,talentsStr:l.talentString??"",glyphs:p,professions:r,missingEnchants:n,missingItems:i})}};Iv.slotIDs={[i.ItemSlotHead]:1,[i.ItemSlotNeck]:2,[i.ItemSlotShoulder]:3,[i.ItemSlotBack]:15,[i.ItemSlotChest]:5,[i.ItemSlotWrist]:9,[i.ItemSlotHands]:10,[i.ItemSlotWaist]:6,[i.ItemSlotLegs]:7,[i.ItemSlotFeet]:8,[i.ItemSlotFinger1]:11,[i.ItemSlotFinger2]:12,[i.ItemSlotTrinket1]:13,[i.ItemSlotTrinket2]:14,[i.ItemSlotMainHand]:16,[i.ItemSlotOffHand]:17};let Ev=Iv;class Tv extends Bg{constructor(e,t){super(e,t,{identifier:"bulk-tab",title:oe.t("bulk_tab.title")}),this.itemsChangedEmitter=new te,this.settingsChangedEmitter=new te,this.items=new Array,this.pickerGroups=new Map,this.combinations=0,this.iterations=0,this.frozenItems=new Map([[ut.ItemSlotFinger,null],[ut.ItemSlotTrinket,null]]),this.topGearResults=null,this.originalGear=null,this.originalGearResults=null,this.isRunning=!1,this.simUI=t,this.playerCanDualWield=this.simUI.player.getPlayerSpec().canDualWield&&this.simUI.player.getClass()!==q.ClassHunter,this.playerIsFuryWarrior=this.simUI.player.getSpec()===K.SpecFuryWarrior;const a=U(),i=U(),s=U(),o=U(),n=U(),r=U(),l=U();this.contentContainer.appendChild(H(de,null,H("div",{className:"bulk-tab-left tab-panel-left"},H("div",{className:"bulk-tab-tabs"},H("ul",{className:"nav nav-tabs",attributes:{role:"tablist"}},H("li",{className:"nav-item",attributes:{role:"presentation"}},H("button",{className:"nav-link active",type:"button",attributes:{role:"tab","aria-controls":"bulkSetupTab","aria-selected":!0},dataset:{bsToggle:"tab",bsTarget:"#bulkSetupTab"},ref:a},oe.t("bulk_tab.tabs.setup"))),H("li",{className:"nav-item",attributes:{role:"presentation"}},H("button",{className:"nav-link",type:"button",attributes:{role:"tab","aria-controls":"bulkResultsTab","aria-selected":!1},dataset:{bsToggle:"tab",bsTarget:"#bulkResultsTab"},ref:s},oe.t("bulk_tab.tabs.results")))),H("div",{className:"tab-content"},H("div",{id:"bulkSetupTab",className:"tab-pane fade active show",ref:i}),H("div",{id:"bulkResultsTab",className:"tab-pane fade show",ref:o},H("div",{className:"d-flex align-items-center justify-content-center p-gap"},oe.t("bulk_tab.results.run_simulation")))))),H("div",{className:"bulk-tab-right tab-panel-right"},H("div",{className:"bulk-settings-outer-container"},H("div",{className:"bulk-settings-container",ref:n},H("div",{className:"bulk-combinations-count h4",ref:r}),H("button",{className:"btn btn-primary bulk-settings-btn",ref:l},oe.t("bulk_tab.actions.simulate_batch"))))))),this.setupTabElem=i.value,this.resultsTabElem=o.value,this.pendingDiv=H("div",{className:"results-pending-overlay"}),this.combinationsElem=r.value,this.bulkSimButton=l.value,this.settingsContainer=n.value,this.setupTab=new jt(a.value),this.resultsTab=new jt(s.value),this.pendingResults=new Ug(this.pendingDiv),this.pendingResults.hideAll(),this.selectorModal=new wk(this.simUI.rootElem,this.simUI,this.simUI.player,void 0,{id:"bulk-selector-modal"}),this.inheritUpgrades=!0,this.defaultGems=Array.from({length:5},()=>v.create()),this.gemIconElements=[],this.buildTabContent(),this.simUI.sim.waitForInit().then(()=>{this.loadSettings();const e=()=>{if(!this.isRunning){for(const e of this.pickerGroups.values())e.has(-1)&&e.remove(-1,!0),e.has(-2)&&e.remove(-2,!0);this.simUI.player.getEquippedItems().forEach((e,t)=>{const a=$t(t,this.playerCanDualWield),i=this.pickerGroups.get(a),s=this.isSecondaryItemSlot(t)?-2:-1;e&&i.add(s,e,!0)}),this.itemsChangedEmitter.emit(te.nextEventID())}};e(),te.onAny([this.simUI.player.challengeModeChangeEmitter,this.simUI.player.gearChangeEmitter]).on(()=>e()),te.onAny([this.settingsChangedEmitter,this.itemsChangedEmitter]).on(()=>this.storeSettings()),te.onAny([this.itemsChangedEmitter,this.settingsChangedEmitter,this.simUI.sim.iterationsChangeEmitter]).on(()=>{this.getCombinationsCount().then(e=>this.combinationsElem.replaceChildren(e))}),this.getCombinationsCount().then(e=>this.combinationsElem.replaceChildren(e))})}getSettingsKey(){return this.simUI.getStorageKey("bulk-settings.v1")}loadSettings(){const e=window.localStorage.getItem(this.getSettingsKey());if(null!=e){const t=Yt.fromJsonString(e,{ignoreUnknownFields:!0});this.addItems(t.items,!0),this.setInheritUpgrades(t.inheritUpgrades),this.defaultGems=new Array(w.create({id:t.defaultRedGem}),w.create({id:t.defaultYellowGem}),w.create({id:t.defaultBlueGem}),w.create({id:t.defaultMetaGem}),w.create({id:t.defaultPrismaticGem})),this.defaultGems.forEach((e,t)=>{Lr.fromItemId(e.id).fill().then(a=>{e.id&&(this.gemIconElements[t].src=a.iconUrl,this.gemIconElements[t].classList.remove("hide"))})})}}storeSettings(){const e=this.createBulkSettings(),t=Yt.toJsonString(e,{enumAsInteger:!0});window.localStorage.setItem(this.getSettingsKey(),t)}createBulkSettings(){return Yt.create({items:this.getItems(),inheritUpgrades:this.inheritUpgrades,defaultRedGem:this.defaultGems[0].id,defaultYellowGem:this.defaultGems[1].id,defaultBlueGem:this.defaultGems[2].id,defaultMetaGem:this.defaultGems[3].id,defaultPrismaticGem:this.defaultGems[4].id,iterationsPerCombo:this.getDefaultIterationsCount()})}getDefaultIterationsCount(){return qt()?1e3:this.simUI.sim.getIterations()}createBulkItemsDatabase(){const e=m.create();for(const t of this.items.values()){if(!t)continue;const a=this.simUI.sim.db.lookupItemSpec(t);if(!a)throw new Error(`item with ID ${t.id} not found in database`);e.items.push(g.fromJson(f.toJson(a.item),{ignoreUnknownFields:!0}));this.simUI.sim.db.getItemEffectRandPropPoints(a.ilvl)&&e.itemEffectRandPropPoints.push(Xt.create(this.simUI.sim.db.getItemEffectRandPropPoints(a.ilvl))),a.enchant&&e.enchants.push(b.fromJson(y.toJson(a.enchant),{ignoreUnknownFields:!0})),a.randomSuffix&&e.randomSuffixes.push(S.fromJson(S.toJson(a.randomSuffix),{ignoreUnknownFields:!0})),a.reforge&&e.reforgeStats.push(_.fromJson(_.toJson(a.reforge),{ignoreUnknownFields:!0}));for(const t of a.gems)t&&e.gems.push(w.fromJson(v.toJson(t),{ignoreUnknownFields:!0}))}for(const t of this.defaultGems)t.id>0&&e.gems.push(t);return e}addItem(e){this.addItems([e])}addItems(e,t=!1){e.forEach(e=>{const a=this.simUI.sim.db.lookupItemSpec(e)?.withChallengeMode(this.simUI.player.getChallengeModeEnabled()).withDynamicStats();a&&M(a.item,this.playerIsFuryWarrior).forEach(i=>{if(this.isSecondaryItemSlot(i)||!pt(a.item,this.simUI.player.getPlayerSpec(),i))return;const s=this.items.push(e)-1,o=$t(i,this.playerCanDualWield);this.pickerGroups.get(o).add(s,a,t)})}),this.itemsChangedEmitter.emit(te.nextEventID())}addItemToSlot(e,t){const a=this.simUI.sim.db.lookupItemSpec(e)?.withChallengeMode(this.simUI.player.getChallengeModeEnabled()).withDynamicStats();if(a){const i=M(a.item,this.playerIsFuryWarrior);if(!pt(a.item,this.simUI.player.getPlayerSpec(),i[0]))return;const s=this.items.push(e)-1;this.pickerGroups.get(t).add(s,a),this.itemsChangedEmitter.emit(te.nextEventID())}}updateItem(e,t){const a=this.simUI.sim.db.lookupItemSpec(t)?.withChallengeMode(this.simUI.player.getChallengeModeEnabled()).withDynamicStats();a&&(this.items[e]=t,M(a.item,this.playerIsFuryWarrior).forEach(t=>{if(this.isSecondaryItemSlot(t)||!pt(a.item,this.simUI.player.getPlayerSpec(),t))return;const i=$t(t,this.playerCanDualWield);this.pickerGroups.get(i).update(e,a)})),this.itemsChangedEmitter.emit(te.nextEventID())}removeItem(e){for(let t=0;t<this.items.length;t++)if(this.items[t]&&o.equals(this.items[t],e))return void this.removeItemByIndex(t)}removeItemByIndex(e,t=!1){if(e<0||this.items.length<e||!this.items[e])return void new Dg({variant:"error",body:oe.t("bulk_tab.notifications.failed_to_remove_item")});const a=this.items[e],i=this.simUI.sim.db.lookupItemSpec(a);i&&(this.items[e]=null,M(i.item,this.playerIsFuryWarrior).forEach(a=>{if(!pt(i.item,this.simUI.player.getPlayerSpec(),a))return;const s=$t(a,this.playerCanDualWield),o=this.pickerGroups.get(s);o.has(e)&&o.remove(e,t)}),this.itemsChangedEmitter.emit(te.nextEventID()))}clearItems(){for(let e=0;e<this.items.length;e++)this.removeItemByIndex(e,!0);this.items=new Array,this.itemsChangedEmitter.emit(te.nextEventID())}hasItem(e){return this.items.some(t=>!!t&&o.equals(t,e))}getItems(){const e=new Array;return this.items.forEach(t=>{t&&e.push(o.clone(t))}),e}getAllWeaponCombos(){const e=[];let t=[];for(const o of[ut.ItemSlotMainHand,ut.ItemSlotHandWeapon]){if(!this.pickerGroups.has(o))continue;const e=this.pickerGroups.get(o),a=Array.from(e.pickers.values()).map(e=>e.item);t=t.concat(a.filter(e=>![E.RangedWeaponTypeUnknown,E.RangedWeaponTypeWand].includes(e.item.rangedWeaponType)||e.item.handType==h.HandTypeTwoHand))}for(const o of t)e.push([o,null]);const a=this.pickerGroups.get(ut.ItemSlotMainHand),i=this.pickerGroups.get(ut.ItemSlotOffHand);if(a?.pickers.size){for(const o of Array.from(a.pickers.values()).map(e=>e.item))if(!t.includes(o))if(i?.pickers.size)for(const t of Array.from(i.pickers.values()).map(e=>e.item))e.push([o,t]);else e.push([o,null])}else if(i?.pickers.size)for(const o of Array.from(i.pickers.values()).map(e=>e.item))e.push([null,o]);const s=this.pickerGroups.get(ut.ItemSlotHandWeapon);if(s?.pickers.size){const a=Array.from(s.pickers.values()).map(e=>e.item).filter(e=>!t.includes(e));for(let t=0;t<a.length;t++)if(!a.slice(0,t).some(e=>e.equals(a[t],!0,!0,!0,this.inheritUpgrades)))for(let i=t+1;i<a.length;i++)a.slice(t+1,i).some(e=>e.equals(a[i],!0,!0,!0,this.inheritUpgrades))||(e.push([a[t],a[i]]),a[t].equals(a[i],!0,!0,!0,this.inheritUpgrades)||e.push([a[i],a[t]]))}return e}getItemsForCombo(e){const t=new Map,a=this.getAllWeaponCombos(),s=a.length;if(s>0){const o=e%s;e=Math.floor(e/s);const n=a[o];n[0]&&t.set(i.ItemSlotMainHand,n[0]),n[1]&&t.set(i.ItemSlotOffHand,n[1])}for(const[i,o]of this.pickerGroups.entries()){if(0==o.pickers.size||[ut.ItemSlotMainHand,ut.ItemSlotOffHand,ut.ItemSlotHandWeapon].includes(i))continue;const a=Array.from(o.pickers.values()).map(e=>e.item),s=a.length;if([ut.ItemSlotFinger,ut.ItemSlotTrinket].includes(i)){if(s<2)throw"At least 2 items must be selected for "+ut[i];let o=Zt(a);const n=this.frozenItems.get(i);n&&(o=a.filter(e=>!n.equals(e)).map(e=>[n,e]));const r=o.length,l=e%r;e=Math.floor(e/r);const c=o[l],h=Kt.get(i);t.set(h[0],c[0]),t.set(h[1],c[1])}else{const o=e%s;e=Math.floor(e/s),t.set(Jt.get(i),a[o])}}return t}async calculateBulkCombinations(){try{let e=this.getAllWeaponCombos().length;for(const[t,a]of this.pickerGroups.entries()){if([ut.ItemSlotMainHand,ut.ItemSlotOffHand,ut.ItemSlotHandWeapon].includes(t))continue;const i=a.pickers.size;i>1&&[ut.ItemSlotFinger,ut.ItemSlotTrinket].includes(t)?this.frozenItems.get(t)?e*=i-1:e*=Qt(i,2):e*=Math.max(i,1)}this.combinations=e,this.iterations=this.simUI.sim.getIterations()*e}catch(e){this.simUI.handleCrash(e)}}buildTabContent(){this.buildSetupTabContent(),this.buildResultsTabContent(),this.buildBatchSettings()}buildSetupTabContent(){const t=U(),a=U(),i=U();this.setupTabElem.appendChild(H(de,null,H("p",{className:"mb-0",innerHTML:oe.t("bulk_tab.description")}),qt()&&H("p",{className:"mb-0"},H("a",{href:ea,target:"_blank"},H("i",{className:"fas fa-gauge-high me-1"}),oe.t("bulk_tab.download_local"))),H("div",{className:"bulk-gear-actions"},H("button",{className:"btn btn-secondary",ref:t},H("i",{className:"fa fa-download me-1"})," ",oe.t("bulk_tab.actions.import_bags")),H("button",{className:"btn btn-secondary",ref:a},H("i",{className:"fa fa-download me-1"})," ",oe.t("bulk_tab.actions.import_favorites")),H("button",{className:"btn btn-danger ms-auto",ref:i},H("i",{className:"fas fa-times me-1"}),oe.t("bulk_tab.actions.clear_items")))));const s=t.value,n=a.value,r=i.value;s.addEventListener("click",()=>new xf(this.simUI.rootElem,this.simUI,this).open()),n.addEventListener("click",()=>{const e=this.simUI.player.sim.getFilters().favoriteItems.map(e=>o.create({id:e}));this.addItems(e)}),r.addEventListener("click",()=>this.clearItems()),new pf(this.setupTabElem,this.simUI,this);const l=H("div",{className:"bulk-gear-combo"});this.setupTabElem.appendChild(l),e(ut).forEach(e=>{this.playerCanDualWield&&[ut.ItemSlotMainHand,ut.ItemSlotOffHand].includes(e)||(this.playerCanDualWield||e!==ut.ItemSlotHandWeapon)&&this.pickerGroups.set(e,new uf(l,this.simUI,this,e))})}resetResultsTabContent(){this.resultsTabElem.replaceChildren()}buildResultsTabContent(){if(this.topGearResults&&this.originalGearResults){for(const e of this.topGearResults)new mf(this.resultsTabElem,this.simUI,e,this.originalGearResults);this.isPending=!1,this.resultsTab.show()}}isSecondaryItemSlot(e){return ta(e)||this.playerCanDualWield&&e===i.ItemSlotOffHand}set isPending(e){e?(this.simUI.rootElem.classList.add("blurred"),this.simUI.rootElem.insertAdjacentElement("afterend",this.pendingDiv)):(this.simUI.rootElem.classList.remove("blurred"),this.pendingDiv.remove(),this.pendingResults.hideAll())}buildBatchSettings(){this.isRunning=!1,this.bulkSimButton.addEventListener("click",async()=>{if(this.isRunning)return;Km({action:"sim",category:"simulate",label:"batch",value:this.combinations}),this.isRunning=!0,this.bulkSimButton.disabled=!0,this.isPending=!0;let e=!1,a=!1;this.topGearResults=null,this.originalGearResults=null;const i=this.simUI.sim.getPhase()>=2,s=this.simUI.player.getChallengeModeEnabled(),o=this.simUI.player.isBlacksmithing();try{await this.simUI.sim.signalManager.abortType(qm.All),this.originalGear=this.simUI.player.getGear();let l=this.originalGear,c=[];this.pendingResults.addAbortButton(async()=>{if(!e)try{e=!0,await this.simUI.sim.signalManager.abortType(qm.All)}catch(t){console.error("Error on bulk sim abort!"),console.error(t)}finally{e=!1,a=!0,this.isRunning||(this.bulkSimButton.disabled=!1)}});let h=(new Date).getTime();this.resetResultsTabContent(),await this.calculateBulkCombinations(),await this.simUI.runSim(e=>{const t=(new Date).getTime()-h;this.setSimProgress(e,t/1e3,0,this.combinations)});const d=this.simUI.raidSimResultsManager.currentData.simResult.getFirstPlayer().dps,u=[];for(let e=0;e<this.combinations;e++)u.push(this.getItemsForCombo(e));const p=new Map;for(const[e,a]of[t.GemColorRed,t.GemColorYellow,t.GemColorBlue,t.GemColorMeta,t.GemColorPrismatic].entries())p.set(a,this.simUI.sim.db.lookupGem(this.defaultGems[e].id));for(let e=0;e<this.combinations;e++){if(a)throw new Error("Bulk Sim Aborted");l=this.originalGear;for(const[a,i]of u[e].entries()){const e=this.originalGear.getEquippedItem(a);let t=e?e.withItem(i.item):i.withChallengeMode(s);i._randomSuffix&&(t=t.withRandomSuffix(i._randomSuffix)),this.inheritUpgrades||(t=t.withUpgrade(i._upgrade)),l=l.withEquippedItem(a,t,this.playerIsFuryWarrior);for(const[s,n]of i.curSocketColors(o).entries())p.get(n)&&(l=l.withGem(a,s,p.get(n)))}if(await this.simUI.player.setGearAsync(te.nextEventID(),l),this.simUI.reforger){this.simUI.reforger.setIncludeGems(te.nextEventID(),!0),this.simUI.reforger.setIncludeEOTBPGemSocket(te.nextEventID(),i),Og.hasRoRo(this.simUI.player)&&-1!==this.simUI.reforger.relativeStatCapStat&&(this.simUI.reforger.relativeStatCap=new Og(this.simUI.reforger.relativeStatCapStat,this.simUI.player,this.simUI.player.getClass()));try{await this.simUI.reforger.optimizeReforges(!0)}catch(n){await this.simUI.player.setGearAsync(te.nextEventID(),l),this.simUI.reforger.setIncludeGems(te.nextEventID(),!1),Og.hasRoRo(this.simUI.player)&&-1!==this.simUI.reforger.relativeStatCapStat&&(this.simUI.reforger.relativeStatCap=new Og(this.simUI.reforger.relativeStatCapStat,this.simUI.player,this.simUI.player.getClass()));try{await this.simUI.reforger.optimizeReforges(!0)}catch(r){continue}}}const t=await this.simUI.runSim(t=>{const a=(new Date).getTime()-h;this.setSimProgress(t,a/1e3,e+1,this.combinations)},{silent:!0});if(t&&"type"in t)throw new Error(t.message);l=this.simUI.player.getGear();this.originalGear.equals(l)||c.push({gear:l,dpsMetrics:t.getFirstPlayer().dps}),c.sort((e,t)=>t.dpsMetrics.avg-e.dpsMetrics.avg),c.length>5&&c.pop()}await this.simUI.player.setGearAsync(te.nextEventID(),this.originalGear),this.topGearResults=c,this.originalGearResults={gear:this.originalGear,dpsMetrics:d},this.topGearResults.push(this.originalGearResults),this.topGearResults.sort((e,t)=>t.dpsMetrics.avg-e.dpsMetrics.avg),this.simUI.resultsViewer.hideAll(),this.buildResultsTabContent()}catch(n){console.error(n),await this.simUI.player.setGearAsync(te.nextEventID(),this.originalGear)}finally{this.isRunning=!1,e||(this.bulkSimButton.disabled=!1),a&&new Dg({variant:"error",body:oe.t("bulk_tab.notifications.bulk_sim_cancelled")}),this.simUI.resultsViewer.hideAll(),this.isPending=!1}});const e=U(),a=U(),s=U(),o=U();this.settingsContainer.appendChild(H(de,null,H("div",{className:"default-gem-container"},H("h6",null,oe.t("bulk_tab.settings.default_gems")),H("div",{ref:e,className:"sockets-container"})),H("div",{ref:a,className:"inherit-upgrades-container"}),H("div",{ref:s}),H("div",{ref:o}))),a.value&&new gc(a.value,this,{id:"inherit-upgrades",label:oe.t("bulk_tab.settings.inherit_upgrades.label"),labelTooltip:oe.t("bulk_tab.settings.inherit_upgrades.tooltip"),inline:!0,changedEvent:e=>this.settingsChangedEmitter,getValue:e=>this.inheritUpgrades,setValue:(e,t,a)=>{this.setInheritUpgrades(a)}}),s.value&&new Ag(s.value,this,{id:"freeze-ring",label:oe.t("bulk_tab.settings.freeze_ring.label"),labelTooltip:oe.t("bulk_tab.settings.freeze_ring.tooltip"),values:[{name:oe.t("common.none"),value:-1},{name:oe.t("gear_tab.slots.finger_1"),value:i.ItemSlotFinger1},{name:oe.t("gear_tab.slots.finger_2"),value:i.ItemSlotFinger2}],changedEvent:e=>te.onAny([this.settingsChangedEmitter,this.itemsChangedEmitter]),getValue:e=>{const t=this.frozenItems.get(ut.ItemSlotFinger);if(!t)return-1;const a=this.simUI.player.getGear();return a.getEquippedItem(i.ItemSlotFinger1)?.equals(t)?i.ItemSlotFinger1:a.getEquippedItem(i.ItemSlotFinger2)?.equals(t)?i.ItemSlotFinger2:(this.frozenItems.set(ut.ItemSlotFinger,null),this.settingsChangedEmitter.emit(te.nextEventID()),-1)},setValue:(e,t,a)=>{let i=null;-1!=a&&(i=this.simUI.player.getGear().getEquippedItem(a)),i!==this.frozenItems.get(ut.ItemSlotFinger)&&(this.frozenItems.set(ut.ItemSlotFinger,i),this.settingsChangedEmitter.emit(e))}}),o.value&&new Ag(o.value,this,{id:"freeze-trinket",label:oe.t("bulk_tab.settings.freeze_trinket.label"),labelTooltip:oe.t("bulk_tab.settings.freeze_trinket.tooltip"),values:[{name:oe.t("common.none"),value:-1},{name:oe.t("gear_tab.slots.trinket_1"),value:i.ItemSlotTrinket1},{name:oe.t("gear_tab.slots.trinket_2"),value:i.ItemSlotTrinket2}],changedEvent:e=>te.onAny([this.settingsChangedEmitter,this.itemsChangedEmitter]),getValue:e=>{const t=this.frozenItems.get(ut.ItemSlotTrinket);if(!t)return-1;const a=this.simUI.player.getGear();return a.getEquippedItem(i.ItemSlotTrinket1)?.equals(t)?i.ItemSlotTrinket1:a.getEquippedItem(i.ItemSlotTrinket2)?.equals(t)?i.ItemSlotTrinket2:(this.frozenItems.set(ut.ItemSlotTrinket,null),this.settingsChangedEmitter.emit(te.nextEventID()),-1)},setValue:(e,t,a)=>{let i=null;-1!=a&&(i=this.simUI.player.getGear().getEquippedItem(a)),i!==this.frozenItems.get(ut.ItemSlotTrinket)&&(this.frozenItems.set(ut.ItemSlotTrinket,i),this.settingsChangedEmitter.emit(e))}}),Array(t.GemColorRed,t.GemColorYellow,t.GemColorBlue,t.GemColorMeta,t.GemColorPrismatic).forEach((t,a)=>{const i=U(),s=U(),o=U();let n;e.value.appendChild(H("div",{ref:i,className:"gem-socket-container"},H("img",{ref:s,className:"gem-icon hide"}),H("img",{ref:o,className:"socket-icon"}))),this.gemIconElements.push(s.value),o.value.src=fr(t);const r=e=>{this.defaultGems[a]=e.item,this.storeSettings(),Lr.fromItemId(e.id).fill().then(t=>{e.id&&(this.gemIconElements[a].src=t.iconUrl,this.gemIconElements[a].classList.remove("hide"))}),n.close()},l=()=>{this.defaultGems[a]=v.create(),this.storeSettings(),this.gemIconElements[a].classList.add("hide"),this.gemIconElements[a].src="",n.close()},c=()=>{n||(n=new gf(this.simUI.rootElem,this.simUI,t,r,l)),n.show()};this.gemIconElements[a].addEventListener("click",c),i.value?.addEventListener("click",c)})}async getCombinationsCount(){await this.calculateBulkCombinations(),this.bulkSimButton.disabled=this.combinations>5e4;const e=U(),t=H(de,null,H("span",{className:xr(this.showIterationsWarning()&&"text-danger")},1===this.combinations?oe.t("bulk_tab.settings.combination_singular"):oe.t("bulk_tab.settings.combinations_count",{count:this.combinations}),H("br",null),H("small",null,this.iterations," ",oe.t("bulk_tab.settings.iterations"))),this.showIterationsWarning()&&H("button",{className:"warning link-warning",ref:e},H("i",{className:"fas fa-exclamation-triangle fa-2x"})));return e.value&&ie(e.value,{content:oe.t("bulk_tab.warning.iterations_limit",{limit:5e4}),placement:"left",popperOptions:{modifiers:[{name:"flip",options:{fallbackPlacements:["auto"]}}]}}),t}showIterationsWarning(){return this.iterations>this.getIterationsLimit()}getIterationsLimit(){return qt()?5e4:1e6}setSimProgress(e,t,a,i){const s=t*(i-a+1)/a;isNaN(Number(s))||this.pendingResults.setContent(H("div",{className:"results-sim"},H("div",null,i>0&&H(de,null,oe.t("bulk_tab.progress.refining_rounds",{current:a,total:i}))),H("div",{innerHTML:oe.t("bulk_tab.progress.iterations_complete",{completed:e.completedIterations,total:e.totalIterations})}),H("div",null,oe.t("bulk_tab.progress.seconds_remaining",{seconds:Math.round(s)}))))}setInheritUpgrades(e){this.inheritUpgrades=e,this.settingsChangedEmitter.emit(te.nextEventID())}}class Av extends Wr{constructor(e,t){if(super(e,"exporter",{title:t.title,header:!0,footer:!0}),this.changedEvent=new te,this.textElem=H("textarea",{spellcheck:!1,className:"exporter-textarea form-control"}),this.body.append(this.textElem),new Tg(this.footer,{extraCssClasses:["btn-primary"],getContent:()=>this.textElem.innerHTML,text:oe.t("export.json.copy_button"),tooltip:oe.t("export.json.copy_tooltip")}),t.allowDownload){const e=U();this.footer.appendChild(H("button",{className:"exporter-button btn btn-primary download-button ms-2",ref:e},H("i",{className:"fa fa-download me-1"}),oe.t("export.json.download_button")));e.value.addEventListener("click",e=>{const t=this.textElem.textContent;aa(t,"wowsims.json")})}}open(){const e=this.header?.title.toLowerCase().replaceAll(" ","-");Zm(this.header.title,`/export/${e}`),super.open(),this.init()}init(){this.changedEvent.on(()=>this.updateContent()),this.updateContent()}updateContent(){this.textElem.textContent=this.getData()}}const Pv=class t extends Av{constructor(a,i,s){super(a,s),this.simUI=i;const o={};if(e(ff).forEach(e=>o[e]=vf.DEFAULT_CATEGORIES.includes(e)),this.exportCategories=o,s.selectCategories){const e=H("div",{className:"exporter-category-pickers"});this.body.prepend(e),t.exportPickerConfigs.forEach(t=>{const a=t.category;new gc(e,this,{id:`link-exporter-${a}`,label:t.label,labelTooltip:t.labelTooltip,inline:!0,getValue:()=>this.exportCategories[a],setValue:(e,t,i)=>{this.exportCategories[a]=i,this.changedEvent.emit(e)},changedEvent:()=>this.changedEvent})})}}};Pv.exportPickerConfigs=[{category:ff.Gear,label:oe.t("export.categories.gear.label"),labelTooltip:oe.t("export.categories.gear.tooltip")},{category:ff.Talents,label:oe.t("export.categories.talents.label"),labelTooltip:oe.t("export.categories.talents.tooltip")},{category:ff.Rotation,label:oe.t("export.categories.rotation.label"),labelTooltip:oe.t("export.categories.rotation.tooltip")},{category:ff.Consumes,label:oe.t("export.categories.consumes.label"),labelTooltip:oe.t("export.categories.consumes.tooltip")},{category:ff.External,label:oe.t("export.categories.external.label"),labelTooltip:oe.t("export.categories.external.tooltip")},{category:ff.Miscellaneous,label:oe.t("export.categories.miscellaneous.label"),labelTooltip:oe.t("export.categories.miscellaneous.tooltip")},{category:ff.Encounter,label:oe.t("export.categories.encounter.label"),labelTooltip:oe.t("export.categories.encounter.tooltip")}];let Rv=Pv;const Dv=class e extends Rv{constructor(e,t){super(e,t,{title:"Sixty Upgrades Cataclysm EP Export",allowDownload:!0})}getData(){const t=this.simUI.player,a=t.getEpWeights(),i=ne.getAll(),s={};return i.forEach(t=>{const i=e.getName(t),o=a.getUnitStat(t);0!=o&&""!=i&&(s[i]?s[i]+=o:s[i]=o)}),`https://sixtyupgrades.com/mop/ep/import?name=${encodeURIComponent(`${t.getPlayerSpec().friendlyName} WoWSims Weights`)}`+Object.keys(s).map(e=>`&${e}=${s[e].toFixed(3)}`).join("")}static getName(t){return t.isStat()?e.statNames[t.getStat()]:e.pseudoStatNames[t.getPseudoStat()]||""}};Dv.statNames={[ee.StatStrength]:"strength",[ee.StatAgility]:"agility",[ee.StatStamina]:"stamina",[ee.StatIntellect]:"intellect",[ee.StatSpirit]:"spirit",[ee.StatSpellPower]:"spellDamage",[ee.StatMP5]:"mp5",[ee.StatHitRating]:"hitRating",[ee.StatCritRating]:"critRating",[ee.StatHasteRating]:"hasteRating",[ee.StatAttackPower]:"attackPower",[ee.StatMasteryRating]:"masteryRating",[ee.StatExpertiseRating]:"expertiseRating",[ee.StatPvpResilienceRating]:"pvpResilienceRating",[ee.StatPvpPowerRating]:"pvpPowerRating",[ee.StatMana]:"mana",[ee.StatArmor]:"armor",[ee.StatRangedAttackPower]:"attackPower",[ee.StatDodgeRating]:"dodgeRating",[ee.StatParryRating]:"parryRating",[ee.StatHealth]:"health",[ee.StatBonusArmor]:"armorBonus"},Dv.pseudoStatNames={[T.PseudoStatMainHandDps]:"dps",[T.PseudoStatRangedDps]:"rangedDps"};class Mv extends Rv{constructor(e,t){super(e,t,{title:oe.t("export.cli.title"),allowDownload:!0})}getData(){const e=fe.toJson(this.simUI.sim.makeRaidSimRequest(!1));return delete e.raid?.parties[0]?.players[0]?.database,JSON.stringify(e,null,2)}}class Lv extends Rv{constructor(e,t){super(e,t,{title:oe.t("export.json.title"),allowDownload:!0,selectCategories:!0})}getData(){return Lv.getData(this.simUI,e(ff).filter(e=>this.exportCategories[e]))}static getData(e,t){return t||(t=vf.DEFAULT_CATEGORIES),ia(nt.toJson(e.toProto(t)),2,(e,t)=>!!["stats","pseudoStats","itemSwap"].includes(t[t.length-1])||(["player","equipment","items"].every((e,a)=>t[a]==e)||!("player"!=t[0]||"rotation"!=t[1]||!["prepullActions","priorityList","groups","valueVariables"].includes(t[2])))&&t.length>3)}}class Nv extends Rv{constructor(e,t){super(e,t,{title:oe.t("export.link.title"),selectCategories:!0})}getData(){return Nv.createLink(this.simUI,e(ff).filter(e=>this.exportCategories[e]))}static createLink(e,t){t||(t=vf.DEFAULT_CATEGORIES);const a=e.toProto(t),i=nt.toBinary(a),s=vv.deflate(i,{to:"string"}),o=btoa(String.fromCharCode(...s)),n=new URL(window.location.href);if(n.hash=o,sa(t,vf.DEFAULT_CATEGORIES))n.searchParams.delete(vf.CATEGORY_PARAM);else{const e=t.map(e=>bf.get(e)).join("");n.searchParams.set(vf.CATEGORY_PARAM,e)}return n.toString()}}const Ov=class e extends Rv{constructor(e,t){super(e,t,{title:oe.t("export.pawn_ep.title"),allowDownload:!0})}getData(){const t=this.simUI.player,a=t.getEpWeights(),i=ne.getAll(),s={};return i.forEach(t=>{const i=e.getName(t),o=a.getUnitStat(t);0!=o&&""!=i&&(s[i]?s[i]+=o:s[i]=o)}),`( Pawn: v1: "${t.getPlayerSpec().friendlyName} WoWSims Weights": Class=${t.getPlayerClass().friendlyName},`+Object.keys(s).map(e=>`${e}=${s[e].toFixed(3)}`).join(",")+" )"}static getName(t){return t.isStat()?e.statNames[t.getStat()]:e.pseudoStatNames[t.getPseudoStat()]||""}};Ov.statNames={[ee.StatStrength]:"Strength",[ee.StatAgility]:"Agility",[ee.StatStamina]:"Stamina",[ee.StatIntellect]:"Intellect",[ee.StatSpirit]:"Spirit",[ee.StatSpellPower]:"SpellDamage",[ee.StatMP5]:"Mp5",[ee.StatHitRating]:"HitRating",[ee.StatCritRating]:"CritRating",[ee.StatHasteRating]:"HasteRating",[ee.StatAttackPower]:"Ap",[ee.StatMasteryRating]:"MasteryRating",[ee.StatExpertiseRating]:"ExpertiseRating",[ee.StatMana]:"Mana",[ee.StatArmor]:"Armor",[ee.StatRangedAttackPower]:"Ap",[ee.StatDodgeRating]:"DodgeRating",[ee.StatParryRating]:"ParryRating",[ee.StatPvpResilienceRating]:"ResilienceRating",[ee.StatPvpPowerRating]:"PVPPowerRating",[ee.StatHealth]:"Health",[ee.StatBonusArmor]:"Armor2"},Ov.pseudoStatNames={[T.PseudoStatMainHandDps]:"MeleeDps",[T.PseudoStatRangedDps]:"RangedDps"};let Gv=Ov;const zv="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";function Fv(e){let t=e,a=0;const i=[];for(let s=1;s<=5;s++){const e=5*s;if(t<1<<e){const e=[];for(;e.length<s;){const a=63&t;t>>=6,e.unshift(a)}return e[0]=e[0]|a,i.push(...e),i}t-=1<<e,a=(64|a)>>1}throw new Error("Value too large to encode.")}function Hv(e){const t=[0];Object.keys(e).sort((e,t)=>Number(e)-Number(t)).forEach(a=>{const i=e[Number(a)];i&&(t.push(...Fv(parseInt(a))),t.push(...Fv(i)))});let a="";for(let i=0;i<t.length;i++)a+=zv.charAt(t[i]);return a}function Uv(e){let t="";const a=[4];a.push(...Fv(Pr)),a.push(1),a.push(...Fv(e.level??0)),a.push(e.specIndex??0);const i=function(e){let t=0;for(let a=e.length-1;a>=0;a--)t<<=2,t|=3&Math.min(4,parseInt(e.substring(a,a+1)));return Fv(t)}(e.talents);a.push(...i);const s=[Hv(e.glyphs??[])];a.push(...Fv(s.length)),s.forEach(e=>{a.push(...Fv(e.length)),a.push(...e.split("").map(e=>zv.indexOf(e)))});const o=e.items??[];a.push(...Fv(o.length)),o.forEach(e=>{let t=0;const i=[];if(i.push(...Fv(e.slotId??0)),i.push(...Fv(e.itemId??0)),t<<=1,e.randomEnchantId){t|=1;let a=e.randomEnchantId;const s=a<0?1:0;s&&(a*=-1),a<<=1,a|=s,i.push(...Fv(a))}t<<=1,e.upgradeRank&&(t|=1,i.push(...Fv(e.upgradeRank))),t<<=1,e.reforge&&(t|=1,i.push(...Fv(e.reforge)));const s=Bv((e.gemItemIds??[]).slice(0,8));t<<=3,t|=s.length,s.forEach(e=>i.push(...Fv(e)));const o=Bv((e.enchantIds??[]).slice(0,4));t<<=2,t|=o.length,o.forEach(e=>i.push(...Fv(e))),a.push(...Fv(t)),a.push(...i)});let n="";for(let r=0;r<a.length;r++)n+=zv.charAt(a[r]);return n&&(t+=n),t}function Bv(e){for(;e.length>0&&0===e[e.length-1];)e.pop();return e}class Wv extends Rv{constructor(e,t){super(e,t,{title:oe.t("export.wowhead.title"),allowDownload:!0}),this.getData()}getData(){const e=this.simUI.player,t=`https://www.wowhead.com/mop-classic/gear-planner/${e.getPlayerClass().friendlyName.replaceAll(/\s/g,"-").toLowerCase()}/${(e=>{const t=e.endsWith("(A)")?"alliance-":void 0,a=e.endsWith("(H)")?"horde-":void 0;return(t??a??"")+e.replaceAll(" (A)","").replaceAll(" (H)","").replaceAll(/\s/g,"-").toLowerCase()})(qr.get(e.getRace()))}/`,a=e=>{const t=this.simUI.sim.db.glyphItemToSpellId(e);return t||0},s=e.getGlyphs(),o={level:L,specIndex:e.getPlayerSpec().specIndex,talents:e.getTalentsString(),glyphs:[a(s.major1),a(s.major2),a(s.major3),a(s.minor1),a(s.minor2),a(s.minor3)],items:[]},n=e.getGear();n.getItemSlots().sort((e,t)=>Ev.slotIDs[e]-Ev.slotIDs[t]).forEach(e=>{const t=n.getEquippedItem(e);if(!t)return;const a={slotId:Ev.slotIDs[e],itemId:t.id};t._randomSuffix?.id&&(a.randomEnchantId=t._randomSuffix.id),a.enchantIds=[],t._enchant?.spellId&&a.enchantIds.push(t._enchant.spellId),t._tinker?.spellId&&a.enchantIds.push(t._tinker.spellId),i.ItemSlotHands,t._gems&&(a.gemItemIds=t._gems.map(e=>e?.id??0)),t._reforge&&(a.reforge=t._reforge.id),t._upgrade>0&&(a.upgradeRank=t._upgrade),o.items.push(a)});const r=function(e){return""+Uv(e)}(o);return t+r}}class Vv extends F{constructor(e,t,a){super(e,"summary-table-root"),this.rootElem.classList.add("hide"),this.simUI=t,this.player=a,this.container=new $e(this.rootElem,"summary-table-container",{header:{title:oe.t("gear_tab.gem_summary.title"),extraCssClasses:["summary-table--gems"]},extraCssClasses:["summary-table--gems"]}),a.gearChangeEmitter.on(()=>this.updateTable())}updateTable(){const e=H(de,null),t=this.player.getGear().getAllGems(this.player.isBlacksmithing()),a=!!t.length;if(this.rootElem.classList[a?"remove":"add"]("hide"),a){const a={};for(const e of t)a[e.name]?a[e.name].count+=1:a[e.name]={gem:e,count:1};for(const t of Object.keys(a)){const i=a[t],s=U(),o=U(),n=H("div",{className:"summary-table-row d-flex align-items-center"},H("a",{ref:s,className:"summary-table-link","data-whtticon":"false",target:"_blank"},H("img",{ref:o,className:"gem-icon"}),H("div",null,t)),H("div",null,i.count.toFixed(0)));e.appendChild(n);const r=s.value,l=o.value;jr(r,i.gem.quality),Lr.fromItemId(i.gem.id).fill().then(e=>{l.src=e.iconUrl,e.setWowheadHref(r)})}if(this.container.bodyElement.replaceChildren(e),!this.container.headerElement)return;const i=this.container.headerElement.querySelector(".summary-table-reset-button"),s=H("button",{className:"btn btn-sm btn-link btn-reset summary-table-reset-button",onclick:()=>{Km({action:"click",category:"gems",label:"reset"}),this.player.setGear(te.nextEventID(),this.player.getGear().withoutGems(this.player.canDualWield2H()))}},H("i",{className:"fas fa-times me-1"}),oe.t("gear_tab.gem_summary.reset_gems"));i?this.container.headerElement.replaceChild(s,i):this.container.headerElement.appendChild(s)}}}class jv extends F{constructor(e,t,a){super(e,"summary-table-root"),this.rootElem.classList.add("hide"),this.simUI=t,this.player=a,this.container=new $e(this.rootElem,"summary-table-container",{header:{title:oe.t("gear_tab.reforge_summary.title")},extraCssClasses:["summary-table--reforge"]}),a.gearChangeEmitter.on(()=>this.updateTable())}updateTable(){const e=H(de,null),t=this.player.getGear().getAllReforges(),a={};for(const[s,o]of t){const{fromStat:e,toStat:t,fromAmount:i,toAmount:s}=o;"number"!=typeof a[e]&&(a[e]=0),"number"!=typeof a[t]&&(a[t]=0),i&&(a[e]+=i),s&&(a[t]+=s)}const i=!!Object.keys(a).length;if(this.rootElem.classList[i?"remove":"add"]("hide"),i){Object.keys(a).forEach(t=>{const i=Number(t),s=a[i];s&&e.appendChild(H("div",{className:"summary-table-row d-flex align-items-center"},H("div",null,ot(i)),H("div",{className:""+(0===s?"":s>0?"positive":"negative")},s)))}),this.container.bodyElement.replaceChildren(e);const t=this.container.bodyElement.querySelector(".reforge-summary-footer");t&&t.remove();const i=H("div",{className:"reforge-summary-footer mt-2"}),s=H("div",{className:"d-flex w-100 justify-content-end"});if(i.appendChild(s),new Tg(s,{extraCssClasses:["btn-outline-primary"],getContent:()=>{Km({action:"click",category:"reforging",label:"copy"});try{const e=this.simUI.toProto(),t=e?nt.toJson(e):{};return JSON.stringify(t)}catch(e){return""}},text:oe.t("gear_tab.reforge_summary.copy_to_reforge_lite")}),this.container.bodyElement.appendChild(i),!this.container.headerElement)return;const o=this.container.headerElement.querySelector(".summary-table-reset-button"),n=H("button",{className:"btn btn-sm btn-link btn-reset summary-table-reset-button",onclick:()=>{Km({action:"click",category:"reforging",label:"reset"});const e=this.player.getGear().withoutReforges(this.player.canDualWield2H());this.player.setGear(te.nextEventID(),e)}},H("i",{className:"fas fa-times me-1"}),oe.t("gear_tab.reforge_summary.reset_reforges"));o?this.container.headerElement.replaceChild(n,o):this.container.headerElement.appendChild(n)}}}const Yv=new Map([["valorPoints",new Map([[W.ItemQualityRare,250],[W.ItemQualityEpic,250],[W.ItemQualityLegendary,250]])],["justicePoints",new Map([[W.ItemQualityRare,750],[W.ItemQualityEpic,1e3],[W.ItemQualityLegendary,1e3]])],["honorPoints",new Map([[W.ItemQualityRare,750],[W.ItemQualityEpic,1e3],[W.ItemQualityLegendary,1e3]])]]);class qv extends F{constructor(e,t,a){super(e,"summary-table-root"),this.rootElem.classList.add("hide"),this.simUI=t,this.player=a,this.container=new $e(this.rootElem,"summary-table-container",{header:{title:oe.t("gear_tab.upgrade_summary.title")},extraCssClasses:["summary-table--upgrade-costs"]}),te.onAny([a.gearChangeEmitter,a.raceChangeEmitter]).on(()=>this.updateTable())}updateTable(){const e=H(de,null),t=this.player.getGear().asArray().filter(e=>!!(e?._item.scalingOptions&&e.getMaxUpgradeCount()>0)),a=!!Object.keys(t).length;if(this.rootElem.classList[a?"remove":"add"]("hide"),a){const a=Tk.RAID_IDS[oa.RaidThroneOfThunder],i=e=>"drop"===e.source.oneofKind&&e.source.drop.zoneId===a,s=t.reduce((e,t)=>{let a="justicePoints";return t._item.sources.some(i)&&(a="valorPoints"),t._item.name.includes("Gladiator's")&&(a="honorPoints"),e[a]+=(Yv.get(a)?.get(t._item.quality)||0)*(t.getMaxUpgradeCount()-t.upgrade),e},{valorPoints:0,justicePoints:0,honorPoints:0});Object.entries(s).forEach(([t,a])=>{a>0&&e.appendChild(H("div",null,H("div",{className:"summary-table-row d-flex align-items-center"},H("div",{className:"d-flex align-items-center"},H("img",{className:"gem-icon",src:"justicePoints"===t?"https://wow.zamimg.com/images/wow/icons/small/pvecurrency-justice.jpg":"valorPoints"===t?"https://wow.zamimg.com/images/wow/icons/small/pvecurrency-valor.jpg":`https://wow.zamimg.com/images/wow/icons/small/pvpcurrency-honor-${this.player.getFaction()===na.Horde?"horde":"alliance"}.jpg`}),H("div",null,oe.t(`common.currency.${t}`))),H("div",null,a))))}),this.container.bodyElement.replaceChildren(e);const o=this.container.bodyElement.querySelector(".upgrade-costs-summary-footer");if(o&&o.remove(),this.container.bodyElement.appendChild(H("div",{className:"upgrade-costs-summary-footer mt-2"},H("div",{className:"d-flex w-100 justify-content-end"},H("button",{className:"btn btn-outline-primary",onclick:()=>{Km({action:"click",category:"upgrades",label:"upgrade_all"});let e=this.player.getGear();for(const t of e.getItemSlots()){const a=e.getEquippedItem(t);a&&(e=e.withEquippedItem(t,a.withUpgrade(a.getMaxUpgradeCount()),this.player.canDualWield2H()))}this.player.setGear(te.nextEventID(),e)}},H("i",{className:"fas fa-arrow-up me-1"}),oe.t("gear_tab.upgrade_summary.upgrade_all_items"))))),!this.container.headerElement)return;const n=this.container.headerElement.querySelector(".summary-table-reset-button"),r=H("button",{className:"btn btn-sm btn-link btn-reset summary-table-reset-button",onclick:()=>{Km({action:"click",category:"upgrades",label:"reset"});const e=this.player.getGear().withoutUpgrades(this.player.canDualWield2H());this.player.setGear(te.nextEventID(),e)}},H("i",{className:"fas fa-times me-1"}),oe.t("gear_tab.upgrade_summary.reset_upgrades"));n?this.container.headerElement.replaceChild(r,n):this.container.headerElement.appendChild(r)}}}class Xv extends Bg{constructor(e,t){super(e,t,{identifier:"gear-tab",title:oe.t("gear_tab.title")}),this.simUI=t,this.leftPanel=document.createElement("div"),this.leftPanel.classList.add("gear-tab-left","tab-panel-left"),this.rightPanel=document.createElement("div"),this.rightPanel.classList.add("gear-tab-right","tab-panel-right"),this.contentContainer.appendChild(this.leftPanel),this.contentContainer.appendChild(this.rightPanel),this.buildTabContent()}buildTabContent(){this.buildGearPickers(),this.buildSummaryTablesContainer(),this.buildPresetConfigurationPicker(),this.buildSavedGearsetPicker()}buildSummaryTablesContainer(){const e=document.createElement("div");e.classList.add("summary-tables-container"),this.leftPanel.appendChild(e),new Vv(e,this.simUI,this.simUI.player),new jv(e,this.simUI,this.simUI.player),new qv(e,this.simUI,this.simUI.player)}buildGearPickers(){new lf(this.leftPanel,this.simUI,this.simUI.player)}buildPresetConfigurationPicker(){new ra(this.rightPanel,this.simUI,[la.Gear])}buildSavedGearsetPicker(){const e=new Pg(this.rightPanel,this.simUI.player,{header:{title:oe.t("gear_tab.gear_sets.title")},label:oe.t("gear_tab.gear_sets.gear_set"),nameLabel:oe.t("gear_tab.gear_sets.gear_set_name"),saveButtonText:oe.t("gear_tab.gear_sets.save_gear_set"),storageKey:this.simUI.getSavedGearStorageKey(),getData:e=>ca.create({gear:e.getGear().asSpec(),bonusStatsStats:e.getBonusStats().toProto()}),setData:(e,t,a)=>{te.freezeAllAndDo(()=>{t.setGear(e,this.simUI.sim.db.lookupEquipmentSpec(a.gear||s.create())),t.setBonusStats(e,n.fromProto(a.bonusStatsStats||ha.create()))})},changeEmitters:[this.simUI.player.changeEmitter],equals:(e,t)=>ca.equals(e,t),toJson:e=>ca.toJson(e),fromJson:e=>ca.fromJson(e)});this.simUI.sim.waitForInit().then(()=>{e.loadUserData(),this.simUI.individualConfig.presets.gear.forEach(t=>{e.addSavedData({name:t.name,tooltip:t.tooltip,isPreset:!0,data:ca.create({gear:this.simUI.sim.db.lookupEquipmentSpec(t.gear).asSpec(),bonusStatsStats:(new n).toProto()}),enableWhen:t.enableWhen,onLoad:t.onLoad})})})}}function $v(e,t,a){return{inputs:e,label:t,categoryId:a,showWhen:t=>e.filter(e=>!e.showWhen||e.showWhen(t)).length>0}}function Zv(e){const t=e.getModObject;return{id:e.id,type:"boolean",label:e.label,labelTooltip:e.labelTooltip,description:e.description,changedEvent:a=>e.changedEvent(t(a)),getValue:a=>e.getValue(t(a)),setValue:(a,i,s)=>e.setValue(a,t(i),s),enableWhen:e.enableWhen?a=>e.enableWhen(t(a)):void 0,showWhen:e.showWhen?a=>e.showWhen(t(a)):void 0,extraCssClasses:e.extraCssClasses}}function Kv(e){return Zv({id:`${String(e.fieldName)||da()}`,label:e.label,labelTooltip:e.labelTooltip,description:e.description,getModObject:e=>e,getValue:e.getValue||(t=>t.getClassOptions()[e.fieldName]),setValue:e.setValue||((t,a,i)=>{const s=a.getClassOptions();s[e.fieldName]=i,a.setClassOptions(t,s)}),changedEvent:e.changeEmitter||(e=>e.specOptionsChangeEmitter),enableWhen:e.enableWhen,showWhen:e.showWhen,extraCssClasses:e.extraCssClasses})}function Jv(e){return Zv({id:`${String(e.fieldName)||da()}`,label:e.label,labelTooltip:e.labelTooltip,description:e.description,getModObject:e=>e,getValue:e.getValue||(t=>t.getSpecOptions()[e.fieldName]),setValue:e.setValue||((t,a,i)=>{const s=a.getSpecOptions();s[e.fieldName]=i,a.setSpecOptions(t,s)}),changedEvent:e.changeEmitter||(e=>e.specOptionsChangeEmitter),enableWhen:e.enableWhen,showWhen:e.showWhen,extraCssClasses:e.extraCssClasses})}function Qv(e){return Zv({id:`${String(e.fieldName)||da()}`,label:e.label,labelTooltip:e.labelTooltip,description:e.description,getModObject:e=>e,getValue:e.getValue||(t=>t.getSimpleRotation()[e.fieldName]),setValue:e.setValue||((t,a,i)=>{const s=a.getSimpleRotation();s[e.fieldName]=i,a.setSimpleRotation(t,s)}),changedEvent:e.changeEmitter||(e=>e.rotationChangeEmitter),enableWhen:e.enableWhen,showWhen:e.showWhen,extraCssClasses:e.extraCssClasses})}function ex(e){const t=e.getModObject;return{id:e.id,type:"number",label:e.label,labelTooltip:e.labelTooltip,description:e.description,float:e.float,showZeroes:e.showZeroes,maxDecimalDigits:e.maxDecimalDigits,positive:e.positive,changedEvent:a=>e.changedEvent(t(a)),getValue:a=>e.getValue(t(a)),setValue:(a,i,s)=>e.setValue(a,t(i),s),enableWhen:e.enableWhen?a=>e.enableWhen(t(a)):void 0,showWhen:e.showWhen?a=>e.showWhen(t(a)):void 0,extraCssClasses:e.extraCssClasses}}const tx=(e,t)=>Number(se(e/100,{maximumFractionDigits:t.maxDecimalDigits,useGrouping:!1})),ax=(e,t)=>Number(se(100*e,{maximumFractionDigits:t.maxDecimalDigits,useGrouping:!1}));function ix(e){const t={id:`${String(e.fieldName)||da()}`,label:e.label,labelTooltip:e.labelTooltip,description:e.description,float:e.float,showZeroes:e.showZeroes,maxDecimalDigits:e.maxDecimalDigits,positive:e.positive,getModObject:e=>e,getValue:e.getValue||(t=>t.getClassOptions()[e.fieldName]),setValue:e.setValue||((t,a,i)=>{const s=a.getClassOptions();e?.max&&i>e.max&&(i=e.max),s[e.fieldName]=i,a.setClassOptions(t,s)}),changedEvent:e.changeEmitter||(e=>e.specOptionsChangeEmitter),enableWhen:e.enableWhen,showWhen:e.showWhen,extraCssClasses:e.extraCssClasses};if(e.percent){const a=t.getValue;t.getValue=t=>ax(a(t),e);const i=t.setValue;t.setValue=(t,a,s)=>i(t,a,tx(s,e))}return ex(t)}function sx(e){const t={id:`${String(e.fieldName)||da()}`,label:e.label,labelTooltip:e.labelTooltip,description:e.description,float:e.float,showZeroes:e.showZeroes,maxDecimalDigits:e.maxDecimalDigits,positive:e.positive,getModObject:e=>e,getValue:e.getValue||(t=>t.getSpecOptions()[e.fieldName]),setValue:e.setValue||((t,a,i)=>{const s=a.getSpecOptions();e?.max&&i>e.max&&(i=e.max),s[e.fieldName]=i,a.setSpecOptions(t,s)}),changedEvent:e.changeEmitter||(e=>e.specOptionsChangeEmitter),enableWhen:e.enableWhen,showWhen:e.showWhen,extraCssClasses:e.extraCssClasses};if(e.percent){const a=t.getValue;t.getValue=t=>ax(a(t),e);const i=t.setValue;t.setValue=(t,a,s)=>i(t,a,tx(s,e))}return ex(t)}function ox(e){const t={id:`${String(e.fieldName)||da()}`,label:e.label,labelTooltip:e.labelTooltip,description:e.description,float:e.float,showZeroes:e.showZeroes,positive:e.positive,getModObject:e=>e,getValue:e.getValue||(t=>t.getSimpleRotation()[e.fieldName]),setValue:e.setValue||((t,a,i)=>{const s=a.getSimpleRotation();e?.max&&i>e.max&&(i=e.max),s[e.fieldName]=i,a.setSimpleRotation(t,s)}),changedEvent:e.changeEmitter||(e=>e.rotationChangeEmitter),enableWhen:e.enableWhen,showWhen:e.showWhen,extraCssClasses:e.extraCssClasses};if(e.percent){const a=t.getValue;t.getValue=t=>ax(a(t),e);const i=t.setValue;t.setValue=(t,a,s)=>i(t,a,tx(s,e))}return ex(t)}function nx(e){const t=e.getModObject;return{id:e.id,type:"enum",label:e.label,labelTooltip:e.labelTooltip,description:e.description,values:e.values,changedEvent:a=>e.changedEvent(t(a)),getValue:a=>e.getValue(t(a)),setValue:(a,i,s)=>e.setValue(a,t(i),s),enableWhen:e.enableWhen?a=>e.enableWhen(t(a)):void 0,showWhen:e.showWhen?a=>e.showWhen(t(a)):void 0}}function rx(e){return nx({id:`${String(e.fieldName)||da()}`,label:e.label,labelTooltip:e.labelTooltip,description:e.description,values:e.values,getModObject:e=>e,getValue:e.getValue||(t=>t.getSpecOptions()[e.fieldName]),setValue:e.setValue||((t,a,i)=>{const s=a.getSpecOptions();s[e.fieldName]=i,a.setSpecOptions(t,s)}),changedEvent:e.changeEmitter||(e=>e.specOptionsChangeEmitter),enableWhen:e.enableWhen,showWhen:e.showWhen})}function lx(e){return nx({id:`${String(e.fieldName)||da()}`,label:e.label,labelTooltip:e.labelTooltip,description:e.description,values:e.values,getModObject:e=>e,getValue:e.getValue||(t=>t.getSimpleRotation()[e.fieldName]),setValue:e.setValue||((t,a,i)=>{const s=a.getSimpleRotation();s[e.fieldName]=i,a.setSimpleRotation(t,s)}),changedEvent:e.changeEmitter||(e=>e.rotationChangeEmitter),enableWhen:e.enableWhen,showWhen:e.showWhen})}function cx(e){const t=e.getModObject;return{type:"icon",actionId:e.actionId,label:e.label,states:e.states,changedEvent:a=>e.changedEvent(t(a)),showWhen:a=>!e.showWhen||e.showWhen(t(a)),getValue:a=>e.getValue(t(a)),setValue:(a,i,s)=>e.setValue(a,t(i),s),extraCssClasses:e.extraCssClasses}}function hx(e,t,a,i,s){return cx({getModObject:e.getModObject,actionId:t,label:s,states:2,changedEvent:e.changeEmitter,showWhen:e.showWhen,getValue:e.getFieldValue||(t=>i?e.getValue(t)[a]==i:e.getValue(t)[a]),setValue:e.setFieldValue||((t,s,o)=>{const n=e.getValue(s);i?o?n[a]=i:n[a]==i&&(n[a]=0):n[a]=o,e.setValue(t,s,n)}),extraCssClasses:e.extraCssClasses})}function dx(e){return hx({getModObject:e=>e,getValue:e=>e.getClassOptions(),setValue:(e,t,a)=>t.setClassOptions(e,a),changeEmitter:e.changeEmitter||(e=>e.specOptionsChangeEmitter),extraCssClasses:e.extraCssClasses,getFieldValue:e.getValue,setFieldValue:e.setValue,showWhen:e.showWhen},e.id,e.fieldName,e.value)}function ux(e,t,a,i,s,o){const n=function(e,t,a,i,s){return cx({getModObject:e.getModObject,actionId:t,label:s,states:0,changedEvent:e.changeEmitter,getValue:t=>e.getValue(t)[a],setValue:(t,s,o)=>{const n=e.getValue(s);if(i){const e=o-n[a];o+=(i-1)*e}o<0&&(o=0),n[a]=o,e.setValue(t,s,n)}})}(e,t,i,s,o);return n.states=a,n}function px(e){const t=e.getModObject;return{type:"iconEnum",numColumns:e.numColumns,values:e.values.map(e=>{if(e.showWhen){const a=e.showWhen;e.showWhen=e=>a(t(e))}return e}),equals:e.equals,showWhen:a=>!e.showWhen||e.showWhen(t(a)),zeroValue:e.zeroValue,changedEvent:a=>e.changedEvent(t(a)),getValue:a=>e.getValue(t(a)),setValue:(a,i,s)=>e.setValue(a,t(i),s),extraCssClasses:e.extraCssClasses}}function mx(e){return px({numColumns:e.numColumns||1,values:e.values,equals:(e,t)=>e==t,showWhen:e.showWhen,zeroValue:0,getModObject:e=>e,getValue:e.getValue||(t=>t.getClassOptions()[e.fieldName]),setValue:e.setValue||((t,a,i)=>{const s=a.getClassOptions();s[e.fieldName]=i,a.setClassOptions(t,s)}),changedEvent:e.changeEmitter||(e=>e.specOptionsChangeEmitter),extraCssClasses:e.extraCssClasses})}function gx(e){return px({numColumns:e.numColumns||1,values:e.values,equals:(e,t)=>e==t,showWhen:e.showWhen,zeroValue:0,getModObject:e=>e,getValue:e.getValue||(t=>t.getSpecOptions()[e.fieldName]),setValue:e.setValue||((t,a,i)=>{const s=a.getSpecOptions();s[e.fieldName]=i,a.setSpecOptions(t,s)}),changedEvent:e.changeEmitter||(e=>e.specOptionsChangeEmitter),extraCssClasses:e.extraCssClasses})}class fx extends nl{constructor(e,t,a){super(e,"icon-enum-picker-root",t,a),this.rootElem.classList.add("icon-picker","vertical"===(a.direction??"vertical")?"dropdown":"dropend"),this.config=a,this.currentValue=this.config.zeroValue;const i=this.config.changedEvent(this.modObject).on(()=>{this.showWhen()?(this.restoreValue(),this.rootElem.classList.remove("hide")):(this.storeValue(),this.rootElem.classList.add("hide"))});if(this.addOnDisposeCallback(()=>i.dispose()),a.tooltip){const e=ie(this.rootElem,{content:a.tooltip});this.addOnDisposeCallback(()=>e.destroy())}const s=U(),o=U(),n=U();this.rootElem.appendChild(H(de,null,H("a",{ref:s,href:"javascript:void(0)",className:"icon-picker-button",attributes:{"aria-expanded":"false",role:"button"},dataset:{bsToggle:"dropdown",whtticon:"false",disableWowheadTouchTooltip:"true"}}),H("ul",{ref:o,className:"dropdown-menu",style:{gridTemplateColumns:this.config.numColumns?`repeat(${this.config.numColumns}, 1fr)`:void 0,gridAutoFlow:"Horizontal"==this.config.direction?"column":void 0}}),H("label",{ref:n,className:"form-label"}))),this.buttonElem=s.value,this.buttonText=n.value;const r=o.value;this.config.values.forEach(e=>{const t=document.createElement("li");t.classList.add("icon-dropdown-option","dropdown-option"),r.appendChild(t);const a=document.createElement("a");a.classList.add("icon-picker-button"),a.dataset.whtticon="false",a.dataset.disableWowheadTouchTooltip="true",t.appendChild(a);const i=()=>{this.setImage(a,e),this.showValueWhen(e)?t.classList.remove("hide"):(t.classList.add("hide"),this.currentValue==e.value&&(this.setInputValue(this.config.zeroValue),this.inputChanged(te.nextEventID())))},s=this.config.changedEvent(this.modObject).on(i);if(i(),a.addEventListener("click",t=>{t.preventDefault(),this.currentValue=e.value,this.storedValue=void 0,this.inputChanged(te.nextEventID())},{signal:this.signal}),this.addOnDisposeCallback(()=>s.dispose()),e.tooltip){const t=ie(a,{content:e.tooltip});this.addOnDisposeCallback(()=>t.destroy())}}),this.init()}storeValue(){void 0===this.storedValue&&(this.storedValue=this.getInputValue(),this.setInputValue(this.config.zeroValue),this.inputChanged(te.nextEventID()))}restoreValue(){void 0!==this.storedValue&&(this.setInputValue(this.storedValue),this.inputChanged(te.nextEventID()),this.storedValue=void 0)}setActionImage(e,t){t.fillAndSet(e,!0,!0)}setImage(e,t){if(t.showWhen&&!t.showWhen(this.modObject))return void e.removeAttribute("href");const a=t.actionId;a?(this.setActionImage(e,a),e.style.filter=""):t.iconUrl?(e.style.backgroundImage=`url(${t.iconUrl})`,e.style.filter="grayscale(1)"):(e.style.backgroundImage="",e.style.filter="",e.style.backgroundColor=t.color)}update(){super.update(),this.setActive(this.enabled&&!this.config.equals(this.currentValue,this.config.zeroValue))}getInputElem(){return this.buttonElem}getInputValue(){return this.currentValue}setInputValue(e){this.currentValue=e,this.setActive(this.enabled&&!this.config.equals(this.currentValue,this.config.zeroValue)),this.buttonText.textContent="",this.buttonText.style.display="none";const t=this.config.values.find(e=>this.config.equals(e.value,this.currentValue));if(t)this.setImage(this.buttonElem,t),null!=t.text&&(this.buttonText.style.display="block",this.buttonText.textContent=t.text);else if(this.config.backupIconUrl){const e=this.config.backupIconUrl(this.currentValue);this.setActionImage(this.buttonElem,e),this.setActive(!1)}}setActive(e){e?this.buttonElem.classList.add("active"):this.buttonElem.classList.remove("active")}showWhen(){return(!this.config.showWhen||this.config.showWhen(this.modObject))&&!!this.config.values.find(e=>e.actionId&&null!=e.actionId&&(!e.showWhen||e.showWhen(this.modObject)))}showValueWhen(e){return(!e.actionId||null!=e.actionId)&&(!e.showWhen||e.showWhen(this.modObject))}}class bx extends nl{constructor(e,t,a){super(e,"icon-picker-root",t,a),this.rootElem.classList.add("icon-picker"),this.active=!1,this.config=a,this.currentValue=0,this.rootAnchor=document.createElement("a"),this.rootAnchor.classList.add("icon-picker-button"),this.rootAnchor.dataset.whtticon="false",this.rootAnchor.dataset.disableWowheadTouchTooltip="true",this.rootAnchor.target="_blank",this.rootElem.prepend(this.rootAnchor);const i=Boolean(this.config.improvedId);i&&this.rootAnchor.classList.add("use-improved-icons"),this.config.improvedId2&&this.rootAnchor.classList.add("use-improved-icons2"),!i&&this.config.states>2&&this.rootAnchor.classList.add("use-counter");const s=U(),o=U(),n=U();this.rootAnchor.appendChild(H("div",{className:"icon-input-level-container"},H("a",{ref:s,className:"icon-picker-button icon-input-improved icon-input-improved1",dataset:{whtticon:"false",disableWowheadTouchTooltip:"true"}}),H("a",{ref:o,className:"icon-picker-button icon-input-improved icon-input-improved2",dataset:{whtticon:"false",disableWowheadTouchTooltip:"true"}}),H("span",{ref:n,className:"icon-picker-label "+(this.config.states>2?"":"hide")}))),this.improvedAnchor=s.value,this.improvedAnchor2=o.value,this.counterElem=n.value,this.updateButtonImage();const r=this.config.changedEvent(this.modObject).on(()=>{this.updateButtonImage(),this.showWhen()?(this.rootElem.classList.remove("hide"),this.restoreValue()):(this.storeValue(),this.rootElem.classList.add("hide"))});this.init(),this.rootAnchor.addEventListener("click",e=>{e.preventDefault(),this.handleLeftClick()},{signal:this.signal}),this.rootAnchor.addEventListener("contextmenu",e=>{e.preventDefault()},{signal:this.signal}),this.rootAnchor.addEventListener("mousedown",e=>{vt(e)&&(e.preventDefault(),this.handleRightClick())},{signal:this.signal}),this.addOnDisposeCallback(()=>r.dispose())}updateButtonImage(){this.config.actionId.fillAndSet(this.rootAnchor,!0,!0),this.config.states>=3&&this.config.improvedId&&this.config.improvedId.fillAndSet(this.improvedAnchor,!0,!0,{signal:this.signal}),this.config.states>=4&&this.config.improvedId2&&this.config.improvedId2.fillAndSet(this.improvedAnchor2,!0,!0,{signal:this.signal})}handleLeftClick(){0==this.config.states||this.currentValue+1<this.config.states?(this.currentValue++,this.inputChanged(te.nextEventID())):this.currentValue>0&&(this.currentValue=0,this.inputChanged(te.nextEventID()))}handleRightClick(){this.currentValue>0?this.currentValue--:0===this.config.states?this.currentValue=1:this.currentValue=this.config.states-1,this.inputChanged(te.nextEventID())}getInputElem(){return this.rootAnchor}getInputValue(){return 2==this.config.states?Boolean(this.currentValue):this.currentValue}getActionId(){const e=Number(this.config.getValue(this.modObject));return 0==e?null:1==e?this.config.actionId:2==e&&this.config.improvedId?this.config.improvedId:3==e&&this.config.improvedId2?this.config.improvedId2:this.config.actionId}setInputValue(e){this.currentValue=Number(e),this.currentValue>0?(this.active=!0,this.rootAnchor.classList.add("active"),this.counterElem.classList.add("active")):(this.active=!1,this.rootAnchor.classList.remove("active"),this.counterElem.classList.remove("active")),this.config.states>=3&&this.config.improvedId&&(this.currentValue>1?this.improvedAnchor.classList.add("active"):this.improvedAnchor.classList.remove("active")),this.config.states>=4&&this.config.improvedId2&&(this.currentValue>2?(this.improvedAnchor2.classList.add("active"),this.improvedAnchor.hidden=!0,this.improvedAnchor2.hidden=!1):(this.improvedAnchor2.classList.remove("active"),this.improvedAnchor.hidden=!1,this.improvedAnchor2.hidden=!0)),!this.config.improvedId&&(this.config.states>3||0==this.config.states)&&(this.counterElem.textContent=String(this.currentValue))}storeValue(){void 0===this.storedValue&&(this.storedValue=this.getInputValue(),this.setInputValue(0),this.inputChanged(te.nextEventID()))}restoreValue(){void 0!==this.storedValue&&(this.setInputValue(this.storedValue),this.inputChanged(te.nextEventID()),this.storedValue=void 0)}showWhen(){return null!=this.config.actionId&&(!this.config.showWhen||this.config.showWhen(this.modObject))}}const yx=(e,t,a)=>{if("icon"==a.type)return new bx(e,t,a);if("iconEnum"==a.type)return new fx(e,t,a);throw new Error("Unsupported input type")};function wx(e){return hx({getModObject:e=>e,showWhen:t=>!e.faction||e.faction==t.getFaction(),getValue:e=>e.getRaid().getBuffs(),setValue:(e,t,a)=>t.getRaid().setBuffs(e,a),changeEmitter:e=>te.onAny([e.getRaid().buffsChangeEmitter,e.raceChangeEmitter])},e.actionId,e.fieldName,e.value,e.label)}function vx(e){return hx({getModObject:e=>e,getValue:e=>e.getRaid().getDebuffs(),setValue:(e,t,a)=>t.getRaid().setDebuffs(e,a),changeEmitter:e=>te.onAny([e.getRaid().debuffsChangeEmitter])},e.actionId,e.fieldName,e.value,e.label)}function xx(e){return ux({getModObject:e=>e,showWhen:t=>!e.faction||e.faction==t.getFaction(),getValue:e=>e.getRaid().getBuffs(),setValue:(e,t,a)=>t.getRaid().setBuffs(e,a),changeEmitter:e=>te.onAny([e.getRaid().buffsChangeEmitter,e.raceChangeEmitter])},e.actionId,e.numStates,e.fieldName,e.multiplier,e.label)}function Sx(e){return ux({getModObject:e=>e,showWhen:t=>!e.faction||e.faction==t.getFaction(),getValue:e=>e.getBuffs(),setValue:(e,t,a)=>t.setBuffs(e,a),changeEmitter:e=>te.onAny([e.buffsChangeEmitter,e.raceChangeEmitter])},e.actionId,e.numStates,e.fieldName,e.multiplier,e.label)}const _x={actions:{create:{useIcon:!1}}};let kx=null;const Cx=class e extends nl{constructor(t,a,i){if(i.isCompact&&(i.extraCssClasses=[...i.extraCssClasses||[],"list-picker-compact"]),super(t,"list-picker-root",a,i),this.config={..._x,...i},this.itemPickerPairs=[],i.title&&this.rootElem.appendChild(H("label",{className:"list-picker-title form-label"},i.title)),this.itemsDiv=this.rootElem.appendChild(H("div",{className:"list-picker-items hide"})),this.config.hideUi&&this.rootElem.classList.add("d-none"),this.config.horizontalLayout&&(this.config.inlineMenuBar=!0,this.rootElem.classList.add("horizontal")),this.config.titleTooltip&&new ua(this.rootElem.querySelector(".list-picker-title"),this.config.titleTooltip,["ms-2"]),this.actionEnabled("create")){let t=null,a=null;this.config.actions?.create?.useIcon?(t=e.makeActionElem("link-success","fa-plus"),a=ie(t,{allowHTML:!1,content:oe.t("rotation_tab.apl.floatingActionBar.new",{itemName:i.itemLabel})}),this.addOnDisposeCallback(()=>a?.destroy())):t=H("button",{className:"btn btn-primary"},H("i",{className:"fa fa-plus me-2"}),oe.t("rotation_tab.apl.floatingActionBar.new",{itemName:i.itemLabel})),t.classList.add("list-picker-new-button"),t.addEventListener("click",()=>{const e=this.config.newItem(),t=this.config.getValue(this.modObject).concat([e]);this.config.setValue(te.nextEventID(),this.modObject,t),a&&a.hide()},{signal:this.signal}),this.rootElem.appendChild(t)}this.init()}getInputElem(){return this.rootElem}getInputValue(){return this.itemPickerPairs.map(e=>e.picker.getInputValue())}setInputValue(e){if(e.length<this.itemPickerPairs.length)this.itemPickerPairs.slice(e.length).forEach(e=>e.elem.remove()),this.itemPickerPairs=this.itemPickerPairs.slice(0,e.length);else if(e.length>this.itemPickerPairs.length){const t=e.length-this.itemPickerPairs.length;for(let e=0;e<t;e++)this.addNewPicker()}0===e.length?this.itemsDiv.classList.add("hide"):this.itemsDiv.classList.contains("hide")&&this.itemsDiv.classList.remove("hide"),e.forEach((e,t)=>this.itemPickerPairs[t].picker.setInputValue(e))}actionEnabled(e){return!this.config.allowedActions||this.config.allowedActions.includes(e)}addHoverListeners(e){e.addEventListener("mouseenter",()=>{e.classList.add("hover")},{signal:this.signal}),e.addEventListener("mouseleave",()=>{e.classList.remove("hover")},{signal:this.signal})}addNewPicker(){const t=this.itemPickerPairs.length,a=document.createElement("div");a.classList.add("list-picker-item-container"),this.config.inlineMenuBar&&a.classList.add("inline"),this.itemsDiv.appendChild(a);const i=document.createElement("div");i.classList.add("list-picker-item");const s=document.createElement("div");s.classList.add("list-picker-item-header");const o=document.createElement("div");o.classList.add("list-picker-item-popover"),o.setAttribute("popover","auto"),s.appendChild(o);let n=!1;if(this.config.inlineMenuBar)a.appendChild(i),a.appendChild(s);else if(a.appendChild(s),a.appendChild(i),this.config.itemLabel){const e=document.createElement("h6");e.classList.add("list-picker-item-title"),e.textContent=`${this.config.itemLabel} ${this.itemPickerPairs.length+1}`,s.appendChild(e)}const r=this.config.newItemPicker(i,this,t,{changedEvent:this.config.changedEvent,getValue:()=>this.getSourceValue()[t],setValue:(e,a,i)=>{const s=this.getSourceValue();s[t]=i,this.config.setValue(e,a,s)}}),l={elem:a,picker:r,idx:t};if(this.actionEnabled("delete")&&(!this.config.minimumItems||t+1>this.config.minimumItems)){n=!0;const a=e.makeActionElem("list-picker-item-delete","fa-times");a.classList.add("link-danger"),o.appendChild(a);const i=ie(a,{allowHTML:!1,content:oe.t("common.list_picker.delete_item",{itemLabel:pa(this.config.itemLabel)})});a.addEventListener("click",()=>{const e=this.config.getValue(this.modObject);e.splice(t,1),this.config.setValue(te.nextEventID(),this.modObject,e),i.hide()},{signal:this.signal}),this.addOnDisposeCallback(()=>i?.destroy()),this.addHoverListeners(a)}if(this.actionEnabled("copy")){n=!0;const a=e.makeActionElem("list-picker-item-copy","fa-copy");o.appendChild(a);const i=ie(a,{allowHTML:!1,content:oe.t("common.list_picker.copy_to_new",{itemLabel:pa(this.config.itemLabel)})});a.addEventListener("click",()=>{const e=this.config.getValue(this.modObject).slice();e.splice(t,0,this.config.copyItem(e[t])),this.config.setValue(te.nextEventID(),this.modObject,e),i.hide()},{signal:this.signal}),this.addOnDisposeCallback(()=>i?.destroy()),this.addHoverListeners(a)}if(this.actionEnabled("move")){n=!0,a.classList.add("draggable"),this.config.itemLabel&&a.classList.add(this.config.itemLabel.toLowerCase().replace(" ","-"));const i=e.makeActionElem("list-picker-item-move","fa-arrows-up-down");o.appendChild(i);const s=ie(i,{allowHTML:!1,content:oe.t("common.list_picker.move_drag_drop")});i.addEventListener("click",()=>{s.hide()},{signal:this.signal}),this.addOnDisposeCallback(()=>{s?.destroy()}),this.addHoverListeners(i),i.addEventListener("mousedown",()=>{i.setAttribute("draggable","true"),a.setAttribute("draggable","true")},{signal:this.signal}),i.addEventListener("mouseup",()=>{i.removeAttribute("draggable"),a.removeAttribute("draggable")},{signal:this.signal}),i.addEventListener("dragstart",e=>{if(e.target==i){const t=o.getBoundingClientRect();e.dataTransfer.setDragImage(a,0,t.height/2),e.dataTransfer.dropEffect="move",e.dataTransfer.effectAllowed="move",a.classList.add("dragfrom"),kx={listPicker:this,item:l}}},{signal:this.signal});const r=()=>kx&&"Action"===this.config.itemLabel&&kx.listPicker!==this,c=()=>kx&&kx.listPicker===this&&kx.item.idx===t,h=()=>kx&&kx.item.elem.contains(a),d=(e=!0)=>!kx||kx.listPicker.config.itemLabel!==this.config.itemLabel||(!!r()||(!(!e||!c())||!(!e||!h())));let u=0;a.addEventListener("dragenter",e=>{d()||(e.stopPropagation(),u++,a.classList.add("dragto"))},{signal:this.signal}),a.addEventListener("dragleave",e=>{d()||(e.preventDefault(),u--,u<=0&&a.classList.remove("dragto"))},{signal:this.signal}),a.addEventListener("dragover",e=>{d()?(r()||c())&&(e.dataTransfer.dropEffect="none"):(e.dataTransfer.dropEffect="move",e.stopPropagation(),e.preventDefault())},{signal:this.signal});const p=()=>{kx&&(i.removeAttribute("draggable"),a.removeAttribute("draggable"),kx.item.elem.removeAttribute("draggable"),[...document.querySelectorAll(".dragfrom,.dragto")].forEach(e=>{e.classList.remove("dragfrom"),e.classList.remove("dragto")}))};a.addEventListener("dragend",e=>{d(!1)||(e.stopPropagation(),p(),kx=null)},{signal:this.signal}),a.addEventListener("drop",e=>{if(!kx||d())return void(c()&&(e.stopPropagation(),p()));e.stopPropagation(),p();const i=kx.item.idx;let s=t;const o=a.getBoundingClientRect();e.clientY>o.top+o.height/2&&s++;const n=this.config.getValue(this.modObject);let r;if(kx.listPicker!==this){const e=kx.listPicker.config.getValue(kx.listPicker.modObject);r=e[i],e.splice(i,1),kx.listPicker.config.setValue(te.nextEventID(),kx.listPicker.modObject,e)}else r=n[i],n.splice(i,1);n.splice(s,0,r),this.config.setValue(te.nextEventID(),this.modObject,n),kx=null},{signal:this.signal})}if(n){const t=e.makeActionElem("list-picker-item-actions","fa-ellipsis");s.appendChild(t),t.addEventListener("mouseover",()=>{o.showPopover();const e=t.getBoundingClientRect(),a=o.getBoundingClientRect(),i=(a.height-e.height)/2;o.style.top=e.top-i+"px",o.style.left=e.right-a.width+10+"px",o.classList.add("hover")},{signal:this.signal}),o.addEventListener("mouseleave",()=>{o.classList.remove("hover"),o.hidePopover()},{signal:this.signal})}this.itemPickerPairs.push(l)}static makeActionElem(e,t){return H("button",{type:"button",className:xr("list-picker-item-action",e)},H("i",{className:xr("fa","fa-xl",t)}))}static getItemHeaderElem(e){const t=e.rootElem.parentElement,a=t.nextElementSibling||t.previousElementSibling;if(!a?.classList.contains("list-picker-item-header"))throw new Error("Could not find list item header");return a}static makeListItemValidations(t,a,i){const s=e.makeActionElem("apl-validations","fa-exclamation-triangle");s.setAttribute("data-bs-html","true");const o=ie(s,{theme:"dropdown-tooltip",content:oe.t("common.list_picker.warnings")});t.appendChild(s);const n=s.querySelector("i"),r=async()=>{if(!ae(s))return o?.destroy(),s?.remove(),void a.currentStatsEmitter.off(r);o.setContent("");const e=i(a);if(e.length){s.style.removeProperty("display");const t=await Promise.all(e.map(async e=>({...e,validation:await Lr.replaceAllInString(e.validation)})));let a=ma.Undefined;const i=t.reduce((e,t)=>{const i=t.logLevel;a=Math.max(i,a);const s=e.get(i);return s?s.push(t.validation):e.set(i,[t.validation]),e},new Map);for(const[e,s]of this.logLevelDisplayData)n.classList.remove(s.icon);const r=this.logLevelDisplayData.get(a)?.icon;r&&n.classList.add(r);for(const[e,o]of Object.entries(ma))s.classList[o===a?"add":"remove"](`apl-validation-${e.toLowerCase()}`);let l="";for(const[e,s]of i)l+=`\n\t\t\t\t\t\t<p>${this.logLevelDisplayData.get(e)?.header}</p>\n\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t${s.map(e=>`<li>${e}</li>`).join("")}\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t`;o.setContent(l)}else s.style.display="none"};r(),a.currentStatsEmitter.on(r)}};Cx.logLevelDisplayData=new Map([[ma.Information,{icon:"fa-info-circle",header:oe.t("common.list_picker.additional_information")}],[ma.Warning,{icon:"fa-exclamation-triangle",header:oe.t("common.list_picker.action_has_warnings")}],[ma.Error,{icon:"fa-exclamation-triangle",header:oe.t("common.list_picker.action_has_errors")}]]);let Ix=Cx;class Ex extends F{constructor(e,t,a,i){super(e,"apl-floating-action-bar-root");this.rootElem.appendChild(H("button",{className:"btn btn-primary"},H("i",{className:"fas fa-plus me-2"}),oe.t("rotation_tab.apl.floatingActionBar.new",{itemName:i}))).addEventListener("click",()=>{const e=a.config.newItem(),t=a.config.getValue(a.modObject).concat([e]);a.config.setValue(te.nextEventID(),a.modObject,t)});this.rootElem.appendChild(H("button",{className:"btn btn-sm btn-link btn-reset ms-auto"},H("i",{className:"fas fa-times me-1"}),oe.t("rotation_tab.apl.floatingActionBar.reset"))).addEventListener("click",()=>{t.applyEmptyAplRotation(te.nextEventID())}),new IntersectionObserver(([e])=>{e.target.classList.toggle("stuck")},{root:e,rootMargin:"-100% 0px 0px 0px"}).observe(this.rootElem)}}class Tx extends nl{constructor(e,t,a){super(e,"adaptive-string-picker-root",t,a),this.inputElem=document.createElement("input"),this.inputElem.type="text",this.inputElem.id=a.id,this.inputElem.classList.add("form-control"),this.rootElem.appendChild(this.inputElem),this.init(),this.inputElem.addEventListener("change",()=>{this.inputChanged(te.nextEventID())},{signal:this.signal}),this.inputElem.addEventListener("input",()=>{this.updateSize()},{signal:this.signal}),this.updateSize()}getInputElem(){return this.inputElem}getInputValue(){return this.inputElem.value}setInputValue(e){this.inputElem.value=e,this.updateSize()}updateSize(){const e=Math.max(3,this.inputElem.value.length);this.inputElem.size!=e&&(this.inputElem.size=e)}}const Ax={auras:{defaultLabel:oe.t("rotation_tab.apl.helpers.action_id_sets.auras"),getActionIDs:async e=>e.getAuras().map(e=>({value:e.id}))},stackable_auras:{defaultLabel:oe.t("rotation_tab.apl.helpers.action_id_sets.stackable_auras"),getActionIDs:async e=>e.getAuras().filter(e=>e.data.maxStacks>0).map(e=>({value:e.id}))},icd_auras:{defaultLabel:oe.t("rotation_tab.apl.helpers.action_id_sets.icd_auras"),getActionIDs:async e=>e.getAuras().filter(e=>e.data.hasIcd).map(e=>({value:e.id}))},exclusive_effect_auras:{defaultLabel:oe.t("rotation_tab.apl.helpers.action_id_sets.exclusive_effect_auras"),getActionIDs:async e=>e.getAuras().filter(e=>e.data.hasExclusiveEffect).map(e=>({value:e.id}))},spells:{defaultLabel:oe.t("rotation_tab.apl.helpers.action_id_sets.spells"),getActionIDs:async e=>e.getSpells().filter(e=>e.data.isCastable).map(e=>({value:e.id}))},castable_spells:{defaultLabel:oe.t("rotation_tab.apl.helpers.action_id_sets.castable_spells"),getActionIDs:async e=>{const t=e.getSpells().filter(e=>e.data.isCastable),{spells:a,cooldowns:i}=ue(t,e=>e.data.isMajorCooldown?"cooldowns":"spells"),s=[Lr.fromOtherId(O.OtherActionPotion)];return[[{value:Lr.fromEmpty(),headerText:oe.t("rotation_tab.apl.submenus.spell"),submenu:["spell"]}],(a||[]).map(e=>({value:e.id,submenu:["spell"],extraCssClasses:e.data.prepullOnly?["apl-prepull-actions-only"]:e.data.encounterOnly?["apl-priority-list-only"]:[]})),[{value:Lr.fromEmpty(),headerText:oe.t("rotation_tab.apl.submenus.cooldowns"),submenu:["cooldowns"]}],(i||[]).map(e=>({value:e.id,submenu:["cooldowns"],extraCssClasses:e.data.prepullOnly?["apl-prepull-actions-only"]:e.data.encounterOnly?["apl-priority-list-only"]:[]})),[{value:Lr.fromEmpty(),headerText:oe.t("rotation_tab.apl.submenus.placeholders"),submenu:["placeholders"]}],s.map(e=>({value:e,submenu:["placeholders"],tooltip:oe.t("rotation_tab.apl.helpers.placeholder_tooltip")}))].flat()}},non_instant_spells:{defaultLabel:oe.t("rotation_tab.apl.helpers.action_id_sets.non_instant_spells"),getActionIDs:async e=>e.getSpells().filter(e=>e.data.isCastable&&e.data.hasCastTime).map(e=>({value:e.id}))},friendly_spells:{defaultLabel:oe.t("rotation_tab.apl.helpers.action_id_sets.friendly_spells"),getActionIDs:async e=>e.getSpells().filter(e=>e.data.isCastable&&e.data.isFriendly).map(e=>({value:e.id}))},channel_spells:{defaultLabel:oe.t("rotation_tab.apl.helpers.action_id_sets.channel_spells"),getActionIDs:async e=>e.getSpells().filter(e=>e.data.isCastable&&e.data.isChanneled).map(e=>({value:e.id}))},dot_spells:{defaultLabel:oe.t("rotation_tab.apl.helpers.action_id_sets.dot_spells"),getActionIDs:async e=>e.getSpells().filter(e=>e.data.hasDot).filter((e,t,a)=>a.findIndex(t=>t.id.anyId()===e.id.anyId())===t).map(e=>({value:e.id}))},castable_dot_spells:{defaultLabel:oe.t("rotation_tab.apl.helpers.action_id_sets.castable_dot_spells"),getActionIDs:async e=>e.getSpells().filter(e=>e.data.isCastable&&e.data.hasDot).map(e=>({value:e.id}))},expected_dot_spells:{defaultLabel:oe.t("rotation_tab.apl.helpers.action_id_sets.expected_dot_spells"),getActionIDs:async e=>e.getSpells().filter(e=>e.data.hasExpectedTick).filter((e,t,a)=>a.findIndex(t=>t.id.anyId()===e.id.anyId())===t).map(e=>({value:e.id}))},shield_spells:{defaultLabel:oe.t("rotation_tab.apl.helpers.action_id_sets.shield_spells"),getActionIDs:async e=>e.getSpells().filter(e=>e.data.hasShield).map(e=>({value:e.id}))},spells_with_travelTime:{defaultLabel:oe.t("rotation_tab.apl.helpers.action_id_sets.spells_with_travelTime"),getActionIDs:async e=>e.getSpells().filter(e=>e.data.hasMissileSpeed).map(e=>({value:e.id}))}},Px=new Sr;class Rx extends kc{constructor(e,t,a){const i=Ax[a.actionIdSet];super(e,t,{...a,sourceToValue:e=>e?Lr.fromProto(e):Lr.fromEmpty(),valueToSource:e=>e.toProto(),defaultLabel:i.defaultLabel,equals:(e,t)=>null==e==(null==t)&&(!e||e.equals(t)),setOptionContent:(e,t)=>{const i=t.value,s=["auras","stackable_auras","icd_auras","exclusive_effect_auras"].includes(a.actionIdSet),o=`${i.toString()}${s}`,n=Px.get(o)?.cloneNode(!0);n&&e.appendChild(n);const r=U(),l=H(de,null,H("a",{ref:r,className:"apl-actionid-item-icon",dataset:{whtticon:!1}}),i.name);e.appendChild(l),i.setBackgroundAndHref(r.value),i.setWowheadDataset(r.value,{useBuffAura:s}),Px.set(o,l)},createMissingValue:e=>0==e.anyId()?new Promise(()=>{i.defaultLabel}):e.fill().then(e=>({value:e})),values:[]});const s=a.getUnitRef,o="self"==a.defaultUnitRef?Ge.create({type:ze.Self}):Ge.create({type:ze.CurrentTarget}),n=i.getActionIDs,r=async()=>{const e=s(t),a=t.sim.getUnitMetadata(e,t,o);if(a){const e=await n(a);this.setOptions(e)}};r();const l=t.sim.unitMetadataEmitter.on(r),c=t.rotationChangeEmitter.on(r);this.addOnDisposeCallback(()=>{l.dispose(),c.dispose()})}}const Dx={aura_sources:{getUnits:e=>[void 0,e.getPetMetadatas().asList().map((e,t)=>Ge.create({type:ze.Pet,index:t,owner:Ge.create({type:ze.Self})})),Ge.create({type:ze.CurrentTarget}),Ge.create({type:ze.PreviousTarget}),Ge.create({type:ze.NextTarget}),e.sim.raid.getActivePlayers().filter(t=>t!=e).map(e=>Ge.create({type:ze.Player,index:e.getRaidIndex()})),e.sim.encounter.targetsMetadata.asList().map((e,t)=>Ge.create({type:ze.Target,index:t}))].flat()},aura_sources_targets_first:{targetUI:!0,getUnits:e=>[void 0,e.sim.encounter.targetsMetadata.asList().map((e,t)=>Ge.create({type:ze.Target,index:t})),Ge.create({type:ze.Self}),e.getPetMetadatas().asList().map((e,t)=>Ge.create({type:ze.Pet,index:t,owner:Ge.create({type:ze.Self})}))].flat()},targets:{targetUI:!0,getUnits:e=>[void 0,e.sim.encounter.targetsMetadata.asList().map((e,t)=>Ge.create({type:ze.Target,index:t})),Ge.create({type:ze.PreviousTarget}),Ge.create({type:ze.NextTarget})].flat()},players:{targetUI:!0,getUnits:e=>[void 0,e.sim.raid.getActivePlayers().map(e=>Ge.create({type:ze.Player,index:e.getRaidIndex()}))].flat()}};class Mx extends Ic{constructor(e,t,a){const i=!!Dx[a.unitSet].targetUI;super(e,t,{...a,sourceToValue:e=>Mx.refToValue(e,t,i),valueToSource:e=>e.value,values:[],hideLabelWhenDefaultSelected:!0}),this.unitSet=a.unitSet,this.rootElem.classList.add("apl-unit-picker"),this.updateValues();const s=t.sim.unitMetadataEmitter.on(()=>this.updateValues());this.addOnDisposeCallback(()=>{s.dispose()})}static refToValue(e,t,a){if(!e||e.type==ze.Unknown)return{value:e,iconUrl:a?"fa-bullseye":"fa-user",text:a?oe.t("rotation_tab.apl.helpers.unit_labels.current_target"):oe.t("rotation_tab.apl.helpers.unit_labels.self")};if(e.type==ze.Self)return{value:e,iconUrl:"fa-user",text:oe.t("rotation_tab.apl.helpers.unit_labels.self")};if(e.type==ze.CurrentTarget)return{value:e,iconUrl:"fa-bullseye",text:oe.t("rotation_tab.apl.helpers.unit_labels.current_target")};if(e.type==ze.PreviousTarget)return{value:e,iconUrl:"fa-arrow-left",text:oe.t("rotation_tab.apl.helpers.unit_labels.previous_target")};if(e.type==ze.NextTarget)return{value:e,iconUrl:"fa-arrow-right",text:oe.t("rotation_tab.apl.helpers.unit_labels.next_target")};if(e.type==ze.Player){const a=t.sim.raid.getPlayer(e.index);if(a)return{value:e,iconUrl:a.getSpecIcon(),text:`${oe.t("rotation_tab.apl.helpers.unit_labels.player")} ${e.index+1}`}}else if(e.type==ze.Target){if(t.sim.encounter.targetsMetadata.asList()[e.index])return{value:e,iconUrl:Gr,text:`${oe.t("rotation_tab.apl.helpers.unit_labels.target")} ${e.index+1}`}}else if(e.type==ze.Pet){const a=t.sim.getUnitMetadata(e,t,Ge.create({type:ze.Self}));let i=`${oe.t("rotation_tab.apl.helpers.unit_labels.pet")} ${e.index+1}`,s="fa-paw";if(a){const e=a.getName();if(e){const t=e.indexOf(" - ");i=e.substring(t+3),s=function(e){return zr[e]||Fr[e]}(i)||s}}return{value:e,iconUrl:s,text:i}}return{value:e}}updateValues(){const e=Dx[this.unitSet],t=e.getUnits(this.modObject);this.setOptions(t.map(t=>{const a={value:Mx.refToValue(t,this.modObject,e.targetUI)};return t&&t.type==ze.Pet&&(e.targetUI?a.submenu=[Mx.refToValue(t.owner,this.modObject,e.targetUI)]:a.submenu=[Mx.refToValue(void 0,this.modObject,e.targetUI)]),a}))}}class Lx extends nl{constructor(e,t,a){super(e,"apl-picker-builder-root",t,a),this.config=a,this.fieldPickers=a.fields.map(e=>Lx.makeFieldPicker(this,e)),this.init()}static makeFieldPicker(e,t){const a=t.field,i=t.factory(e.rootElem,e.modObject,{label:t.label,labelTooltip:t.labelTooltip,id:da(),changedEvent:e=>e.rotationChangeEmitter,getValue:()=>{const i=e.getSourceValue();return i[a]||(i[a]=t.newValue()),i[a]},setValue:(t,i,s)=>{e.getSourceValue()[a]=s,i.rotationChangeEmitter.emit(t)}},()=>e.getSourceValue());return"vals"!==a&&"actions"!==a||i.rootElem.classList.add("apl-picker-builder-multi"),{...t,picker:i}}getInputElem(){return this.rootElem}getInputValue(){const e=this.config.newValue();return this.fieldPickers.forEach(t=>{e[t.field]=t.picker.getInputValue()}),e}setInputValue(e){this.fieldPickers.forEach(t=>{t.picker.setInputValue(e[t.field])})}}function Nx(e,t,a,i,s){return{field:e,newValue:()=>z.create(),factory:(e,s,o,n)=>new Rx(e,s,{id:da(),...o,actionIdSet:t,getUnitRef:()=>a?n()[a]:Ge.create(),defaultUnitRef:i||"self"})}}function Ox(e,t,a){return{field:e,newValue:()=>{},factory:(e,a,i)=>new Mx(e,a,{id:da(),...i,unitSet:t})}}function Gx(e,t,a){return{field:e,newValue:()=>!1,factory:(e,t,a)=>(a.extraCssClasses=["input-inline"].concat(a.extraCssClasses||[]),new gc(e,t,{id:da(),...a})),...a||{},label:t}}function zx(e,t,a){return{field:e,newValue:()=>0,factory:(e,a,i)=>{const s=i;return s.float=t,s.extraCssClasses=["input-inline"].concat(i.extraCssClasses||[]),new rl(e,a,s)},...a||{}}}function Fx(e,t){return{field:e,newValue:()=>"",factory:(e,t,a)=>(a.extraCssClasses=["input-inline"].concat(a.extraCssClasses||[]),new Tx(e,t,{id:da(),...a})),...t||{}}}class Hx extends nl{constructor(e,t,a,i,s,o){super(e,"apl-group-variable-picker-root",t,a),this.getParentValue=i,this.groupNameField=s,this.variableName=o;const n=document.createElement("label");n.textContent=`${this.variableName}:`,n.classList.add("group-variable-label","fw-bold","d-block"),this.rootElem.appendChild(n),this.valuePicker=new Cc(this.rootElem,this.modObject,{id:da(),label:"",labelTooltip:oe.t("rotation_tab.apl.helpers.field_configs.variable_assignment_tooltip",{variableName:this.variableName}),defaultLabel:oe.t("rotation_tab.apl.helpers.select_variable"),equals:(e,t)=>e===t,values:[],changedEvent:e=>e.rotationChangeEmitter,getValue:()=>{const e=this.getSourceValue();return e?.value?.value?.variableRef?.name?e.value.value.variableRef.name:""},setValue:(e,t,a)=>{const i=this.getSourceValue();i&&a&&(i.value={uuid:{value:da()},value:{oneofKind:"variableRef",variableRef:{name:a}}},t.rotationChangeEmitter.emit(e))}});const r=()=>{if(!this.getParentValue()[this.groupNameField])return void this.valuePicker.setOptions([]);const e=(this.modObject.aplRotation?.valueVariables||[]).map(e=>({value:e.name,label:e.name}));this.valuePicker.setOptions(e)};this.modObject.rotationChangeEmitter.on(r),r(),this.init()}getInputElem(){return this.rootElem}getInputValue(){return{name:this.variableName,value:this.getSourceValue()?.value}}setInputValue(e){}}function Ux(e,t){const a=[{value:ga.RuneBlood,label:oe.t("rotation_tab.apl.helpers.rune_types.blood")},{value:ga.RuneFrost,label:oe.t("rotation_tab.apl.helpers.rune_types.frost")},{value:ga.RuneUnholy,label:oe.t("rotation_tab.apl.helpers.rune_types.unholy")}];return t&&a.push({value:ga.RuneDeath,label:oe.t("rotation_tab.apl.helpers.rune_types.death")}),{field:e,newValue:()=>ga.RuneBlood,factory:(e,t,i)=>new Cc(e,t,{id:da(),...i,defaultLabel:oe.t("common.none"),equals:(e,t)=>e==t,values:a})}}function Bx(e){return{field:e,newValue:()=>ya.SlotLeftBlood,factory:(e,t,a)=>new Cc(e,t,{id:da(),...a,defaultLabel:oe.t("common.none"),equals:(e,t)=>e==t,values:[{value:ya.SlotLeftBlood,label:oe.t("rotation_tab.apl.helpers.rune_slots.blood_left")},{value:ya.SlotRightBlood,label:oe.t("rotation_tab.apl.helpers.rune_slots.blood_right")},{value:ya.SlotLeftFrost,label:oe.t("rotation_tab.apl.helpers.rune_slots.frost_left")},{value:ya.SlotRightFrost,label:oe.t("rotation_tab.apl.helpers.rune_slots.frost_right")},{value:ya.SlotLeftUnholy,label:oe.t("rotation_tab.apl.helpers.rune_slots.unholy_left")},{value:ya.SlotRightUnholy,label:oe.t("rotation_tab.apl.helpers.rune_slots.unholy_right")}]})}}function Wx(t){const a=e(ee),i=[{value:-1,label:oe.t("common.none")}].concat(a.map(e=>({value:e,label:ot(e)})));return{field:t,label:oe.t("rotation_tab.apl.helpers.field_configs.buff_type"),newValue:()=>0,factory:(e,t,a)=>new Cc(e,t,{id:da(),...a,defaultLabel:oe.t("common.none"),equals:(e,t)=>e==t,values:i})}}const Vx=zx("minIcdSeconds",!1,{label:oe.t("rotation_tab.apl.helpers.field_configs.min_icd"),labelTooltip:oe.t("rotation_tab.apl.helpers.field_configs.min_icd_tooltip")});function jx(e,t){return(a,i,s)=>new Lx(a,i,{...s,newValue:e,fields:t})}function Yx(){return Gx("includeReactionTime",oe.t("rotation_tab.apl.helpers.field_configs.include_reaction_time"),{labelTooltip:oe.t("rotation_tab.apl.helpers.field_configs.include_reaction_time_tooltip")})}function qx(){return Gx("useBaseValue",oe.t("rotation_tab.apl.helpers.field_configs.use_base_value"),{labelTooltip:oe.t("rotation_tab.apl.helpers.field_configs.use_base_value_tooltip")})}function Xx(e){return{field:e,newValue:()=>ba.Swap1,factory:(e,t,a)=>new Cc(e,t,{id:da(),...a,defaultLabel:oe.t("common.none"),equals:(e,t)=>e==t,values:[{value:ba.Main,label:oe.t("rotation_tab.apl.item_swap_sets.main")},{value:ba.Swap1,label:oe.t("rotation_tab.apl.item_swap_sets.swapped")}]})}}class $x extends nl{constructor(e,t,a){super(e,"apl-value-picker-root",t,a);const i=null!=this.rootElem.closest(".apl-prepull-action-picker"),s=null!=this.rootElem.closest(".apl-groups-picker"),o=Object.keys(Qx).filter(e=>(!!e&&Qx[e].includeIf?.(t,i,s))??!0);if(this.rootElem.parentElement.classList.contains("list-picker-item")){const e=Ix.getItemHeaderElem(this)||this.rootElem;Ix.makeListItemValidations(e,t,e=>e.getCurrentStats().rotationStats?.uuidValidations?.find(e=>e.uuid?.value===this.rootElem.id)?.validations||[])}this.kindPicker=new Cc(this.rootElem,t,{defaultLabel:oe.t("rotation_tab.apl.values.no_condition"),id:da(),values:[{value:void 0,label:oe.t("rotation_tab.apl.values.none")}].concat(o.map(e=>{const a=Qx[e],i=a.dynamicStringResolver||(e=>e);return{value:e,label:i(a.label,t),submenu:a.submenu,tooltip:a.fullDescription?`<p>${i(a.shortDescription,t)}</p> ${i(a.fullDescription,t)}`:i(a.shortDescription,t)}})),equals:(e,t)=>e==t,changedEvent:e=>e.rotationChangeEmitter,getValue:e=>this.getSourceValue()?.value.oneofKind,setValue:(e,t,a)=>{const i=this.getSourceValue(),s=i?.value.oneofKind;if(s!=a){if(a){const t=Qx[a];let o=this.makeAPLValue(a,t.newValue());i&&s&&this.valuePicker&&("not"==a?o.value.not.val=this.makeAPLValue(s,this.valuePicker.getInputValue()):"not"==i.value.oneofKind&&i.value.not.val?.value.oneofKind==a?o=i.value.not.val:"and"==a?"or"==i.value.oneofKind?o.value.and.vals=i.value.or.vals:o.value.and.vals=[this.makeAPLValue(s,this.valuePicker.getInputValue())]:"or"==a?"and"==i.value.oneofKind?o.value.or.vals=i.value.and.vals:o.value.or.vals=[this.makeAPLValue(s,this.valuePicker.getInputValue())]:"min"==a?"max"==i.value.oneofKind?o.value.min.vals=i.value.max.vals:o.value.min.vals=[this.makeAPLValue(s,this.valuePicker.getInputValue())]:"max"==a?"min"==i.value.oneofKind?o.value.max.vals=i.value.min.vals:o.value.max.vals=[this.makeAPLValue(s,this.valuePicker.getInputValue())]:"and"==i.value.oneofKind&&i.value.and.vals?.[0]?.value.oneofKind==a?o=i.value.and.vals[0]:"or"==i.value.oneofKind&&i.value.or.vals?.[0]?.value.oneofKind==a?o=i.value.or.vals[0]:"min"==i.value.oneofKind&&i.value.min.vals?.[0]?.value.oneofKind==a?o=i.value.min.vals[0]:"max"==i.value.oneofKind&&i.value.max.vals?.[0]?.value.oneofKind==a?o=i.value.max.vals[0]:"cmp"==a&&(o.value.cmp.lhs=this.makeAPLValue(s,this.valuePicker.getInputValue()))),i?i.value=o.value:this.setSourceValue(e,o)}else this.setSourceValue(e,void 0);t.rotationChangeEmitter.emit(e)}}}),this.currentKind=void 0,this.valuePicker=null,this.init()}getInputElem(){return this.rootElem}getInputValue(){const e=this.kindPicker.getInputValue();return e?ds.create({value:{oneofKind:e,...(()=>{const t={};return e&&this.valuePicker&&(t[e]=this.valuePicker.getInputValue()),t})()},uuid:{value:da()}}):void 0}setInputValue(e){const t=e?.value.oneofKind;this.updateValuePicker(t),t&&e&&this.valuePicker.setInputValue(e.value[t]),e&&(e.uuid&&""!=e.uuid.value||(e.uuid={value:da()}),this.rootElem.id=e.uuid.value)}makeAPLValue(e,t){if(!e)return ds.create({uuid:{value:da()}});const a={oneofKind:e};return a[e]=t,ds.create({value:a,uuid:{value:da()}})}updateValuePicker(e){const t=this.currentKind;if(e==t)return;if(this.currentKind=e,this.valuePicker&&(this.valuePicker.rootElem.remove(),this.valuePicker=null),!e)return;this.kindPicker.setInputValue(e);const a=Qx[e];this.valuePicker=a.factory(this.rootElem,this.modObject,{id:da(),changedEvent:e=>e.rotationChangeEmitter,getValue:()=>{const t=this.getSourceValue();return t&&t.value[e]||a.newValue()},setValue:(t,a,i)=>{const s=this.getSourceValue();s&&(s.value[e]=i),a.rotationChangeEmitter.emit(t)}})}}function Zx(e,t){return{field:e,newValue:()=>ds.create({uuid:{value:da()}}),factory:(e,t,a)=>new $x(e,t,a),...t||{}}}function Kx(e){return{field:e,newValue:()=>[],factory:(e,t,a)=>new Ix(e,t,{...a,setValue:(e,t,i)=>{a.setValue(e,t,i.map(e=>e||ds.create({uuid:{value:da()}})))},itemLabel:"Value",newItem:()=>ds.create({uuid:{value:da()}}),copyItem:e=>e?ds.clone(e):e,newItemPicker:(e,a,i,s)=>new $x(e,t,s),allowedActions:["copy","create","delete","move"],actions:{create:{useIcon:!0}}})}}function Jx(e){return{label:e.label,submenu:e.submenu,shortDescription:e.shortDescription,fullDescription:e.fullDescription,newValue:e.newValue,includeIf:e.includeIf,factory:jx(e.newValue,e.fields),dynamicStringResolver:e.dynamicStringResolver}}const Qx={const:Jx({label:oe.t("rotation_tab.apl.values.const.label"),shortDescription:oe.t("rotation_tab.apl.values.const.tooltip"),fullDescription:oe.t("rotation_tab.apl.values.const.full_description"),newValue:hs.create,fields:[Fx("val")]}),cmp:Jx({label:oe.t("rotation_tab.apl.values.compare.label"),submenu:["logic"],shortDescription:oe.t("rotation_tab.apl.values.compare.tooltip"),newValue:cs.create,fields:[Zx("lhs"),(eS="op",{field:eS,newValue:()=>ps.OpEq,factory:(e,t,a)=>new Cc(e,t,{id:da(),...a,defaultLabel:oe.t("common.none"),equals:(e,t)=>e==t,values:[{value:ps.OpEq,label:oe.t("rotation_tab.apl.operators.equals")},{value:ps.OpNe,label:oe.t("rotation_tab.apl.operators.not_equals")},{value:ps.OpGe,label:oe.t("rotation_tab.apl.operators.greater_than_or_equal")},{value:ps.OpGt,label:oe.t("rotation_tab.apl.operators.greater_than")},{value:ps.OpLe,label:oe.t("rotation_tab.apl.operators.less_than_or_equal")},{value:ps.OpLt,label:oe.t("rotation_tab.apl.operators.less_than")}]})}),Zx("rhs")]}),math:Jx({label:oe.t("rotation_tab.apl.values.math.label"),submenu:["logic"],shortDescription:oe.t("rotation_tab.apl.values.math.tooltip"),newValue:ls.create,fields:[Zx("lhs"),function(e){return{field:e,newValue:()=>us.OpAdd,factory:(e,t,a)=>new Cc(e,t,{id:da(),...a,defaultLabel:oe.t("common.none"),equals:(e,t)=>e==t,values:[{value:us.OpAdd,label:oe.t("rotation_tab.apl.operators.add")},{value:us.OpSub,label:oe.t("rotation_tab.apl.operators.subtract")},{value:us.OpMul,label:oe.t("rotation_tab.apl.operators.multiply")},{value:us.OpDiv,label:oe.t("rotation_tab.apl.operators.divide")}]})}}("op"),Zx("rhs")]}),max:Jx({label:oe.t("rotation_tab.apl.values.max.label"),submenu:["logic"],shortDescription:oe.t("rotation_tab.apl.values.max.tooltip"),newValue:rs.create,fields:[Kx("vals")]}),min:Jx({label:oe.t("rotation_tab.apl.values.min.label"),submenu:["logic"],shortDescription:oe.t("rotation_tab.apl.values.min.tooltip"),newValue:ns.create,fields:[Kx("vals")]}),and:Jx({label:oe.t("rotation_tab.apl.values.all_of.label"),submenu:["logic"],shortDescription:oe.t("rotation_tab.apl.values.all_of.tooltip"),newValue:os.create,fields:[Kx("vals")]}),or:Jx({label:oe.t("rotation_tab.apl.values.any_of.label"),submenu:["logic"],shortDescription:oe.t("rotation_tab.apl.values.any_of.tooltip"),newValue:ss.create,fields:[Kx("vals")]}),not:Jx({label:oe.t("rotation_tab.apl.values.not.label"),submenu:["logic"],shortDescription:oe.t("rotation_tab.apl.values.not.tooltip"),newValue:is.create,fields:[Zx("val")]}),currentTime:Jx({label:oe.t("rotation_tab.apl.values.current_time.label"),submenu:["encounter"],shortDescription:oe.t("rotation_tab.apl.values.current_time.tooltip"),newValue:as.create,fields:[]}),currentTimePercent:Jx({label:oe.t("rotation_tab.apl.values.current_time_percent.label"),submenu:["encounter"],shortDescription:oe.t("rotation_tab.apl.values.current_time_percent.tooltip"),newValue:ts.create,fields:[]}),remainingTime:Jx({label:oe.t("rotation_tab.apl.values.remaining_time.label"),submenu:["encounter"],shortDescription:oe.t("rotation_tab.apl.values.remaining_time.tooltip"),newValue:es.create,fields:[]}),remainingTimePercent:Jx({label:oe.t("rotation_tab.apl.values.remaining_time_percent.label"),submenu:["encounter"],shortDescription:oe.t("rotation_tab.apl.values.remaining_time_percent.tooltip"),newValue:Qi.create,fields:[]}),isExecutePhase:Jx({label:oe.t("rotation_tab.apl.values.is_execute_phase.label"),submenu:["encounter"],shortDescription:oe.t("rotation_tab.apl.values.is_execute_phase.tooltip"),newValue:Ji.create,fields:[function(e){return{field:e,newValue:()=>As.E20,factory:(e,t,a)=>new Cc(e,t,{id:da(),...a,defaultLabel:oe.t("common.none"),equals:(e,t)=>e==t,values:[{value:As.E20,label:oe.t("rotation_tab.apl.execute_phases.e20")},{value:As.E25,label:oe.t("rotation_tab.apl.execute_phases.e25")},{value:As.E35,label:oe.t("rotation_tab.apl.execute_phases.e35")},{value:As.E45,label:oe.t("rotation_tab.apl.execute_phases.e45")},{value:As.E90,label:oe.t("rotation_tab.apl.execute_phases.e90")}]})}}("threshold")]}),numberTargets:Jx({label:oe.t("rotation_tab.apl.values.num_targets.label"),submenu:["encounter"],shortDescription:oe.t("rotation_tab.apl.values.num_targets.tooltip"),newValue:Ki.create,fields:[]}),frontOfTarget:Jx({label:oe.t("rotation_tab.apl.values.in_front_of_target.label"),submenu:["encounter"],shortDescription:oe.t("rotation_tab.apl.values.in_front_of_target.tooltip"),newValue:Zi.create,fields:[]}),bossSpellIsCasting:Jx({label:oe.t("rotation_tab.apl.values.spell_is_casting.label"),submenu:["boss"],shortDescription:oe.t("rotation_tab.apl.values.spell_is_casting.tooltip"),newValue:$i.create,fields:[Ox("targetUnit","targets"),Nx("spellId","non_instant_spells","targetUnit","currentTarget")]}),bossSpellTimeToReady:Jx({label:oe.t("rotation_tab.apl.values.spell_time_to_ready.label"),submenu:["boss"],shortDescription:oe.t("rotation_tab.apl.values.spell_time_to_ready.tooltip"),newValue:Xi.create,fields:[Ox("targetUnit","targets"),Nx("spellId","spells","targetUnit","currentTarget")]}),bossCurrentTarget:Jx({label:oe.t("rotation_tab.apl.values.boss_current_target.label"),submenu:["boss"],shortDescription:oe.t("rotation_tab.apl.values.boss_current_target.tooltip"),newValue:qi.create,fields:[Ox("targetUnit","targets")]}),unitIsMoving:Jx({label:oe.t("rotation_tab.apl.values.unit_is_moving.label"),submenu:["unit"],shortDescription:oe.t("rotation_tab.apl.values.unit_is_moving.tooltip"),newValue:Yi.create,fields:[Ox("sourceUnit","aura_sources")]}),unitDistance:Jx({label:oe.t("rotation_tab.apl.values.distance_to_unit.label"),submenu:["unit"],shortDescription:oe.t("rotation_tab.apl.values.distance_to_unit.tooltip"),newValue:ji.create,fields:[Ox("sourceUnit","aura_sources")]}),currentHealth:Jx({label:oe.t("rotation_tab.apl.values.current_health.label"),submenu:["resources","health"],shortDescription:oe.t("rotation_tab.apl.values.current_health.tooltip"),newValue:Vi.create,fields:[Ox("sourceUnit","aura_sources")]}),currentHealthPercent:Jx({label:oe.t("rotation_tab.apl.values.current_health_percent.label"),submenu:["resources","health"],shortDescription:oe.t("rotation_tab.apl.values.current_health_percent.tooltip"),newValue:Wi.create,fields:[Ox("sourceUnit","aura_sources")]}),maxHealth:Jx({label:oe.t("rotation_tab.apl.values.max_health.label"),submenu:["resources","health"],shortDescription:oe.t("rotation_tab.apl.values.max_health.tooltip"),newValue:Bi.create,fields:[]}),currentMana:Jx({label:oe.t("rotation_tab.apl.values.current_mana.label"),submenu:["resources","mana"],shortDescription:oe.t("rotation_tab.apl.values.current_mana.tooltip"),newValue:Ui.create,includeIf(e,t){const a=e.getClass();return a!==q.ClassDeathKnight&&a!==q.ClassHunter&&a!==q.ClassRogue&&a!==q.ClassWarrior},fields:[]}),currentManaPercent:Jx({label:oe.t("rotation_tab.apl.values.current_mana_percent.label"),submenu:["resources","mana"],shortDescription:oe.t("rotation_tab.apl.values.current_mana_percent.tooltip"),newValue:Hi.create,includeIf(e,t){const a=e.getClass();return a!==q.ClassDeathKnight&&a!==q.ClassHunter&&a!==q.ClassRogue&&a!==q.ClassWarrior},fields:[]}),currentRage:Jx({label:oe.t("rotation_tab.apl.values.current_rage.label"),submenu:["resources","rage"],shortDescription:oe.t("rotation_tab.apl.values.current_rage.tooltip"),newValue:Fi.create,includeIf(e,t){const a=e.getClass(),i=e.getSpec();return i===K.SpecFeralDruid||i===K.SpecGuardianDruid||a===q.ClassWarrior},fields:[]}),maxRage:Jx({label:oe.t("rotation_tab.apl.values.max_rage.label"),submenu:["resources","rage"],shortDescription:oe.t("rotation_tab.apl.values.max_rage.tooltip"),newValue:zi.create,includeIf(e,t){const a=e.getClass(),i=e.getSpec();return i===K.SpecFeralDruid||i===K.SpecGuardianDruid||a===q.ClassWarrior},fields:[]}),currentFocus:Jx({label:oe.t("rotation_tab.apl.values.current_focus.label"),submenu:["resources","focus"],shortDescription:oe.t("rotation_tab.apl.values.current_focus.tooltip"),newValue:Gi.create,includeIf:(e,t)=>e.getClass()==q.ClassHunter,fields:[]}),maxFocus:Jx({label:oe.t("rotation_tab.apl.values.max_focus.label"),submenu:["resources","focus"],shortDescription:oe.t("rotation_tab.apl.values.max_focus.tooltip"),newValue:Oi.create,includeIf:(e,t)=>e.getClass()==q.ClassHunter,fields:[]}),focusRegenPerSecond:Jx({label:oe.t("rotation_tab.apl.values.focus_regen_per_second.label"),submenu:["resources","focus"],shortDescription:oe.t("rotation_tab.apl.values.focus_regen_per_second.tooltip"),newValue:Ni.create,includeIf:(e,t)=>e.getClass()==q.ClassHunter,fields:[]}),focusTimeToTarget:Jx({label:oe.t("rotation_tab.apl.values.estimated_time_to_target_focus.label"),submenu:["resources","focus"],shortDescription:oe.t("rotation_tab.apl.values.estimated_time_to_target_focus.tooltip"),newValue:Li.create,includeIf:(e,t)=>e.getClass()==q.ClassHunter,fields:[Zx("targetFocus")]}),currentEnergy:Jx({label:oe.t("rotation_tab.apl.values.current_energy.label"),submenu:["resources","energy"],shortDescription:oe.t("rotation_tab.apl.values.current_energy.tooltip"),newValue:Mi.create,includeIf(e,t){const a=e.getClass(),i=e.getSpec();return i===K.SpecFeralDruid||i===K.SpecGuardianDruid||a===q.ClassRogue||a===q.ClassMonk},fields:[]}),maxEnergy:Jx({label:oe.t("rotation_tab.apl.values.max_energy.label"),submenu:["resources","energy"],shortDescription:oe.t("rotation_tab.apl.values.max_energy.tooltip"),newValue:Di.create,includeIf(e,t){const a=e.getClass(),i=e.getSpec();return i===K.SpecFeralDruid||i===K.SpecGuardianDruid||a===q.ClassRogue||a===q.ClassMonk},fields:[]}),energyRegenPerSecond:Jx({label:oe.t("rotation_tab.apl.values.energy_regen_per_second.label"),submenu:["resources","energy"],shortDescription:oe.t("rotation_tab.apl.values.energy_regen_per_second.tooltip"),newValue:Ri.create,includeIf(e,t){const a=e.getClass(),i=e.getSpec();return i===K.SpecFeralDruid||i===K.SpecGuardianDruid||a===q.ClassRogue||a===q.ClassMonk},fields:[]}),energyTimeToTarget:Jx({label:oe.t("rotation_tab.apl.values.estimated_time_to_target_energy.label"),submenu:["resources","energy"],shortDescription:oe.t("rotation_tab.apl.values.estimated_time_to_target_energy.tooltip"),newValue:Pi.create,includeIf(e,t){const a=e.getClass(),i=e.getSpec();return i===K.SpecFeralDruid||i===K.SpecGuardianDruid||a===q.ClassRogue||a===q.ClassMonk},fields:[Zx("targetEnergy")]}),currentComboPoints:Jx({label:oe.t("rotation_tab.apl.values.current_combo_points.label"),submenu:["resources","combo_points"],shortDescription:oe.t("rotation_tab.apl.values.current_combo_points.tooltip"),newValue:Ai.create,includeIf(e,t){const a=e.getClass(),i=e.getSpec();return i===K.SpecFeralDruid||i===K.SpecGuardianDruid||a===q.ClassRogue},fields:[]}),maxComboPoints:Jx({label:oe.t("rotation_tab.apl.values.max_combo_points.label"),submenu:["resources","combo_points"],shortDescription:oe.t("rotation_tab.apl.values.max_combo_points.tooltip"),newValue:Ti.create,includeIf(e,t){const a=e.getClass(),i=e.getSpec();return i===K.SpecFeralDruid||i===K.SpecGuardianDruid||a===q.ClassRogue},fields:[]}),monkCurrentChi:Jx({label:oe.t("rotation_tab.apl.values.current_chi.label"),submenu:["resources","chi"],shortDescription:oe.t("rotation_tab.apl.values.current_chi.tooltip"),newValue:_a.create,includeIf:(e,t)=>e.getClass()===q.ClassMonk,fields:[]}),monkMaxChi:Jx({label:oe.t("rotation_tab.apl.values.max_chi.label"),submenu:["resources","chi"],shortDescription:oe.t("rotation_tab.apl.values.max_chi.tooltip"),newValue:Ei.create,includeIf:(e,t)=>e.getClass()===q.ClassMonk,fields:[]}),currentRunicPower:Jx({label:oe.t("rotation_tab.apl.values.current_runic_power.label"),submenu:["resources","runic_power"],shortDescription:oe.t("rotation_tab.apl.values.current_runic_power.tooltip"),newValue:Ii.create,includeIf:(e,t)=>e.getClass()==q.ClassDeathKnight,fields:[]}),maxRunicPower:Jx({label:oe.t("rotation_tab.apl.values.max_runic_power.label"),submenu:["resources","runic_power"],shortDescription:oe.t("rotation_tab.apl.values.max_runic_power.tooltip"),newValue:Ci.create,includeIf:(e,t)=>e.getClass()==q.ClassDeathKnight,fields:[]}),currentSolarEnergy:Jx({label:oe.t("rotation_tab.apl.values.solar_energy.label"),submenu:["resources","eclipse"],shortDescription:oe.t("rotation_tab.apl.values.solar_energy.tooltip"),newValue:ki.create,includeIf:(e,t)=>e.getSpec()==K.SpecBalanceDruid,fields:[]}),currentLunarEnergy:Jx({label:oe.t("rotation_tab.apl.values.lunar_energy.label"),submenu:["resources","eclipse"],shortDescription:oe.t("rotation_tab.apl.values.lunar_energy.tooltip"),newValue:_i.create,includeIf:(e,t)=>e.getSpec()==K.SpecBalanceDruid,fields:[]}),druidCurrentEclipsePhase:Jx({label:oe.t("rotation_tab.apl.values.current_eclipse_phase.label"),submenu:["resources","eclipse"],shortDescription:oe.t("rotation_tab.apl.values.current_eclipse_phase.tooltip"),newValue:Si.create,includeIf:(e,t)=>e.getSpec()==K.SpecBalanceDruid,fields:[function(e){const t=[{value:fa.LunarPhase,label:oe.t("rotation_tab.apl.helpers.eclipse_types.lunar")},{value:fa.SolarPhase,label:oe.t("rotation_tab.apl.helpers.eclipse_types.solar")},{value:fa.NeutralPhase,label:oe.t("rotation_tab.apl.helpers.eclipse_types.neutral")}];return{field:e,newValue:()=>ga.RuneBlood,factory:(e,a,i)=>new Cc(e,a,{id:da(),...i,defaultLabel:oe.t("rotation_tab.apl.helpers.eclipse_types.lunar"),equals:(e,t)=>e==t,values:t})}}("eclipsePhase")]}),currentGenericResource:Jx({label:oe.t("rotation_tab.apl.values.generic_resource.label"),submenu:["resources"],shortDescription:oe.t("rotation_tab.apl.values.generic_resource.tooltip"),newValue:xi.create,includeIf:(e,t)=>dl.hasSecondaryResource(e.getSpec()),fields:[],dynamicStringResolver:(e,t)=>t.secondaryResource?.replaceResourceName(e)||""}),currentRuneCount:Jx({label:oe.t("rotation_tab.apl.values.num_runes.label"),submenu:["resources","runes"],shortDescription:oe.t("rotation_tab.apl.values.num_runes.tooltip"),newValue:vi.create,includeIf:(e,t)=>e.getClass()==q.ClassDeathKnight,fields:[Ux("runeType",!0)]}),currentNonDeathRuneCount:Jx({label:oe.t("rotation_tab.apl.values.num_non_death_runes.label"),submenu:["resources","runes"],shortDescription:oe.t("rotation_tab.apl.values.num_non_death_runes.tooltip"),newValue:wi.create,includeIf:(e,t)=>e.getClass()==q.ClassDeathKnight,fields:[Ux("runeType",!1)]}),currentRuneActive:Jx({label:oe.t("rotation_tab.apl.values.rune_is_ready.label"),submenu:["resources","runes"],shortDescription:oe.t("rotation_tab.apl.values.rune_is_ready.tooltip"),newValue:yi.create,includeIf:(e,t)=>e.getClass()==q.ClassDeathKnight,fields:[Bx("runeSlot")]}),currentRuneDeath:Jx({label:oe.t("rotation_tab.apl.values.rune_is_death.label"),submenu:["resources","runes"],shortDescription:oe.t("rotation_tab.apl.values.rune_is_death.tooltip"),newValue:bi.create,includeIf:(e,t)=>e.getClass()==q.ClassDeathKnight,fields:[Bx("runeSlot")]}),runeCooldown:Jx({label:oe.t("rotation_tab.apl.values.rune_cooldown.label"),submenu:["resources","runes"],shortDescription:oe.t("rotation_tab.apl.values.rune_cooldown.tooltip"),newValue:fi.create,includeIf:(e,t)=>e.getClass()==q.ClassDeathKnight,fields:[Ux("runeType",!1)]}),nextRuneCooldown:Jx({label:oe.t("rotation_tab.apl.values.next_rune_cooldown.label"),submenu:["resources","runes"],shortDescription:oe.t("rotation_tab.apl.values.next_rune_cooldown.tooltip"),newValue:gi.create,includeIf:(e,t)=>e.getClass()==q.ClassDeathKnight,fields:[Ux("runeType",!1)]}),runeSlotCooldown:Jx({label:oe.t("rotation_tab.apl.values.rune_slot_cooldown.label"),submenu:["resources","runes"],shortDescription:oe.t("rotation_tab.apl.values.rune_slot_cooldown.tooltip"),newValue:mi.create,includeIf:(e,t)=>e.getClass()==q.ClassDeathKnight,fields:[Bx("runeSlot")]}),fullRuneCooldown:Jx({label:oe.t("rotation_tab.apl.values.full_rune_cooldown.label"),submenu:["resources","runes"],shortDescription:oe.t("rotation_tab.apl.values.full_rune_cooldown.tooltip"),newValue:pi.create,includeIf:(e,t)=>e.getClass()==q.ClassDeathKnight,fields:[Gx("useBaseValue","Use base value",{labelTooltip:"If checked, will return your base (unmodified by procs/lust etc) rune regen rate"})]}),gcdIsReady:Jx({label:oe.t("rotation_tab.apl.values.gcd_is_ready.label"),submenu:["gcd"],shortDescription:oe.t("rotation_tab.apl.values.gcd_is_ready.tooltip"),newValue:ui.create,fields:[]}),gcdTimeToReady:Jx({label:oe.t("rotation_tab.apl.values.gcd_time_to_ready.label"),submenu:["gcd"],shortDescription:oe.t("rotation_tab.apl.values.gcd_time_to_ready.tooltip"),newValue:di.create,fields:[]}),autoTimeToNext:Jx({label:oe.t("rotation_tab.apl.values.time_to_next_auto.label"),submenu:["auto"],shortDescription:oe.t("rotation_tab.apl.values.time_to_next_auto.tooltip"),newValue:hi.create,includeIf(e,t){const a=e.getClass(),i=e.getSpec();return a!==q.ClassHunter&&a!==q.ClassMage&&a!==q.ClassPriest&&a!==q.ClassWarlock&&i!==K.SpecBalanceDruid&&i!==K.SpecElementalShaman},fields:[]}),spellIsKnown:Jx({label:oe.t("rotation_tab.apl.values.spell_known.label"),submenu:["spell"],shortDescription:oe.t("rotation_tab.apl.values.spell_known.tooltip"),newValue:ci.create,fields:[Nx("spellId","castable_spells","")]}),spellCurrentCost:Jx({label:oe.t("rotation_tab.apl.values.current_cost.label"),submenu:["spell"],shortDescription:oe.t("rotation_tab.apl.values.current_cost.tooltip"),newValue:li.create,fields:[Nx("spellId","castable_spells","")]}),spellCanCast:Jx({label:oe.t("rotation_tab.apl.values.can_cast.label"),submenu:["spell"],shortDescription:oe.t("rotation_tab.apl.values.can_cast.tooltip"),fullDescription:oe.t("rotation_tab.apl.values.can_cast.full_description"),newValue:ri.create,fields:[Nx("spellId","castable_spells","")]}),spellIsReady:Jx({label:oe.t("rotation_tab.apl.values.is_ready.label"),submenu:["spell"],shortDescription:oe.t("rotation_tab.apl.values.is_ready.tooltip"),newValue:ni.create,fields:[Nx("spellId","castable_spells","")]}),spellTimeToReady:Jx({label:oe.t("rotation_tab.apl.values.time_to_ready.label"),submenu:["spell"],shortDescription:oe.t("rotation_tab.apl.values.time_to_ready.tooltip"),newValue:oi.create,fields:[Nx("spellId","castable_spells","")]}),spellCastTime:Jx({label:oe.t("rotation_tab.apl.values.cast_time.label"),submenu:["spell"],shortDescription:oe.t("rotation_tab.apl.values.cast_time.tooltip"),newValue:si.create,fields:[Nx("spellId","castable_spells","")]}),spellTravelTime:Jx({label:oe.t("rotation_tab.apl.values.travel_time.label"),submenu:["spell"],shortDescription:oe.t("rotation_tab.apl.values.travel_time.tooltip"),newValue:ii.create,fields:[Nx("spellId","castable_spells","")]}),spellCpm:Jx({label:oe.t("rotation_tab.apl.values.cpm.label"),submenu:["spell"],shortDescription:oe.t("rotation_tab.apl.values.cpm.tooltip"),newValue:ai.create,fields:[Nx("spellId","castable_spells","")]}),spellIsChanneling:Jx({label:oe.t("rotation_tab.apl.values.is_channeling.label"),submenu:["spell"],shortDescription:oe.t("rotation_tab.apl.values.is_channeling.tooltip"),newValue:ti.create,fields:[Nx("spellId","channel_spells","")]}),spellChanneledTicks:Jx({label:oe.t("rotation_tab.apl.values.channeled_ticks.label"),submenu:["spell"],shortDescription:oe.t("rotation_tab.apl.values.channeled_ticks.tooltip"),newValue:ei.create,fields:[Nx("spellId","channel_spells","")]}),spellNumCharges:Jx({label:oe.t("rotation_tab.apl.values.number_of_charges.label"),submenu:["spell"],shortDescription:oe.t("rotation_tab.apl.values.number_of_charges.tooltip"),newValue:Qa.create,fields:[Nx("spellId","castable_spells","")]}),spellTimeToCharge:Jx({label:oe.t("rotation_tab.apl.values.time_to_next_charge.label"),submenu:["spell"],shortDescription:oe.t("rotation_tab.apl.values.time_to_next_charge.tooltip"),newValue:Ja.create,fields:[Nx("spellId","castable_spells","")]}),spellGcdHastedDuration:Jx({label:oe.t("rotation_tab.apl.values.gcd_hasted_duration.label"),submenu:["spell"],shortDescription:oe.t("rotation_tab.apl.values.gcd_hasted_duration.tooltip"),newValue:Ka.create,fields:[Nx("spellId","castable_spells","")]}),spellFullCooldown:Jx({label:oe.t("rotation_tab.apl.values.full_cooldown.label"),submenu:["spell"],shortDescription:oe.t("rotation_tab.apl.values.full_cooldown.tooltip"),newValue:Za.create,fields:[Nx("spellId","castable_spells","")]}),channelClipDelay:Jx({label:oe.t("rotation_tab.apl.values.channel_clip_delay.label"),submenu:["spell"],shortDescription:oe.t("rotation_tab.apl.values.channel_clip_delay.tooltip"),newValue:$a.create,fields:[]}),inputDelay:Jx({label:oe.t("rotation_tab.apl.values.input_delay.label"),submenu:["spell"],shortDescription:oe.t("rotation_tab.apl.values.input_delay.tooltip"),newValue:Xa.create,fields:[]}),spellInFlight:Jx({label:oe.t("rotation_tab.apl.values.spell_in_flight.label"),submenu:["spell"],shortDescription:oe.t("rotation_tab.apl.values.spell_in_flight.tooltip"),newValue:qa.create,fields:[Nx("spellId","spells_with_travelTime","")]}),auraIsKnown:Jx({label:oe.t("rotation_tab.apl.values.aura_known.label"),submenu:["aura"],shortDescription:oe.t("rotation_tab.apl.values.aura_known.tooltip"),newValue:Ya.create,fields:[Ox("sourceUnit","aura_sources"),Nx("auraId","auras","sourceUnit")]}),auraIsActive:Jx({label:oe.t("rotation_tab.apl.values.aura_active.label"),submenu:["aura"],shortDescription:oe.t("rotation_tab.apl.values.aura_active.tooltip"),newValue:()=>Es.create({includeReactionTime:!0}),fields:[Ox("sourceUnit","aura_sources"),Nx("auraId","auras","sourceUnit"),Yx()]}),auraIsActiveWithReactionTime:Jx({label:oe.t("rotation_tab.apl.values.aura_active_with_reaction_time.label"),submenu:["aura"],shortDescription:oe.t("rotation_tab.apl.values.aura_active_with_reaction_time.tooltip"),newValue:()=>Es.create({includeReactionTime:!0}),fields:[Ox("sourceUnit","aura_sources"),Nx("auraId","auras","sourceUnit")]}),auraIsInactive:Jx({label:oe.t("rotation_tab.apl.values.aura_inactive.label"),submenu:["aura"],shortDescription:oe.t("rotation_tab.apl.values.aura_inactive.tooltip"),newValue:()=>Is.create({includeReactionTime:!0}),fields:[Ox("sourceUnit","aura_sources"),Nx("auraId","auras","sourceUnit"),Yx()]}),auraIsInactiveWithReactionTime:Jx({label:oe.t("rotation_tab.apl.values.aura_inactive_with_reaction_time.label"),submenu:["aura"],shortDescription:oe.t("rotation_tab.apl.values.aura_inactive_with_reaction_time.tooltip"),newValue:()=>Is.create({includeReactionTime:!0}),fields:[Ox("sourceUnit","aura_sources"),Nx("auraId","auras","sourceUnit")]}),auraRemainingTime:Jx({label:oe.t("rotation_tab.apl.values.aura_remaining_time.label"),submenu:["aura"],shortDescription:oe.t("rotation_tab.apl.values.aura_remaining_time.tooltip"),newValue:ja.create,fields:[Ox("sourceUnit","aura_sources"),Nx("auraId","auras","sourceUnit")]}),auraNumStacks:Jx({label:oe.t("rotation_tab.apl.values.aura_num_stacks.label"),submenu:["aura"],shortDescription:oe.t("rotation_tab.apl.values.aura_num_stacks.tooltip"),newValue:()=>Cs.create({includeReactionTime:!0}),fields:[Ox("sourceUnit","aura_sources"),Nx("auraId","stackable_auras","sourceUnit"),Yx()]}),auraInternalCooldown:Jx({label:oe.t("rotation_tab.apl.values.aura_remaining_icd.label"),submenu:["aura"],shortDescription:oe.t("rotation_tab.apl.values.aura_remaining_icd.tooltip"),newValue:Va.create,fields:[Ox("sourceUnit","aura_sources"),Nx("auraId","icd_auras","sourceUnit")]}),auraIcdIsReady:Jx({label:oe.t("rotation_tab.apl.values.aura_icd_is_ready.label"),submenu:["aura"],shortDescription:oe.t("rotation_tab.apl.values.aura_icd_is_ready.tooltip"),newValue:()=>ks.create({includeReactionTime:!0}),fields:[Ox("sourceUnit","aura_sources"),Nx("auraId","icd_auras","sourceUnit"),Yx()]}),auraIcdIsReadyWithReactionTime:Jx({label:oe.t("rotation_tab.apl.values.aura_icd_is_ready_with_reaction_time.label"),submenu:["aura"],shortDescription:oe.t("rotation_tab.apl.values.aura_icd_is_ready_with_reaction_time.tooltip"),newValue:()=>ks.create({includeReactionTime:!0}),fields:[Ox("sourceUnit","aura_sources"),Nx("auraId","icd_auras","sourceUnit")]}),auraShouldRefresh:Jx({label:oe.t("rotation_tab.apl.values.aura_should_refresh.label"),submenu:["aura"],shortDescription:oe.t("rotation_tab.apl.values.aura_should_refresh.tooltip"),fullDescription:oe.t("rotation_tab.apl.values.aura_should_refresh.full_description"),newValue:()=>_s.create({maxOverlap:{value:{oneofKind:"const",const:{val:"0ms"}}}}),fields:[Ox("sourceUnit","aura_sources_targets_first"),Nx("auraId","exclusive_effect_auras","sourceUnit","currentTarget"),Zx("maxOverlap",{label:oe.t("rotation_tab.apl.values.overlap.label"),labelTooltip:oe.t("rotation_tab.apl.values.overlap.tooltip")})]}),allTrinketStatProcsActive:Jx({label:oe.t("rotation_tab.apl.values.all_trinket_stat_procs_active.label"),submenu:["aura_sets"],shortDescription:oe.t("rotation_tab.apl.values.all_trinket_stat_procs_active.tooltip"),fullDescription:oe.t("rotation_tab.apl.values.all_trinket_stat_procs_active.full_description"),newValue:()=>Ss.create({statType1:-1,statType2:-1,statType3:-1}),fields:[Wx("statType1"),Wx("statType2"),Wx("statType3"),Vx]}),anyTrinketStatProcsActive:Jx({label:oe.t("rotation_tab.apl.values.any_trinket_stat_procs_active.label"),submenu:["aura_sets"],shortDescription:oe.t("rotation_tab.apl.values.any_trinket_stat_procs_active.tooltip"),fullDescription:oe.t("rotation_tab.apl.values.any_trinket_stat_procs_active.full_description"),newValue:()=>xs.create({statType1:-1,statType2:-1,statType3:-1}),fields:[Wx("statType1"),Wx("statType2"),Wx("statType3"),Vx]}),anyTrinketStatProcsAvailable:Jx({label:oe.t("rotation_tab.apl.values.any_trinket_stat_procs_available.label"),submenu:["aura_sets"],shortDescription:oe.t("rotation_tab.apl.values.any_trinket_stat_procs_available.tooltip"),fullDescription:oe.t("rotation_tab.apl.values.any_trinket_stat_procs_available.full_description"),newValue:()=>vs.create({statType1:-1,statType2:-1,statType3:-1}),fields:[Wx("statType1"),Wx("statType2"),Wx("statType3"),Vx]}),trinketProcsMinRemainingTime:Jx({label:oe.t("rotation_tab.apl.values.trinket_procs_min_remaining_time.label"),submenu:["aura_sets"],shortDescription:oe.t("rotation_tab.apl.values.trinket_procs_min_remaining_time.tooltip"),newValue:()=>ws.create({statType1:-1,statType2:-1,statType3:-1}),fields:[Wx("statType1"),Wx("statType2"),Wx("statType3"),Vx]}),trinketProcsMaxRemainingIcd:Jx({label:oe.t("rotation_tab.apl.values.trinket_procs_max_remaining_icd.label"),submenu:["aura_sets"],shortDescription:oe.t("rotation_tab.apl.values.trinket_procs_max_remaining_icd.tooltip"),newValue:()=>ys.create({statType1:-1,statType2:-1,statType3:-1}),fields:[Wx("statType1"),Wx("statType2"),Wx("statType3"),Vx]}),numEquippedStatProcTrinkets:Jx({label:oe.t("rotation_tab.apl.values.num_equipped_stat_proc_trinkets.label"),submenu:["aura_sets"],shortDescription:oe.t("rotation_tab.apl.values.num_equipped_stat_proc_trinkets.tooltip"),newValue:()=>bs.create({statType1:-1,statType2:-1,statType3:-1}),fields:[Wx("statType1"),Wx("statType2"),Wx("statType3"),Vx]}),numStatBuffCooldowns:Jx({label:oe.t("rotation_tab.apl.values.num_stat_buff_cooldowns.label"),submenu:["aura_sets"],shortDescription:oe.t("rotation_tab.apl.values.num_stat_buff_cooldowns.tooltip"),fullDescription:oe.t("rotation_tab.apl.values.num_stat_buff_cooldowns.full_description"),newValue:()=>fs.create({statType1:-1,statType2:-1,statType3:-1}),fields:[Wx("statType1"),Wx("statType2"),Wx("statType3")]}),anyStatBuffCooldownsActive:Jx({label:oe.t("rotation_tab.apl.values.any_stat_buff_cooldowns_active.label"),submenu:["aura_sets"],shortDescription:oe.t("rotation_tab.apl.values.any_stat_buff_cooldowns_active.tooltip"),fullDescription:oe.t("rotation_tab.apl.values.any_stat_buff_cooldowns_active.full_description"),newValue:()=>gs.create({statType1:-1,statType2:-1,statType3:-1}),fields:[Wx("statType1"),Wx("statType2"),Wx("statType3")]}),anyStatBuffCooldownsMinDuration:Jx({label:oe.t("rotation_tab.apl.values.any_stat_buff_cooldowns_min_duration.label"),submenu:["aura_sets"],shortDescription:oe.t("rotation_tab.apl.values.any_stat_buff_cooldowns_min_duration.tooltip"),fullDescription:oe.t("rotation_tab.apl.values.any_stat_buff_cooldowns_min_duration.full_description"),newValue:()=>ms.create({statType1:-1,statType2:-1,statType3:-1}),fields:[Wx("statType1"),Wx("statType2"),Wx("statType3")]}),dotIsActive:Jx({label:oe.t("rotation_tab.apl.values.dot_is_active.label"),submenu:["dot"],shortDescription:oe.t("rotation_tab.apl.values.dot_is_active.tooltip"),newValue:Wa.create,fields:[Ox("targetUnit","targets"),Nx("spellId","dot_spells","")]}),dotIsActiveOnAllTargets:Jx({label:oe.t("rotation_tab.apl.values.dot_is_active_on_all_targets.label"),submenu:["dot"],shortDescription:oe.t("rotation_tab.apl.values.dot_is_active_on_all_targets.tooltip"),newValue:Ba.create,fields:[Nx("spellId","dot_spells")]}),dotRemainingTime:Jx({label:oe.t("rotation_tab.apl.values.dot_remaining_time.label"),submenu:["dot"],shortDescription:oe.t("rotation_tab.apl.values.dot_remaining_time.tooltip"),newValue:Ua.create,fields:[Ox("targetUnit","targets"),Nx("spellId","dot_spells","")]}),dotLowestRemainingTime:Jx({label:oe.t("rotation_tab.apl.values.dot_lowest_remaining_time.label"),submenu:["dot"],shortDescription:oe.t("rotation_tab.apl.values.dot_lowest_remaining_time.tooltip"),newValue:Ha.create,fields:[Nx("spellId","dot_spells","")]}),dotTickFrequency:Jx({label:oe.t("rotation_tab.apl.values.dot_tick_frequency.label"),submenu:["dot"],shortDescription:oe.t("rotation_tab.apl.values.dot_tick_frequency.tooltip"),newValue:Fa.create,fields:[Ox("targetUnit","targets"),Nx("spellId","dot_spells","")]}),dotTimeToNextTick:Jx({label:oe.t("rotation_tab.apl.values.dot_time_to_next_tick.label"),submenu:["dot"],shortDescription:oe.t("rotation_tab.apl.values.dot_time_to_next_tick.tooltip"),newValue:za.create,fields:[Ox("targetUnit","targets"),Nx("spellId","dot_spells","")]}),dotBaseDuration:Jx({label:"Dot Base Duration",submenu:["dot"],shortDescription:"The base duration of the DoT.",newValue:Ga.create,fields:[Nx("spellId","dot_spells","")]}),dotPercentIncrease:Jx({label:oe.t("rotation_tab.apl.values.dot_percent_increase.label"),submenu:["dot"],shortDescription:oe.t("rotation_tab.apl.values.dot_percent_increase.tooltip"),newValue:Oa.create,fields:[Ox("targetUnit","targets"),Nx("spellId","expected_dot_spells",""),qx()]}),dotCritPercentIncrease:Jx({label:"Dot Crit Chance Increase %",submenu:["dot"],shortDescription:"How much higher a new DoT's Critical Strike Chance would be compared to the old.",newValue:Oa.create,fields:[Ox("targetUnit","targets"),Nx("spellId","expected_dot_spells",""),qx()]}),dotTickRatePercentIncrease:Jx({label:"Dot Tick Rate Increase %",submenu:["dot"],shortDescription:"How much faster a new DoT would tick compared to the old.",newValue:Oa.create,fields:[Ox("targetUnit","targets"),Nx("spellId","expected_dot_spells",""),qx()]}),sequenceIsComplete:Jx({label:oe.t("rotation_tab.apl.values.sequence_is_complete.label"),submenu:["sequence"],shortDescription:oe.t("rotation_tab.apl.values.sequence_is_complete.tooltip"),newValue:Na.create,fields:[Fx("sequenceName")]}),sequenceIsReady:Jx({label:oe.t("rotation_tab.apl.values.sequence_is_ready.label"),submenu:["sequence"],shortDescription:oe.t("rotation_tab.apl.values.sequence_is_ready.tooltip"),newValue:La.create,fields:[Fx("sequenceName")]}),sequenceTimeToReady:Jx({label:oe.t("rotation_tab.apl.values.sequence_time_to_ready.label"),submenu:["sequence"],shortDescription:oe.t("rotation_tab.apl.values.sequence_time_to_ready.tooltip"),newValue:Ma.create,fields:[Fx("sequenceName")]}),totemRemainingTime:Jx({label:oe.t("rotation_tab.apl.values.totem_remaining_time.label"),submenu:["shaman"],shortDescription:oe.t("rotation_tab.apl.values.totem_remaining_time.tooltip"),newValue:Da.create,includeIf:(e,t)=>e.getClass()==q.ClassShaman,fields:[function(e){return{field:e,newValue:()=>Ts.Water,factory:(e,t,a)=>new Cc(e,t,{id:da(),...a,defaultLabel:oe.t("common.none"),equals:(e,t)=>e==t,values:[{value:Ts.Earth,label:oe.t("rotation_tab.apl.totem_types.earth")},{value:Ts.Air,label:oe.t("rotation_tab.apl.totem_types.air")},{value:Ts.Fire,label:oe.t("rotation_tab.apl.totem_types.fire")},{value:Ts.Water,label:oe.t("rotation_tab.apl.totem_types.water")}]})}}("totemType")]}),shamanFireElementalDuration:Jx({label:oe.t("rotation_tab.apl.values.shaman_fire_elemental_duration.label"),submenu:["shaman"],shortDescription:oe.t("rotation_tab.apl.values.shaman_fire_elemental_duration.tooltip"),newValue:Ra.create,includeIf:(e,t)=>e.getClass()==q.ClassShaman,fields:[]}),catExcessEnergy:Jx({label:oe.t("rotation_tab.apl.values.cat_excess_energy.label"),submenu:["feral_druid"],shortDescription:oe.t("rotation_tab.apl.values.cat_excess_energy.tooltip"),newValue:Pa.create,includeIf:(e,t)=>e.getSpec()==K.SpecFeralDruid,fields:[]}),catNewSavageRoarDuration:Jx({label:oe.t("rotation_tab.apl.values.cat_new_savage_roar_duration.label"),submenu:["feral_druid"],shortDescription:oe.t("rotation_tab.apl.values.cat_new_savage_roar_duration.tooltip"),newValue:Aa.create,includeIf:(e,t)=>e.getSpec()==K.SpecFeralDruid,fields:[]}),warlockHandOfGuldanInFlight:Jx({label:oe.t("rotation_tab.apl.values.warlock_hand_of_guldan_in_flight.label"),submenu:["warlock"],shortDescription:oe.t("rotation_tab.apl.values.warlock_hand_of_guldan_in_flight.tooltip"),newValue:Ta.create,includeIf:(e,t)=>e.getSpec()==K.SpecDemonologyWarlock,fields:[]}),warlockHauntInFlight:Jx({label:oe.t("rotation_tab.apl.values.warlock_haunt_in_flight.label"),submenu:["warlock"],shortDescription:oe.t("rotation_tab.apl.values.warlock_haunt_in_flight.tooltip"),newValue:Ea.create,includeIf:(e,t)=>e.getSpec()==K.SpecAfflictionWarlock,fields:[]}),afflictionExhaleWindow:Jx({label:oe.t("rotation_tab.apl.values.affliction_exhale_window.label"),submenu:["warlock"],shortDescription:oe.t("rotation_tab.apl.values.affliction_exhale_window.tooltip"),newValue:Ia.create,includeIf:(e,t)=>e.getSpec()==K.SpecAfflictionWarlock,fields:[]}),afflictionCurrentSnapshot:Jx({label:oe.t("rotation_tab.apl.values.affliction_current_snapshot.label"),submenu:["warlock"],shortDescription:oe.t("rotation_tab.apl.values.affliction_current_snapshot.tooltip"),newValue:Ca.create,includeIf:(e,t)=>e.getSpec()==K.SpecAfflictionWarlock,fields:[Ox("targetUnit","targets"),Nx("spellId","expected_dot_spells","")]}),mageCurrentCombustionDotEstimate:Jx({label:oe.t("rotation_tab.apl.values.mage_current_combustion_dot_estimate.label"),submenu:["mage"],shortDescription:oe.t("rotation_tab.apl.values.mage_current_combustion_dot_estimate.tooltip"),newValue:ka.create,includeIf:(e,t)=>e.getSpec()==K.SpecFireMage,fields:[]}),brewmasterMonkCurrentStaggerPercent:Jx({label:oe.t("rotation_tab.apl.values.brewmaster_monk_current_stagger_percent.label"),submenu:["tank"],shortDescription:oe.t("rotation_tab.apl.values.brewmaster_monk_current_stagger_percent.tooltip"),newValue:_a.create,includeIf:(e,t)=>e.getSpec()===K.SpecBrewmasterMonk,fields:[]}),protectionPaladinDamageTakenLastGlobal:Jx({label:oe.t("rotation_tab.apl.values.protection_paladin_damage_taken_last_global.label"),submenu:["tank"],shortDescription:oe.t("rotation_tab.apl.values.protection_paladin_damage_taken_last_global.tooltip"),newValue:Sa.create,includeIf:(e,t)=>e.getSpec()===K.SpecProtectionPaladin,fields:[]}),variableRef:Jx({label:"Variable Reference",submenu:["Variables"],shortDescription:"Reference a named condition variable",newValue:()=>({name:""}),fields:[function(e){return{field:e,newValue:()=>"",factory:(e,t,a)=>{const i=new Cc(e,t,{id:da(),...a,defaultLabel:oe.t("rotation_tab.apl.helpers.select_variable"),equals:(e,t)=>e===t,values:[],changedEvent:e=>e.rotationChangeEmitter}),s=()=>{const e=(t.aplRotation?.valueVariables||[]).map(e=>({value:e.name,label:e.name}));0===e.length&&e.push({value:"",label:oe.t("rotation_tab.apl.helpers.no_variables_defined")}),i.setOptions(e)};return s(),t.rotationChangeEmitter.on(s),i}}}("name")]}),variablePlaceholder:Jx({label:"Variable Placeholder",submenu:["Variables"],shortDescription:"Placeholder value that gets replaced when group is referenced",fullDescription:'\n\t\t\t<p>Defines a placeholder value that must be set when this group is referenced. This allows groups to be parameterized.</p>\n\t\t\t<p>Example: If you add a Variable Placeholder named "replace", then when referencing this group, you must provide a value for "replace".</p>\n\t\t',includeIf:(e,t,a)=>!t&&a,newValue:()=>({name:""}),fields:[Fx("name",{labelTooltip:"Name of the variable placeholder to expose. This name will be used when referencing the group."})]}),activeItemSwapSet:Jx({label:"Item Swap",submenu:["Misc"],shortDescription:"Returns <b>True</b> if the specified item swap set is currently active.",includeIf:(e,t)=>ck.includes(e.getSpec()),newValue:xa.create,fields:[Xx("swapSet")]})};var eS;class tS extends nl{constructor(e,t,a){super(e,"apl-action-picker-root",t,a),this.conditionPicker=new $x(this.rootElem,this.modObject,{label:oe.t("rotation_tab.apl.priority_list.if_label"),changedEvent:e=>e.rotationChangeEmitter,getValue:e=>this.getSourceValue()?.condition,setValue:(e,t,a)=>{const i=this.getSourceValue();i?(i.condition=a,t.rotationChangeEmitter.emit(e)):this.setSourceValue(e,Os.create({condition:a}))}}),this.conditionPicker.rootElem.classList.add("apl-action-condition","apl-priority-list-only"),this.actionDiv=document.createElement("div"),this.actionDiv.classList.add("apl-action-picker-action"),this.rootElem.appendChild(this.actionDiv);const i=null!=this.rootElem.closest(".apl-prepull-action-picker"),s=Object.keys(sS).filter(e=>sS[e].includeIf?.(t,i)??!0);this.kindPicker=new Cc(this.actionDiv,t,{id:da(),defaultLabel:oe.t("rotation_tab.apl.priority_list.item_label"),values:s.map(e=>{const t=sS[e];return{value:e,label:t.label,submenu:t.submenu,tooltip:t.fullDescription?`<p>${t.shortDescription}</p> ${t.fullDescription}`:t.shortDescription}}),equals:(e,t)=>e==t,changedEvent:e=>e.rotationChangeEmitter,getValue:e=>this.getSourceValue()?.action.oneofKind,setValue:(e,t,a)=>{const i=this.getSourceValue(),s=i?.action.oneofKind;if(s!=a){if(a){const t=sS[a];let o=this.makeAPLAction(a,t.newValue());i&&s&&this.actionPicker&&("sequence"==a?"strictSequence"==i.action.oneofKind?o.action.sequence.actions=i.action.strictSequence.actions:o.action.sequence.actions=[this.makeAPLAction(s,this.actionPicker.getInputValue())]:"strictSequence"==a?"sequence"==i.action.oneofKind?o.action.strictSequence.actions=i.action.sequence.actions:o.action.strictSequence.actions=[this.makeAPLAction(s,this.actionPicker.getInputValue())]:"sequence"==i.action.oneofKind&&i.action.sequence.actions?.[0]?.action.oneofKind==a?o=i.action.sequence.actions[0]:"strictSequence"==i.action.oneofKind&&i.action.strictSequence.actions?.[0]?.action.oneofKind==a&&(o=i.action.strictSequence.actions[0])),i?i.action=o.action:this.setSourceValue(e,o)}else i.action={oneofKind:a};t.rotationChangeEmitter.emit(e)}}}),this.currentKind=void 0,this.actionPicker=null,this.init()}getInputElem(){return this.rootElem}getInputValue(){const e=this.kindPicker.getInputValue();return Os.create({condition:this.conditionPicker.getInputValue(),action:{oneofKind:e,...(()=>{const t={};return e&&this.actionPicker&&(t[e]=this.actionPicker.getInputValue()),t})()}})}setInputValue(e){if(!e)return;this.conditionPicker.setInputValue(e.condition||ds.create({uuid:{value:da()}}));const t=e.action.oneofKind;this.updateActionPicker(t),t&&this.actionPicker.setInputValue(e.action[t])}makeAPLAction(e,t){if(!e)return Os.create();const a={oneofKind:e};return a[e]=t,Os.create({action:a})}updateActionPicker(e){const t=this.currentKind;if(e==t)return;if(this.currentKind=e,this.actionPicker&&(this.actionPicker.rootElem.remove(),this.actionPicker=null),!e)return;this.kindPicker.setInputValue(e);const a=sS[e];this.actionPicker=a.factory(this.actionDiv,this.modObject,{changedEvent:e=>e.rotationChangeEmitter,getValue:()=>this.getSourceValue()?.action?.[e]||a.newValue(),setValue:(t,a,i)=>{const s=this.getSourceValue();s&&((s?.action)[e]=i),a.rotationChangeEmitter.emit(t)}}),this.actionPicker.rootElem.classList.add("apl-action-"+e)}}function aS(e){return{field:e,newValue:()=>[],factory:(e,t,a)=>new Ix(e,t,{...a,setValue:(e,t,i)=>{a.setValue(e,t,i.map(e=>e||Os.create()))},itemLabel:"action",newItem:Os.create,copyItem:e=>e?Os.clone(e):e,newItemPicker:(e,a,i,s)=>new tS(e,t,s),allowedActions:["create","delete","move"],actions:{create:{useIcon:!0}}})}}function iS(e){return{label:e.label,submenu:e.submenu,shortDescription:e.shortDescription,fullDescription:e.fullDescription,includeIf:e.includeIf,newValue:e.newValue,factory:jx(e.newValue,e.fields)}}const sS={castSpell:iS({label:oe.t("rotation_tab.apl.actions.cast.label"),shortDescription:oe.t("rotation_tab.apl.actions.cast.tooltip"),newValue:Ns.create,fields:[Nx("spellId","castable_spells",""),Ox("target","targets")]}),castFriendlySpell:iS({label:oe.t("rotation_tab.apl.actions.cast_at_player.label"),shortDescription:oe.t("rotation_tab.apl.actions.cast_at_player.tooltip"),newValue:Ls.create,fields:[Nx("spellId","friendly_spells",""),Ox("target","players")],includeIf:(e,t)=>e.getRaid().size()>1||e.shouldEnableTargetDummies()}),multidot:iS({label:oe.t("rotation_tab.apl.actions.multi_dot.label"),submenu:["casting"],shortDescription:oe.t("rotation_tab.apl.actions.multi_dot.tooltip"),includeIf:(e,t)=>!t,newValue:()=>so.create({maxDots:3,maxOverlap:{value:{oneofKind:"const",const:{val:"0ms"}}}}),fields:[Nx("spellId","castable_dot_spells",""),zx("maxDots",!1,{label:oe.t("rotation_tab.apl.actions.multi_dot.max_dots.label"),labelTooltip:oe.t("rotation_tab.apl.actions.multi_dot.max_dots.tooltip")}),Zx("maxOverlap",{label:oe.t("rotation_tab.apl.actions.multi_dot.overlap.label"),labelTooltip:oe.t("rotation_tab.apl.actions.multi_dot.overlap.tooltip")})]}),strictMultidot:iS({label:oe.t("rotation_tab.apl.actions.strict_multi_dot.label"),submenu:["casting"],shortDescription:oe.t("rotation_tab.apl.actions.strict_multi_dot.tooltip"),includeIf:(e,t)=>!t,newValue:()=>io.create({maxDots:3,maxOverlap:{value:{oneofKind:"const",const:{val:"0ms"}}}}),fields:[Nx("spellId","castable_dot_spells",""),zx("maxDots",!1,{label:oe.t("rotation_tab.apl.actions.strict_multi_dot.max_dots.label"),labelTooltip:oe.t("rotation_tab.apl.actions.strict_multi_dot.max_dots.tooltip")}),Zx("maxOverlap",{label:oe.t("rotation_tab.apl.actions.strict_multi_dot.overlap.label"),labelTooltip:oe.t("rotation_tab.apl.actions.strict_multi_dot.overlap.tooltip")})]}),multishield:iS({label:oe.t("rotation_tab.apl.actions.multi_shield.label"),submenu:["casting"],shortDescription:oe.t("rotation_tab.apl.actions.multi_shield.tooltip"),includeIf:(e,t)=>!t&&e.getSpec().isHealingSpec,newValue:()=>ao.create({maxShields:3,maxOverlap:{value:{oneofKind:"const",const:{val:"0ms"}}}}),fields:[Nx("spellId","shield_spells",""),zx("maxShields",!1,{label:oe.t("rotation_tab.apl.actions.multi_shield.max_shields.label"),labelTooltip:oe.t("rotation_tab.apl.actions.multi_shield.max_shields.tooltip")}),Zx("maxOverlap",{label:oe.t("rotation_tab.apl.actions.multi_shield.overlap.label"),labelTooltip:oe.t("rotation_tab.apl.actions.multi_shield.overlap.tooltip")})]}),channelSpell:iS({label:oe.t("rotation_tab.apl.actions.channel.label"),submenu:["casting"],shortDescription:oe.t("rotation_tab.apl.actions.channel.tooltip"),fullDescription:oe.t("rotation_tab.apl.actions.channel.full"),newValue:()=>to.create({interruptIf:{value:{oneofKind:"gcdIsReady",gcdIsReady:{}}}}),fields:[Nx("spellId","channel_spells",""),Ox("target","targets"),Zx("interruptIf",{label:oe.t("rotation_tab.apl.actions.channel.interrupt_if.label"),labelTooltip:oe.t("rotation_tab.apl.actions.channel.interrupt_if.tooltip")}),Gx("allowRecast",oe.t("rotation_tab.apl.actions.channel.recast.label"),{labelTooltip:oe.t("rotation_tab.apl.actions.channel.recast.tooltip")})]}),castAllStatBuffCooldowns:iS({label:oe.t("rotation_tab.apl.actions.cast_all_stat_buff_cooldowns.label"),submenu:["casting"],shortDescription:oe.t("rotation_tab.apl.actions.cast_all_stat_buff_cooldowns.tooltip"),fullDescription:oe.t("rotation_tab.apl.actions.cast_all_stat_buff_cooldowns.full"),newValue:()=>eo.create({statType1:-1,statType2:-1,statType3:-1}),fields:[Wx("statType1"),Wx("statType2"),Wx("statType3")]}),autocastOtherCooldowns:iS({label:oe.t("rotation_tab.apl.actions.autocast_other_cooldowns.label"),submenu:["casting"],shortDescription:oe.t("rotation_tab.apl.actions.autocast_other_cooldowns.tooltip"),fullDescription:oe.t("rotation_tab.apl.actions.autocast_other_cooldowns.full"),includeIf:(e,t)=>!t,newValue:Ms.create,fields:[]}),wait:iS({label:oe.t("rotation_tab.apl.actions.wait.label"),submenu:["timing"],shortDescription:oe.t("rotation_tab.apl.actions.wait.tooltip"),includeIf:(e,t)=>!t,newValue:()=>Qs.create({duration:{value:{oneofKind:"const",const:{val:"1000ms"}}}}),fields:[Zx("duration")]}),waitUntil:iS({label:oe.t("rotation_tab.apl.actions.wait_until.label"),submenu:["timing"],shortDescription:oe.t("rotation_tab.apl.actions.wait_until.tooltip"),includeIf:(e,t)=>!t,newValue:()=>Js.create(),fields:[Zx("condition")]}),schedule:iS({label:oe.t("rotation_tab.apl.actions.scheduled_action.label"),submenu:["timing"],shortDescription:oe.t("rotation_tab.apl.actions.scheduled_action.tooltip"),includeIf:(e,t)=>!t,newValue:()=>Ks.create({schedule:"0s, 60s",innerAction:{action:{oneofKind:"castSpell",castSpell:{}}}}),fields:[Fx("schedule",{label:oe.t("rotation_tab.apl.actions.scheduled_action.do_at.label"),labelTooltip:oe.t("rotation_tab.apl.actions.scheduled_action.do_at.tooltip")}),function(e){return{field:e,newValue:()=>ds.create({uuid:{value:da()}}),factory:(e,t,a)=>new tS(e,t,a)}}("innerAction")]}),sequence:iS({label:oe.t("rotation_tab.apl.actions.sequence.label"),submenu:["sequences"],shortDescription:oe.t("rotation_tab.apl.actions.sequence.tooltip"),fullDescription:oe.t("rotation_tab.apl.actions.sequence.full"),includeIf:(e,t)=>!t,newValue:Ds.create,fields:[Fx("name"),aS("actions")]}),resetSequence:iS({label:oe.t("rotation_tab.apl.actions.reset_sequence.label"),submenu:["sequences"],shortDescription:oe.t("rotation_tab.apl.actions.reset_sequence.tooltip"),fullDescription:oe.t("rotation_tab.apl.actions.reset_sequence.full"),includeIf:(e,t)=>!t,newValue:Rs.create,fields:[Fx("sequenceName")]}),strictSequence:iS({label:oe.t("rotation_tab.apl.actions.strict_sequence.label"),submenu:["sequences"],shortDescription:oe.t("rotation_tab.apl.actions.strict_sequence.tooltip"),fullDescription:oe.t("rotation_tab.apl.actions.strict_sequence.full"),includeIf:(e,t)=>!t,newValue:Ps.create,fields:[aS("actions")]}),changeTarget:iS({label:oe.t("rotation_tab.apl.actions.change_target.label"),submenu:["misc"],shortDescription:oe.t("rotation_tab.apl.actions.change_target.tooltip"),newValue:()=>Zs.create(),fields:[Ox("newTarget","targets")]}),activateAura:iS({label:oe.t("rotation_tab.apl.actions.activate_aura.label"),submenu:["misc"],shortDescription:oe.t("rotation_tab.apl.actions.activate_aura.tooltip"),includeIf:(e,t)=>t,newValue:()=>$s.create(),fields:[Nx("auraId","auras")]}),activateAuraWithStacks:iS({label:oe.t("rotation_tab.apl.actions.activate_aura_with_stacks.label"),submenu:["misc"],shortDescription:oe.t("rotation_tab.apl.actions.activate_aura_with_stacks.tooltip"),includeIf:(e,t)=>t,newValue:()=>Xs.create({numStacks:1}),fields:[Nx("auraId","stackable_auras"),zx("numStacks",!1,{label:oe.t("rotation_tab.apl.actions.activate_aura_with_stacks.stacks"),labelTooltip:oe.t("rotation_tab.apl.actions.activate_aura_with_stacks.stacks_tooltip")})]}),activateAllStatBuffProcAuras:iS({label:oe.t("rotation_tab.apl.actions.activate_all_stat_buff_proc_auras.label"),submenu:["misc"],shortDescription:oe.t("rotation_tab.apl.actions.activate_all_stat_buff_proc_auras.tooltip"),includeIf:(e,t)=>t,newValue:()=>qs.create({swapSet:ba.Main,statType1:-1,statType2:-1,statType3:-1}),fields:[Xx("swapSet"),Wx("statType1"),Wx("statType2"),Wx("statType3")]}),cancelAura:iS({label:oe.t("rotation_tab.apl.actions.cancel_aura.label"),submenu:["misc"],shortDescription:oe.t("rotation_tab.apl.actions.cancel_aura.tooltip"),newValue:()=>Ys.create(),fields:[Nx("auraId","auras")]}),triggerIcd:iS({label:oe.t("rotation_tab.apl.actions.trigger_icd.label"),submenu:["misc"],shortDescription:oe.t("rotation_tab.apl.actions.trigger_icd.tooltip"),includeIf:(e,t)=>t,newValue:()=>js.create(),fields:[Nx("auraId","icd_auras")]}),itemSwap:iS({label:oe.t("rotation_tab.apl.actions.item_swap.label"),submenu:["misc"],shortDescription:oe.t("rotation_tab.apl.actions.item_swap.tooltip"),includeIf:(e,t)=>ck.includes(e.getSpec()),newValue:()=>Vs.create(),fields:[Xx("swapSet")]}),move:iS({label:oe.t("rotation_tab.apl.actions.move.label"),submenu:["misc"],shortDescription:oe.t("rotation_tab.apl.actions.move.tooltip"),newValue:()=>Ws.create(),fields:[Zx("rangeFromTarget",{label:oe.t("rotation_tab.apl.actions.move.to_range"),labelTooltip:oe.t("rotation_tab.apl.actions.move.to_range_tooltip")})]}),moveDuration:iS({label:oe.t("rotation_tab.apl.actions.move.move_duration"),submenu:["misc"],shortDescription:oe.t("rotation_tab.apl.actions.move.move_duration_tooltip"),newValue:()=>Bs.create(),fields:[Zx("duration",{label:oe.t("rotation_tab.apl.actions.move.duration"),labelTooltip:oe.t("rotation_tab.apl.actions.move.duration_tooltip")})]}),customRotation:iS({label:oe.t("rotation_tab.apl.actions.custom_rotation.label"),shortDescription:oe.t("rotation_tab.apl.actions.custom_rotation.tooltip"),includeIf:(e,t)=>!1,newValue:()=>Us.create(),fields:[]}),groupReference:iS({label:"Group Reference",submenu:["Groups"],shortDescription:"References an action group defined in the Groups section.",fullDescription:'\n\t\t\t<p>Executes all actions in the referenced group in order. Groups allow you to create reusable action sequences.</p>\n\t\t\t<p>Example: If you have a group named "careful_aim" with actions [serpent_sting, chimera_shot, steady_shot],\n\t\t\treferencing this group will execute those three actions in sequence.</p>\n\t\t',newValue:()=>Hs.create({groupName:"",variables:[]}),fields:[function(e,t){return{field:e,newValue:()=>"",factory:(e,t,a)=>{const i=new Cc(e,t,{id:da(),...a,defaultLabel:oe.t("rotation_tab.apl.helpers.select_group"),equals:(e,t)=>e===t,values:[],changedEvent:e=>e.rotationChangeEmitter}),s=()=>{const e=(t.aplRotation?.groups||[]).map(e=>({value:e.name,label:e.name}));0===e.length&&e.push({value:"",label:oe.t("rotation_tab.apl.helpers.no_groups_defined")}),i.setOptions(e)};return s(),t.rotationChangeEmitter.on(s),i},...t||{}}}("groupName",{labelTooltip:"Name of the group to reference (must match a group defined in the Groups section)"}),function(e,t,a){return{field:e,newValue:()=>[],factory:(e,a,i,s)=>{const o=document.createElement("div");o.classList.add("group-reference-variables-container"),e.appendChild(o);const n=new Ix(o,a,{title:"Group Variables",titleTooltip:"Variables to pass to the group. These will override the group's internal variables.",itemLabel:"Variable",changedEvent:e=>e.rotationChangeEmitter,getValue:()=>{const e=s();return e?.variables||[]},setValue:(e,t,a)=>{s().variables=a,i.setValue(e,t,a)},newItem:()=>{throw new Error("newItem should not be called for auto-populated group variables")},copyItem:e=>({name:e.name,value:e.value}),newItemPicker:(e,i,o,n)=>{const r=s()?.variables||[],l=r[o]?.__uiVarName||r[o]?.name||"";return new Hx(e,a,n,s,t,l)},inlineMenuBar:!1,allowedActions:["delete","copy"]}),r=()=>{const e=s(),i=e[t];if(!i)return n.setInputValue([]),void o.classList.add("d-none");const r=(a.aplRotation?.groups||[]).find(e=>e.name===i);if(!r)return n.setInputValue([]),void o.classList.add("d-none");const l=new Set,c=e=>{if(e&&"object"==typeof e){if("variablePlaceholder"===e?.value?.oneofKind){const t=e.value.variablePlaceholder?.name;t&&l.add(t)}Array.isArray(e)?e.forEach(e=>c(e)):Object.values(e).forEach(e=>c(e))}};if(r.actions?.forEach(e=>{c(e)}),0===l.size)return o.classList.add("d-none"),void n.setInputValue([]);o.classList.remove("d-none"),e.variables=Array.from(l).map(t=>{let a=e?.variables.find(e=>e.name===t);return a||(a={name:t,value:{uuid:{value:da()},value:{oneofKind:"variableRef",variableRef:{name:""}}}}),a.__uiVarName=t,a}),n.setInputValue(e.variables)};return a.rotationChangeEmitter.on(r),r(),{rootElem:o,getInputValue:()=>{const e=s();return e?.variables||[]},setInputValue:e=>{s().variables=e}}},...a||{}}}("variables","groupName",{label:"Group Variables",labelTooltip:"Variables to pass to the group. These will override the group's internal variables."})]}),catOptimalRotationAction:iS({label:oe.t("rotation_tab.apl.actions.optimal_rotation_action.label"),submenu:["feral_druid"],shortDescription:oe.t("rotation_tab.apl.actions.optimal_rotation_action.tooltip"),includeIf:(e,t)=>e.getSpec()==K.SpecFeralDruid,newValue:()=>Fs.create({rotationType:va.SingleTarget,manualParams:!0,minRoarOffset:40,ripLeeway:4,useBite:!0,biteTime:6,berserkBiteTime:5,allowAoeBerserk:!1,bearWeave:!0,snekWeave:!0,useNs:!0,wrathWeave:!1}),fields:[function(e){const t=[{value:va.SingleTarget,label:oe.t("rotation_tab.apl.helpers.rotation_types.single_target")},{value:va.Aoe,label:oe.t("rotation_tab.apl.helpers.rotation_types.aoe")}];return{field:e,label:oe.t("rotation_tab.apl.helpers.field_configs.type"),newValue:()=>va.SingleTarget,factory:(e,a,i)=>new Cc(e,a,{id:da(),...i,defaultLabel:oe.t("rotation_tab.apl.helpers.rotation_types.single_target"),equals:(e,t)=>e==t,values:t})}}("rotationType"),Gx("bearWeave",oe.t("rotation_tab.options.druid.feral.bear_weave.label"),{labelTooltip:oe.t("rotation_tab.options.druid.feral.bear_weave.tooltip")}),Gx("snekWeave",oe.t("rotation_tab.options.druid.feral.snek_weave.label"),{labelTooltip:oe.t("rotation_tab.options.druid.feral.snek_weave.tooltip")}),Gx("useNs",oe.t("rotation_tab.options.druid.feral.use_ns.label"),{labelTooltip:oe.t("rotation_tab.options.druid.feral.use_ns.tooltip")}),Gx("wrathWeave",oe.t("rotation_tab.apl.actions.optimal_rotation_action.wrath_weave.label"),{labelTooltip:oe.t("rotation_tab.apl.actions.optimal_rotation_action.wrath_weave.tooltip")}),Gx("allowAoeBerserk",oe.t("rotation_tab.options.druid.feral.allow_aoe_berserk.label"),{labelTooltip:oe.t("rotation_tab.options.druid.feral.allow_aoe_berserk.tooltip")}),Gx("manualParams",oe.t("rotation_tab.options.druid.feral.manual_params.label"),{labelTooltip:oe.t("rotation_tab.options.druid.feral.manual_params.tooltip")}),zx("minRoarOffset",!0,{label:oe.t("rotation_tab.options.druid.feral.roar_offset.label"),labelTooltip:oe.t("rotation_tab.options.druid.feral.roar_offset.tooltip")}),zx("ripLeeway",!1,{label:oe.t("rotation_tab.options.druid.feral.rip_leeway.label"),labelTooltip:oe.t("rotation_tab.options.druid.feral.rip_leeway.tooltip")}),Gx("useBite",oe.t("rotation_tab.options.druid.feral.bite_during_rotation.label"),{labelTooltip:oe.t("rotation_tab.options.druid.feral.bite_during_rotation.tooltip")}),zx("biteTime",!0,{label:oe.t("rotation_tab.options.druid.feral.bite_time.label"),labelTooltip:oe.t("rotation_tab.options.druid.feral.bite_time.tooltip")}),zx("berserkBiteTime",!0,{label:oe.t("rotation_tab.options.druid.feral.berserk_bite_time.label"),labelTooltip:oe.t("rotation_tab.options.druid.feral.berserk_bite_time.tooltip")})]}),guardianHotwDpsRotation:iS({label:oe.t("rotation_tab.apl.actions.guardian_hotw_dps_rotation.label"),submenu:["guardian_druid"],shortDescription:oe.t("rotation_tab.apl.actions.guardian_hotw_dps_rotation.tooltip"),includeIf:(e,t)=>e.getSpec()==K.SpecGuardianDruid,newValue:()=>zs.create({strategy:wa.Caster}),fields:[function(e){const t=[{value:wa.Caster,label:oe.t("rotation_tab.apl.helpers.hotw_strategies.caster")},{value:wa.Cat,label:oe.t("rotation_tab.apl.helpers.hotw_strategies.cat")},{value:wa.Hybrid,label:oe.t("rotation_tab.apl.helpers.hotw_strategies.hybrid")}];return{field:e,label:oe.t("rotation_tab.apl.helpers.field_configs.strategy"),newValue:()=>wa.Caster,factory:(e,a,i)=>new Cc(e,a,{id:da(),...i,defaultLabel:oe.t("rotation_tab.apl.helpers.hotw_strategies.caster"),equals:(e,t)=>e==t,values:t})}}("strategy")]}),warlockNextExhaleTarget:iS({label:oe.t("rotation_tab.apl.actions.warlock_next_exhale_target.label"),submenu:["warlock"],shortDescription:oe.t("rotation_tab.apl.actions.warlock_next_exhale_target.tooltip"),includeIf:(e,t)=>e.getSpec()==K.SpecAfflictionWarlock,newValue:()=>Gs.create({}),fields:[]})};class oS extends nl{constructor(e,t,a){super(e,"hide-picker-root",t,a),this.inputElem=Ix.makeActionElem("hide-picker-button","fa-eye"),this.iconElem=this.inputElem.childNodes[0],this.inputElem.addEventListener("click",()=>{this.setInputValue(!this.getInputValue()),this.inputChanged(te.nextEventID())},{signal:this.signal}),this.rootElem.appendChild(this.inputElem),this.init()}getInputElem(){return this.inputElem}getInputValue(){return this.iconElem.classList.contains("fa-eye-slash")}setInputValue(e){e?(this.iconElem.classList.add("fa-eye-slash"),this.iconElem.classList.remove("fa-eye")):(this.iconElem.classList.add("fa-eye"),this.iconElem.classList.remove("fa-eye-slash"))}}class nS extends nl{constructor(e,t,a){super(e,"apl-group-editor-root",t,a),this.rootElem.classList.add("apl-list-item-picker-root"),this.index=a.index;const i=this.rootElem.appendChild(H("div",{className:"apl-action-picker-root"}));this.namePicker=new Tx(i,this.modObject,{id:da(),label:oe.t("rotation_tab.apl.actionGroups.attributes.name"),labelTooltip:oe.t("rotation_tab.apl.actionGroups.tooltips.name"),extraCssClasses:["apl-group-name-picker"],inline:!0,changedEvent:e=>e.rotationChangeEmitter,getValue:()=>this.getSourceValue()?.name||"",setValue:(e,t,a)=>{const i=this.getSourceValue();i&&(i.name=a,t.rotationChangeEmitter.emit(e))}}),this.actionsContainer=i.appendChild(H("div",{className:"apl-group-actions-container"})),this.actionsPicker=new Ix(this.actionsContainer,this.modObject,{extraCssClasses:["apl-list-item-picker"],title:oe.t("rotation_tab.apl.actionGroups.attributes.actions"),titleTooltip:oe.t("rotation_tab.apl.actionGroups.tooltips.actions"),itemLabel:oe.t("rotation_tab.apl.priorityList.name"),actions:{create:{useIcon:!0}},changedEvent:e=>e.rotationChangeEmitter,getValue:()=>this.getSourceValue()?.actions||[],setValue:(e,t,a)=>{const i=this.getSourceValue();i&&(i.actions=a,t.rotationChangeEmitter.emit(e))},newItem:()=>oo.create({action:{}}),copyItem:e=>oo.clone(e),newItemPicker:(e,t,a,i)=>new rS(e,this.modObject,{...i,groupIndex:this.index,index:a}),inlineMenuBar:!0,allowedActions:["create","copy","delete","move"]}),this.init()}getInputElem(){return this.rootElem}getInputValue(){return this.getSourceValue()?no.create({name:this.namePicker.getInputValue(),actions:this.actionsPicker.getInputValue()}):no.create()}setInputValue(e){e&&(this.namePicker.setInputValue(e.name||""),this.actionsPicker.setInputValue(e.actions||[]))}}class rS extends nl{getItem(){return this.getSourceValue()||oo.create({action:{}})}constructor(e,t,a){a.enableWhen=()=>!this.getItem().hide,super(e,"apl-list-item-picker-root",t,a),this.player=t,this.rootElem.classList.add("apl-list-item-picker-root");const i=Ix.getItemHeaderElem(this);Ix.makeListItemValidations(i,t,e=>{const t=[],i=e.aplRotation.groups||[];return a.groupIndex<i.length&&i[a.groupIndex].actions&&a.index<i[a.groupIndex].actions.length&&t.push(...e.getCurrentStats().rotationStats?.groups?.[a.groupIndex]?.actions?.[a.index]?.validations||[]),t.push(...e.getCurrentStats().rotationStats?.uuidValidations?.find(e=>e.uuid?.value===this.rootElem.id)?.validations||[]),t}),this.hidePicker=new oS(i,t,{changedEvent:()=>this.player.rotationChangeEmitter,getValue:()=>this.getItem().hide,setValue:(e,t,a)=>{this.getItem().hide=a,this.player.rotationChangeEmitter.emit(e)}}),this.actionPicker=new tS(this.rootElem,this.modObject,{changedEvent:()=>this.modObject.rotationChangeEmitter,getValue:()=>this.getItem().action,setValue:(e,t,a)=>{this.getSourceValue()&&(this.getItem().action=a,t.rotationChangeEmitter.emit(e))}}),this.init()}getInputElem(){return this.rootElem}getInputValue(){return oo.create({action:this.actionPicker.getInputValue()})}setInputValue(e){e&&(this.actionPicker.setInputValue(e.action||Os.create()),e.action?.condition&&(e.action.condition?.uuid?.value&&""!=e.action.condition.uuid.value||(e.action.condition.uuid=ro.create({value:da()})),this.rootElem.id=e.action.condition.uuid.value))}}class lS extends F{constructor(e,t){super(e,"apl-group-list-picker-root");const a=new Ix(this.rootElem,t.player,{title:oe.t("rotation_tab.apl.actionGroups.header"),titleTooltip:oe.t("rotation_tab.apl.actionGroups.tooltips.overview"),extraCssClasses:["apl-list-item-picker","apl-groups-picker"],itemLabel:oe.t("rotation_tab.apl.actionGroups.name"),changedEvent:e=>e.rotationChangeEmitter,getValue:e=>e.aplRotation.groups||[],setValue:(e,t,a)=>{t.aplRotation.groups=a,t.rotationChangeEmitter.emit(e)},newItem:()=>no.create({name:oe.t("rotation_tab.apl.actionGroups.newGroupName"),actions:[],variables:[]}),copyItem:e=>no.clone(e),newItemPicker:(e,a,i,s)=>new nS(e,t.player,{...s,index:i}),allowedActions:["copy","delete","move"],inlineMenuBar:!0});new Ex(this.rootElem,t,a,oe.t("rotation_tab.apl.actionGroups.name"))}}class cS extends F{constructor(e,t){super(e,"apl-variables-list-picker-root");const a=new Ix(this.rootElem,t.player,{title:oe.t("rotation_tab.apl.variables.header"),titleTooltip:oe.t("rotation_tab.apl.variables.tooltips.overview"),extraCssClasses:["apl-list-item-picker","apl-value-variables-picker"],itemLabel:oe.t("rotation_tab.apl.variables.name"),changedEvent:e=>e.rotationChangeEmitter,getValue:e=>e.aplRotation.valueVariables||[],setValue:(e,t,a)=>{t.aplRotation.valueVariables=a,t.rotationChangeEmitter.emit(e)},newItem:()=>this.createValueVariable(),copyItem:e=>this.copyValueVariable(e),newItemPicker:(e,a,i,s)=>new hS(e,t.player,i,s),allowedActions:["copy","delete","move"],actions:{create:{useIcon:!1}},inlineMenuBar:!0});new Ex(this.rootElem,t,a,oe.t("rotation_tab.apl.variables.name"))}createValueVariable(){return lo.create({name:oe.t("rotation_tab.apl.variables.newVariableName"),value:void 0})}copyValueVariable(e){return lo.create({name:oe.t("rotation_tab.apl.variables.copyName",{variableName:e.name}),value:e.value})}}class hS extends nl{constructor(e,t,a,i){super(e,"apl-value-variable-picker-root",t,i),this.rootElem.classList.add("apl-list-item-picker-root"),this.config=i,this.modObject=t,this.index=a;const s=this.rootElem.appendChild(H("div",{className:"apl-action-picker-root"}));if(this.rootElem.parentElement.classList.contains("list-picker-item")){const e=Ix.getItemHeaderElem(this)||this.rootElem;Ix.makeListItemValidations(e,t,e=>e.getCurrentStats().rotationStats?.uuidValidations?.find(e=>e.uuid?.value===this.rootElem.id)?.validations||[])}this.namePicker=new Tx(s,t,{id:da(),label:oe.t("rotation_tab.apl.variables.attributes.name"),labelTooltip:oe.t("rotation_tab.apl.variables.attributes.nameTooltip"),extraCssClasses:["apl-variable-name-picker"],inline:!0,changedEvent:e=>e.rotationChangeEmitter,getValue:()=>this.getSourceValue().name,setValue:(e,t,a)=>{this.getSourceValue().name=a,this.config.setValue(e,t,this.config.getValue(t))}}),this.valuePicker=new $x(s,t,{id:da(),label:oe.t("rotation_tab.apl.variables.attributes.value"),labelTooltip:oe.t("rotation_tab.apl.variables.attributes.valueTooltip"),changedEvent:e=>e.rotationChangeEmitter,getValue:()=>this.getSourceValue().value,setValue:(e,t,a)=>{this.getSourceValue().value=a,this.config.setValue(e,t,this.config.getValue(t))}}),this.init()}getInputElem(){return this.rootElem}getInputValue(){return{name:this.namePicker.getInputValue(),value:this.valuePicker.getInputValue()}}setInputValue(e){this.namePicker.setInputValue(e.name),this.valuePicker.setInputValue(e.value),e.value&&(e.value.uuid&&""!=e.value.uuid.value||(e.value.uuid=ro.create({value:da()})),this.rootElem.id=e.value.uuid.value)}}class dS extends F{constructor(e,t){super(e,"apl-pre-pull-list-picker-root"),new Ix(this.rootElem,t.player,{title:oe.t("rotation_tab.apl.prePullActions.header"),titleTooltip:oe.t("rotation_tab.apl.prePullActions.tooltips.overview"),extraCssClasses:["apl-list-item-picker","apl-prepull-action-picker"],itemLabel:oe.t("rotation_tab.apl.prePullActions.name"),changedEvent:e=>e.rotationChangeEmitter,getValue:e=>e.aplRotation.prepullActions,setValue:(e,t,a)=>{t.aplRotation.prepullActions=a,t.rotationChangeEmitter.emit(e)},newItem:()=>co.create({action:{},doAtValue:{value:{oneofKind:"const",const:{val:"-1s"}}}}),copyItem:e=>co.clone(e),newItemPicker:(e,a,i,s)=>new uS(e,t.player,s,i),allowedActions:["create","copy","delete","move"],inlineMenuBar:!0})}}class uS extends nl{constructor(e,t,a,i){a.enableWhen=()=>!this.getItem().hide,super(e,"apl-list-item-picker-root",t,a),this.player=t;const s=Ix.getItemHeaderElem(this);Ix.makeListItemValidations(s,t,e=>e.getCurrentStats().rotationStats?.prepullActions[i]?.validations||[]),this.hidePicker=new oS(s,t,{changedEvent:()=>this.player.rotationChangeEmitter,getValue:()=>this.getItem().hide,setValue:(e,t,a)=>{this.getItem().hide=a,this.player.rotationChangeEmitter.emit(e)}}),this.doAtPicker=new Tx(this.rootElem,this.player,{id:da(),label:oe.t("rotation_tab.apl.prepull_actions.do_at.label"),labelTooltip:oe.t("rotation_tab.apl.prepull_actions.do_at.tooltip"),extraCssClasses:["apl-prepull-actions-doat"],changedEvent:()=>this.player.rotationChangeEmitter,getValue:()=>this.getItem().doAtValue?.value?.const.val||"",setValue:(e,t,a)=>{this.getItem().doAtValue=a?ds.create({value:{oneofKind:"const",const:{val:a}},uuid:{value:da()}}):void 0,this.player.rotationChangeEmitter.emit(e)},inline:!0}),this.actionPicker=new tS(this.rootElem,this.player,{changedEvent:()=>this.player.rotationChangeEmitter,getValue:()=>this.getItem().action,setValue:(e,t,a)=>{this.getItem().action=a,this.player.rotationChangeEmitter.emit(e)}}),this.init()}getInputElem(){return this.rootElem}getInputValue(){return co.create({hide:this.hidePicker.getInputValue(),doAtValue:{value:{oneofKind:"const",const:{val:this.doAtPicker.getInputValue()}}},action:this.actionPicker.getInputValue()})}setInputValue(e){e&&(this.hidePicker.setInputValue(e.hide),this.doAtPicker.setInputValue(e.doAtValue?.value?.const.val||""),this.actionPicker.setInputValue(e.action||Os.create()))}getItem(){return this.getSourceValue()||co.create({action:{}})}}class pS extends F{constructor(e,t){super(e,"apl-priority-list-picker-root");const a=new Ix(this.rootElem,t.player,{title:oe.t("rotation_tab.apl.priorityList.header"),titleTooltip:oe.t("rotation_tab.apl.priorityList.tooltips.overview"),extraCssClasses:["apl-list-item-picker"],itemLabel:oe.t("rotation_tab.apl.priorityList.name"),changedEvent:e=>e.rotationChangeEmitter,getValue:e=>e.aplRotation.priorityList,setValue:(e,t,a)=>{t.aplRotation.priorityList=a,t.rotationChangeEmitter.emit(e)},newItem:()=>oo.create({action:{}}),copyItem:e=>oo.clone(e),newItemPicker:(e,a,i,s)=>new mS(e,t.player,s,i),allowedActions:["copy","delete","move"],inlineMenuBar:!0});new Ex(this.rootElem,t,a,oe.t("rotation_tab.apl.priorityList.name"))}}class mS extends nl{getItem(){return this.getSourceValue()||oo.create({action:{}})}constructor(e,t,a,i){a.enableWhen=()=>!this.getItem().hide,super(e,"apl-list-item-picker-root",t,a),this.player=t;const s=Ix.getItemHeaderElem(this);Ix.makeListItemValidations(s,t,e=>{const t=e.getCurrentStats().rotationStats?.priorityList[i]?.validations||[];return t.push(...e.getCurrentStats().rotationStats?.uuidValidations?.find(e=>e.uuid?.value===this.rootElem.id)?.validations||[]),t}),this.hidePicker=new oS(s,t,{changedEvent:()=>this.player.rotationChangeEmitter,getValue:()=>this.getItem().hide,setValue:(e,t,a)=>{this.getItem().hide=a,this.player.rotationChangeEmitter.emit(e)}}),this.actionPicker=new tS(this.rootElem,this.player,{changedEvent:()=>this.player.rotationChangeEmitter,getValue:()=>this.getItem().action,setValue:(e,t,a)=>{this.getItem().action=a,this.player.rotationChangeEmitter.emit(e)}}),this.init()}getInputElem(){return this.rootElem}getInputValue(){return oo.create({hide:this.hidePicker.getInputValue(),action:this.actionPicker.getInputValue()})}setInputValue(e){e&&(this.hidePicker.setInputValue(e.hide),this.actionPicker.setInputValue(e.action||Os.create()),e.action?.condition?.uuid?.value&&(this.rootElem.id=e.action?.condition?.uuid?.value))}}class gS extends nl{constructor(e,t,a){super(e,"number-list-picker-root",t,a),this.inputElem=document.createElement("input"),this.inputElem.id=a.id,this.inputElem.type="text",this.inputElem.placeholder=a.placeholder||"",this.inputElem.classList.add("number-list-picker-input","form-control"),this.rootElem.appendChild(this.inputElem),this.init(),this.inputElem.addEventListener("change",()=>{this.inputChanged(te.nextEventID())},{signal:this.signal})}getInputElem(){return this.inputElem}getInputValue(){const e=this.inputElem.value;return e?e.split(",").map(parseFloat).filter(e=>!isNaN(e)):[]}setInputValue(e){sa(this.getInputValue(),e)||(this.inputElem.value=e.map(e=>String(e)).join(","))}}class fS extends F{constructor(e,t){super(e,"cooldowns-picker-root"),this.player=t,this.cooldownPickers=[];const a=te.onAny([this.player.rotationChangeEmitter,this.player.sim.unitMetadataEmitter]).on(()=>{ae(this.rootElem)?this.update():this.dispose()});this.addOnDisposeCallback(()=>{this.rootElem.remove(),this.cooldownPickers.forEach(e=>e.remove()),a.dispose()}),this.update()}update(){this.rootElem.innerHTML="";const e=this.player.getSimpleCooldowns().cooldowns;this.cooldownPickers=[];for(let t=0;t<e.length+1;t++){const a=e[t],i=document.createElement("div");i.classList.add("cooldown-picker"),t==e.length&&i.classList.add("add-cooldown-picker"),this.rootElem.appendChild(i),this.makeActionPicker(i,t);const s=document.createElement("label");s.classList.add("cooldown-picker-label","form-label"),a&&a.id&&Lr.fromProto(a.id).fill(this.player.getRaidIndex()).then(e=>s.textContent=e.name),i.appendChild(s),this.makeTimingsPicker(i,t);const o=document.createElement("fragment");o.innerHTML='\n\t\t\t\t<button class="delete-cooldown link-danger">\n\t\t\t\t\t<i class="fa fa-times fa-xl"></i>\n\t\t\t\t</button>\n\t\t\t';const n=o.children[0],r=ie(n,{content:oe.t("rotation_tab.cooldowns.delete_tooltip")});n.addEventListener("click",()=>{const e=this.player.getSimpleCooldowns();e.cooldowns.splice(t,1),this.player.setSimpleCooldowns(te.nextEventID(),e),r.hide()}),i.appendChild(n),this.cooldownPickers.push(i)}}makeActionPicker(e,t){const a=this.player.getMetadata().getSpells().filter(e=>e.data.isMajorCooldown).map(e=>e.id).filter(e=>{const t=0!==e.spellId?e.spellId:e.itemId;return!this.player.hiddenMCDs.includes(t)});this.rootElem.closest(".cooldown-settings")?.classList[a.length?"remove":"add"]("hide");return new fx(e,this.player,{extraCssClasses:["cooldown-action-picker"],numColumns:3,values:[{color:"#grey",value:z.create()}].concat(a.map(e=>({actionId:e,value:e.toProto()}))),equals:(e,t)=>z.equals(e,t),zeroValue:z.create(),backupIconUrl:e=>Lr.fromProto(e),changedEvent:e=>e.rotationChangeEmitter,getValue:e=>e.getSimpleCooldowns().cooldowns[t]?.id||z.create(),setValue:(e,a,i)=>{if(!i.rawId.oneofKind)return;const s=a.getSimpleCooldowns();for(;s.cooldowns.length<t;)s.cooldowns.push(ho.create());s.cooldowns[t]=ho.create({id:i,timings:[]}),a.setSimpleCooldowns(e,s)}})}makeTimingsPicker(e,t){return new gS(e,this.player,{id:`cooldown-timings-${t}`,extraCssClasses:["cooldown-timings-picker"],placeholder:oe.t("rotation_tab.cooldowns.timings_placeholder"),changedEvent:e=>e.rotationChangeEmitter,getValue:e=>e.getSimpleCooldowns().cooldowns[t]?.timings||[],setValue:(e,a,i)=>{const s=a.getSimpleCooldowns();s.cooldowns[t].timings=i,a.setSimpleCooldowns(e,s)},enableWhen:e=>{const a=e.getSimpleCooldowns().cooldowns[t];return a&&!z.equals(a.id,z.create())}})}}class bS extends Bg{constructor(e,t){super(e,t,{identifier:"rotation-tab",title:oe.t("rotation_tab.title")}),this.simUI=t,this.autoTab=H("div",{className:"rotation-tab rotation-tab-auto"}),this.simpleTab=H("div",{className:"rotation-tab rotation-tab-simple"}),this.aplTab=H("div",{className:"rotation-tab rotation-tab-apl"}),this.contentContainer.appendChild(this.autoTab),this.contentContainer.appendChild(this.simpleTab),this.contentContainer.appendChild(this.aplTab),this.buildTabContent(),this.updateSections(),this.simUI.player.rotationChangeEmitter.on(()=>this.updateSections())}buildTabContent(){this.buildAutoTab(),this.buildSimpleTab(),this.buildAplTab()}buildAutoTab(){const e=H("div",{className:"rotation-tab-col tab-panel-left"}),t=H("div",{className:"rotation-tab-col tab-panel-right"});this.autoTab.appendChild(e),this.autoTab.appendChild(t),this.buildRotationTypePicker(e),e.appendChild(H("p",null,oe.t("rotation_tab.auto.description"))),this.buildPresetConfigurationPicker(t),this.buildSavedDataPickers(t)}buildSimpleTab(){if(!this.simUI.player.hasSimpleRotationGenerator()||!this.simUI.individualConfig.rotationInputs)return;const e=H("div",{className:"rotation-tab-col tab-panel-left tab-content"}),t=H("div",{className:"rotation-tab-col tab-panel-right"});this.simpleTab.appendChild(e),this.simpleTab.appendChild(t),this.buildRotationTypePicker(e),this.buildPresetConfigurationPicker(t),this.buildSavedDataPickers(t);const a=H("div",{className:"simple-rotation-container"});e.appendChild(a);const i=new $e(a,"rotation-settings",{header:{title:oe.t("rotation_tab.simple.title")}}),s=nl.newGroupContainer();s.classList.add("rotation-icon-group","icon-group"),i.bodyElement.appendChild(s),this.simUI.individualConfig.rotationIconInputs?.length&&this.configureIconSection(s,this.simUI.individualConfig.rotationIconInputs.map(e=>yx(s,this.simUI.player,e)),!0),this.configureInputSection(i.bodyElement,this.simUI.individualConfig.rotationInputs);const o=new $e(a,"cooldown-settings",{header:{title:oe.t("rotation_tab.cooldowns.title"),tooltip:oe.t("rotation_tab.cooldowns.tooltip")}});new fS(o.bodyElement,this.simUI.player)}buildAplTab(){const e=this.aplTab.appendChild(H("div",{className:"apl-rotation-navbar"}));new ag(e,this.simUI),this.buildRotationTypePicker(e);const t=e.appendChild(H("ul",{className:"nav nav-tabs",attributes:{role:"tablist"}})),a=this.aplTab.appendChild(H("div",{className:"rotation-tab-col tab-panel-left tab-content"})),i=this.aplTab.appendChild(H("div",{className:"rotation-tab-col tab-panel-right"})),s=this.buildAPLTab(t,a,oe.t("rotation_tab.apl.tabs.priorityList"),"apl-priority-list",!0),o=this.buildAPLTab(t,a,oe.t("rotation_tab.apl.tabs.actionGroups"),"apl-action-groups"),n=this.buildAPLTab(t,a,oe.t("rotation_tab.apl.tabs.variables"),"apl-variables");new dS(s,this.simUI),new pS(s,this.simUI),new lS(o,this.simUI),new cS(n,this.simUI),this.buildPresetConfigurationPicker(i),this.buildSavedDataPickers(i)}buildAPLTab(e,t,a,i,s=!1){e.appendChild(H("li",{className:"nav-item",attributes:{role:"presentation"}},H("button",{className:xr({"nav-link":!0,active:s}),type:"button",attributes:{role:"tab","aria-controls":i,"aria-selected":!!s},dataset:{bsToggle:"tab",bsTarget:`#${i}`}},a)));return t.appendChild(H("div",{id:i,className:xr({"tab-pane fade":!0,"active show":s})}))}updateSections(){this.rootElem.classList.remove("rotation-type-auto","rotation-type-simple","rotation-type-apl");let e="";switch(this.simUI.player.getRotationType()){case uo.TypeAuto:e="rotation-type-auto";break;case uo.TypeSimple:e="rotation-type-simple";break;case uo.TypeAPL:e="rotation-type-apl"}this.rootElem.classList.add(e)}configureInputSection(e,t){t.inputs.forEach(t=>{t.extraCssClasses=[...t.extraCssClasses||[],"input-inline"],"number"==t.type?new rl(e,this.simUI.player,{...t,inline:!0}):"boolean"==t.type?new gc(e,this.simUI.player,{...t,inline:!0,reverse:!0}):"enum"==t.type&&new Ag(e,this.simUI.player,{...t,inline:!0})})}configureIconSection(e,t,a){t.length?a&&(t.length<=4?e.style.gridTemplateColumns=`repeat(${t.length}, 1fr)`:t.length>4&&t.length<8&&(e.style.gridTemplateColumns=`repeat(${Math.ceil(t.length/2)}, 1fr)`)):e.classList.add("hide")}buildRotationTypePicker(e){const t=H("div",{className:"rotation-type-container"});e.appendChild(t),new Cc(t,this.simUI.player,{id:"rotation-tab-rotation-type",defaultLabel:"",values:this.simUI.player.hasSimpleRotationGenerator()?[{value:uo.TypeAuto,label:oe.t("rotation_tab.common.rotation_type.auto")},{value:uo.TypeSimple,label:oe.t("rotation_tab.common.rotation_type.simple")},{value:uo.TypeAPL,label:oe.t("rotation_tab.common.rotation_type.apl")}]:[{value:uo.TypeAuto,label:oe.t("rotation_tab.common.rotation_type.auto")},{value:uo.TypeAPL,label:oe.t("rotation_tab.common.rotation_type.apl")}],equals:(e,t)=>e===t,changedEvent:e=>e.rotationChangeEmitter,getValue:e=>e.getRotationType(),setValue:(e,t,a)=>{t.aplRotation.type=a,t.rotationChangeEmitter.emit(e)}})}buildPresetConfigurationPicker(e){new ra(e,this.simUI,[la.Rotation])}buildSavedDataPickers(e){const t=new Pg(e,this.simUI.player,{label:oe.t("rotation_tab.saved_rotations.label"),header:{title:oe.t("rotation_tab.saved_rotations.title")},storageKey:this.simUI.getSavedRotationStorageKey(),getData:e=>mo.create({rotation:e.getResolvedAplRotation()}),setData:(e,t,a)=>te.freezeAllAndDo(()=>{t.setAplRotation(e,a.rotation||fo.create())}),changeEmitters:[this.simUI.player.rotationChangeEmitter,this.simUI.player.talentsChangeEmitter],equals:(e,t)=>go(this.simUI.player,e.rotation,t.rotation),toJson:e=>mo.toJson(e),fromJson:e=>po(mo.fromJson(e),["uuid"]),nameLabel:oe.t("rotation_tab.saved_rotations.name_label"),saveButtonText:oe.t("rotation_tab.saved_rotations.save_button"),deleteTooltip:oe.t("rotation_tab.saved_rotations.delete.tooltip"),deleteConfirmMessage:oe.t("rotation_tab.saved_rotations.delete.confirm"),chooseNameAlert:oe.t("rotation_tab.saved_rotations.alerts.choose_name"),nameExistsAlert:oe.t("rotation_tab.saved_rotations.alerts.name_exists")});this.simUI.sim.waitForInit().then(()=>{t.loadUserData(),(this.simUI.individualConfig.presets.rotations||[]).forEach(e=>{const a=e.rotation;a.rotation||(a.rotation=fo.create()),t.addSavedData({name:e.name,tooltip:e.tooltip,isPreset:!0,data:a,enableWhen:e.enableWhen,onLoad:e.onLoad})})})}}class yS{constructor(e){this.duration=300,this.durationVariation=60,this.executeProportion20=.2,this.executeProportion25=.25,this.executeProportion35=.35,this.executeProportion45=.45,this.executeProportion90=.9,this.useHealth=!1,this.targetsChangeEmitter=new te,this.durationChangeEmitter=new te,this.executeProportionChangeEmitter=new te,this.changeEmitter=new te,this.sim=e,this.targets=[yS.defaultTargetProto()],this.targetsMetadata=new kk,[this.targetsChangeEmitter,this.durationChangeEmitter,this.executeProportionChangeEmitter].forEach(e=>e.on(e=>this.changeEmitter.emit(e)))}get primaryTarget(){return this.targets[0]}getDurationVariation(){return this.durationVariation}setDurationVariation(e,t){t!=this.durationVariation&&(this.durationVariation=t,this.durationChangeEmitter.emit(e))}getDuration(){return this.duration}setDuration(e,t){t!=this.duration&&(this.duration=t,this.durationChangeEmitter.emit(e))}getExecuteProportion20(){return this.executeProportion20}setExecuteProportion20(e,t){t!=this.executeProportion20&&(this.executeProportion20=t,this.executeProportionChangeEmitter.emit(e))}getExecuteProportion25(){return this.executeProportion25}setExecuteProportion25(e,t){t!=this.executeProportion25&&(this.executeProportion25=t,this.executeProportionChangeEmitter.emit(e))}getExecuteProportion35(){return this.executeProportion35}setExecuteProportion35(e,t){t!=this.executeProportion35&&(this.executeProportion35=t,this.executeProportionChangeEmitter.emit(e))}getExecuteProportion45(){return this.executeProportion45}setExecuteProportion45(e,t){t!=this.executeProportion45&&(this.executeProportion45=t,this.executeProportionChangeEmitter.emit(e))}getExecuteProportion90(){return this.executeProportion90}setExecuteProportion90(e,t){t!=this.executeProportion90&&(this.executeProportion90=t,this.executeProportionChangeEmitter.emit(e))}getUseHealth(){return this.useHealth}setUseHealth(e,t){t!=this.useHealth&&(this.useHealth=t,this.durationChangeEmitter.emit(e),this.executeProportionChangeEmitter.emit(e))}matchesPreset(e){return e.targets.length==this.targets.length&&this.targets.every((t,a)=>bo.equals(t,e.targets[a].target))}applyPreset(e,t){this.targets=t.targets.map(e=>e.target||bo.create()),this.targetsChangeEmitter.emit(e)}applyPresetTarget(e,t,a){this.targets[a]=t.target||bo.create(),this.targetsChangeEmitter.emit(e)}toProto(){return Fe.create({duration:this.duration,durationVariation:this.durationVariation,executeProportion20:this.executeProportion20,executeProportion25:this.executeProportion25,executeProportion35:this.executeProportion35,executeProportion45:this.executeProportion45,executeProportion90:this.executeProportion90,useHealth:this.useHealth,targets:this.targets,apiVersion:yo})}fromProto(e,t){yS.updateProtoVersion(t),te.freezeAllAndDo(()=>{this.setDuration(e,t.duration),this.setDurationVariation(e,t.durationVariation),this.setExecuteProportion20(e,t.executeProportion20),this.setExecuteProportion25(e,t.executeProportion25),this.setExecuteProportion35(e,t.executeProportion35),this.setExecuteProportion45(e,t.executeProportion45),this.setExecuteProportion90(e,t.executeProportion90),this.setUseHealth(e,t.useHealth),this.targets=t.targets,this.targetsChangeEmitter.emit(e)})}applyDefaults(e){this.fromProto(e,yS.defaultEncounterProto())}static defaultEncounterProto(e=1){return Fe.create({duration:300,durationVariation:60,executeProportion20:.2,executeProportion25:.25,executeProportion35:.35,executeProportion45:.45,executeProportion90:.9,targets:Array.from({length:e},()=>yS.defaultTargetProto()),apiVersion:yo})}static defaultTargetProto(){return bo.create({id:31146,name:"Raid Target",level:xo,mobType:vo.MobTypeMechanical,stats:n.fromMap({[ee.StatArmor]:24835,[ee.StatAttackPower]:650,[ee.StatHealth]:120016403}).asProtoArray(),minBaseDamage:55e4,damageSpread:.4,tankIndex:0,swingSpeed:2,suppressDodge:!1,parryHaste:!1,dualWield:!1,dualWieldPenalty:!1,spellSchool:wo.SpellSchoolPhysical,targetInputs:new Array(0)})}static updateProtoVersion(e){e.apiVersion}}class wS extends F{constructor(e,t,a,i){super(e,"encounter-picker-root"),_S(this.rootElem,t,a.showExecuteProportion),t.sim.waitForInit().then(()=>{const e=t.sim.db.getAllPresetTargets(),a=t.sim.db.getAllPresetEncounters();if(new Ag(this.rootElem,t,{id:"encounter-preset-encouter",label:oe.t("settings_tab.encounter.encounter_preset.label"),extraCssClasses:["damage-metrics","npc-picker"],values:[{name:oe.t("common.custom"),value:-1}].concat(a.map((e,t)=>({name:e.path,value:t}))),changedEvent:e=>e.changeEmitter,getValue:e=>a.findIndex(t=>e.matchesPreset(t)),setValue:(e,t,i)=>{-1!=i&&t.applyPreset(e,a[i])}}),i.isIndividualSim()&&i.player.canEnableTargetDummies()){const e=i.player;new rl(this.rootElem,i.sim.raid,{id:"encounter-num-allies",label:oe.t("settings_tab.encounter.num_allies.label"),labelTooltip:oe.t("settings_tab.encounter.num_allies.tooltip"),changedEvent:t=>te.onAny([t.targetDummiesChangeEmitter,e.itemSwapSettings.changeEmitter]),getValue:e=>e.getTargetDummies(),setValue:(e,t,a)=>{t.setTargetDummies(e,a)},showWhen:t=>{const a=e.shouldEnableTargetDummies();return![K.SpecBrewmasterMonk,K.SpecWindwalkerMonk].includes(e.getSpec())&&(a||t.setTargetDummies(te.nextEventID(),0),a)}})}i.isIndividualSim()&&i.player.getPlayerSpec().isTankSpec&&new rl(this.rootElem,t,{id:"encounter-min-base-damage",label:oe.t("settings_tab.encounter.min_base_damage.label"),labelTooltip:oe.t("settings_tab.encounter.min_base_damage.tooltip"),changedEvent:e=>e.changeEmitter,getValue:e=>e.primaryTarget.minBaseDamage,setValue:(e,t,a)=>{t.primaryTarget.minBaseDamage=a,t.targetsChangeEmitter.emit(e)}});const s=e.findIndex(e=>t.primaryTarget.id==e.target?.id),o=e[s]?.target?.targetInputs||[];(o.length!=t.primaryTarget.targetInputs.length||t.primaryTarget.targetInputs.some((e,t)=>e.label!=o[t].label))&&(t.primaryTarget.targetInputs=o,t.targetsChangeEmitter.emit(te.nextEventID())),kS(this.rootElem,t,0);const n=new vS(i.rootElem,i,t),r=document.createElement("button");r.classList.add("advanced-button","btn","btn-primary"),r.textContent=oe.t("settings_tab.encounter.advanced"),r.addEventListener("click",()=>n.open()),this.rootElem.appendChild(r)})}}class vS extends Wr{constructor(e,t,a){super(e,"advanced-encounter-picker-modal",{disposeOnClose:!1}),this.encounter=a,this.addHeader(),this.body.innerHTML='\n\t\t\t<div class="encounter-header"></div>\n\t\t\t<div class="encounter-targets"></div>\n\t\t';const i=this.rootElem.getElementsByClassName("encounter-header")[0],s=this.rootElem.getElementsByClassName("encounter-targets")[0];_S(i,this.encounter,!0),t.isIndividualSim()||new gc(i,a,{id:"aem-use-health",label:oe.t("settings_tab.encounter.use_health.label"),labelTooltip:oe.t("settings_tab.encounter.use_health.tooltip"),inline:!0,changedEvent:e=>e.changeEmitter,getValue:e=>e.getUseHealth(),setValue:(e,t,a)=>{t.setUseHealth(e,a)}}),new Ix(s,this.encounter,{extraCssClasses:["targets-picker","mb-0"],itemLabel:oe.t("settings_tab.encounter.target"),changedEvent:e=>e.targetsChangeEmitter,getValue:e=>e.targets,setValue:(e,t,a)=>{Km({action:"settings",category:"encounter",label:a.length>t.targets.length?"add-target":"remove-target"}),t.targets=a,t.targetsChangeEmitter.emit(e)},newItem:()=>yS.defaultTargetProto(),copyItem:e=>bo.clone(e),newItemPicker:(e,t,i,s)=>new xS(e,a,i,s),minimumItems:1})}addHeader(){const e=this.encounter.sim.db.getAllPresetEncounters();new Ag(this.header,this.encounter,{id:"aem-encounter-picker",label:oe.t("settings_tab.encounter.encounter_preset.label"),extraCssClasses:["encounter-picker","mb-0","pe-2","order-first"],values:[{name:"Custom",value:-1}].concat(e.map((e,t)=>({name:e.path,value:t}))),changedEvent:e=>e.changeEmitter,getValue:t=>e.findIndex(e=>t.matchesPreset(e)),setValue:(t,a,i)=>{if(-1!=i){const s=e[i];Km({action:"settings",category:"encounter",label:"preset",value:s.path}),a.applyPreset(t,s)}}})}}class xS extends nl{getTarget(){return this.encounter.targets[this.targetIndex]||bo.create()}constructor(e,t,a,i){super(e,"target-picker-root",t,i),this.encounter=t,this.targetIndex=a,this.rootElem.innerHTML='\n\t\t\t<div class="picker-group target-picker-section target-picker-section1"></div>\n\t\t\t<div class="picker-group target-picker-section target-picker-section2"></div>\n\t\t\t<div class="picker-group target-picker-section target-picker-section3 threat-metrics"></div>\n\t\t';const s=this.rootElem.querySelector(".target-picker-section1"),o=this.rootElem.querySelector(".target-picker-section2"),n=this.rootElem.querySelector(".target-picker-section3"),r=t.sim.db.getAllPresetTargets();new Ag(s,null,{id:"target-picker-npc",extraCssClasses:["npc-picker"],label:oe.t("settings_tab.encounter.npc.label"),labelTooltip:oe.t("settings_tab.encounter.npc.tooltip"),values:[{name:oe.t("common.custom"),value:-1}].concat(r.map((e,t)=>({name:e.path,value:t}))),changedEvent:()=>t.targetsChangeEmitter,getValue:()=>r.findIndex(e=>function(e,t){if(!!e!=!!t)return!1;if(!e)return!0;const a=bo.clone(t);return a.targetInputs=e.targetInputs,bo.equals(e,a)}(this.getTarget(),e.target)),setValue:(e,a,i)=>{if(-1!=i){const a=r[i];Km({action:"settings",category:"targets",label:"preset",value:a.target?.name||a.path}),t.applyPresetTarget(e,a,this.targetIndex),t.targetsChangeEmitter.emit(e)}}}),this.aiPicker=new Ag(s,null,{id:"target-picker-ai",extraCssClasses:["ai-picker"],label:oe.t("settings_tab.encounter.ai.label"),labelTooltip:oe.t("settings_tab.encounter.ai.tooltip"),values:[{name:oe.t("common.none"),value:0}].concat(r.map(e=>({name:e.path,value:e.target.id}))),changedEvent:()=>t.targetsChangeEmitter,getValue:()=>this.getTarget().id,setValue:(e,a,i)=>{const s=this.getTarget();s.id=i,Km({action:"settings",category:"targets",label:"ai",value:s.name}),s.targetInputs=(r.find(e=>s.id==e.target?.id)?.target?.targetInputs||[]).map(e=>_o.clone(e)),t.targetsChangeEmitter.emit(e)}}),this.levelPicker=new Ag(s,null,{id:"target-picker-level",label:oe.t("settings_tab.encounter.level"),values:[{name:"93",value:93},{name:"92",value:92},{name:"91",value:91},{name:"90",value:90},{name:"88",value:88}],changedEvent:()=>t.targetsChangeEmitter,getValue:()=>this.getTarget().level,setValue:(e,a,i)=>{Km({action:"settings",category:"targets",label:"level",value:i}),this.getTarget().level=i,t.targetsChangeEmitter.emit(e)}}),this.mobTypePicker=new Ag(s,null,{id:"target-picker-mob-type",label:oe.t("settings_tab.encounter.mob_type"),values:IS,changedEvent:()=>t.targetsChangeEmitter,getValue:()=>this.getTarget().mobType,setValue:(e,a,i)=>{Km({action:"settings",category:"targets",label:"mob_type",value:i}),this.getTarget().mobType=i,t.targetsChangeEmitter.emit(e)}}),this.tankIndexPicker=new Ag(s,null,{id:"target-picker-tanked-by",extraCssClasses:["threat-metrics"],label:oe.t("settings_tab.encounter.tanked_by.label"),labelTooltip:oe.t("settings_tab.encounter.tanked_by.tooltip"),values:[{name:oe.t("common.none"),value:-1},{name:oe.t("common.tanks.main_tank"),value:0},{name:oe.t("common.tanks.tank_2"),value:1},{name:oe.t("common.tanks.tank_3"),value:2},{name:oe.t("common.tanks.tank_4"),value:3}],changedEvent:()=>t.targetsChangeEmitter,getValue:()=>this.getTarget().tankIndex,setValue:(e,a,i)=>{Km({action:"settings",category:"targets",label:"tank_index",value:i}),this.getTarget().tankIndex=i,t.targetsChangeEmitter.emit(e)}}),this.targetInputPickers=kS(s,t,this.targetIndex),this.statPickers=CS.map(e=>{const a=e.stat;return new rl(o,null,{id:`target-${this.targetIndex}-picker-stats-${e.stat}`,inline:!0,extraCssClasses:e.extraCssClasses,label:ot(a),labelTooltip:e.tooltip,changedEvent:()=>t.targetsChangeEmitter,getValue:()=>this.getTarget().stats[a],setValue:(e,i,s)=>{this.getTarget().stats[a]=s,t.targetsChangeEmitter.emit(e)}})}),this.swingSpeedPicker=new rl(n,null,{id:`target-${this.targetIndex}-picker-swing-speed`,label:oe.t("settings_tab.encounter.swing_speed.label"),labelTooltip:oe.t("settings_tab.encounter.swing_speed.tooltip"),float:!0,changedEvent:()=>t.targetsChangeEmitter,getValue:()=>this.getTarget().swingSpeed,setValue:(e,a,i)=>{Km({action:"settings",category:"targets",label:"swing_speed",value:i}),this.getTarget().swingSpeed=i,t.targetsChangeEmitter.emit(e)}}),this.minBaseDamagePicker=new rl(n,null,{id:`target-${this.targetIndex}-picker-min-base-damage`,label:oe.t("settings_tab.encounter.min_base_damage.label"),labelTooltip:oe.t("settings_tab.encounter.min_base_damage.tooltip"),changedEvent:()=>t.targetsChangeEmitter,getValue:()=>this.getTarget().minBaseDamage,setValue:(e,a,i)=>{Km({action:"settings",category:"targets",label:"min_base_damage",value:i}),this.getTarget().minBaseDamage=i,t.targetsChangeEmitter.emit(e)}}),this.damageSpreadPicker=new rl(n,null,{id:`target-${this.targetIndex}-picker-damage-spread`,label:oe.t("settings_tab.encounter.damage_spread.label"),labelTooltip:oe.t("settings_tab.encounter.damage_spread.tooltip"),float:!0,changedEvent:()=>t.targetsChangeEmitter,getValue:()=>this.getTarget().damageSpread,setValue:(e,a,i)=>{Km({action:"settings",category:"targets",label:"damage_spread",value:i}),this.getTarget().damageSpread=i,t.targetsChangeEmitter.emit(e)}}),this.dualWieldPicker=new gc(n,null,{id:`target-${this.targetIndex}-picker-dual-wield`,label:oe.t("settings_tab.encounter.dual_wield.label"),labelTooltip:oe.t("settings_tab.encounter.dual_wield.tooltip"),inline:!0,reverse:!0,changedEvent:()=>t.targetsChangeEmitter,getValue:()=>this.getTarget().dualWield,setValue:(e,a,i)=>{Km({action:"settings",category:"targets",label:"dual_wield",value:i}),this.getTarget().dualWield=i,t.targetsChangeEmitter.emit(e)}}),this.dwMissPenaltyPicker=new gc(n,null,{id:`target-${this.targetIndex}-picker-dw-miss-penalty`,label:oe.t("settings_tab.encounter.dual_wield_penalty.label"),labelTooltip:oe.t("settings_tab.encounter.dual_wield_penalty.tooltip"),inline:!0,reverse:!0,changedEvent:()=>t.targetsChangeEmitter,getValue:()=>this.getTarget().dualWieldPenalty,setValue:(e,a,i)=>{Km({action:"settings",category:"targets",label:"dual_wield_penalty",value:i}),this.getTarget().dualWieldPenalty=i,t.targetsChangeEmitter.emit(e)},enableWhen:()=>this.getTarget().dualWield}),this.parryHastePicker=new gc(n,null,{id:`target-${this.targetIndex}-picker-parry-haste`,label:oe.t("settings_tab.encounter.parry_haste.label"),labelTooltip:oe.t("settings_tab.encounter.parry_haste.tooltip"),inline:!0,reverse:!0,changedEvent:()=>t.targetsChangeEmitter,getValue:()=>this.getTarget().parryHaste,setValue:(e,a,i)=>{Km({action:"settings",category:"targets",label:"parry_haste",value:i}),this.getTarget().parryHaste=i,t.targetsChangeEmitter.emit(e)}}),this.spellSchoolPicker=new Ag(n,null,{id:`target-${this.targetIndex}-picker-spell-school`,label:oe.t("settings_tab.encounter.spell_school.label"),labelTooltip:oe.t("settings_tab.encounter.spell_school.tooltip"),values:[{name:Eo(wo.SpellSchoolPhysical),value:wo.SpellSchoolPhysical},{name:Eo(wo.SpellSchoolArcane),value:wo.SpellSchoolArcane},{name:Eo(wo.SpellSchoolFire),value:wo.SpellSchoolFire},{name:Eo(wo.SpellSchoolFrost),value:wo.SpellSchoolFrost},{name:Eo(wo.SpellSchoolHoly),value:wo.SpellSchoolHoly},{name:Eo(wo.SpellSchoolNature),value:wo.SpellSchoolNature},{name:Eo(wo.SpellSchoolShadow),value:wo.SpellSchoolShadow}],changedEvent:()=>t.targetsChangeEmitter,getValue:()=>this.getTarget().spellSchool,setValue:(e,a,i)=>{Km({action:"settings",category:"targets",label:"spell_school",value:i}),this.getTarget().spellSchool=i,t.targetsChangeEmitter.emit(e)}}),this.init()}getInputElem(){return null}getInputValue(){return bo.create({id:this.aiPicker.getInputValue(),level:this.levelPicker.getInputValue(),mobType:this.mobTypePicker.getInputValue(),tankIndex:this.tankIndexPicker.getInputValue(),swingSpeed:this.swingSpeedPicker.getInputValue(),minBaseDamage:this.minBaseDamagePicker.getInputValue(),dualWield:this.dualWieldPicker.getInputValue(),dualWieldPenalty:this.dwMissPenaltyPicker.getInputValue(),parryHaste:this.parryHastePicker.getInputValue(),spellSchool:this.spellSchoolPicker.getInputValue(),damageSpread:this.damageSpreadPicker.getInputValue(),stats:this.statPickers.map(e=>e.getInputValue()).map((e,t)=>(new n).withStat(CS[t].stat,e)).reduce((e,t)=>e.add(t)).asProtoArray(),targetInputs:this.targetInputPickers.getInputValue()})}setInputValue(e){e&&(this.aiPicker.setInputValue(e.id),this.levelPicker.setInputValue(e.level),this.mobTypePicker.setInputValue(e.mobType),this.tankIndexPicker.setInputValue(e.tankIndex),this.swingSpeedPicker.setInputValue(e.swingSpeed),this.minBaseDamagePicker.setInputValue(e.minBaseDamage),this.dualWieldPicker.setInputValue(e.dualWield),this.dwMissPenaltyPicker.setInputValue(e.dualWieldPenalty),this.parryHastePicker.setInputValue(e.parryHaste),this.spellSchoolPicker.setInputValue(e.spellSchool),this.damageSpreadPicker.setInputValue(e.damageSpread),CS.forEach((t,a)=>this.statPickers[a].setInputValue(e.stats[t.stat])),this.targetInputPickers.setInputValue(e.targetInputs))}}class SS extends nl{getTargetInput(){return this.encounter.targets[this.targetIndex].targetInputs[this.targetInputIndex]||_o.create()}clearPickers(){this.boolPicker&&(this.boolPicker.rootElem.remove(),this.boolPicker=null),this.numberPicker&&(this.numberPicker.rootElem.remove(),this.numberPicker=null),this.enumPicker&&(this.enumPicker.rootElem.remove(),this.enumPicker=null)}constructor(e,t,a,i,s){super(e,"target-input-picker-root",t,s),this.encounter=t,this.targetIndex=a,this.targetInputIndex=i,this.boolPicker=null,this.numberPicker=null,this.enumPicker=null,this.init()}getInputElem(){return this.rootElem}getInputValue(){return _o.create({boolValue:this.boolPicker?this.boolPicker.getInputValue():void 0,numberValue:this.numberPicker?this.numberPicker.getInputValue():void 0,enumValue:this.enumPicker?this.enumPicker.getInputValue():void 0})}setInputValue(e){if(!e)return;const t={action:"settings",category:"targets",label:e.label};if(e.inputType==ko.Number){if(this.numberPicker&&this.numberPicker.inputConfig.label===e.label)return;this.clearPickers(),this.numberPicker=new rl(this.rootElem,null,{id:da(),float:!0,label:Io(e.label),labelTooltip:Co(e.label,e.tooltip),changedEvent:()=>this.encounter.targetsChangeEmitter,getValue:()=>this.getTargetInput().numberValue,setValue:(e,a,i)=>{Km({...t,value:i}),this.getTargetInput().numberValue=i,this.encounter.targetsChangeEmitter.emit(e)}})}else if(e.inputType==ko.Bool){if(this.boolPicker&&this.boolPicker.inputConfig.label===e.label)return;this.clearPickers(),this.boolPicker=new gc(this.rootElem,null,{id:da(),label:Io(e.label),labelTooltip:Co(e.label,e.tooltip),extraCssClasses:["input-inline"],changedEvent:()=>this.encounter.targetsChangeEmitter,getValue:()=>this.getTargetInput().boolValue,setValue:(e,a,i)=>{Km({...t,value:i}),this.getTargetInput().boolValue=i,this.encounter.targetsChangeEmitter.emit(e)}})}else e.inputType==ko.Enum&&(this.clearPickers(),this.enumPicker=new Ag(this.rootElem,null,{id:da(),label:Io(e.label),values:e.enumOptions.map((e,t)=>({value:t,name:e})),changedEvent:()=>this.encounter.targetsChangeEmitter,getValue:()=>this.getTargetInput().enumValue,setValue:(e,a,i)=>{Km({...t,value:i}),this.getTargetInput().enumValue=i,this.encounter.targetsChangeEmitter.emit(e)}}))}}function _S(e,t,a){const i=nl.newGroupContainer();if(e.appendChild(i),new rl(i,t,{id:"encounter-duration",label:oe.t("settings_tab.encounter.duration.label"),labelTooltip:oe.t("settings_tab.encounter.duration.tooltip"),changedEvent:e=>e.changeEmitter,getValue:e=>e.getDuration(),setValue:(e,t,a)=>{Km({action:"settings",category:"duration",label:"duration",value:a}),t.setDuration(e,a)},enableWhen:e=>!t.getUseHealth()}),new rl(i,t,{id:"encounter-duration-variation",label:oe.t("settings_tab.encounter.duration_variation.label"),labelTooltip:oe.t("settings_tab.encounter.duration_variation.tooltip"),changedEvent:e=>e.changeEmitter,getValue:e=>e.getDurationVariation(),setValue:(e,t,a)=>{Km({action:"settings",category:"duration",label:"variation",value:a}),t.setDurationVariation(e,a)},enableWhen:e=>!t.getUseHealth()}),a){const a=nl.newGroupContainer();a.classList.add("execute-group"),e.appendChild(a),new rl(a,t,{id:"encounter-execute-proportion",label:oe.t("settings_tab.encounter.execute_duration_20.label"),labelTooltip:oe.t("settings_tab.encounter.execute_duration_20.tooltip"),changedEvent:e=>e.changeEmitter,getValue:e=>100*e.getExecuteProportion20(),setValue:(e,t,a)=>{Km({action:"settings",category:"execute",label:"execute_20",value:a}),t.setExecuteProportion20(e,a/100)},enableWhen:e=>!t.getUseHealth()}),new rl(a,t,{id:"encounter-execute-proportion-25",label:oe.t("settings_tab.encounter.execute_duration_25.label"),labelTooltip:oe.t("settings_tab.encounter.execute_duration_25.tooltip"),changedEvent:e=>e.changeEmitter,getValue:e=>100*e.getExecuteProportion25(),setValue:(e,t,a)=>{Km({action:"settings",category:"execute",label:"execute_25",value:a}),t.setExecuteProportion25(e,a/100)},enableWhen:e=>!t.getUseHealth()}),new rl(a,t,{id:"encounter-execute-proportion-35",label:oe.t("settings_tab.encounter.execute_duration_35.label"),labelTooltip:oe.t("settings_tab.encounter.execute_duration_35.tooltip"),changedEvent:e=>e.changeEmitter,getValue:e=>100*e.getExecuteProportion35(),setValue:(e,t,a)=>{Km({action:"settings",category:"execute",label:"execute_35",value:a}),t.setExecuteProportion35(e,a/100)},enableWhen:e=>!t.getUseHealth()}),new rl(a,t,{id:"encounter-execute-proportion-45",label:oe.t("settings_tab.encounter.execute_duration_45.label"),labelTooltip:oe.t("settings_tab.encounter.execute_duration_45.tooltip"),changedEvent:e=>e.changeEmitter,getValue:e=>100*e.getExecuteProportion45(),setValue:(e,t,a)=>{Km({action:"settings",category:"execute",label:"execute_45",value:a}),t.setExecuteProportion45(e,a/100)},enableWhen:e=>!t.getUseHealth()}),new rl(a,t,{id:"encounter-execute-proportion-90",label:oe.t("settings_tab.encounter.duration_below_high_hp.label"),labelTooltip:oe.t("settings_tab.encounter.duration_below_high_hp.tooltip"),changedEvent:e=>e.changeEmitter,getValue:e=>100*e.getExecuteProportion90(),setValue:(e,t,a)=>{Km({action:"settings",category:"execute",label:"execute_90",value:a}),t.setExecuteProportion90(e,a/100)},enableWhen:e=>!t.getUseHealth()})}}function kS(e,t,a){return new Ix(e,t,{allowedActions:[],itemLabel:oe.t("settings_tab.encounter.target_inputs.label"),extraCssClasses:["mt-2"],isCompact:!0,changedEvent:e=>e.targetsChangeEmitter,getValue:e=>e.targets[a].targetInputs,setValue:(e,t,i)=>{Km({action:"settings",category:"targets",label:"count",value:i.length}),t.targets[a].targetInputs=i,t.targetsChangeEmitter.emit(e)},newItem:()=>_o.create(),copyItem:e=>_o.clone(e),newItemPicker:(e,i,s,o)=>new SS(e,t,a,s,o)})}const CS=[{stat:ee.StatHealth,tooltip:"",extraCssClasses:[]},{stat:ee.StatArmor,tooltip:"",extraCssClasses:[]},{stat:ee.StatAttackPower,tooltip:"",extraCssClasses:["threat-metrics"]}],IS=[{name:So(vo.MobTypeUnknown),value:vo.MobTypeUnknown},{name:So(vo.MobTypeBeast),value:vo.MobTypeBeast},{name:So(vo.MobTypeDemon),value:vo.MobTypeDemon},{name:So(vo.MobTypeDragonkin),value:vo.MobTypeDragonkin},{name:So(vo.MobTypeElemental),value:vo.MobTypeElemental},{name:So(vo.MobTypeGiant),value:vo.MobTypeGiant},{name:So(vo.MobTypeHumanoid),value:vo.MobTypeHumanoid},{name:So(vo.MobTypeMechanical),value:vo.MobTypeMechanical},{name:So(vo.MobTypeUndead),value:vo.MobTypeUndead}];class ES extends F{constructor(e,t,a,i){super(e,"multi-icon-picker-root"),this.rootElem.classList.add("icon-picker"),this.abortController=new AbortController,this.signal=this.abortController.signal,this.config=a,this.currentValue=null;const s=U(),o=U(),n=U();this.rootElem.replaceChildren(H(de,null,H("div",{className:"dropend"},H("a",{ref:s,className:"icon-picker-button",attributes:{role:"button","aria-expanded":!1},dataset:{bsToggle:"dropdown",disableWowheadTouchTtooltip:!0}}),H("ul",{ref:o,className:"dropdown-menu"})),H("label",{ref:n,className:"multi-icon-picker-label form-label"})));const r=n.value;a.label?r.textContent=a.label:r.remove(),this.buttonElem=s.value,this.dropdownMenu=o.value,this.buttonElem.addEventListener("hide.bs.dropdown",e=>{e.hasOwnProperty("clickEvent")&&e.preventDefault()},{signal:this.signal}),this.buttonElem.addEventListener("contextmenu",e=>{e.preventDefault()},{signal:this.signal}),this.buttonElem.addEventListener("mousedown",e=>{vt(e)&&this.clearPicker()},{signal:this.signal}),this.buildBlankOption(),this.pickers=a.inputs.map((e,a)=>{const i=document.createElement("li");return i.classList.add("icon-picker-option","dropdown-option"),this.dropdownMenu.appendChild(i),new bx(i,t,e)}),i.sim.waitForInit().then(()=>this.updateButtonImage());const l=i.changeEmitter.on(()=>{if(!ae(this.rootElem)||!ae(this.dropdownMenu)||!ae(this.buttonElem))return void this.dispose();this.updateButtonImage();!this.config.showWhen||this.config.showWhen(i.sim.raid.getPlayer(0))?this.rootElem.classList.remove("hide"):this.rootElem.classList.add("hide")});this.addOnDisposeCallback(()=>l.dispose())}buildBlankOption(){const e=document.createElement("li");this.dropdownMenu.appendChild(e);const t=document.createElement("a");t.classList.add("icon-dropdown-option","dropdown-option"),e.appendChild(t);t.addEventListener("click",()=>this.clearPicker(),{signal:this.signal})}clearPicker(){te.freezeAllAndDo(()=>{this.pickers.forEach(e=>{e.setInputValue(null),e.inputChanged(te.nextEventID())}),this.updateButtonImage()})}updateButtonImage(){this.currentValue=this.getMaxValue(),this.currentValue?(this.buttonElem.classList.add("active"),null!=this.config.categoryId?this.config.categoryId.fillAndSet(this.buttonElem,!1,!0,{signal:this.signal}):this.currentValue.fillAndSet(this.buttonElem,!1,!0,{signal:this.signal})):(this.buttonElem.classList.remove("active"),null!=this.config.categoryId?this.config.categoryId.fillAndSet(this.buttonElem,!1,!0,{signal:this.signal}):this.buttonElem.style.backgroundImage="",this.buttonElem.removeAttribute("href"))}getMaxValue(){return this.pickers.map(e=>e.getActionId()).filter(e=>null!=e)[0]||null}}const TS=$v([wx({actionId:Lr.fromSpellId(20217),fieldName:"blessingOfKings"}),wx({actionId:Lr.fromSpellId(1126),fieldName:"markOfTheWild"}),wx({actionId:Lr.fromSpellId(90363),fieldName:"embraceOfTheShaleSpider"}),wx({actionId:Lr.fromSpellId(115921),fieldName:"legacyOfTheEmperor"})],oe.t("settings_tab.raid_buffs.stats")),AS=$v([wx({actionId:Lr.fromSpellId(19506),fieldName:"trueshotAura"}),wx({actionId:Lr.fromSpellId(57330),fieldName:"hornOfWinter"}),wx({actionId:Lr.fromSpellId(6673),fieldName:"battleShout"})],oe.t("settings_tab.raid_buffs.attack_power")),PS=$v([wx({actionId:Lr.fromSpellId(55610),fieldName:"unholyAura"}),wx({actionId:Lr.fromSpellId(128433),fieldName:"serpentsSwiftness"}),wx({actionId:Lr.fromSpellId(113742),fieldName:"swiftbladesCunning"}),wx({actionId:Lr.fromSpellId(30809),fieldName:"unleashedRage"}),wx({actionId:Lr.fromSpellId(128432),fieldName:"cacklingHowl"})],oe.t("settings_tab.raid_buffs.attack_speed")),RS=$v([wx({actionId:Lr.fromSpellId(1459),fieldName:"arcaneBrilliance"}),wx({actionId:Lr.fromSpellId(126309),fieldName:"stillWater"}),wx({actionId:Lr.fromSpellId(77747),fieldName:"burningWrath"}),wx({actionId:Lr.fromSpellId(109773),fieldName:"darkIntent"})],oe.t("settings_tab.raid_buffs.spell_power")),DS=$v([wx({actionId:Lr.fromSpellId(24907),fieldName:"moonkinAura"}),wx({actionId:Lr.fromSpellId(49868),fieldName:"mindQuickening"}),wx({actionId:Lr.fromSpellId(51470),fieldName:"elementalOath"})],oe.t("settings_tab.raid_buffs.spell_haste")),MS=$v([wx({actionId:Lr.fromSpellId(17007),fieldName:"leaderOfThePack"}),wx({actionId:Lr.fromSpellId(24604),fieldName:"furiousHowl"}),wx({actionId:Lr.fromSpellId(90309),fieldName:"terrifyingRoar"}),wx({actionId:Lr.fromSpellId(116781),fieldName:"legacyOfTheWhiteTiger"}),wx({actionId:Lr.fromSpellId(1459),fieldName:"arcaneBrilliance"}),wx({actionId:Lr.fromSpellId(126309),fieldName:"stillWater"})],oe.t("settings_tab.raid_buffs.crit_percent")),LS=$v([wx({actionId:Lr.fromSpellId(19740),fieldName:"blessingOfMight"}),wx({actionId:Lr.fromSpellId(93435),fieldName:"roarOfCourage"}),wx({actionId:Lr.fromSpellId(128997),fieldName:"spiritBeastBlessing"}),wx({actionId:Lr.fromSpellId(116956),fieldName:"graceOfAir"})],oe.t("settings_tab.raid_buffs.mastery")),NS=$v([wx({actionId:Lr.fromSpellId(469),fieldName:"commandingShout"}),wx({actionId:Lr.fromSpellId(109773),fieldName:"darkIntent"}),wx({actionId:Lr.fromSpellId(21562),fieldName:"powerWordFortitude"}),wx({actionId:Lr.fromSpellId(90364),fieldName:"qirajiFortitude"})],oe.t("settings_tab.raid_buffs.stamina")),OS=xx({actionId:Lr.fromSpellId(16190),numStates:5,fieldName:"manaTideTotemCount"}),GS=wx({actionId:Lr.fromSpellId(2825),fieldName:"bloodlust",label:oe.t("settings_tab.external_damage_cooldowns.bloodlust")}),zS=xx({actionId:Lr.fromSpellId(114207),numStates:11,fieldName:"skullBannerCount",label:oe.t("settings_tab.external_damage_cooldowns.skull_banner")}),FS=xx({actionId:Lr.fromSpellId(120668),numStates:11,fieldName:"stormlashTotemCount",label:oe.t("settings_tab.external_damage_cooldowns.stormlash_totem")}),HS=hx({getModObject:e=>e,showWhen:e=>!US.faction||US.faction==e.getFaction(),getValue:e=>e.getBuffs(),setValue:(e,t,a)=>t.setBuffs(e,a),changeEmitter:e=>te.onAny([e.buffsChangeEmitter,e.raceChangeEmitter])},(US={actionId:Lr.fromSpellId(57933),fieldName:"tricksOfTheTrade",label:oe.t("settings_tab.external_damage_cooldowns.tricks_of_the_trade")}).actionId,US.fieldName,US.value,US.label);var US;const BS=Sx({actionId:Lr.fromSpellId(49016),numStates:11,fieldName:"unholyFrenzyCount",label:oe.t("settings_tab.external_damage_cooldowns.unholy_frenzy")}),WS=Sx({actionId:Lr.fromSpellId(1249459),numStates:11,fieldName:"shatteringThrowCount",label:oe.t("settings_tab.external_damage_cooldowns.shattering_throw")}),VS=Sx({actionId:Lr.fromSpellId(114030),numStates:11,fieldName:"vigilanceCount",label:oe.t("settings_tab.external_defensive_cooldowns.vigilance")}),jS=Sx({actionId:Lr.fromSpellId(31821),numStates:11,fieldName:"devotionAuraCount",label:oe.t("settings_tab.external_defensive_cooldowns.devotion_aura")}),YS=Sx({actionId:Lr.fromSpellId(33206),numStates:11,fieldName:"painSuppressionCount",label:oe.t("settings_tab.external_defensive_cooldowns.pain_suppression")}),qS=Sx({actionId:Lr.fromSpellId(97462),numStates:11,fieldName:"rallyingCryCount",label:oe.t("settings_tab.external_defensive_cooldowns.rallying_cry")}),XS=vx({actionId:Lr.fromSpellId(113746),fieldName:"weakenedArmor",label:oe.t("settings_tab.debuffs.armor_reduction")}),$S=vx({actionId:Lr.fromSpellId(115798),fieldName:"weakenedBlows",label:oe.t("settings_tab.debuffs.phys_dmg_reduction")}),ZS=$v([vx({actionId:Lr.fromSpellId(73975),fieldName:"necroticStrike"}),vx({actionId:Lr.fromSpellId(58604),fieldName:"lavaBreath"}),vx({actionId:Lr.fromSpellId(50274),fieldName:"sporeCloud"}),vx({actionId:Lr.fromSpellId(5761),fieldName:"mindNumbingPoison"}),vx({actionId:Lr.fromSpellId(31589),fieldName:"slow"}),vx({actionId:Lr.fromSpellId(109466),fieldName:"curseOfEnfeeblement"})],oe.t("settings_tab.debuffs.cast_speed")),KS=vx({actionId:Lr.fromSpellId(81326),fieldName:"physicalVulnerability",label:oe.t("settings_tab.debuffs.phys_dmg")}),JS=$v([vx({actionId:Lr.fromSpellId(24844),fieldName:"lightningBreath"}),vx({actionId:Lr.fromSpellId(1490),fieldName:"curseOfElements"}),vx({actionId:Lr.fromSpellId(58410),fieldName:"masterPoisoner"}),vx({actionId:Lr.fromSpellId(34889),fieldName:"fireBreath"})],oe.t("settings_tab.debuffs.spell_dmg")),QS=[{config:TS,picker:ES,stats:[ee.StatStrength,ee.StatAgility,ee.StatIntellect]},{config:AS,picker:ES,stats:[ee.StatAttackPower,ee.StatRangedAttackPower]},{config:PS,picker:ES,stats:[ee.StatAttackPower,ee.StatRangedAttackPower]},{config:RS,picker:ES,stats:[ee.StatSpellPower]},{config:DS,picker:ES,stats:[ee.StatSpellPower]},{config:MS,picker:ES,stats:[ee.StatCritRating]},{config:LS,picker:ES,stats:[ee.StatMasteryRating]},{config:NS,picker:ES,stats:[ee.StatStamina]}],e_=[{config:OS,picker:bx,stats:[ee.StatSpirit]}],t_=[{config:GS,picker:bx,stats:[ee.StatHasteRating]},{config:zS,picker:bx,stats:[ee.StatAttackPower,ee.StatRangedAttackPower,ee.StatSpellPower]},{config:FS,picker:bx,stats:[ee.StatAttackPower,ee.StatRangedAttackPower,ee.StatSpellPower]},{config:HS,picker:bx,stats:[ee.StatAttackPower,ee.StatRangedAttackPower,ee.StatSpellPower]},{config:BS,picker:bx,stats:[ee.StatAttackPower,ee.StatRangedAttackPower]},{config:WS,picker:bx,stats:[ee.StatAttackPower,ee.StatRangedAttackPower]}],a_=[{config:VS,picker:bx,stats:[ee.StatStamina]},{config:jS,picker:bx,stats:[ee.StatStamina]},{config:YS,picker:bx,stats:[ee.StatStamina]},{config:qS,picker:bx,stats:[ee.StatStamina]}],i_=[{config:XS,picker:bx,stats:[ee.StatAttackPower,ee.StatRangedAttackPower]},{config:KS,picker:bx,stats:[ee.StatAttackPower,ee.StatRangedAttackPower]},{config:JS,picker:ES,stats:[ee.StatAttackPower,ee.StatRangedAttackPower,ee.StatSpellPower]},{config:$S,picker:bx,stats:[ee.StatStamina]},{config:ZS,picker:ES,stats:[ee.StatStamina]}],s_=[];function o_(e,t){return e.filter(e=>0==e.stats.length||e.stats.some(e=>t.individualConfig.epStats.includes(e))||t.individualConfig.includeBuffDebuffInputs.includes(e.config)).filter(e=>!t.individualConfig.excludeBuffDebuffInputs.includes(e.config))}function n_(e){return(t,a)=>{const i=t.map(e=>({actionId:e.config.actionId,value:e.config.value,showWhen:t=>(!e.config.showWhen||e.config.showWhen(t))&&(e.config.faction||t.getFaction())==t.getFaction()}));return{type:"iconEnum",tooltip:a,numColumns:t.length>5?2:1,values:[{value:0,iconUrl:"",tooltip:oe.t("common.none")}].concat(i),equals:(e,t)=>e==t,zeroValue:0,changedEvent:e=>te.onAny([e.consumesChangeEmitter,e.gearChangeEmitter,e.professionChangeEmitter]),showWhen:t=>(!e.showWhen||e.showWhen(t))&&i.some(e=>e.showWhen?.(t)),getValue:t=>t.getConsumes()[e.consumesFieldName],setValue:(t,a,i)=>{const s=a.getConsumes();s[e.consumesFieldName]!==i&&(s[e.consumesFieldName]=i,te.freezeAllAndDo(()=>{a.setConsumes(t,s),e.onSet&&e.onSet(t,a,i)}))}}}}const r_={actionId:Lr.fromItemId(12662),value:12662},l_={actionId:Lr.fromItemId(5512),value:5512},c_=[{config:{actionId:Lr.fromItemId(7676),value:7676,showWhen:e=>e.getClass()==q.ClassRogue},stats:[]},{config:l_,stats:[ee.StatStamina]},{config:r_,stats:[ee.StatIntellect]}],h_=n_({consumesFieldName:"conjuredId"}),d_=[{config:{actionId:Lr.fromItemId(63396),value:89637,showWhen:e=>e.hasProfession(a.Engineering)},stats:[]},{config:{actionId:Lr.fromItemId(60223),value:82207,showWhen:e=>e.hasProfession(a.Engineering)},stats:[]}],u_=n_({consumesFieldName:"explosiveId"});function p_(e,t,a){const i=e.map(e=>({value:e.id,iconUrl:e.icon,actionId:Lr.fromItemId(e.id),tooltip:e.name}));return{type:"iconEnum",tooltip:a,numColumns:e.length>5?2:1,values:[{value:0,iconUrl:"",tooltip:oe.t("common.none")}].concat(i),equals:(e,t)=>e===t,zeroValue:0,changedEvent:e=>e.consumesChangeEmitter,getValue:e=>e.getConsumes()[t.consumesFieldName],showWhen:e=>!!i.length,setValue:(e,a,i)=>{t.setValue&&t.setValue(e,a,i);const s={...a.getConsumes(),[t.consumesFieldName]:i};"flaskId"===t.consumesFieldName&&(s.guardianElixirId=0,s.battleElixirId=0),"battleElixirId"!==t.consumesFieldName&&"guardianElixirId"!==t.consumesFieldName||(s.flaskId=0),a.setConsumes(e,s)}}}class m_ extends F{constructor(e,t,a,i){super(e,"consumes-picker-root"),this.settingsTab=t,this.simUI=a,this.db=i}getConsumables(e){return this.db.getConsumablesByTypeAndStats(e,this.simUI.individualConfig.consumableStats??this.simUI.individualConfig.epStats)}static create(e,t,a){const i=new m_(e,t,a,Ar.getSync());return i.init(),i}init(){this.buildPotionsPicker(),this.buildElixirsPicker(),this.buildFoodPicker(),this.buildEngPicker(),this.buildPetPicker()}buildPotionsPicker(){const e=U(),t=this.rootElem.appendChild(H(g_,{label:"Potions"},H("div",{ref:e,className:"picker-group icon-group consumes-row-inputs consumes-potions"}))),a=e.value;let i=this.getConsumables(To.ConsumableTypePotion);this.simUI.player.getClass()!==q.ClassWarrior&&this.simUI.player.getSpec()!==K.SpecGuardianDruid&&(i=i.filter(e=>13442!==e.id));const s=p_(i,{consumesFieldName:"prepotId"},oe.t("settings_tab.consumables.potions.prepop")),o=p_(i,{consumesFieldName:"potId"},oe.t("settings_tab.consumables.potions.combat")),n=yx(a,this.simUI.player,s),r=yx(a,this.simUI.player,o),l=h_(o_(c_,this.simUI)),c=yx(a,this.simUI.player,l),h=te.onAny([this.simUI.player.professionChangeEmitter]).on(()=>this.updateRow(t,[r,c,n]));this.addOnDisposeCallback(()=>h.dispose()),this.updateRow(t,[r,c,n])}buildElixirsPicker(){const e=U(),t=U(),a=U();this.rootElem.appendChild(H(g_,{label:"Elixirs"},H("div",{className:"picker-group icon-group consumes-row-inputs"},H("div",{ref:e,className:"consumes-flasks"}),H("span",{className:"elixir-space"},"or"),H("div",{ref:t,className:"consumes-battle-elixirs"}),H("div",{ref:a,className:"consumes-guardian-elixirs"}))));const i=e.value,s=t.value,o=a.value,n=p_(this.getConsumables(To.ConsumableTypeFlask),{consumesFieldName:"flaskId"},"");yx(i,this.simUI.player,n);const r=p_(this.getConsumables(To.ConsumableTypeBattleElixir),{consumesFieldName:"battleElixirId"},""),l=p_(this.getConsumables(To.ConsumableTypeGuardianElixir),{consumesFieldName:"guardianElixirId"},"");yx(s,this.simUI.player,r),yx(o,this.simUI.player,l)}buildFoodPicker(){const e=U();this.rootElem.appendChild(H(g_,{label:"Food"},H("div",{ref:e,className:"picker-group icon-group consumes-row-inputs consumes-food"})));const t=e.value,a=p_(this.getConsumables(To.ConsumableTypeFood),{consumesFieldName:"foodId"},"");yx(t,this.simUI.player,a)}buildEngPicker(){const e=U(),t=this.rootElem.appendChild(H(g_,{label:"Engineering"},H("div",{ref:e,className:"picker-group icon-group consumes-row-inputs consumes-engi"}))),a=e.value,i=u_(o_(d_,this.simUI),oe.t("settings_tab.consumables.engineering.explosives")),s=yx(a,this.simUI.player,i),o=this.simUI.player.professionChangeEmitter.on(()=>this.updateRow(t,[s]));this.addOnDisposeCallback(()=>o.dispose()),this.updateRow(t,[s])}buildPetPicker(){if(this.simUI.individualConfig.petConsumeInputs?.length){const e=U();this.rootElem.appendChild(H(g_,{label:"Pet"},H("div",{ref:e,className:"picker-group icon-group consumes-row-inputs consumes-pet"})));const t=e.value;this.simUI.individualConfig.petConsumeInputs.forEach(e=>yx(t,this.simUI.player,e))}}updateRow(e,t){e.classList[t.find(e=>e?.showWhen())?"remove":"add"]("hide")}}const g_=({label:e,children:t})=>H("div",{className:"consumes-row input-root input-inline"},H("label",{className:"form-label"},oe.t(`settings_tab.consumables.${e.toLowerCase()}.title`)),t);class f_ extends Bg{constructor(e,t){super(e,t,{identifier:"settings-tab",title:oe.t("settings_tab.title")}),this.column1=this.buildColumn(1,"settings-left-col"),this.column2=this.buildColumn(2,"settings-left-col"),this.column3=this.buildColumn(3,"settings-left-col"),this.simUI=t,this.leftPanel=document.createElement("div"),this.leftPanel.classList.add("settings-tab-left","tab-panel-left"),this.leftPanel.appendChild(this.column1),this.leftPanel.appendChild(this.column2),this.leftPanel.appendChild(this.column3),this.simUI.isWithinRaidSim&&(this.column4=this.buildColumn(4,"settings-left-col"),this.leftPanel.appendChild(this.column4)),this.rightPanel=document.createElement("div"),this.rightPanel.classList.add("settings-tab-right","tab-panel-right","within-raid-sim-hide"),this.contentContainer.appendChild(this.leftPanel),this.contentContainer.appendChild(this.rightPanel),this.simUI.sim.waitForInit().then(()=>{this.buildTabContent()})}buildTabContent(){this.simUI.isWithinRaidSim||this.buildEncounterSettings(),this.buildPlayerSettings(),this.buildCustomSettingsSections(),this.buildConsumesSection(),this.buildOtherSettings(),this.simUI.isWithinRaidSim||(this.buildBuffsSettings(),this.raidExternalDamageCooldowns(),this.raidExternalDefensiveCooldowns(),this.buildDebuffsSettings()),this.simUI.isWithinRaidSim||(this.buildPresetConfigurationPicker(),this.buildSavedDataPickers())}buildEncounterSettings(){const e=new $e(this.column1,"encounter-settings",{header:{title:oe.t("settings_tab.encounter.title")}});new wS(e.bodyElement,this.simUI.sim.encounter,this.simUI.individualConfig.encounterPicker,this.simUI)}buildPlayerSettings(){const t=this.column1,i=new $e(t,"player-settings",{header:{title:oe.t("settings_tab.player.title")}}),s=nl.newGroupContainer();s.classList.add("player-icon-group","icon-group"),i.bodyElement.appendChild(s),this.configureIconSection(s,this.simUI.individualConfig.playerIconInputs.map(e=>yx(s,this.simUI.player,e)),!0);const o=this.simUI.player.getPlayerClass().races;new Ag(i.bodyElement,this.simUI.player,{id:"simui-race",label:oe.t("settings_tab.player.race"),values:o.map(e=>({name:Ao(e),value:e})),changedEvent:e=>e.raceChangeEmitter,getValue:e=>e.getRace(),setValue:(e,t,a)=>t.setRace(e,a)}),this.simUI.individualConfig.playerInputs?.inputs.length&&this.configureInputSection(i.bodyElement,this.simUI.individualConfig.playerInputs);const n=nl.newGroupContainer();i.bodyElement.appendChild(n);const r=e(a).filter(e=>e!=a.Archeology);new Ag(n,this.simUI.player,{id:"simui-profession1",label:oe.t("settings_tab.player.profession_1"),values:r.map(e=>({name:Po(e),value:e})),changedEvent:e=>e.professionChangeEmitter,getValue:e=>e.getProfession1(),setValue:(e,t,a)=>t.setProfession1(e,a)}),new Ag(n,this.simUI.player,{id:"simui-profession2",label:oe.t("settings_tab.player.profession_2"),values:r.map(e=>({name:Po(e),value:e})),changedEvent:e=>e.professionChangeEmitter,getValue:e=>e.getProfession2(),setValue:(e,t,a)=>t.setProfession2(e,a)})}buildCustomSettingsSections(){(this.simUI.individualConfig.customSections||[]).forEach(e=>{e(this.column2,this.simUI).rootElem.classList.add("custom-section")})}buildConsumesSection(){const e=this.simUI.isWithinRaidSim?this.column3:this.column2,t=new $e(e,"consumes-settings",{header:{title:oe.t("settings_tab.consumables.title")}});m_.create(t.bodyElement,this,this.simUI)}buildOtherSettings(){const e=this.simUI.individualConfig.otherInputs?.inputs.filter(e=>!e.extraCssClasses?.includes("within-raid-sim-hide")||!0),t=this.simUI.individualConfig.itemSwapSlots||[];if(e.length>0||t.length>0){const a=new $e(this.column2,"other-settings",{header:{title:oe.t("settings_tab.other.title")}});e.length>0&&(this.configureInputSection(a.bodyElement,this.simUI.individualConfig.otherInputs),a.bodyElement.querySelectorAll(".input-root").forEach(e=>{e.classList.add("input-inline")})),t.length>0&&new Sk(a.bodyElement,this.simUI,this.simUI.player,{itemSlots:t})}}buildBuffsSettings(){const e=new $e(this.column3,"buffs-settings",{header:{title:oe.t("settings_tab.raid_buffs.title"),tooltip:oe.t("settings_tab.raid_buffs.tooltip")}});e.headerElement?.appendChild(H("p",{className:"fs-body"},oe.t("settings_tab.raid_buffs.description")));const t=o_(QS,this.simUI);this.configureIconSection(e.bodyElement,t.map(t=>t.picker&&new t.picker(e.bodyElement,this.simUI.player,t.config,this.simUI)));const a=o_(e_,this.simUI);a.length>0&&new ES(e.bodyElement,this.simUI.player,{inputs:a.map(e=>e.config),label:oe.t("settings_tab.raid_buffs.misc.label")},this.simUI)}raidExternalDamageCooldowns(){const e=o_(t_,this.simUI);if(e.length>0){const t=new $e(this.column3,"buffs-settings",{header:{title:oe.t("settings_tab.external_damage_cooldowns.title"),tooltip:oe.t("settings_tab.external_damage_cooldowns.tooltip")}});this.configureIconSection(t.bodyElement,e.map(e=>e.picker&&new e.picker(t.bodyElement,this.simUI.player,e.config)))}}raidExternalDefensiveCooldowns(){const e=o_(a_,this.simUI);if(e.length>0){const t=new $e(this.column3,"buffs-settings",{header:{title:oe.t("settings_tab.external_defensive_cooldowns.title"),tooltip:oe.t("settings_tab.external_defensive_cooldowns.tooltip")}});this.configureIconSection(t.bodyElement,e.map(e=>e.picker&&new e.picker(t.bodyElement,this.simUI.player,e.config)))}}buildDebuffsSettings(){const e=new $e(this.column3,"debuffs-settings",{header:{title:oe.t("settings_tab.debuffs.title"),tooltip:oe.t("settings_tab.debuffs.tooltip")}}),t=o_(i_,this.simUI);this.configureIconSection(e.bodyElement,t.map(t=>t.picker&&new t.picker(e.bodyElement,this.simUI.player,t.config,this.simUI)));const a=o_(s_,this.simUI);a.length&&new ES(e.bodyElement,this.simUI.player,{inputs:a.map(e=>e.config),label:oe.t("settings_tab.debuffs.misc.label")},this.simUI)}buildPresetConfigurationPicker(){new ra(this.rightPanel,this.simUI,[la.Encounter,la.Settings])}buildSavedDataPickers(){const e=new Pg(this.rightPanel,this.simUI.sim.encounter,{label:oe.t("settings_tab.saved_encounters.encounter"),header:{title:oe.t("settings_tab.saved_encounters.title")},nameLabel:oe.t("settings_tab.saved_encounters.encounter_name"),saveButtonText:oe.t("settings_tab.saved_encounters.save_encounter"),storageKey:this.simUI.getSavedEncounterStorageKey(),getData:e=>Ro.create({encounter:e.toProto()}),setData:(e,t,a)=>t.fromProto(e,a.encounter),changeEmitters:[this.simUI.sim.encounter.changeEmitter],equals:(e,t)=>Ro.equals(e,t),toJson:e=>Ro.toJson(e),fromJson:e=>Ro.fromJson(e)}),t=new Pg(this.rightPanel,this.simUI,{label:oe.t("settings_tab.saved_settings.settings"),header:{title:oe.t("settings_tab.saved_settings.title")},nameLabel:oe.t("settings_tab.saved_settings.settings_name"),saveButtonText:oe.t("settings_tab.saved_settings.save_settings"),storageKey:this.simUI.getSavedSettingsStorageKey(),getData:()=>this.getCurrentSavedSettings(),setData:(e,t,a)=>{te.freezeAllAndDo(()=>{t.sim.raid.setBuffs(e,a.raidBuffs||Mo.create()),t.sim.raid.setDebuffs(e,a.debuffs||Lo.create());const i=t.player.getParty();i&&i.setBuffs(e,a.partyBuffs||No.create()),t.player.setBuffs(e,a.playerBuffs||Oo.create()),t.player.setConsumes(e,a.consumables||Go.create()),t.player.setRace(e,a.race),t.player.setProfessions(e,a.professions),t.player.itemSwapSettings.setItemSwapSettings(e,a.enableItemSwap,t.sim.db.lookupItemSwap(a.itemSwap||zo.create()),n.fromProto(a.itemSwap?.prepullBonusStats)),t.player.setReactionTime(e,a.reactionTimeMs),t.player.setChannelClipDelay(e,a.channelClipDelayMs),t.player.setInFrontOfTarget(e,a.inFrontOfTarget),t.player.setDistanceFromTarget(e,a.distanceFromTarget),t.player.setHealingModel(e,a.healingModel||Fo.create()),t.player.setChallengeModeEnabled(e,a.challengeMode)})},changeEmitters:[this.simUI.sim.raid.buffsChangeEmitter,this.simUI.sim.raid.debuffsChangeEmitter,this.simUI.player.getParty().buffsChangeEmitter,this.simUI.player.buffsChangeEmitter,this.simUI.player.consumesChangeEmitter,this.simUI.player.raceChangeEmitter,this.simUI.player.professionChangeEmitter,this.simUI.player.itemSwapSettings.changeEmitter,this.simUI.player.miscOptionsChangeEmitter,this.simUI.player.inFrontOfTargetChangeEmitter,this.simUI.player.distanceFromTargetChangeEmitter,this.simUI.player.healingModelChangeEmitter],equals:(e,t)=>Do.equals(e,t),toJson:e=>Do.toJson(e),fromJson:e=>Do.fromJson(e)});this.simUI.sim.waitForInit().then(()=>{e.loadUserData(),t.loadUserData(),this.simUI.individualConfig.presets.settings?.forEach(e=>{t.addSavedData({name:e.name,tooltip:e.tooltip,isPreset:!0,data:Do.create({race:e.race,raidBuffs:e.raidBuffs,playerBuffs:e.buffs,debuffs:e.debuffs,consumables:e.consumables})})}),this.simUI.individualConfig.presets.itemSwaps?.forEach(e=>{this.simUI.player,t.addSavedData({name:e.name,tooltip:e.tooltip,isPreset:!0,data:Do.create({...this.getCurrentSavedSettings(),enableItemSwap:!0,itemSwap:e.itemSwap})})})})}getCurrentSavedSettings(){return Do.create({raidBuffs:this.simUI.sim.raid.getBuffs(),partyBuffs:this.simUI.player.getParty()?.getBuffs()||No.create(),playerBuffs:this.simUI.player.getBuffs(),debuffs:this.simUI.sim.raid.getDebuffs(),consumables:this.simUI.player.getConsumes(),race:this.simUI.player.getRace(),professions:this.simUI.player.getProfessions(),enableItemSwap:this.simUI.player.itemSwapSettings.getEnableItemSwap(),itemSwap:this.simUI.player.itemSwapSettings.toProto(),reactionTimeMs:this.simUI.player.getReactionTime(),channelClipDelayMs:this.simUI.player.getChannelClipDelay(),inFrontOfTarget:this.simUI.player.getInFrontOfTarget(),distanceFromTarget:this.simUI.player.getDistanceFromTarget(),healingModel:this.simUI.player.getHealingModel(),challengeMode:this.simUI.player.getChallengeModeEnabled()})}configureInputSection(e,t){t.inputs.forEach(t=>{"number"==t.type?new rl(e,this.simUI.player,t):"boolean"==t.type?new gc(e,this.simUI.player,{...t,reverse:!0}):"enum"==t.type&&new Ag(e,this.simUI.player,t)})}configureIconSection(e,t,a){0==t.length?e.classList.add("hide"):a&&(t.length<=4?e.style.gridTemplateColumns=`repeat(${t.length}, 1fr)`:t.length>4&&t.length<8&&(e.style.gridTemplateColumns=`repeat(${Math.ceil(t.length/2)}, 1fr)`))}}const b_=[{spec:Ho.Ferocity,label:"Ferocity",iconKey:"ability_druid_kingofthejungle"},{spec:Ho.Tenacity,label:"Tenacity",iconKey:"ability_druid_demoralizingroar"},{spec:Ho.Cunning,label:"Cunning",iconKey:"ability_eyeoftheowl"}];class y_ extends F{constructor(e,t){super(e,"pet-spec-picker"),this.player=t;const a=U();this.rootElem.replaceChildren(H(de,null,H("div",{className:"talent-tree-header"},H("span",{className:"talent-tree-title"},"Pet Spec")),H("div",{ref:a,className:"talent-tree-main pet-spec-list"},b_.map(({spec:e,label:t,iconKey:a})=>{const i=H("div",{className:"talent-picker-root pet-spec-item",onclick:()=>this.onClickSpec(e)},H("div",{className:"talent-picker-icon",style:{backgroundImage:`url('https://wow.zamimg.com/images/wow/icons/large/${a}.jpg')`}}),H("div",{className:"talent-picker-label"},t)),s=ie(i,{content:t});return this.addOnDisposeCallback(()=>s.destroy()),i})))),this.container=a.value,t.specOptionsChangeEmitter.on(()=>this.renderActive()),this.renderActive()}onClickSpec(e){if(e===this.player.getClassOptions().petSpec)return;const t=this.player.getClassOptions();t.petSpec=e,this.player.setClassOptions(te.nextEventID(),t)}renderActive(){const e=this.player.getClassOptions().petSpec,t=[Ho.Ferocity,Ho.Tenacity,Ho.Cunning];[...this.container.children].forEach((a,i)=>{const s=t[i];a.classList.toggle("selected",s===e)})}}class w_ extends Bg{constructor(e,t){super(e,t,{identifier:"talents-tab",title:oe.t("talents_tab.title")}),this.simUI=t,this.leftPanel=H("div",{className:"talents-tab-left tab-panel-left"}),this.rightPanel=H("div",{className:"talents-tab-right tab-panel-right within-raid-sim-hide"}),this.contentContainer.appendChild(this.leftPanel),this.contentContainer.appendChild(this.rightPanel),this.buildTabContent()}buildTabContent(){this.buildTalentsPicker(this.leftPanel),this.buildPresetConfigurationPicker(),this.buildSavedTalentsPicker(),this.buildHunterPetPicker(this.leftPanel)}buildHunterPetPicker(e){this.simUI.player.isClass(q.ClassHunter)&&new y_(e,this.simUI.player)}buildTalentsPicker(e){new If(e,this.simUI.player,{playerClass:this.simUI.player.getClass(),playerSpec:this.simUI.player.getSpec(),tree:Jf[this.simUI.player.getClass()],changedEvent:e=>e.talentsChangeEmitter,getValue:e=>e.getTalentsString(),setValue:(e,t,a)=>{Km({action:"settings",category:"talents",label:"update"}),t.setTalentsString(e,a)}})}buildPresetConfigurationPicker(){new ra(this.rightPanel,this.simUI,[la.Talents])}buildSavedTalentsPicker(){const e=new Pg(this.rightPanel,this.simUI.player,{label:oe.t("talents_tab.saved_talents.label"),header:{title:oe.t("talents_tab.saved_talents.title")},storageKey:this.simUI.getSavedTalentsStorageKey(),getData:e=>Uo.create({talentsString:e.getTalentsString(),glyphs:e.getGlyphs()}),setData:(e,t,a)=>{te.freezeAllAndDo(()=>{t.setTalentsString(e,a.talentsString),t.setGlyphs(e,a.glyphs||Vt.create())})},changeEmitters:[this.simUI.player.talentsChangeEmitter,this.simUI.player.glyphsChangeEmitter],equals:(e,t)=>Uo.equals(e,t),toJson:e=>Uo.toJson(e),fromJson:e=>Uo.fromJson(e),nameLabel:oe.t("talents_tab.saved_talents.name_label"),saveButtonText:oe.t("talents_tab.saved_talents.save_button"),deleteTooltip:oe.t("talents_tab.saved_talents.delete.tooltip"),deleteConfirmMessage:oe.t("talents_tab.saved_talents.delete.confirm"),chooseNameAlert:oe.t("talents_tab.saved_talents.alerts.choose_name"),nameExistsAlert:oe.t("talents_tab.saved_talents.alerts.name_exists")});this.simUI.sim.waitForInit().then(()=>{e.loadUserData(),this.simUI.individualConfig.presets.talents.forEach(t=>{t.isPreset=!0,e.addSavedData({name:t.name,isPreset:!0,data:t.data,onLoad:t.onLoad})})})}}const v_={id:"input-delay",type:"number",label:oe.t("settings_tab.other.input_delay.label"),labelTooltip:oe.t("settings_tab.other.input_delay.tooltip"),changedEvent:e=>e.miscOptionsChangeEmitter,getValue:e=>e.getReactionTime(),setValue:(e,t,a)=>{t.setReactionTime(e,a)}},x_={id:"challenge-mode",type:"boolean",label:oe.t("settings_tab.other.challenge_mode.label"),labelTooltip:oe.t("settings_tab.other.challenge_mode.tooltip"),changedEvent:e=>e.challengeModeChangeEmitter,getValue:e=>e.getChallengeModeEnabled(),setValue:(e,t,a)=>{t.setChallengeModeEnabled(e,a)}},S_={id:"channel-clip-delay",type:"number",label:oe.t("settings_tab.other.channel_clip_delay.label"),labelTooltip:oe.t("settings_tab.other.channel_clip_delay.tooltip"),changedEvent:e=>e.miscOptionsChangeEmitter,getValue:e=>e.getChannelClipDelay(),setValue:(e,t,a)=>{t.setChannelClipDelay(e,a)}},__={id:"in-front-of-target",type:"boolean",label:oe.t("settings_tab.other.in_front_of_target.label"),labelTooltip:oe.t("settings_tab.other.in_front_of_target.tooltip"),changedEvent:e=>e.inFrontOfTargetChangeEmitter,getValue:e=>e.getInFrontOfTarget(),setValue:(e,t,a)=>{t.setInFrontOfTarget(e,a)}},k_={id:"distance-from-target",type:"number",label:oe.t("settings_tab.other.distance_from_target.label"),labelTooltip:oe.t("settings_tab.other.distance_from_target.tooltip"),changedEvent:e=>e.distanceFromTargetChangeEmitter,getValue:e=>e.getDistanceFromTarget(),setValue:(e,t,a)=>{t.setDistanceFromTarget(e,a)}},C_={id:"tank-assignment",type:"enum",extraCssClasses:["tank-selector","threat-metrics","within-raid-sim-hide"],label:oe.t("settings_tab.other.tank_assignment.label"),labelTooltip:oe.t("settings_tab.other.tank_assignment.tooltip"),values:[{name:oe.t("common.none"),value:-1},{name:oe.t("common.tanks.main_tank"),value:0},{name:oe.t("common.tanks.tank_2"),value:1},{name:oe.t("common.tanks.tank_3"),value:2},{name:oe.t("common.tanks.tank_4"),value:3}],changedEvent:e=>e.getRaid().tanksChangeEmitter,getValue:e=>(e.getRaid()?.getTanks()||[]).findIndex(t=>Ge.equals(t,e.makeUnitReference())),setValue:(e,t,a)=>{const i=[];if(-1!=a){for(let e=0;e<a;e++)i.push(Bo());i.push(t.makeUnitReference())}t.getRaid().setTanks(e,i)}},I_={id:"incoming-hps",type:"number",label:oe.t("settings_tab.other.incoming_hps.label"),labelTooltip:oe.t("settings_tab.other.incoming_hps.tooltip"),changedEvent:e=>e.getRaid().changeEmitter,getValue:e=>e.getHealingModel().hps,setValue:(e,t,a)=>{const i=t.getHealingModel();i.hps=a,t.setHealingModel(e,i)},enableWhen:e=>null!=(e.getRaid()?.getTanks()||[]).find(t=>Ge.equals(t,e.makeUnitReference()))},E_={id:"healing-cadence",type:"number",float:!0,label:oe.t("settings_tab.other.healing_cadence.label"),labelTooltip:oe.t("settings_tab.other.healing_cadence.tooltip"),changedEvent:e=>e.getRaid().changeEmitter,getValue:e=>e.getHealingModel().cadenceSeconds,setValue:(e,t,a)=>{const i=t.getHealingModel();i.cadenceSeconds=a,t.setHealingModel(e,i)},enableWhen:e=>null!=(e.getRaid()?.getTanks()||[]).find(t=>Ge.equals(t,e.makeUnitReference()))},T_={id:"healing-cadence-variation",type:"number",float:!0,label:oe.t("settings_tab.other.healing_cadence_variation.label"),labelTooltip:oe.t("settings_tab.other.healing_cadence_variation.tooltip"),changedEvent:e=>e.getRaid().changeEmitter,getValue:e=>e.getHealingModel().cadenceVariation,setValue:(e,t,a)=>{const i=t.getHealingModel();i.cadenceVariation=a,t.setHealingModel(e,i)},enableWhen:e=>null!=(e.getRaid()?.getTanks()||[]).find(t=>Ge.equals(t,e.makeUnitReference()))},A_={id:"healing-model-absorb-frac",type:"number",float:!0,label:oe.t("settings_tab.other.absorb_frac.label"),labelTooltip:oe.t("settings_tab.other.absorb_frac.tooltip"),changedEvent:e=>e.healingModelChangeEmitter,getValue:e=>100*e.getHealingModel().absorbFrac,setValue:(e,t,a)=>{const i=t.getHealingModel();i.absorbFrac=a/100,t.setHealingModel(e,i)}},P_={id:"burst-window",type:"number",float:!1,label:oe.t("settings_tab.other.burst_window.label"),labelTooltip:oe.t("settings_tab.other.burst_window.tooltip"),changedEvent:e=>e.getRaid().changeEmitter,getValue:e=>e.getHealingModel().burstWindow,setValue:(e,t,a)=>{const i=t.getHealingModel();i.burstWindow=a,t.setHealingModel(e,i)},enableWhen:e=>null!=(e.getRaid()?.getTanks()||[]).find(t=>Ge.equals(t,e.makeUnitReference()))},R_={id:"hp-percent-for-defensives",type:"number",float:!0,label:oe.t("settings_tab.other.hp_percent_for_defensives.label"),labelTooltip:oe.t("settings_tab.other.hp_percent_for_defensives.tooltip"),changedEvent:e=>e.rotationChangeEmitter,getValue:e=>100*e.getSimpleCooldowns().hpPercentForDefensives,setValue:(e,t,a)=>{const i=t.getSimpleCooldowns();i.hpPercentForDefensives=a/100,t.setSimpleCooldowns(e,i)}};class D_{constructor(e){this.changeEmitter=new te,this._excludedStats=[],this._excludedPseudoStats=[],this.storageKey=e.getStorageKey("__statweight_settings__"),this.changeEmitter.on(()=>{const e=Yo.toJsonString(this.toProto());window.localStorage.setItem(this.storageKey,e)})}set excludedStats(e){this._excludedStats=e}get excludedStats(){return this._excludedStats.slice()}set excludedPseudoStats(e){this._excludedPseudoStats=e}get excludedPseudoStats(){return this._excludedPseudoStats.slice()}static updateProtoVersion(e){}applyDefaults(e){this.excludedStats=[],this.excludedPseudoStats=[],this.changeEmitter.emit(e)}load(e){const t=window.localStorage.getItem(this.storageKey);if(t){const a=Yo.fromJsonString(t,{ignoreUnknownFields:!0}),{excludedStats:i,excludedPseudoStats:s}=a;this.excludedStats=i||[],this.excludedPseudoStats=s||[],this.changeEmitter.emit(e)}}toProto(){return Yo.create({apiVersion:yo,excludedStats:this.excludedStats,excludedPseudoStats:this.excludedPseudoStats})}isStatExcludedFromCalc(e){return!!this.excludedStats.includes(e)}isPseudoStatExcludedFromCalc(e){return!!this.excludedPseudoStats.includes(e)}isUnitStatExcludedFromCalc(e){return e.isStat()?this.isStatExcludedFromCalc(e.getStat()):this.isPseudoStatExcludedFromCalc(e.getPseudoStat())}setStatExcluded(e,t,a){const i=(e,t)=>{const i=t.indexOf(e);return a?-1===i&&t.push(e):-1!==i&&t.splice(i,1),t};t.isStat()?this.excludedStats=i(t.getStat(),this.excludedStats):this.excludedPseudoStats=i(t.getPseudoStat(),this.excludedPseudoStats),this.changeEmitter.emit(e)}}const M_=e=>{const t={footer:!0,scrollContents:!0};return e.sim.getShowThreatMetrics()?{size:"xl",...t}:t},L_=class e extends Wr{constructor(e,t){super(e.rootElem,"ep-weights-menu",{...M_(e),disposeOnClose:!1}),this.showAllStats=!1,this.header?.insertAdjacentElement("afterbegin",H("h5",{className:"modal-title"},oe.t("sidebar.buttons.stat_weights.modal.title"))),this.simUI=e,this.statsType="ep",this.epStats=this.simUI.individualConfig.epStats,this.epPseudoStats=this.simUI.individualConfig.epPseudoStats||[],this.epReferenceStat=this.simUI.individualConfig.epReferenceStat,this.settings=t;const a=this.buildStatsTable(),i=U(),s=U(),o=U(),r=U(),l=U(),c=U(),h=U(),d=U(),u=U(),p=U(),m=U(),g=e=>void 0!==e?ot(e):"??",f=e=>Object.values(this.epStats).find(t=>g(t)===e),b=H(de,null,this.epStats.map(e=>H("option",null,g(e))));this.body.appendChild(H("div",{className:"d-flex flex-column flex-lg-row align-items-lg-start gap-3"},H("div",{className:"ep-weights-content order-1 order-lg-0"},H("div",{className:"ep-weights-options row"},H("div",{className:"col col-sm-3"},H("select",{ref:d,className:"ep-type-select form-select"},H("option",{value:"ep"},oe.t("sidebar.buttons.stat_weights.modal.ep")),H("option",{value:"weight"},oe.t("sidebar.buttons.stat_weights.modal.weights")))),H("div",{ref:m,className:"show-all-stats-container col col-sm-3"})),H("div",{className:"ep-reference-options row"},H("div",{className:"col col-sm-4 damage-metrics"},H("span",null,oe.t("sidebar.buttons.stat_weights.modal.dps_tps_reference")),H("select",{ref:l,className:"ref-stat-select form-select damage-metrics"},b.cloneNode(!0))),H("div",{className:"col col-sm-4 healing-metrics"},H("span",null,oe.t("sidebar.buttons.stat_weights.modal.healing_reference")),H("select",{ref:c,className:"ref-stat-select form-select healing-metrics"},b.cloneNode(!0))),H("div",{className:"col col-sm-4 threat-metrics"},H("span",null,oe.t("sidebar.buttons.stat_weights.modal.mitigation_reference")),H("select",{ref:h,className:"ref-stat-select form-select threat-metrics"},b.cloneNode(!0))),H("p",null,oe.t("sidebar.buttons.stat_weights.modal.reference_description"))),H("p",null,oe.t("sidebar.buttons.stat_weights.modal.current_ep_description"),H("br",null),oe.t("sidebar.buttons.stat_weights.modal.copy_icon_description")),H("div",{ref:i,className:"results-ep-table-container modal-scroll-table"},H("table",{ref:o,className:"results-ep-table"},H("thead",null,H("tr",null,H("th",null,oe.t("sidebar.buttons.stat_weights.modal.column_headers.stat")),H("th",null,oe.t("sidebar.buttons.stat_weights.modal.column_headers.update")),a.map(({metric:e,type:t,label:a,metricRef:i})=>{const s="action"===t;return H("th",{className:xr(e&&`${e}-metrics`,s?"text-center":`type-${t}`)},H("span",null,a),H("button",{ref:i,className:"col-action"},H("i",{className:xr("fas",s?"fa-arrows-rotate":"fa-copy")})))})),H("tr",{className:"ep-ratios"},H("td",null,oe.t("sidebar.buttons.stat_weights.modal.column_headers.ep_ratio")),H("td",null),a.filter(({type:e})=>"action"!==e).map(({metric:e,type:t,ratioRef:a})=>H("td",{ref:a,className:xr("type-ratio",`${e}-metrics`,`type-${t}`)})),H("td",{className:"text-center align-middle"},H("button",{ref:u,className:"btn btn-primary compute-ep"},H("i",{className:"fas fa-calculator"}),H("span",{className:"not-tiny"},oe.t("sidebar.buttons.stat_weights.modal.column_headers.update_ep_button")))))),H("tbody",{ref:r})))),H("div",{ref:s,className:"ep-weights-sidebar sticky-lg-top order-0 order-lg-1"}))),this.footer.appendChild(H(de,null,H("button",{ref:p,className:"btn btn-primary calc-weights"},H("i",{className:"fas fa-calculator me-1"}),oe.t("sidebar.buttons.stat_weights.modal.calculate")))),this.container=i.value,this.sidebar=s.value,this.table=o.value,this.tableBody=r.value;const y=H("div",{className:"results-pending-overlay"});this.resultsViewer=new Ug(y);const w=()=>{"ep"===this.statsType?(this.table.classList.remove("stats-type-weight"),this.table.classList.add("stats-type-ep")):(this.table.classList.add("stats-type-weight"),this.table.classList.remove("stats-type-ep"))},v=d.value;v.addEventListener("input",()=>{this.statsType=v.value,w()}),v.value=this.statsType,w();const x=()=>{this.simUI.player.epRefStatChangeEmitter.emit(te.nextEventID()),this.simUI.prevEpSimResult=this.calculateEp(this.getPrevSimResult()),this.updateTable()},S=l.value;S&&(S.addEventListener("input",()=>{this.simUI.dpsRefStat=f(S.value),x()}),S.value=g(this.getDpsEpRefStat()));const _=c.value;_&&(_.addEventListener("input",()=>{this.simUI.healRefStat=f(_.value),x()}),_.value=g(this.getHealEpRefStat()));const k=h.value;k&&(k.addEventListener("input",()=>{this.simUI.tankRefStat=f(k.value),x()}),k.value=g(this.getTankEpRefStat()));const C=p.value;let I=!1;C?.addEventListener("click",async()=>{if(Km({action:"sim",category:"stat_weights",label:"calculate"}),I)return;I=!0;try{await this.simUI.sim.signalManager.abortType(qm.All)}catch(n){return void console.error(n)}C.disabled=!0,this.simUI.rootElem.classList.add("blurred"),this.simUI.rootElem.insertAdjacentElement("afterend",y),this.container.scrollTo({top:0}),this.container.classList.add("pending"),this.resultsViewer.setPending();const t=this.simUI.sim.getIterations();let a=!1;this.resultsViewer.addAbortButton(async()=>{if(!a)try{a=!0,await e.sim.signalManager.abortType(qm.StatWeights)}catch(n){console.error("Error on stat weight abort!"),console.error(n)}finally{a=!1,I||(C.disabled=!1)}});const i=this.epStats.filter(e=>!this.settings.isStatExcludedFromCalc(e)),s=this.epPseudoStats.filter(e=>!this.settings.isPseudoStatExcludedFromCalc(e)),o=await this.simUI.player.computeStatWeights(te.nextEventID(),i,s,this.epReferenceStat,e=>{this.setSimProgress(e)});this.simUI.rootElem.classList.remove("blurred"),y.remove(),this.container.classList.remove("pending"),this.resultsViewer.hideAll(),I=!1,a||(C.disabled=!1),o&&(this.simUI.prevEpIterations=t,this.simUI.prevEpSimResult=this.calculateEp(o),this.updateTable())}),this.addOnHideCallback(()=>{this.simUI.sim.signalManager.abortType(qm.StatWeights).catch(console.error)});const E=(e,t,a,i,s)=>{const o=e.previousElementSibling;ie(o,{content:()=>{if(!s)return t;const e=g(s());return`${t} ${oe.t("sidebar.buttons.stat_weights.modal.tooltips.normalized_by",{refStatName:e})}`}}),ie(e,{content:a}),e.addEventListener("click",()=>{this.setEpWeightsWithoutExcluded(n.fromProto(i())),this.updateTable()})};a.forEach(({metricRef:e,labelTooltip:t,actionTooltip:a,getWeights:i,getEpRefStat:s})=>E(e.value,t,a,i,s)),new gc(m.value,this,{id:"ep-show-all-stats",label:oe.t("sidebar.buttons.stat_weights.modal.show_all_stats"),inline:!0,changedEvent:()=>new te,getValue:()=>this.showAllStats,setValue:(e,t,a)=>{this.showAllStats=a,this.updateTable()}}),this.updateTable();const T=(e,t)=>{new rl(e,this.simUI.player,{id:`ep-ratio-${t}`,float:!0,changedEvent:e=>e.epRatiosChangeEmitter,getValue:()=>this.simUI.player.getEpRatios()[t],setValue:(e,a,i)=>{const s=a.getEpRatios();s[t]=i,a.setEpRatios(e,s)}})};a.filter(({type:e,ratioRef:t})=>"ep"===e&&!!t?.value).map(({ratioRef:e})=>e.value).forEach(T),this.simUI.player.epRatiosChangeEmitter.on(e=>this.updateTable());a.filter(({type:e,ratioRef:t})=>"weight"===e&&!!t?.value).map(({ratioRef:e})=>e.value).forEach(T);const A=u.value;ie(A,{content:oe.t("sidebar.buttons.stat_weights.modal.tooltips.compute_weighted_ep")}),A.addEventListener("click",()=>{const e=this.getPrevSimResult(),t=this.simUI.player.getEpRatios();if("ep"===this.statsType){const a=n.fromProto(e.dps.epValues).scale(t[0]),i=n.fromProto(e.hps.epValues).scale(t[1]),s=n.fromProto(e.tps.epValues).scale(t[2]),o=n.fromProto(e.dtps.epValues).scale(t[3]),r=n.fromProto(e.tmi.epValues).scale(t[4]),l=n.fromProto(e.pDeath.epValues).scale(t[5]),c=a.add(i).add(s).add(o).add(r).add(l);this.setEpWeightsWithoutExcluded(c)}else{const a=n.fromProto(e.dps.weights).scale(t[0]),i=n.fromProto(e.hps.weights).scale(t[1]),s=n.fromProto(e.tps.weights).scale(t[2]),o=n.fromProto(e.dtps.weights).scale(t[3]),r=n.fromProto(e.tmi.weights).scale(t[4]),l=n.fromProto(e.pDeath.weights).scale(t[5]),c=a.add(i).add(s).add(o).add(r).add(l);this.setEpWeightsWithoutExcluded(c)}this.updateTable()}),this.buildSavedEPWeightsPicker()}setEpWeightsWithoutExcluded(e){const{excludedStats:t,excludedPseudoStats:a}=this.settings,i=this.simUI.player.getEpWeights();for(const s of t)e=e.withStat(s,i.getStat(s));for(const s of a)e=e.withPseudoStat(s,i.getPseudoStat(s));this.simUI.player.setEpWeights(te.nextEventID(),e)}isEpStat(e){return e.isStat()?this.epStats.includes(e.getStat()):this.epPseudoStats.includes(e.getPseudoStat())}setSimProgress(e){this.resultsViewer.setContent(H("div",{className:"results-sim"},H("div",null,e.completedSims," / ",e.totalSims,H("br",null),oe.t("sidebar.buttons.stat_weights.modal.progress.simulations_complete")),H("div",null,e.completedIterations," / ",e.totalIterations,H("br",null),oe.t("sidebar.buttons.stat_weights.modal.progress.iterations_complete"))))}updateTable(){const t=H(de,null);e.epUnitStats.forEach(e=>{if(!this.showAllStats&&e.isStat()&&!this.epStats.includes(e.getStat())||e.isPseudoStat()&&!this.epPseudoStats.includes(e.getPseudoStat()))return;const a=this.makeTableRow(e);t.appendChild(a)}),this.tableBody.replaceChildren(t)}makeTableRow(e){const t=this.settings.isUnitStatExcludedFromCalc(e)?null:this.simUI.prevEpSimResult,a=this.simUI.player.getEpRatios(),i=((e,t,a)=>a?(a.dps?.epValues?t[0]*e.getProtoValue(a.dps.epValues):0)+(a.hps?.epValues?t[1]*e.getProtoValue(a.hps.epValues):0)+(a.tps?.epValues?t[2]*e.getProtoValue(a.tps.epValues):0)+(a.dtps?.epValues?t[3]*e.getProtoValue(a.dtps.epValues):0)+(a.tmi?.epValues?t[4]*e.getProtoValue(a.tmi.epValues):0)+(a.pDeath?.epValues?t[5]*e.getProtoValue(a.pDeath.epValues):0):0)(e,a,t),s=U(),o=U(),n=H("tr",null,H("td",null,e.getFullName(this.simUI.player.getClass())),H("td",{ref:o,className:"swcalc-include-toggle"}),this.makeTableRowCells(e,t?.dps,"damage-metrics",i,a[0]),this.makeTableRowCells(e,t?.hps,"healing-metrics",i,a[1]),this.makeTableRowCells(e,t?.tps,"threat-metrics",i,a[2]),this.makeTableRowCells(e,t?.dtps,"threat-metrics",i,a[3]),this.makeTableRowCells(e,t?.tmi,"threat-metrics",i,a[4]),this.makeTableRowCells(e,t?.pDeath,"threat-metrics",i,a[5]),H("td",{ref:s,className:"current-ep"}));o.value&&this.isEpStat(e)&&new gc(o.value,this,{id:"sw-stat-toggle-"+e.getFullName(this.simUI.player.getClass()),getValue:t=>!t.settings.isUnitStatExcludedFromCalc(e),setValue:(t,a,i)=>a.settings.setStatExcluded(t,e,!i),changedEvent:e=>e.settings.changeEmitter,enableWhen:t=>!e.isStat()||t.epReferenceStat!=e.getStat()});const r=s.value;return new rl(r,this.simUI.player,{id:`ep-weight-stat-${Wo(e.getShortName(this.simUI.player.playerClass.classID))}`,float:!0,changedEvent:e=>e.epWeightsChangeEmitter,getValue:()=>this.simUI.player.getEpWeights().getUnitStat(e),setValue:(t,a,i)=>{const s=a.getEpWeights().withUnitStat(e,i);a.setEpWeights(t,s)}}),n}makeTableRowCells(e,t,a,i,s){let o=null,n=null;const r=0===s,l=U(),c=U();if(t){const a=e.getProtoValue(t.weights),i=e.getProtoValue(t.weightsStdev);o=this.makeTableCellContents(a,i);const s=e.getProtoValue(t.epValues),r=e.getProtoValue(t.epValuesStdev);n=this.makeTableCellContents(s,r)}else o=H("span",{className:"results-avg notapplicable"},oe.t("sidebar.buttons.stat_weights.modal.not_applicable")),n=o.cloneNode(!0);const h=H(de,null,H("td",{ref:l,className:xr("stdev-cell","type-weight",t&&r&&"unused-ep",a)},o),H("td",{ref:c,className:xr("stdev-cell","type-ep",t&&r&&"unused-ep",a)},n));if(!t||r)return h;const d=i-this.simUI.player.getEpWeights().getUnitStat(e),u=c.value.querySelector(".type-ep .results-avg");return"0.00"===d.toFixed(2)||(d>0?u.classList.add("positive"):d<0&&u.classList.add("negative")),h}makeTableCellContents(e,t){const a=this.simUI.prevEpIterations||1;return H(de,null,H("span",{className:"results-avg"},e.toFixed(2)),H("span",{className:"results-stdev"},"(",H("i",{className:"fas fa-plus-minus fa-xs"}),Vo(t,a).toFixed(2),")"))}calculateEp(t){const a=jo.clone(t);return void 0!==this.simUI.dpsRefStat&&(e.normaliseEpValue(this.simUI.dpsRefStat,a.dps),e.normaliseEpValue(this.simUI.dpsRefStat,a.tps)),void 0!==this.simUI.healRefStat&&e.normaliseEpValue(this.simUI.healRefStat,a.hps),void 0!==this.simUI.tankRefStat&&(e.normaliseEpValue(this.simUI.tankRefStat,a.dtps),e.normaliseEpValue(this.simUI.tankRefStat,a.tmi),e.normaliseEpValue(this.simUI.tankRefStat,a.pDeath)),a}static normaliseEpValue(t,a){const i=ne.fromStat(t),s=i.getProtoValue(a.weights),o=i.getProtoValue(a.weightsStdev);e.epUnitStats.forEach(e=>{const t=e.getProtoValue(a.weights);e.setProtoValue(a.epValues,0===s?0:t/s);const i=e.getProtoValue(a.weightsStdev);e.setProtoValue(a.epValuesStdev,0===o?0:i/o)})}getDpsEpRefStat(){return void 0!==this.simUI.dpsRefStat?this.simUI.dpsRefStat:this.epReferenceStat}getHealEpRefStat(){return void 0!==this.simUI.healRefStat?this.simUI.healRefStat:this.epReferenceStat}getTankEpRefStat(){return void 0!==this.simUI.tankRefStat?this.simUI.tankRefStat:ee.StatArmor}getPrevSimResult(){return this.simUI.prevEpSimResult||jo.create({dps:{weights:(new n).toProto(),weightsStdev:(new n).toProto(),epValues:(new n).toProto(),epValuesStdev:(new n).toProto()},hps:{weights:(new n).toProto(),weightsStdev:(new n).toProto(),epValues:(new n).toProto(),epValuesStdev:(new n).toProto()},tps:{weights:(new n).toProto(),weightsStdev:(new n).toProto(),epValues:(new n).toProto(),epValuesStdev:(new n).toProto()},dtps:{weights:(new n).toProto(),weightsStdev:(new n).toProto(),epValues:(new n).toProto(),epValuesStdev:(new n).toProto()},tmi:{weights:(new n).toProto(),weightsStdev:(new n).toProto(),epValues:(new n).toProto(),epValuesStdev:(new n).toProto()},pDeath:{weights:(new n).toProto(),weightsStdev:(new n).toProto(),epValues:(new n).toProto(),epValuesStdev:(new n).toProto()}})}buildSavedEPWeightsPicker(){Rg(this.sidebar,this.simUI)}buildStatsTable(){const e=oe.t("sidebar.buttons.stat_weights.modal.tooltips.copy_to_current_ep"),t=()=>({metricRef:U(),ratioRef:U()});return[{metric:"damage",type:"weight",label:oe.t("sidebar.buttons.stat_weights.modal.dps_weight.label"),labelTooltip:oe.t("sidebar.buttons.stat_weights.modal.dps_weight.tooltip"),actionTooltip:e,getWeights:()=>this.getPrevSimResult().dps.weights,...t()},{metric:"damage",type:"ep",label:oe.t("sidebar.buttons.stat_weights.modal.dps_ep.label"),labelTooltip:oe.t("sidebar.buttons.stat_weights.modal.dps_ep.tooltip"),actionTooltip:e,getWeights:()=>this.getPrevSimResult().dps.epValues,getEpRefStat:()=>this.getDpsEpRefStat(),...t()},{metric:"healing",type:"weight",label:oe.t("sidebar.buttons.stat_weights.modal.hps_weight.label"),labelTooltip:oe.t("sidebar.buttons.stat_weights.modal.hps_weight.tooltip"),actionTooltip:e,getWeights:()=>this.getPrevSimResult().hps.weights,...t()},{metric:"healing",type:"ep",label:oe.t("sidebar.buttons.stat_weights.modal.hps_ep.label"),labelTooltip:oe.t("sidebar.buttons.stat_weights.modal.hps_ep.tooltip"),actionTooltip:e,getWeights:()=>this.getPrevSimResult().hps.epValues,getEpRefStat:()=>this.getHealEpRefStat(),...t()},{metric:"threat",type:"weight",label:oe.t("sidebar.buttons.stat_weights.modal.tps_weight.label"),labelTooltip:oe.t("sidebar.buttons.stat_weights.modal.tps_weight.tooltip"),actionTooltip:e,getWeights:()=>this.getPrevSimResult().tps.weights,...t()},{metric:"threat",type:"ep",label:oe.t("sidebar.buttons.stat_weights.modal.tps_ep.label"),labelTooltip:oe.t("sidebar.buttons.stat_weights.modal.tps_ep.tooltip"),actionTooltip:e,getWeights:()=>this.getPrevSimResult().tps.epValues,getEpRefStat:()=>this.getDpsEpRefStat(),...t()},{metric:"threat",type:"weight",label:oe.t("sidebar.buttons.stat_weights.modal.dtps_weight.label"),labelTooltip:oe.t("sidebar.buttons.stat_weights.modal.dtps_weight.tooltip"),actionTooltip:e,getWeights:()=>this.getPrevSimResult().dtps.weights,...t()},{metric:"threat",type:"ep",label:oe.t("sidebar.buttons.stat_weights.modal.dtps_ep.label"),labelTooltip:oe.t("sidebar.buttons.stat_weights.modal.dtps_ep.tooltip"),actionTooltip:e,getWeights:()=>this.getPrevSimResult().dtps.epValues,getEpRefStat:()=>this.getTankEpRefStat(),...t()},{metric:"threat",type:"weight",label:oe.t("sidebar.buttons.stat_weights.modal.tmi_weight.label"),labelTooltip:oe.t("sidebar.buttons.stat_weights.modal.tmi_weight.tooltip"),actionTooltip:e,getWeights:()=>this.getPrevSimResult().tmi.weights,...t()},{metric:"threat",type:"ep",label:oe.t("sidebar.buttons.stat_weights.modal.tmi_ep.label"),labelTooltip:oe.t("sidebar.buttons.stat_weights.modal.tmi_ep.tooltip"),actionTooltip:e,getWeights:()=>this.getPrevSimResult().tmi.epValues,getEpRefStat:()=>this.getTankEpRefStat(),...t()},{metric:"threat",type:"weight",label:oe.t("sidebar.buttons.stat_weights.modal.death_weight.label"),labelTooltip:oe.t("sidebar.buttons.stat_weights.modal.death_weight.tooltip"),actionTooltip:e,getWeights:()=>this.getPrevSimResult().pDeath.weights,...t()},{metric:"threat",type:"ep",label:oe.t("sidebar.buttons.stat_weights.modal.death_ep.label"),labelTooltip:oe.t("sidebar.buttons.stat_weights.modal.death_ep.tooltip"),actionTooltip:e,getWeights:()=>this.getPrevSimResult().pDeath.epValues,getEpRefStat:()=>this.getTankEpRefStat(),...t()},{type:"action",label:oe.t("sidebar.buttons.stat_weights.modal.current_ep.label"),labelTooltip:oe.t("sidebar.buttons.stat_weights.modal.current_ep.tooltip"),actionTooltip:oe.t("sidebar.buttons.stat_weights.modal.tooltips.restore_default_ep"),getWeights:()=>this.simUI.individualConfig.defaults.epWeights.toProto(),...t()}]}};L_.epUnitStats=ne.getAll().filter(e=>!!e.isStat()||[T.PseudoStatMainHandDps,T.PseudoStatOffHandDps,T.PseudoStatRangedDps,T.PseudoStatPhysicalHitPercent,T.PseudoStatSpellHitPercent,T.PseudoStatPhysicalCritPercent,T.PseudoStatSpellCritPercent].includes(e.getPseudoStat()));let N_=L_;function O_(e){return e.requiredTalentRows?e.requiredTalentRows:[0,1,2,3,4,5]}class G_ extends F{constructor(e){super(null),this.toast=null,this.container=e,this.hasSeenNotice||qo()||Xo()||(this.render(),this.toast?.element.addEventListener("hide.bs.toast",()=>{this.setHasSeenNotice()},{once:!0}))}get settingsKey(){return`${$o}_notice-local-sim.v1`}get hasSeenNotice(){return window.localStorage.getItem(this.settingsKey)}setHasSeenNotice(){window.localStorage.setItem(this.settingsKey,"true")}render(){this.toast=new Dg({additionalClasses:["toast-notice-local-download"],container:this.container,variant:"info",title:oe.t("sim.notice_local_download.title"),autohide:!1,body:H("div",null,H("p",null,oe.t("sim.notice_local_download.message")),H("a",{href:ea,className:"btn btn-outline-light",target:"_blank",onclick:()=>this.setHasSeenNotice()},oe.t("sim.notice_local_download.download_button")))})}}class z_ extends Wr{constructor(e,t){super(e,"settings-menu",{title:oe.t("info.options.title"),footer:!0,disposeOnClose:!1}),this.simUI=t;const a=U(),i=U(),s=U(),o=U(),n=U(),r=U(),l=U(),c=U(),h=U(),d=U(),u=H("div",null,H("div",{className:"picker-group"},H("div",{className:"fixed-rng-seed-container"},H("div",{ref:i,className:"fixed-rng-seed"}),H("div",{className:"form-text"},H("span",null,oe.t("info.options.fixed_rng_seed.last_used")),"",H("span",{ref:s,className:"last-used-rng-seed"},"0"))),H("div",{ref:o,className:"language-picker within-raid-sim-hide"})),H("div",{ref:n,className:"show-threat-metrics-picker w-50 pe-2"}),H("div",{ref:r,className:"show-experimental-picker w-50 pe-2"}),H("div",{ref:l,className:"show-quick-swap-picker w-50 pe-2"}),H("div",{ref:c,className:"use-concurrency-container w-50 pe-2"},H("div",{ref:h,className:"use-concurrent-workers-picker"}),H("div",{ref:d,className:"form-text",hidden:!0})));this.body.innerHTML="",this.body.appendChild(u);const p=H("button",{ref:a,className:"restore-defaults-button btn btn-primary"},oe.t("info.options.restore_defaults.button"));if(this.footer&&(this.footer.innerHTML="",this.footer.appendChild(p)),a.value&&(ie(a.value,{content:oe.t("info.options.restore_defaults.tooltip")}),a.value.addEventListener("click",()=>{Km({action:"settings",category:"restore-defaults",label:"restore"}),this.simUI.applyDefaults(te.nextEventID()),new Dg({variant:"success",body:oe.t("info.options.restore_defaults.success_message")})})),i.value&&new rl(i.value,this.simUI.sim,{id:"simui-fixed-rng-seed",label:oe.t("info.options.fixed_rng_seed.label"),labelTooltip:oe.t("info.options.fixed_rng_seed.tooltip"),extraCssClasses:["mb-0"],changedEvent:e=>e.fixedRngSeedChangeEmitter,getValue:e=>e.getFixedRngSeed(),setValue:(e,t,a)=>{t.setFixedRngSeed(e,a)}}),s.value&&(s.value.textContent=String(this.simUI.sim.getLastUsedRngSeed()),this.simUI.sim.lastUsedRngSeedChangeEmitter.on(()=>{s.value&&(s.value.textContent=String(this.simUI.sim.getLastUsedRngSeed()))})),o.value){const e=Object.keys(Ko),t=e.indexOf("en");new Ag(o.value,this.simUI.sim,{id:"simui-language-picker",label:oe.t("info.options.language.label"),labelTooltip:oe.t("info.options.language.tooltip"),values:e.map((e,t)=>({name:Ko[e],value:t})),changedEvent:e=>e.languageChangeEmitter,getValue:a=>{const i=e.indexOf(a.getLanguage());return-1==i?t:i},setValue:(t,a,i)=>{Km({action:"settings",category:"language",label:"update",value:e[i]}),a.setLanguage(t,e[i]||"en"),Zo(e[i]||"en")}}).changeEmitter.on(()=>setTimeout(()=>location.reload(),300))}if(n.value&&new gc(n.value,this.simUI.sim,{id:"simui-show-threat-metrics",label:oe.t("info.options.feature_toggles.show_threat_metrics"),labelTooltip:"Shows all options and metrics relevant to tanks, like TPS/DTPS.",inline:!0,changedEvent:e=>e.showThreatMetricsChangeEmitter,getValue:e=>e.getShowThreatMetrics(),setValue:(e,t,a)=>{t.setShowThreatMetrics(e,a)}}),r.value&&new gc(r.value,this.simUI.sim,{id:"simui-show-experimental",label:oe.t("info.options.feature_toggles.show_experimental"),labelTooltip:"Shows experimental options, if there are any active experiments.",inline:!0,changedEvent:e=>e.showExperimentalChangeEmitter,getValue:e=>e.getShowExperimental(),setValue:(e,t,a)=>{Km({action:"settings",category:"show-experimental",label:"update",value:a}),t.setShowExperimental(e,a)}}),l.value&&new gc(l.value,this.simUI.sim,{id:"simui-show-quick-swap",label:oe.t("info.options.feature_toggles.show_quick_swap"),labelTooltip:"Allows you to quickly swap between Gems/Enchants through your favorites. (Disabled on touch devices)",inline:!0,changedEvent:e=>e.showQuickSwapChangeEmitter,getValue:e=>e.getShowQuickSwap(),setValue:(e,t,a)=>{t.setShowQuickSwap(e,a)}}),c.value&&h.value){const e=[{value:0,name:"Off"}];for(let t=2;t<=navigator.hardwareConcurrency;t++)e.push({value:t,name:t.toString()});if(new Ag(h.value,this.simUI.sim,{id:"simui-concurrent-workers-picker",label:oe.t("info.options.use_multiple_cpu_cores.label"),labelTooltip:"Use web workers to spread sim workload over multiple CPU cores.",changedEvent:e=>e.wasmConcurrencyChangeEmitter,getValue:e=>e.getWasmConcurrency(),setValue:(e,t,a)=>{Km({action:"settings",category:"concurrency",label:"update",value:a}),t.setWasmConcurrency(e,a)},values:e}),d.value&&navigator.userAgent.toLowerCase().includes("firefox")){const e=d.value;e.hidden=!1,e.textContent="Too many workers can cause significant memory usage! If sim doesn't finish due to RAM running out use a lower number."}this.simUI.sim.isWasm().then(e=>{e||(c.value.hidden=!0)})}}}class F_ extends F{static buildDiscordLink(){const e=H("a",{href:"https://discord.gg/p3DgvmnDCS",target:"_blank",className:"discord-link link-alt",dataset:{tippyContent:oe.t("info.discord")}},H("i",{className:"fab fa-discord fa-lg"}));return ie(e),e}static buildGitHubLink(){const e=H("a",{href:Jo,target:"_blank",className:"github-link link-alt",dataset:{tippyContent:oe.t("info.github")}},H("i",{className:"fab fa-github fa-lg"}));return ie(e),e}static buildPatreonLink(){const e=H("a",{href:"https://patreon.com/wowsims",target:"_blank",className:"patreon-link link-alt",dataset:{tippyContent:oe.t("info.patreon")}},H("i",{className:"fab fa-patreon fa-lg"})," Patreon");return ie(e),e}}class H_ extends F{constructor(e,t){super(e,"sim-header"),this.simUI=t,this.simTabsContainer=this.rootElem.querySelector(".sim-tabs"),this.simToolbar=this.rootElem.querySelector(".sim-toolbar"),this.knownIssuesContent=H("ul",{className:"text-start ps-3 mb-0"}),this.knownIssuesLink=this.addKnownIssuesLink(),this.addBugReportLink(),this.addSimOptionsLink(),this.addSocialLinks(),new IntersectionObserver(([e])=>e.target.classList.toggle("stuck",e.intersectionRatio<1),{threshold:[1]}).observe(this.rootElem)}activateTab(e){this.simTabsContainer.getElementsByClassName(e)[0].click()}addTab(e,t){const a=0==this.simTabsContainer.children.length;this.simTabsContainer.appendChild(H("li",{className:`${t} nav-item`,attributes:{role:"presentation","aria-controls":t}},H("button",{className:`nav-link ${a&&"active"}`,type:"button",dataset:{bsToggle:"tab",bsTarget:`#${t}`},attributes:{role:"tab","aria-selected":a}},e)))}addSimTabLink(e){const t=0==this.simTabsContainer.children.length;e.navLink.setAttribute("aria-selected",t.toString()),t&&e.navLink.classList.add("active","show"),this.simTabsContainer.appendChild(e.navItem)}addImportLink(e,t,a,i=!1){this.addImportExportLink(".import-dropdown",e,t,a,i)}addExportLink(e,t,a,i=!1){this.addImportExportLink(".export-dropdown",e,t,a,i)}addImportExportLink(e,t,a,i,s){const o=this.rootElem.querySelector(e).querySelector(".dropdown-menu"),n=U();if(o.appendChild(H("li",null,H("button",{ref:n,className:xr("dropdown-item",s&&"disabled")},t))),n.value){if(s)return void ie(n.value,{content:"Currently unsupported"});n.value.addEventListener("click",()=>a.open())}}addToolbarLink({parent:e,tooltip:t,classes:a,onclick:i,text:s,...o}){const n=U();return e.appendChild(H(Fg,{linkRef:n,buttonClassName:a,...o},s)),i&&n.value.addEventListener("click",i),t&&ie(n.value,{content:t,placement:"bottom"}),n.value}addKnownIssuesLink(){return this.addToolbarLink({parent:this.simToolbar,text:oe.t("info.known_issues"),tooltip:this.knownIssuesContent,classes:"known-issues link-danger hide"})}addKnownIssue(e){const t=H("li",null);t.innerHTML=e,this.knownIssuesContent.appendChild(t),this.knownIssuesLink.classList.remove("hide"),this.knownIssuesLink._tippy?.setContent(this.knownIssuesContent)}addBugReportLink(){this.addToolbarLink({href:Qo,parent:this.simToolbar,icon:"fas fa-bug fa-lg",tooltip:oe.t("info.bug_report")})}addDownloadBinaryLink(){const e=ea,t="fas fa-gauge-high fa-lg",a=this.simToolbar;qo()?fetch("/version").then(i=>{i.json().then(i=>{2==i.outdated&&this.addToolbarLink({href:e,parent:a,icon:t,tooltip:"Newer version of simulator available for download",classes:"downbin link-danger"})}).catch(e=>{console.warn("No version info found!")})}).catch(ft):this.addToolbarLink({href:e,parent:a,icon:t,tooltip:"Download simulator for faster simulating",classes:"downbin"})}addSimOptionsLink(){const e=new z_(this.simUI.rootElem,this.simUI);this.addToolbarLink({parent:this.simToolbar,icon:"fas fa-cog fa-lg",tooltip:oe.t("info.sim_options"),classes:"sim-options",onclick:()=>{Zm("Options","/settings-menu"),e.open()}})}addSocialLinks(){const e=H("div",{className:"sim-toolbar-socials"});this.simToolbar.appendChild(e),this.addDiscordLink(e),this.addGitHubLink(e),this.addPatreonLink(e)}addDiscordLink(e){e.appendChild(H(Fg,null,F_.buildDiscordLink()))}addGitHubLink(e){e.appendChild(H(Fg,null,F_.buildGitHubLink()))}addPatreonLink(e){e.appendChild(H(Fg,null,F_.buildPatreonLink()))}customRootElement(){return H("header",{className:"sim-header"},H("div",{className:"sim-header-container"},H("ul",{className:"sim-tabs nav nav-tabs",attributes:{role:"tablist"}}),H("div",{className:"import-export nav within-raid-sim-hide"},H("div",{className:"dropdown sim-dropdown-menu import-dropdown"},H("button",{className:"import-link",attributes:{"aria-expanded":"false"},dataset:{bsToggle:"dropdown",bsDisplay:"dynamic"}},H("i",{className:"fa fa-download"})," ",oe.t("import.title")),H("ul",{className:"dropdown-menu"})),H("div",{className:"dropdown sim-dropdown-menu export-dropdown"},H("button",{className:"export-link",attributes:{"aria-expanded":"false"},dataset:{bsToggle:"dropdown",bsDisplay:"dynamic"}},H("i",{className:"fa fa-right-from-bracket"})," ",oe.t("export.title")),H("ul",{className:"dropdown-menu"}))),H("div",{className:"sim-toolbar nav"})))}}class U_ extends F{constructor(e,t,a={}){super(e,"sim-title-dropdown-root");const i=t?{type:"Spec",spec:t}:{type:"Raid"},s=this.buildRootSimLink(i);if(a.noDropdown)return void this.rootElem.replaceChildren(s);const o=U();this.rootElem.replaceChildren(H("div",{className:"dropdown sim-link-dropdown"},s,H("ul",{ref:o,className:"dropdown-menu"}))),this.dropdownMenu=o.value,this.buildDropdown(),this.dropdownMenu.addEventListener("click",e=>{e.target.closest("a")||(e.stopPropagation(),e.preventDefault())})}buildDropdown(){en.status>=tn.Alpha&&this.dropdownMenu?.appendChild(H("li",null,this.buildRaidLink())),an.naturalOrder.forEach(e=>this.dropdownMenu?.appendChild(H("li",null,this.buildClassDropdown(e))))}buildClassDropdown(e){return H("div",{className:"dropend sim-link-dropdown"},this.buildClassLink(e),H("ul",{className:"dropdown-menu"},Object.values(e.specs).map(e=>H("li",null,this.buildSpecLink(e)))))}buildRootSimLink(e){return H("button",{className:xr("sim-link",this.getContextualKlass(e)),dataset:{bsToggle:"dropdown",bsTrigger:"click"},attributes:{"aria-expanded":"false"}},H("div",{className:"sim-link-content"},H("img",{src:this.getSimIconPath(e),className:"sim-link-icon"}),H("div",{className:"d-flex flex-column"},H("span",{className:"sim-link-label text-white"},oe.t("sidebar.header.title")),H("span",{className:"sim-link-title"},"Raid"===e.type&&sn,"Spec"===e.type&&_e.getFullSpecName(e.spec)),this.launchStatusLabel(e))))}buildRaidLink(){return H("a",{href:on,className:xr("sim-link",this.getContextualKlass({type:"Raid"}))},H("div",{className:"sim-link-content"},H("img",{src:this.getSimIconPath({type:"Raid"}),className:"sim-link-icon"}),H("div",{className:"d-flex flex-column"},H("span",{className:"sim-link-title"},sn),this.launchStatusLabel({type:"Raid"}))))}buildClassLink(e){return H("button",{className:xr("sim-link",this.getContextualKlass({type:"Class",class:e})),dataset:{bsToggle:"dropdown"},attributes:{"aria-expanded":"false"}},H("div",{className:"sim-link-content"},H("img",{src:this.getSimIconPath({type:"Class",class:e}),className:"sim-link-icon"}),H("div",{className:"d-flex flex-column"},H("span",{className:"sim-link-title"},nn(e)))))}buildSpecLink(e){return H("a",{href:e.simLink,className:xr("sim-link",this.getContextualKlass({type:"Spec",spec:e}))},H("div",{className:"sim-link-content"},H("img",{src:this.getSimIconPath({type:"Spec",spec:e}),className:"sim-link-icon"}),H("div",{className:"d-flex flex-column"},H("span",{className:"sim-link-label"},nn(_e.getPlayerClass(e))),H("span",{className:"sim-link-title"},wt(e)),this.launchStatusLabel({type:"Spec",spec:e}))))}launchStatusLabel(e){if("Raid"===e.type&&en.status===tn.Launched)return null;const t="Raid"===e.type?en.status:rn[e.spec.specID].status,a="Raid"===e.type?en.phase:rn[e.spec.specID].phase;return H("span",{className:"launch-status-label text-brand"},oe.t("sidebar.header.phase",{phase:oe.t(`common.phases.${a}`),status:ln(t)}))}getSimIconPath(e){let t="";switch(e.type){case"Raid":t=dn;break;case"Class":t=e.class.getIcon("large");break;case"Spec":t=e.spec.getIcon("large")}return t}getContextualKlass(e){switch(e.type){case"Class":return hn(e.class);case"Spec":return cn(e.spec);default:return"text-white"}}}var B_=(e=>(e.computeStats="computeStats",e.computeStatsJson="computeStatsJson",e.raidSim="raidSim",e.raidSimJson="raidSimJson",e.raidSimAsync="raidSimAsync",e.statWeights="statWeights",e.statWeightsAsync="statWeightsAsync",e.statWeightRequests="statWeightRequests",e.statWeightCompute="statWeightCompute",e.raidSimRequestSplit="raidSimRequestSplit",e.raidSimResultCombination="raidSimResultCombination",e.abortById="abortById",e))(B_||{});const W_=5;class V_{constructor(e,t){this.buffs=No.create(),this.compChangeEmitter=new te,this.buffsChangeEmitter=new te,this.sim=t,this.raid=e,this.players=[...Array(5).keys()].map(e=>null),this.playerChangeListener=e=>this.changeEmitter.emit(e),this.changeEmitter=te.onAny([this.compChangeEmitter,this.buffsChangeEmitter],"PartyChange")}size(){return this.players.filter(e=>null!=e).length}isEmpty(){return 0==this.size()}clear(e){this.setBuffs(e,No.create());for(let t=0;t<5;t++)this.setPlayer(e,t,null)}getIndex(){return this.raid.getParties().indexOf(this)}getPlayers(){return this.players.slice()}getPlayer(e){return this.players[e]}setPlayer(e,t,a){if(t<0||t>=5)throw new Error("Invalid player index: "+t);a!=this.players[t]&&te.freezeAllAndDo(()=>{const i=this.players[t];if(null!=i&&(i.changeEmitter.off(this.playerChangeListener),i.setParty(null)),null!=a){const i=a.getParty();i&&i.setPlayer(e,a.getPartyIndex(),null),this.players[t]=a,a.changeEmitter.on(this.playerChangeListener),a.setParty(this)}else this.players[t]=null;this.compChangeEmitter.emit(e)})}getBuffs(){return No.clone(this.buffs)}setBuffs(e,t){No.equals(this.buffs,t)||(this.buffs=No.clone(t),this.buffsChangeEmitter.emit(e))}toProto(e,t){return un.create({players:this.players.map(a=>null==a?pn.create():a.toProto(e,t)),buffs:this.buffs})}fromProto(e,t){te.freezeAllAndDo(()=>{this.setBuffs(e,t.buffs||No.create());for(let a=0;a<5;a++){if(!t.players[a]||t.players[a].class==q.ClassUnknown){this.setPlayer(e,a,null);continue}const i=t.players[a],s=Se(i),o=this.players[a];if(o&&s.specID==o.getSpec())o.fromProto(e,i);else{const t=new Tk(s,this.sim);t.fromProto(e,i),this.setPlayer(e,a,t)}}})}}const j_=5;class Y_{constructor(e){this.buffs=Mo.create(),this.debuffs=Lo.create(),this.tanks=[],this.targetDummies=0,this.numActiveParties=5,this.compChangeEmitter=new te,this.buffsChangeEmitter=new te,this.debuffsChangeEmitter=new te,this.tanksChangeEmitter=new te,this.targetDummiesChangeEmitter=new te,this.numActivePartiesChangeEmitter=new te,this.sim=e,this.parties=[...Array(5).keys()].map(t=>{const a=new V_(this,e);return a.compChangeEmitter.on(e=>this.compChangeEmitter.emit(e)),a.changeEmitter.on(e=>this.changeEmitter.emit(e)),a}),this.activePlayers=[],this.numActivePartiesChangeEmitter.on(e=>this.compChangeEmitter.emit(e)),this.changeEmitter=te.onAny([this.compChangeEmitter,this.buffsChangeEmitter,this.debuffsChangeEmitter,this.tanksChangeEmitter,this.targetDummiesChangeEmitter],"RaidChange"),this.changeEmitter.on(()=>{this.activePlayers=[]})}size(){return d(this.parties.map(e=>e.size()))}isEmpty(){return 0==this.size()}getParties(){return this.parties.slice()}getParty(e){return this.parties[e]}getPlayers(){return this.parties.map(e=>e.getPlayers()).flat()}getPlayer(e){if(-1===e)return null;return this.parties[Math.floor(e/5)].getPlayer(e%5)}getPlayerFromUnitReference(e,t){return e&&e.type!=ze.Unknown?e.type==ze.Player?this.getPlayer(e.index):e.type==ze.Self&&t||null:null}setPlayer(e,t,a){this.parties[Math.floor(t/5)].setPlayer(e,t%5,a)}getClassCount(e){return this.getPlayers().filter(t=>null!=t&&t.getClass()==e).length}getBuffs(){return Mo.clone(this.buffs)}setBuffs(e,t){Mo.equals(this.buffs,t)||(this.buffs=Mo.clone(t),this.buffsChangeEmitter.emit(e))}getDebuffs(){return Lo.clone(this.debuffs)}setDebuffs(e,t){Lo.equals(this.debuffs,t)||(this.debuffs=Lo.clone(t),this.debuffsChangeEmitter.emit(e))}getTanks(){return this.tanks.map(e=>Ge.clone(e))}setTanks(e,t){this.tanks.length==t.length&&this.tanks.every((e,a)=>Ge.equals(e,t[a]))||(this.tanks=t.map(e=>Ge.clone(e)),this.tanksChangeEmitter.emit(e))}getTargetDummies(){return this.targetDummies}setTargetDummies(e,t){this.targetDummies!=t&&(this.targetDummies=t,this.targetDummiesChangeEmitter.emit(e))}getNumActiveParties(){return this.numActiveParties}setNumActiveParties(e,t){t!=this.numActiveParties&&t>0&&(this.numActiveParties=t,this.numActivePartiesChangeEmitter.emit(e))}getActivePlayers(){if(0==this.activePlayers.length){const e=this.getParties().filter((e,t)=>t<this.numActiveParties);this.activePlayers=e.map(e=>e.getPlayers()).flat().filter(e=>null!=e)}return this.activePlayers}toProto(e,t){return He.create({parties:this.parties.map(a=>a.toProto(e,t)),buffs:this.getBuffs(),debuffs:this.getDebuffs(),tanks:this.getTanks(),targetDummies:this.getTargetDummies(),numActiveParties:this.getNumActiveParties()})}fromProto(e,t){te.freezeAllAndDo(()=>{this.setBuffs(e,t.buffs||Mo.create()),this.setDebuffs(e,t.debuffs||Lo.create()),this.setTanks(e,t.tanks),this.setTargetDummies(e,t.targetDummies),this.setNumActiveParties(e,t.numActiveParties||5);for(let a=0;a<5;a++)t.parties[a]?this.parties[a].fromProto(e,t.parties[a]):this.parties[a].clear(e)})}clear(e){te.freezeAllAndDo(()=>{for(let t=0;t<5;t++)this.parties[t].clear(e)})}}const q_=`/${_n}/sim_worker.js`,X_=e=>e+"-"+Array.from(Array(4)).map(()=>Math.floor(65536*Math.random()).toString(16)).join("");class $_{constructor(e){this.workers=[],this.workersDisabled=[],this.setNumWorkers(e)}setNumWorkers(e){if(e<this.workers.length){for(let t=this.workers.length-1;t>=e;t--)this.workers[t].disable(),this.workersDisabled[t]=this.workers[t];this.workers.length=e}else for(let t=0;t<e;t++)this.workers[t]||(this.workersDisabled[t]?(this.workers[t]=this.workersDisabled[t],delete this.workersDisabled[t],this.workers[t].enable()):this.workers[t]=new Z_(t))}getNumWorkers(){return this.workers.length}getLeastBusyWorker(){return this.workers.reduce((e,t)=>e.getSimTaskWorkAmount()<t.getSimTaskWorkAmount()?e:t)}async makeApiCall(e,t){return await this.getLeastBusyWorker().doApiCall(e,t,X_(e))}async computeStats(e){const t=await this.makeApiCall(B_.computeStats,mn.toBinary(e));return gn.fromBinary(t)}getProgressName(e){return`${e}progress`}async statWeightsAsync(e,t,a){const i=this.getLeastBusyWorker();i.log("Stat weights request: "+fn.toJsonString(e));const s=X_(B_.statWeightsAsync);a.abort.onTrigger(async()=>{await i.sendAbortById(s)});const o=e.simOptions?e.simOptions.iterations*e.statsToWeigh.length:3e4,n=await this.doAsyncRequest(B_.statWeightsAsync,fn.toBinary(e),s,i,t,o);return i.log("Stat weights result: "+jo.toJsonString(n.finalWeightResult)),n.finalWeightResult}async statWeightRequests(e){const t=await this.makeApiCall(B_.statWeightRequests,fn.toBinary(e));return bn.fromBinary(t)}async statWeightCompute(e){const t=await this.makeApiCall(B_.statWeightCompute,yn.toBinary(e));return jo.fromBinary(t)}async raidSimAsync(e,t,a){const i=this.getLeastBusyWorker();i.log("Raid sim request: "+fe.toJsonString(e));const s=e.requestId;a.abort.onTrigger(async()=>{await i.sendAbortById(s)});const o=e.simOptions?.iterations??3e3,n=await this.doAsyncRequest(B_.raidSimAsync,fe.toBinary(e),s,i,t,o),r=be.toJson(n.finalRaidResult);return delete r.logs,i.log("Raid sim result: "+JSON.stringify(r)),n.finalRaidResult}async raidSimRequestSplit(e){const t=await this.makeApiCall(B_.raidSimRequestSplit,wn.toBinary(e));return vn.fromBinary(t)}async raidSimResultCombination(e){const t=await this.makeApiCall(B_.raidSimResultCombination,xn.toBinary(e));return be.fromBinary(t)}isWasm(){return this.workers[0].isWasmWorker()}async doAsyncRequest(e,t,a,i,s,o){try{i.addSimTaskRunning(a,o),i.doApiCall(e,t,a);const n=new Promise(e=>{i.addPromiseFunc(this.getProgressName(a),this.newProgressHandler(a,i,s,t=>e(t)),ft)});return await n}finally{i.updateSimTask(a,0)}}newProgressHandler(e,t,a,i){return s=>{const o=Sn.fromBinary(s);a(o),t.updateSimTask(e,Math.max(1,o.totalIterations-o.completedIterations)),null==o.finalRaidResult&&null==o.finalWeightResult?t.addPromiseFunc(this.getProgressName(e),this.newProgressHandler(e,t,a,i),ft):i(o)}}}class Z_{constructor(e){this.workerId=e,this.simTasksRunning={},this.taskIdsToPromiseFuncs={},this.wasmWorker=!1,this.shouldDestroy=!1,this.onReady=new Promise((e,t)=>{this.resolveReady=e}),this.setupWorker(),this.log("Created.")}setupWorker(){this.setTaskActive("setup",!0),this.onReady=new Promise((e,t)=>{this.resolveReady=e}),this.worker=new window.Worker(q_),this.worker.addEventListener("message",({data:e})=>{const{id:t,msg:a,outputData:i}=e;switch(a){case"ready":this.wasmWorker=!!i&&!!i[0],this.postMessage({msg:"setID",id:this.workerId.toString()}),this.resolveReady(),this.setTaskActive("setup",!1),this.log(`Ready, isWasm: ${this.wasmWorker}`);break;case"idConfirm":break;default:const e=this.taskIdsToPromiseFuncs[t];if(!e)return void console.warn(`Unrecognized result id ${t} for msg ${a}`);t.includes("progress")||this.setTaskActive(t,!1),delete this.taskIdsToPromiseFuncs[t],e[0](i)}})}addSimTaskRunning(e,t){this.simTasksRunning[e]={workLeft:t},this.log(`Added work ${e}, current work amount: ${this.getSimTaskWorkAmount()}`)}updateSimTask(e,t){if(t<=0)return delete this.simTasksRunning[e],this.log(`Work ${e} done, current work amount: ${this.getSimTaskWorkAmount()}`),void(this.shouldDestroy&&0==this.getSimTaskWorkAmount()&&this.disable(!0));this.simTasksRunning[e].workLeft=t}getSimTaskWorkAmount(){let e=0;for(const t of Object.values(this.simTasksRunning))e+=t.workLeft;return e}hasTaskId(e){return!!this.simTasksRunning[e]}setTaskActive(e,t){t?this.addSimTaskRunning(e+"task",1):this.updateSimTask(e+"task",0)}async isWasmWorker(){if(!this.onReady||this.shouldDestroy)throw new Error("Disabled worker was used!");return await this.onReady,this.wasmWorker}addPromiseFunc(e,t,a){this.taskIdsToPromiseFuncs[e]=[t,a]}async doApiCall(e,t,a){if(!this.onReady||this.shouldDestroy)throw new Error("Disabled worker was used!");if(!a)throw new Error("ApiCall with empty id!");this.setTaskActive(a,!0),await this.onReady;const i=new Promise((i,s)=>{this.taskIdsToPromiseFuncs[a]=[i,s],this.postMessage({msg:e,id:a,inputData:t})});return await i}postMessage(e){if(!this.worker)throw new Error(`Worker ${this.workerId} postMessage while disabled!`);this.worker.postMessage(e)}disable(e=!1){this.shouldDestroy=!0,!this.worker||!e&&this.getSimTaskWorkAmount()||(this.worker.terminate(),delete this.worker,delete this.onReady,delete this.resolveReady,this.log("Disabled."))}enable(){this.shouldDestroy=!1,this.worker||(this.setupWorker(),this.log("Enabled."))}log(e){}async sendAbortById(e){const t=kn.toBinary(kn.create({requestId:e})),a=X_(B_.abortById),i=await this.doApiCall(B_.abortById,t,a);return Cn.fromBinary(i)}}class K_{constructor(e,t){this.concurrency=e,this.iterationsTotal=t,this.iterationsDone=Array(this.concurrency).fill(0),this.dpsValues=Array(this.concurrency).fill(0),this.hpsValues=Array(this.concurrency).fill(0),this.finalResults=Array(this.concurrency)}getIterationsDone(){let e=0;for(const t of this.iterationsDone)e+=t;return e}getDpsAvg(){let e=0;for(const t of this.dpsValues)e+=t;return e/this.concurrency}getHpsAvg(){let e=0;for(const t of this.hpsValues)e+=t;return e/this.concurrency}updateProgress(e,t){this.iterationsDone[e]=t.completedIterations,this.dpsValues[e]=t.dps,this.hpsValues[e]=t.hps,t.finalRaidResult&&(this.finalResults[e]=t.finalRaidResult)}makeProgressMetrics(){return Sn.create({totalIterations:this.iterationsTotal,completedIterations:this.getIterationsDone(),dps:this.getDpsAvg(),hps:this.getHpsAvg()})}}const J_=(e,t)=>{const a=be.create();return"string"==typeof e?(console.error(e),a.error=In.create({message:e})):(e.message&&console.error(e.message),a.error=e),t(Sn.create({finalRaidResult:a})),a},Q_=async(e,t,a,i)=>{console.log(`Sending requests split for ${t.getNumWorkers()} splits.`);const s=await t.raidSimRequestSplit(wn.create({splitCount:t.getNumWorkers(),request:e}));if(s.errorResult)return J_(s.errorResult,a);if(i.abort.isTriggered())return J_(In.create({type:En.ErrorOutcomeAborted}),a);console.log(`Running ${e.simOptions.iterations} iterations on ${s.splitsDone} concurrent sims...`);const o=await((e,t,a,i,s)=>new Promise(o=>{const n=new K_(e.length,t);let r=0,l=e.length;const c=(e,t)=>{if(l&&(n.updateProgress(e,t),r++,r%l==0&&i(n.makeProgressMetrics()),t.finalRaidResult)){let a;if(l--,t.finalRaidResult.error&&(t.finalRaidResult.error.type==En.ErrorOutcomeError&&console.error(`Worker ${e} had an error!`),a=t.finalRaidResult,s.abort.trigger()),a||0==l){l=0;const e=n.makeProgressMetrics();return e.finalRaidResult=a,i(e),void o({errorResult:a,results:n.finalResults,progressMetricsFinal:e})}}};for(let t=0;t<e.length;t++)a.raidSimAsync(e[t],e=>c(t,e),s)}))(s.requests,e.simOptions.iterations,t,a,i);if(o.errorResult&&o.errorResult.error)return J_(o.errorResult.error,a);if(i.abort.isTriggered())return J_(In.create({type:En.ErrorOutcomeAborted}),a);console.log(`All ${s.splitsDone} sims finished successfully. Combining ${o.results.length} results.`);const n=await t.raidSimResultCombination(xn.create({results:o.results}));return n.error?J_(n.error,a):(o.progressMetricsFinal.finalRaidResult=n,a(o.progressMetricsFinal),n)},ek=(e,t)=>{const a=be.create();return"string"==typeof e?(console.error(e),a.error=In.create({message:e})):(e.message&&console.error(e.message),a.error=e),t(Sn.create({finalWeightResult:a})),a},tk=`${$o}_wasmconcurrency`,ak=class e{constructor({type:t}={}){this.iterations=12500,this.phase=An,this.faction=na.Alliance,this.fixedRngSeed=0,this.filters=e.defaultFilters(),this.showDamageMetrics=!0,this.showThreatMetrics=!1,this.showHealingMetrics=!1,this.showExperimental=!1,this.wasmConcurrency=0,this.showQuickSwap=!0,this.showEPValues=!1,this.language="",this.db_=null,this.iterationsChangeEmitter=new te,this.phaseChangeEmitter=new te,this.factionChangeEmitter=new te,this.fixedRngSeedChangeEmitter=new te,this.lastUsedRngSeedChangeEmitter=new te,this.filtersChangeEmitter=new te,this.showDamageMetricsChangeEmitter=new te,this.showThreatMetricsChangeEmitter=new te,this.showHealingMetricsChangeEmitter=new te,this.showExperimentalChangeEmitter=new te,this.wasmConcurrencyChangeEmitter=new te,this.showQuickSwapChangeEmitter=new te,this.showEPValuesChangeEmitter=new te,this.languageChangeEmitter=new te,this.crashEmitter=new te,this.unitMetadataEmitter=new te("UnitMetadata"),this.simResultEmitter=new te,this.lastUsedRngSeed=0,this.modifyRaidProto=ft,this.type=t??Pn.SimTypeIndividual,this.workerPool=new $_(1),this.wasmConcurrencyChangeEmitter.on(async()=>{if(await this.workerPool.isWasm()){const e=Math.max(1,Math.min(this.wasmConcurrency,navigator.hardwareConcurrency));this.workerPool.setNumWorkers(e)}});let a=parseInt(window.localStorage.getItem(tk)??"NaN");isNaN(a)&&(a=0,navigator.hardwareConcurrency>1&&(a=Math.min(4,Math.floor(navigator.hardwareConcurrency/2)))),this.setWasmConcurrency(te.nextEventID(),a),this.signalManager=new $m,this._initPromise=Ar.get().then(e=>{this.db_=e}),this.raid=new Y_(this),this.encounter=new yS(this),this.settingsChangeEmitter=te.onAny([this.iterationsChangeEmitter,this.phaseChangeEmitter,this.fixedRngSeedChangeEmitter,this.filtersChangeEmitter,this.showDamageMetricsChangeEmitter,this.showThreatMetricsChangeEmitter,this.showHealingMetricsChangeEmitter,this.showExperimentalChangeEmitter,this.wasmConcurrencyChangeEmitter,this.showQuickSwapChangeEmitter,this.showEPValuesChangeEmitter,this.languageChangeEmitter]),this.changeEmitter=te.onAny([this.settingsChangeEmitter,this.raid.changeEmitter,this.encounter.changeEmitter]),te.onAny([this.raid.changeEmitter,this.encounter.changeEmitter]).on(e=>this.updateCharacterStats(e)),this.language=N()}waitForInit(){return this._initPromise}isWasm(){return this.workerPool.isWasm()}async shouldUseWasmConcurrency(){return await this.isWasm()&&this.getWasmConcurrency()>=2&&this.workerPool.getNumWorkers()>=2}get db(){return this.db_}setModifyRaidProto(e){this.modifyRaidProto=e}getModifiedRaidProto(){const e=this.raid.toProto(!1,!0);return this.modifyRaidProto(e),e.parties.forEach(e=>{e.players.forEach(e=>{if(!e.equipment)return;let t=this.db.lookupEquipmentSpec(e.equipment),i=!1;const s=[e.profession1,e.profession2].includes(a.Blacksmithing);t.hasInactiveMetaGem(s)&&(t=t.withoutMetaGem(),i=!0),s||(t=t.withoutBlacksmithSockets(),i=!0),i&&(e.equipment=t.asSpec());const o=e.database,n=[],r=[],l=new Set,c=new Set;Object.values(e.consumables??[]).forEach(e=>{if(!e||l.has(e))return;const t=this.db.getConsumable(e);if(t){l.add(t.id),n.push(t);for(const e of t.effectIds){if(c.has(e))continue;const t=this.db.getSpellEffect(e);t&&(c.add(t.id),r.push(t))}}}),o.consumables=n,o.spellEffects=r,e.database=o})}),e}makeRaidSimRequest(e){const t=this.getModifiedRaidProto(),a=this.encounter.toProto();return fe.create({requestId:X_(B_.raidSimAsync),type:this.type,raid:t,encounter:a,simOptions:Rn.create({iterations:e?1:this.getIterations(),randomSeed:BigInt(this.nextRngSeed()),debugFirstIteration:!0})})}async runRaidSim(e,t,a={}){if(this.raid.isEmpty())throw new Error("Raid is empty! Try adding some players first.");if(this.encounter.targets.length<1)throw new Error("Encounter has no targets! Try adding some targets first.");const i=this.signalManager.registerRunning(qm.RaidSim);try{await this.waitForInit();const s=this.makeRaidSimRequest(!1);let o;if(o=await this.shouldUseWasmConcurrency()?await Q_(s,this.workerPool,t,i):await this.workerPool.raidSimAsync(s,t,i),o.error){if(o.error.type!=En.ErrorOutcomeError)return o.error;throw new sk(o.error.message)}const n=await Dl.makeNew(s,o);return a.silent||this.simResultEmitter.emit(e,n),n}catch(s){if(s instanceof sk)throw s;throw console.error(s),new Error("Something went wrong running your raid sim. Reload the page and try again.")}finally{this.signalManager.unregisterRunning(i)}}async runRaidSimWithLogs(e,t={}){if(this.raid.isEmpty())throw new Error("Raid is empty! Try adding some players first.");if(this.encounter.targets.length<1)throw new Error("Encounter has no targets! Try adding some targets first.");const a=this.signalManager.registerRunning(qm.RaidSim);try{await this.waitForInit();const i=this.makeRaidSimRequest(!0),s=await this.workerPool.raidSimAsync(i,ft,a);if(s.error)throw new sk(s.error.message);const o=await Dl.makeNew(i,s);return t.silent||this.simResultEmitter.emit(e,o),o}catch(i){if(i instanceof sk)throw i;throw console.error(i),new Error("Something went wrong running your raid sim. Reload the page and try again.")}finally{this.signalManager.unregisterRunning(a)}}async updateCharacterStats(e){if(0==e)return;e=te.nextEventID(),await this.waitForInit();const t=this.raid.getPlayers(),a=mn.create({raid:this.getModifiedRaidProto(),encounter:this.encounter.toProto()}),i=await this.workerPool.computeStats(a);""==i.errorResult?te.freezeAllAndDo(async()=>{const a=i.raidStats.parties.map((a,i)=>a.players.map((a,s)=>{const o=t[5*i+s];return o?(o.setCurrentStats(e,a),o.updateMetadata()):null})).flat().filter(e=>null!=e),s=this.encounter.targetsMetadata.update(i.encounterStats.targets.map(e=>e.metadata));(await Promise.all(a.concat([s]))).some(e=>e)&&this.unitMetadataEmitter.emit(e)}):this.crashEmitter.emit(e,new sk(i.errorResult))}async statWeights(e,t,a,i,s){if(this.raid.isEmpty())throw new Error("Raid is empty! Try adding some players first.");if(this.encounter.targets.length<1)throw new Error("Encounter has no targets! Try adding some targets first.");if(await this.waitForInit(),null==e.getParty())return console.warn("Trying to get stat weights without a party!"),jo.create();{const n=this.raid.getTanks().map(e=>e.index).includes(e.getRaidIndex())?[Ge.create({type:ze.Player,index:0})]:[],r=fn.create({player:e.toProto(!1,!0),raidBuffs:this.raid.getBuffs(),partyBuffs:e.getParty().getBuffs(),debuffs:this.raid.getDebuffs(),encounter:this.encounter.toProto(),simOptions:Rn.create({iterations:this.getIterations(),randomSeed:BigInt(this.nextRngSeed()),debug:!1}),tanks:n,statsToWeigh:t,pseudoStatsToWeigh:a,epReferenceStat:i}),l=this.signalManager.registerRunning(qm.StatWeights);try{let e;if(e=await this.shouldUseWasmConcurrency()?await(async(e,t,a,i)=>{console.log("Getting stat weight sim requests.");const s=X_(B_.statWeightsAsync),o=await t.statWeightRequests(e);if(o.baseRequest.requestId=s,i.abort.isTriggered())return ek(In.create({type:En.ErrorOutcomeAborted}),a);let n=o.baseRequest.simOptions.iterations,r=0,l=1,c=0;for(const g of o.statSimRequests)g.requestLow.requestId=s,g.requestHigh.requestId=s,n+=g.requestLow.simOptions.iterations+g.requestHigh.simOptions.iterations,l+=2;console.log(`Need to run a total of ${l} sims and ${n} iterations.`);let h=0;const d=e=>{r+=e.completedIterations-h,h=e.completedIterations,a(Sn.create({totalIterations:n,completedIterations:r,totalSims:l,completedSims:c})),e.finalRaidResult&&c++},u=await Q_(o.baseRequest,t,d,i);if(u.error)return ek(u.error,a);const p=yn.create({baseResult:u,epReferenceStat:o.epReferenceStat,statSimResults:[]});for(const g of o.statSimRequests){if(i.abort.isTriggered())return ek(In.create({type:En.ErrorOutcomeAborted}),a);h=0;const e=await Q_(g.requestLow,t,d,i);if(e.error)return ek(e.error,a);h=0;const s=await Q_(g.requestHigh,t,d,i);if(s.error)return ek(s.error,a);p.statSimResults.push(Tn.create({statData:g.statData,resultLow:e,resultHigh:s}))}console.log(`All ${l} sims finished successfully. Computing weights.`);const m=await t.statWeightCompute(p);return m.error?ek(m.error,a):(a(Sn.create({finalWeightResult:m})),m)})(r,this.workerPool,s,l):await this.workerPool.statWeightsAsync(r,s,l),e.error){if(e.error.type!=En.ErrorOutcomeError)return e;throw new sk(e.error.message)}return e}catch(o){if(o instanceof sk)throw o;throw console.error(o),new Error("Something went wrong calculating your stat weights. Reload the page and try again.")}finally{this.signalManager.unregisterRunning(l)}}}getUnitMetadata(e,t,a){if(!e||e.type==ze.Unknown)return this.getUnitMetadata(a,t,a);if(e.type==ze.Player)return this.raid.getPlayerFromUnitReference(e)?.getMetadata();if(e.type==ze.Target)return this.encounter.targetsMetadata.asList()[e.index];if(e.type==ze.Pet){const a=this.raid.getPlayerFromUnitReference(e.owner,t);return a?a.getPetMetadatas().asList()[e.index]:void 0}return e.type==ze.Self?t?.getMetadata():e.type==ze.CurrentTarget?this.encounter.targetsMetadata.asList()[0]:void 0}getPhase(){return this.phase}setPhase(e,t){t!=this.phase&&(this.phase=t,this.phaseChangeEmitter.emit(e))}getFaction(){return this.faction}setFaction(e,t){t!=this.faction&&t&&(this.faction=t,this.factionChangeEmitter.emit(e))}getFixedRngSeed(){return this.fixedRngSeed}setFixedRngSeed(e,t){t!=this.fixedRngSeed&&(this.fixedRngSeed=t,this.fixedRngSeedChangeEmitter.emit(e))}nextRngSeed(){let t=0;return t=this.fixedRngSeed?this.fixedRngSeed:Math.floor(Math.random()*e.MAX_RNG_SEED),this.lastUsedRngSeed=t,this.lastUsedRngSeedChangeEmitter.emit(te.nextEventID()),t}getLastUsedRngSeed(){return this.lastUsedRngSeed}getFilters(){return Dn.clone(this.filters)}setFilters(e,t){Dn.equals(t,this.filters)||(this.filters=Dn.clone(t),this.filtersChangeEmitter.emit(e))}getShowDamageMetrics(){return this.showDamageMetrics}setShowDamageMetrics(e,t){t!=this.showDamageMetrics&&(this.showDamageMetrics=t,this.showDamageMetricsChangeEmitter.emit(e))}getShowThreatMetrics(){return this.showThreatMetrics}setShowThreatMetrics(e,t){t!=this.showThreatMetrics&&(this.showThreatMetrics=t,this.showThreatMetricsChangeEmitter.emit(e))}getShowHealingMetrics(){return this.showHealingMetrics||this.showThreatMetrics&&[K.SpecBloodDeathKnight,K.SpecGuardianDruid,K.SpecBrewmasterMonk,K.SpecProtectionPaladin].includes(this.raid.getPlayer(0)?.playerSpec.specID)}setShowHealingMetrics(e,t){t!=this.showHealingMetrics&&(this.showHealingMetrics=t,this.showHealingMetricsChangeEmitter.emit(e))}getShowExperimental(){return this.showExperimental}setShowExperimental(e,t){t!=this.showExperimental&&(this.showExperimental=t,this.showExperimentalChangeEmitter.emit(e))}getWasmConcurrency(){return this.wasmConcurrency}setWasmConcurrency(e,t){t!=this.wasmConcurrency&&(this.wasmConcurrency=t,window.localStorage.setItem(tk,t.toString()),this.wasmConcurrencyChangeEmitter.emit(e))}getShowQuickSwap(){return!Mn()&&this.showQuickSwap}setShowQuickSwap(e,t){t!=this.showQuickSwap&&(this.showQuickSwap=t,this.showQuickSwapChangeEmitter.emit(e))}getShowEPValues(){return this.showEPValues}setShowEPValues(e,t){t!=this.showEPValues&&(this.showEPValues=t,this.showEPValuesChangeEmitter.emit(e))}getLanguage(){return this.language}setLanguage(e,t){(t=t||"en")!=this.language&&(this.language=t,this.languageChangeEmitter.emit(e))}getIterations(){return this.iterations}setIterations(e,t){t!=this.iterations&&(this.iterations=t,this.iterationsChangeEmitter.emit(e))}toProto(){const t=this.getFilters();return t.armorTypes.length==e.ALL_ARMOR_TYPES.length&&(t.armorTypes=[]),t.weaponTypes.length==e.ALL_WEAPON_TYPES.length&&(t.weaponTypes=[]),t.rangedWeaponTypes.length==e.ALL_RANGED_WEAPON_TYPES.length&&(t.rangedWeaponTypes=[]),t.sources.length==e.ALL_SOURCES.length&&(t.sources=[]),t.raids.length==e.ALL_RAIDS.length&&(t.raids=[]),Nn.create({iterations:this.getIterations(),phase:this.getPhase(),fixedRngSeed:BigInt(this.getFixedRngSeed()),showDamageMetrics:this.getShowDamageMetrics(),showThreatMetrics:this.getShowThreatMetrics(),showHealingMetrics:this.getShowHealingMetrics(),showExperimental:this.getShowExperimental(),showQuickSwap:this.getShowQuickSwap(),showEpValues:this.getShowEPValues(),language:this.getLanguage(),faction:this.getFaction(),filters:t})}fromProto(t,a){te.freezeAllAndDo(()=>{this.setIterations(t,a.iterations||12500),this.setPhase(t,a.phase||An),this.setFixedRngSeed(t,Number(a.fixedRngSeed)),this.setShowDamageMetrics(t,a.showDamageMetrics),this.setShowThreatMetrics(t,a.showThreatMetrics),this.setShowHealingMetrics(t,a.showHealingMetrics),this.setShowExperimental(t,a.showExperimental),this.setShowQuickSwap(t,a.showQuickSwap),this.setShowEPValues(t,a.showEpValues),this.setLanguage(t,a.language),this.setFaction(t,a.faction||na.Alliance);const i=a.filters||e.defaultFilters();0==i.armorTypes.length&&(this.type==Pn.SimTypeIndividual?i.armorTypes=[this.raid.getActivePlayers()[0].getPlayerClass().armorTypes[0]]:i.armorTypes=e.ALL_ARMOR_TYPES.slice()),0==i.weaponTypes.length&&(i.weaponTypes=e.ALL_WEAPON_TYPES.slice()),0==i.rangedWeaponTypes.length&&(i.rangedWeaponTypes=e.ALL_RANGED_WEAPON_TYPES.slice()),0==i.sources.length&&(i.sources=e.ALL_SOURCES.slice()),0==i.raids.length&&(i.raids=e.ALL_RAIDS.slice()),this.setFilters(t,i)})}applyDefaults(t,a,i){this.fromProto(t,Nn.create({iterations:12500,phase:An,faction:na.Alliance,showDamageMetrics:!i,showThreatMetrics:a,showHealingMetrics:i,showQuickSwap:!0,language:this.getLanguage(),filters:e.defaultFilters(),showEpValues:!1,useSoftCapBreakpoints:!0}))}static defaultFilters(){return Dn.create({oneHandedWeapons:!0,twoHandedWeapons:!0})}};ak.MAX_RNG_SEED=Math.pow(2,32)-1,ak.ALL_ARMOR_TYPES=e(V).filter(e=>0!=e),ak.ALL_WEAPON_TYPES=e(A).filter(e=>0!=e),ak.ALL_RANGED_WEAPON_TYPES=e(E).filter(e=>0!=e),ak.ALL_SOURCES=e(Ln).filter(e=>0!=e),ak.ALL_RAIDS=e(oa).filter(e=>0!=e);let ik=ak;class sk extends Error{constructor(e){super(e),this.errorStr=e}}const ok=[];class nk extends F{constructor(e,t,a){super(e,"sim-ui"),this.sim=t,this.config=a,this.disabled=a.simStatus.status===tn.Unlaunched,this.isWithinRaidSim=null!=this.rootElem.closest(".within-raid-sim");const i=H(de,null,H("div",{className:"sim-root"},H("div",{className:"sim-bg"}),H("div",{className:"notices-banner alert border-bottom mb-0 text-center within-raid-sim-hide"}," You are using the PTR version of the simulator. You can find the live version"," ",H("a",{href:"https://www.wowsims.com/mop/",target:"_blank"},"here")," ",""),a.noticeText?H("div",{className:"notices-banner alert border-bottom mb-0 text-center within-raid-sim-hide"},a.noticeText):null,H("div",{className:"sim-container"},H("aside",{className:"sim-sidebar"},H("div",{className:"sim-title"}),H("div",{className:"sim-sidebar-content"},H("div",{className:"sim-sidebar-actions within-raid-sim-hide"}),H("div",{className:"sim-sidebar-results within-raid-sim-hide"}),H("div",{className:"sim-sidebar-stats"}),H("div",{className:"sim-sidebar-socials"}))),H("div",{className:"sim-content container-fluid"}))),H("div",{className:"sim-toast-container p-3 bottom-0 right-0",id:"toastContainer"}));this.rootElem.appendChild(i),this.simContentContainer=this.rootElem.querySelector(".sim-content"),this.simHeader=new H_(this.simContentContainer,this),this.simMain=document.createElement("main"),this.simMain.classList.add("sim-main","tab-content"),this.simContentContainer.appendChild(this.simMain),this.rootElem.classList.add(this.config.cssClass),this.isWithinRaidSim||this.rootElem.classList.add("not-within-raid-sim"),this.config.spec?.isHealingSpec?this.rootElem.classList.add("sim-type--heal"):this.config.spec?.isTankSpec?this.rootElem.classList.add("sim-type--tank"):(this.config.spec?.isMeleeDpsSpec||this.config.spec?.isRangedDpsSpec)&&this.rootElem.classList.add("sim-type--dps",this.config.spec?.isMeleeDpsSpec?"sim-type--melee":"sim-type--ranged"),this.changeEmitter=te.onAny([this.sim.changeEmitter],"SimUIChange"),this.sim.crashEmitter.on((e,t)=>this.handleCrash(t));const s=()=>{this.sim.getShowDamageMetrics()?this.rootElem.classList.remove("hide-damage-metrics"):this.rootElem.classList.add("hide-damage-metrics")};s(),this.sim.showDamageMetricsChangeEmitter.on(s);const o=()=>{this.sim.getShowThreatMetrics()?this.rootElem.classList.remove("hide-threat-metrics"):this.rootElem.classList.add("hide-threat-metrics")};o(),this.sim.showThreatMetricsChangeEmitter.on(o);const n=()=>{this.sim.getShowHealingMetrics()?this.rootElem.classList.remove("hide-healing-metrics"):this.rootElem.classList.add("hide-healing-metrics")};n(),this.sim.showHealingMetricsChangeEmitter.on(n);const r=()=>{this.sim.getShowThreatMetrics()||this.sim.getShowDamageMetrics()&&this.sim.getShowHealingMetrics()?this.rootElem.classList.remove("hide-ep-ratios"):this.rootElem.classList.add("hide-ep-ratios")};r(),this.sim.showDamageMetricsChangeEmitter.on(r),this.sim.showHealingMetricsChangeEmitter.on(r),this.sim.showThreatMetricsChangeEmitter.on(r);const l=()=>{this.sim.getShowExperimental()?this.rootElem.classList.remove("hide-experimental"):this.rootElem.classList.add("hide-experimental")};l(),this.sim.showExperimentalChangeEmitter.on(l),this.addKnownIssues(a);const c=this.rootElem.querySelector(".sim-title");new U_(c,a.spec,{noDropdown:this.isWithinRaidSim}),this.simActionsContainer=this.rootElem.querySelector(".sim-sidebar-actions"),this.iterationsPicker=new rl(this.simActionsContainer,this.sim,{id:"simui-iterations",label:oe.t("sidebar.iterations"),extraCssClasses:["iterations-picker","within-raid-sim-hide"],changedEvent:e=>e.iterationsChangeEmitter,getValue:e=>e.getIterations(),setValue:(e,t,a)=>{Km({action:"settings",category:"iterations",label:"update",value:a}),t.setIterations(e,a)}}).rootElem;const h=this.rootElem.querySelector(".sim-sidebar-results");this.resultsViewer=new Ug(h);const d=this.rootElem.querySelector(".sim-sidebar-socials");d.appendChild(F_.buildDiscordLink()),d.appendChild(F_.buildGitHubLink()),d.appendChild(F_.buildPatreonLink()),this.simTabContentsContainer=this.rootElem.querySelector(".sim-main.tab-content"),this.disabled&&h.appendChild(H("div",{className:"sim-ui-unlaunched-container d-flex flex-column align-items-center text-center mt-auto mb-auto ms-auto me-auto"},H("i",{className:"fas fa-ban fa-3x mb-2"}),H("h6",null,oe.t("sim.unlaunched.title")),H("p",null,oe.t("sim.unlaunched.contribute_message"),H("br",null),oe.t("sim.unlaunched.discord_message")," ",H("a",{href:"https://discord.gg/p3DgvmnDCS",target:"_blank"},"Discord"),"!"),this.config.spec?.isHealingSpec&&H("p",null,oe.t("sim.unlaunched.healing_message"),H("br",null),oe.t("sim.unlaunched.qe_live_message")," ",H("a",{href:"https://questionablyepic.com/live/"},"QE Live"),"!")))}addNoticeForLocalSim(){new G_(this.simActionsContainer)}addAction(e,t,a){return this.simActionsContainer.appendChild(H("button",{className:xr("sim-sidebar-action-button btn btn-primary w-100",t),onclick:a,disabled:this.disabled},e,H("span",{className:"sim-sidebar-action-button-loading-icon"},H("i",{className:"fas fa-spinner fa-spin"}))))}addActionGroup(e,t={}){const a=[],i=U(),{cssClass:s}=t;return this.simActionsContainer.appendChild(H("div",{ref:i,className:xr("d-flex btn-group w-100",s),attributes:{role:"group"}},e.map(({label:e,cssClass:t,children:i,onClick:s})=>H("button",{ref:e=>a.push(e),onclick:s,className:xr("sim-sidebar-action-button btn btn-primary",t)},e,i,H("span",{className:"sim-sidebar-action-button-loading-icon"},H("i",{className:"fas fa-spinner fa-spin"})))))),{group:i.value,children:a}}addTab(e,t,a){const i=t.replace(/\s+/g,"-")+"-tab",s=0==this.simTabContentsContainer.children.length;this.simHeader.addTab(e,i),this.simTabContentsContainer.appendChild(H("div",{id:i,className:xr("tab-pane fade",s&&"active show")},a))}addSimTab(e){this.simHeader.addSimTabLink(e)}addWarning(e){this.resultsViewer.addWarning(e)}addKnownIssues(e){let t="";switch(e.simStatus.status){case tn.Unlaunched:t=oe.t("info.status.unlaunched");break;case tn.Alpha:t=oe.t("info.status.alpha");break;case tn.Beta:t=oe.t("info.status.beta")}t&&(e.knownIssues=[t].concat(e.knownIssues||[])),e.knownIssues?.forEach(e=>this.simHeader.addKnownIssue(e)),ok?.forEach(e=>this.simHeader.addKnownIssue(e))}getSettingsStorageKey(){return this.getStorageKey("__currentSettings__")}getSavedEncounterStorageKey(){return"sharedData__savedEncounter__"}isIndividualSim(){return this.rootElem.classList.contains("individual-sim-ui")}async runSim(e,t={}){this.resultsViewer.setPending();try{await this.sim.signalManager.abortType(qm.All);const a=await this.sim.runRaidSim(te.nextEventID(),e,t);return a instanceof Dl||a.type!=En.ErrorOutcomeAborted||(new Dg({variant:"info",body:oe.t("sim.notifications.raid_sim_cancelled")}),this.resultsViewer.hideAll()),a}catch(a){this.resultsViewer.hideAll(),this.handleCrash(a)}}async runSimOnce(e={}){this.resultsViewer.setPending();try{return await this.sim.runRaidSimWithLogs(te.nextEventID(),e)}catch(t){this.resultsViewer.hideAll(),this.handleCrash(t)}}async handleCrash(e){if(!(e instanceof sk))return void(e.message?new Dg({variant:"error",body:e.message}):alert(e));new Dg({variant:"error",body:oe.t("sim.notifications.simulation_failed")});const t=e.errorStr;if(t.startsWith("[USER_ERROR] ")){let e=t.substring(13);return e=await Lr.replaceAllInString(e),void alert(e)}if(window.confirm(oe.t("sim.crash_report.confirm_title")+"\n"+t+"\n"+oe.t("sim.crash_report.confirm_message"))){const e=this.hashCode(t),a=this.toLink(),i=this.sim.getLastUsedRngSeed();fetch("https://api.github.com/search/issues?q=is:issue+is:open+repo:wowsims/mop+"+e).then(s=>{s.json().then(s=>{if(s.total_count>0)window.open(s.items[0].html_url,"_blank");else{const s=new URL(On);s.searchParams.append("title",`${oe.t("sim.crash_report.report_title")} ${e}`),s.searchParams.append("assignees",""),s.searchParams.append("labels","");const o=2048-s.toString().length;let n=`Link:\n${a}\n\nRNG Seed: ${i}\n\n${t}`;a.includes("/raid/")&&(n=`${t}\nRNG Seed: ${i}\nLink:\n${a}`);let r=!1;for(;n.length>o-(r?3:0);)n=n.slice(0,n.lastIndexOf("%")),r=!0;r&&(n+="...",new rk(this.rootElem,a).open()),s.searchParams.append("body",n),window.open(s.toString(),"_blank")}})}).catch(e=>{alert(oe.t("sim.notifications.failed_to_file_report")+e)})}}hashCode(e){let t=0;for(let a=0,i=e.length;a<i;a++){t=(t<<5)-t+e.charCodeAt(a),t|=0}return t}}class rk extends Wr{constructor(e,t){super(e,"crash",{title:oe.t("sim.crash_modal.title")}),this.body.appendChild(H("div",{className:"sim-crash-report"},H("h3",{className:"sim-crash-report-header"},oe.t("sim.crash_modal.header")),H("textarea",{className:"sim-crash-report-text form-control"},t)))}}function lk(e,t){return function(e,t){Ck[e]=t}(e,t),t}const ck=[];class hk extends nk{constructor(e,t,a){super(e,t.sim,{cssClass:a.cssClass,cssScheme:a.cssScheme,spec:t.getPlayerSpec(),knownIssues:a.knownIssues,simStatus:rn[t.getSpec()]}),this.epWeightsModal=null,this.bt=null,this.reforger=null,this.rootElem.classList.add("individual-sim-ui"),this.player=t,this.individualConfig=this.applyDefaultConfigOptions(a),this.raidSimResultsManager=null,this.prevEpIterations=0,this.prevEpSimResult=null,this.statWeightActionSettings=new D_(this),(a.itemSwapSlots||[]).length>0&&!ck.includes(t.getSpec())&&ck.push(t.getSpec()),this.addWarning({updateOn:this.player.gearChangeEmitter,getContent:()=>{if(!this.player.getGear().hasInactiveMetaGem(this.player.isBlacksmithing()))return"";const e=this.player.getGear().getMetaGem();return oe.t("sidebar.warnings.meta_gem_disabled",{gemName:e.name,description:mr(e)})}}),this.addWarning({updateOn:te.onAny([this.player.gearChangeEmitter,this.player.professionChangeEmitter]),getContent:()=>{const e=this.player.getGear().getFailedProfessionRequirements(this.player.getProfessions());return 0==e.length?"":e.map(e=>oe.t("sidebar.warnings.profession_requirement",{itemName:e.name,professionName:Kr.get(e.requiredProfession)}))}}),this.addWarning({updateOn:this.player.gearChangeEmitter,getContent:()=>{const e=this.player.getGear().getJCGems(this.player.isBlacksmithing());return e.length<=2?"":oe.t("sidebar.warnings.too_many_jc_gems",{count:e.length})}}),this.addWarning({updateOn:this.player.talentsChangeEmitter,getContent:()=>{const e=Gn(this.player.getTalentsString()),t=O_(this.player.getSpecConfig());if(0==e&&0==t.length)return"";if(function(e,t){const a=O_(e),i=t.split("").map(Number);return a.every(e=>i[e]>0)}(this.player.getSpecConfig(),this.player.getTalentsString()))return"";{const e=function(e,t){const a=O_(e),i=t.split("").map(Number);return a.filter(e=>0===i[e])}(this.player.getSpecConfig(),this.player.getTalentsString()),t=e.map(e=>e+1).join(", ");return oe.t("sidebar.warnings.unspent_talent_points",{rowNumbers:t})}}}),this.addWarning({updateOn:this.player.gearChangeEmitter,getContent:()=>this.player.armorSpecializationArmorType&&this.player.hasArmorSpecializationBonus()?oe.t("sidebar.warnings.armor_specialization",{armorType:Yr.get(this.player.armorSpecializationArmorType)}):""}),this.addWarning({updateOn:te.onAny([this.player.gearChangeEmitter,this.player.talentsChangeEmitter]),getContent:()=>this.player.canDualWield2H()||(this.player.getEquippedItem(i.ItemSlotMainHand)?.item.handType!=h.HandTypeTwoHand||null==this.player.getEquippedItem(i.ItemSlotOffHand))&&this.player.getEquippedItem(i.ItemSlotOffHand)?.item.handType!=h.HandTypeTwoHand?"":oe.t("sidebar.warnings.dual_wield_2h_without_titans_grip")}),(a.warnings||[]).forEach(e=>this.addWarning(e(this))),this.isWithinRaidSim||this.sim.waitForInit().then(()=>{ef.registerSetBonusNotices(this.sim.db),this.loadSettings(),this.player.getPlayerSpec().isHealingSpec&&alert(oe.t("sim.healing_sim_disclaimer"))}),this.addSidebarComponents(),this.addGearTab(),this.addSettingsTab(),this.addTalentsTab(),this.addRotationTab(),this.isWithinRaidSim||this.addDetailedResultsTab(),this.bt=this.addBulkTab(),this.sim.waitForInit().then(()=>{this.addTopbarComponents()})}applyDefaultConfigOptions(e){return e.otherInputs.inputs=[x_,...e.otherInputs.inputs],e}loadSettings(){const e=te.nextEventID();te.freezeAllAndDo(()=>{this.applyDefaults(e);const t=window.localStorage.getItem(this.getSettingsStorageKey());if(null!=t)try{const a=nt.fromJsonString(t,{ignoreUnknownFields:!0});this.fromProto(e,a)}catch(i){console.warn("Failed to parse saved settings: "+i)}try{const t=xv.tryParseUrlLocation(window.location);t&&this.fromProto(e,t.settings,t.categories)}catch(i){console.warn("Failed to parse link settings: "+i)}window.location.hash="",this.player.setName(e,"Player");const a=[this.changeEmitter];this.reforger?.changeEmitter&&a.push(this.reforger.changeEmitter),te.onAny(a).on(e=>{const t=nt.toJsonString(this.toProto());window.localStorage.setItem(this.getSettingsStorageKey(),t)}),this.statWeightActionSettings.load(e)})}addSidebarComponents(){this.raidSimResultsManager=Jm(this),this.sim.waitForInit().then(()=>{this.epWeightsModal=((e,t)=>{const a=new N_(e,t);return e.addAction(oe.t("sidebar.buttons.stat_weights.title"),"ep-weights-action",()=>{Zm("Stat Weights","/stat-weights"),a.open()}),a})(this,this.statWeightActionSettings)}),new ll(this.rootElem.querySelector(".sim-sidebar-stats"),this,this.player,this.individualConfig.displayStats,this.individualConfig.modifyDisplayStats,this.individualConfig.overwriteDisplayStats)}addGearTab(){new Xv(this.simTabContentsContainer,this).rootElem.classList.add("active","show")}addBulkTab(){return new Tv(this.simTabContentsContainer,this)}addSettingsTab(){new f_(this.simTabContentsContainer,this)}addTalentsTab(){new w_(this.simTabContentsContainer,this)}addRotationTab(){new bS(this.simTabContentsContainer,this)}addDetailedResultsTab(){const e=H("div",{className:"detailed-results"});this.addTab(oe.t("results_tab.title"),"detailed-results-tab",e),new sg(e,this,this.raidSimResultsManager)}addTopbarComponents(){this.simHeader.addImportLink("JSON",new sb(this.rootElem,this),!0),this.simHeader.addImportLink("WoWHead",new Ev(this.rootElem,this),!1,!1),this.simHeader.addImportLink("Addon",new ab(this.rootElem,this),!0),this.simHeader.addExportLink("Link",new Nv(this.rootElem,this),!1),this.simHeader.addExportLink("JSON",new Lv(this.rootElem,this),!0),this.simHeader.addExportLink("WoWHead",new Wv(this.rootElem,this),!1,!1),this.simHeader.addExportLink("Pawn EP",new Gv(this.rootElem,this),!1),this.simHeader.addExportLink("CLI",new Mv(this.rootElem,this),!0)}applyDefaultRotation(e){te.freezeAllAndDo(()=>{const t=this.individualConfig.defaults.rotationType||uo.TypeAuto;if(this.player.setAplRotation(e,fo.create({type:t})),!this.individualConfig.defaults.simpleRotation)return;const a=this.individualConfig.defaults.simpleRotation||this.player.specTypeFunctions.rotationCreate();this.player.setSimpleRotation(e,a),this.player.setSimpleCooldowns(e,zn.create({hpPercentForDefensives:this.player.playerSpec.isTankSpec?.4:0}))})}applyEmptyAplRotation(e){te.freezeAllAndDo(()=>{this.player.setAplRotation(e,fo.create({type:uo.TypeAPL}))})}static updateProtoVersion(e){if(!(e.apiVersion<yo))return;const t=new Map([[2,e=>(e.apiVersion=2,e.reforgeSettings=rt.create({useCustomEpValues:e.settings?.useCustomEpValues,useSoftCapBreakpoints:e.settings?.useSoftCapBreakpoints,statCaps:e.statCaps,breakpointLimits:e.breakpointLimits}),e)]]);Fn(e,e.apiVersion,t),e.apiVersion=yo}applyDefaults(e){te.freezeAllAndDo(()=>{const t=this.player.getPlayerSpec().isTankSpec,i=this.player.getPlayerSpec().isHealingSpec;this.player.applySharedDefaults(e),this.player.setRace(e,this.individualConfig.defaults.other?.race||this.player.getPlayerClass().races[0]),this.player.setGear(e,this.sim.db.lookupEquipmentSpec(this.individualConfig.defaults.gear)),this.player.setConsumes(e,this.individualConfig.defaults.consumables),this.applyDefaultRotation(e),this.player.setTalentsString(e,this.individualConfig.defaults.talents.talentsString),this.player.setGlyphs(e,this.individualConfig.defaults.talents.glyphs||Vt.create()),this.player.setSpecOptions(e,this.individualConfig.defaults.specOptions),this.player.setBuffs(e,this.individualConfig.defaults.individualBuffs),this.player.getParty().setBuffs(e,this.individualConfig.defaults.partyBuffs),this.player.getRaid().setBuffs(e,this.individualConfig.defaults.raidBuffs),this.player.setEpWeights(e,this.individualConfig.defaults.epWeights),this.individualConfig.defaults.itemSwap&&this.player.itemSwapSettings.setItemSwapSettings(e,!0,this.sim.db.lookupItemSwap(this.individualConfig.defaults.itemSwap||zo.create()));const s=this.player.getDefaultEpRatios(t,i);this.player.setEpRatios(e,s),this.player.setProfession1(e,this.individualConfig.defaults.other?.profession1||a.Engineering),void 0===this.individualConfig.defaults.other?.profession2?this.player.setProfession2(e,a.Jewelcrafting):this.player.setProfession2(e,this.individualConfig.defaults.other.profession2),this.player.setDistanceFromTarget(e,this.individualConfig.defaults.other?.distanceFromTarget||0),this.player.setChannelClipDelay(e,this.individualConfig.defaults.other?.channelClipDelay||0),this.player.setReactionTime(e,this.individualConfig.defaults.other?.reactionTime||100),this.reforger?.applyDefaults(e),this.isWithinRaidSim?this.sim.raid.setTargetDummies(e,0):(this.sim.raid.setTargetDummies(e,i?9:0),this.sim.encounter.applyDefaults(e),this.sim.encounter.setExecuteProportion90(e,this.individualConfig.defaults.other?.highHpThreshold||.9),this.sim.raid.setDebuffs(e,this.individualConfig.defaults.debuffs),this.sim.applyDefaults(e,t,i),this.individualConfig.defaults.other?.iterationCount&&this.sim.setIterations(e,this.individualConfig.defaults.other.iterationCount),t?this.sim.raid.setTanks(e,[this.player.makeUnitReference()]):this.sim.raid.setTanks(e,[]),this.statWeightActionSettings.applyDefaults(e)),this.individualConfig.defaultBuild&&ra.applyBuild(e,this.individualConfig.defaultBuild,this)})}toProto(e){const t=t=>!e||0==e.length||e.includes(t),a=nt.create({player:this.player.toProto(!0,!1,e),apiVersion:yo});return t(ff.Miscellaneous)&&nt.mergePartial(a,{tanks:this.sim.raid.getTanks()}),t(ff.Encounter)&&nt.mergePartial(a,{encounter:this.sim.encounter.toProto()}),t(ff.External)&&nt.mergePartial(a,{partyBuffs:this.player.getParty()?.getBuffs()||No.create(),raidBuffs:this.sim.raid.getBuffs(),debuffs:this.sim.raid.getDebuffs(),targetDummies:this.sim.raid.getTargetDummies()}),t(ff.UISettings)&&nt.mergePartial(a,{settings:this.sim.toProto(),epWeightsStats:this.player.getEpWeights().toProto(),epRatios:this.player.getEpRatios(),dpsRefStat:this.dpsRefStat,healRefStat:this.healRefStat,tankRefStat:this.tankRefStat,reforgeSettings:this.reforger?.toProto()}),a}toLink(){return Nv.createLink(this)}fromProto(e,t,a){const i=e=>!a||0==a.length||a.includes(e),s=this.player.getPlayerSpec().isTankSpec,o=this.player.getPlayerSpec().isHealingSpec;te.freezeAllAndDo(()=>{if(hk.updateProtoVersion(t),t.player){if(this.player.fromProto(e,t.player,a),i(ff.Miscellaneous)&&this.sim.raid.setTanks(e,t.tanks||[]),i(ff.External)){this.sim.raid.setBuffs(e,t.raidBuffs||Mo.create()),this.sim.raid.setDebuffs(e,t.debuffs||Lo.create());const a=this.player.getParty();a&&a.setBuffs(e,t.partyBuffs||No.create()),this.sim.raid.setTargetDummies(e,t.targetDummies)}if(i(ff.Encounter)&&this.sim.encounter.fromProto(e,t.encounter||Fe.create()),i(ff.UISettings)){t.epWeightsStats?this.player.setEpWeights(e,n.fromProto(t.epWeightsStats)):this.player.setEpWeights(e,this.individualConfig.defaults.epWeights);const a=this.player.getDefaultEpRatios(s,o);if(t.epRatios){const i=new Array(a.length-t.epRatios.length).fill(0);this.player.setEpRatios(e,t.epRatios.concat(i))}else this.player.setEpRatios(e,a);t.reforgeSettings&&this.reforger&&this.reforger.fromProto(e,t.reforgeSettings),t.dpsRefStat&&(this.dpsRefStat=t.dpsRefStat),t.healRefStat&&(this.healRefStat=t.healRefStat),t.tankRefStat&&(this.tankRefStat=t.tankRefStat),t.settings?this.sim.fromProto(e,t.settings):this.sim.applyDefaults(e,s,o)}}})}hasCapForPseudoStat(e){const t=this.individualConfig.defaults.statCaps||new n,a=this.reforger?.statCaps||new n,i=this.individualConfig.defaults.softCapBreakpoints||[];return Qe(e,a.add(t),i)}hasDisplayPseudoStat(e){for(const t of this.individualConfig.displayStats)if(t.equalsPseudoStat(e))return!0;return!1}getSavedGearStorageKey(){return this.getStorageKey("__savedGear__")}getSavedEPWeightsStorageKey(){return this.getStorageKey("__savedEPWeights__")}getSavedRotationStorageKey(){return this.getStorageKey("__savedRotation__")}getSavedSettingsStorageKey(){return this.getStorageKey("__savedSettings__")}getSavedTalentsStorageKey(){return this.getStorageKey("__savedTalents__")}getStorageKey(e){return _e.getLocalStorageKey(this.player.getPlayerSpec())+e}}const dk={rows_in_block:50,blocks_in_cluster:4,tag:null,show_no_data_row:!0,no_data_class:"clusterize-no-data",no_data_text:"No data",keep_parity:!0,callbacks:{}};function uk(e,t){return window.getComputedStyle(t)[e]}class pk{constructor(e,t){this.last_cluster=0,this.scroll_debounce=0,this.pointer_events_set=!1,this.resize_debounce=0,this.cache={},this.options={rows_in_block:void 0!==t.rows_in_block?t.rows_in_block:dk.rows_in_block,blocks_in_cluster:void 0!==t.blocks_in_cluster?t.blocks_in_cluster:dk.blocks_in_cluster,show_no_data_row:void 0!==t.show_no_data_row?t.show_no_data_row:dk.show_no_data_row,no_data_class:void 0!==t.no_data_class?t.no_data_class:dk.no_data_class,no_data_text:void 0!==t.no_data_text?t.no_data_text:dk.no_data_text,keep_parity:void 0!==t.keep_parity?t.keep_parity:dk.keep_parity,tag:void 0!==t.tag?t.tag:dk.tag,callbacks:void 0!==t.callbacks?t.callbacks:dk.callbacks,cluster_height:0,item_height:void 0!==t.item_height?t.item_height:0,content_tag:"",block_height:0,scroll_top:0,rows_in_cluster:0},this.ds=e,this.displayedRows=t.rows,this.scroll_elem=t.scroll_elem,this.content_elem=t.content_elem,this.content_elem.hasAttribute("tabindex")||this.content_elem.setAttribute("tabindex","0");const a=this.scroll_elem.scrollTop;this.getRowsHeight(t.rows),this.insertToDom(t.rows,this.cache),this.scroll_elem.scrollTop=a,this.scroll_elem.addEventListener("scroll",this.scrollEv.bind(this)),window.addEventListener("resize",this.resizeEv.bind(this))}destroy(e){this.scroll_elem.removeEventListener("scroll",this.scrollEv.bind(this)),window.removeEventListener("resize",this.resizeEv.bind(this)),e&&this.setContentElemRows(this.generateEmptyRow())}dispose(){this.destroy()}refresh(e){(this.getRowsHeight(this.displayedRows)||e)&&this.update()}update(){const e=this.scroll_elem.scrollTop;this.ds.getNumberOfRows()*this.options.item_height<e&&(this.scroll_elem.scrollTop=0,this.last_cluster=0),this.insertToDom(this.displayedRows,this.cache),this.scroll_elem.scrollTop=e}elementUpdate(e){for(const t of this.displayedRows)e(t)}getScrollProgress(){return this.options.scroll_top/(this.ds.getNumberOfRows()*this.options.item_height)*100||0}scrollEv(){navigator.platform.toLowerCase().indexOf("mac")+1&&(this.pointer_events_set||(this.content_elem.style.pointerEvents="none"),this.pointer_events_set=!0,clearTimeout(this.scroll_debounce),this.scroll_debounce=window.setTimeout(()=>{this.content_elem.style.pointerEvents="auto",this.pointer_events_set=!1},50)),this.last_cluster!=(this.last_cluster=this.getClusterNum(this.ds.getNumberOfRows()))&&this.insertToDom(this.displayedRows,this.cache),this.options.callbacks.scrollingProgress&&this.options.callbacks.scrollingProgress(this.getScrollProgress())}resizeEv(){clearTimeout(this.resize_debounce),this.resize_debounce=window.setTimeout(this.refresh.bind(this),100)}insertToDom(e,t){this.options.cluster_height||this.exploreEnvironment(e,t);const a=this.generate(),i=a.rows;this.displayedRows=a.rows;const s=this.checkChanges("data",i,t),o=this.checkChanges("top",a.top_offset,t),n=this.checkChanges("bottom",a.bottom_offset,t),r=this.options.callbacks,l=[];if(s||o){if(a.top_offset){if(this.options.keep_parity){const e=this.renderExtraTag("keep-parity");e.hidden=!0,l.push(e)}l.push(this.renderExtraTag("top-space",a.top_offset))}l.push(...i),a.bottom_offset&&l.push(this.renderExtraTag("bottom-space",a.bottom_offset)),r.clusterWillChange&&r.clusterWillChange(),this.setContentElemRows(l),"ol"==this.options.content_tag&&this.content_elem.setAttribute("start",a.rows_above.toString()),this.content_elem.style.counterIncrement="clusterize-counter "+(a.rows_above-1),r.clusterChanged&&r.clusterChanged()}else n&&(this.content_elem.lastChild.style.height=a.bottom_offset+"px")}exploreEnvironment(e,t){const a=this.options;a.content_tag=this.content_elem.tagName.toLowerCase(),e.length&&(this.content_elem.children.length<=1&&this.setContentElemRows([e[0],e[0],e[0]]),a.tag||(a.tag=this.content_elem.children[0].tagName.toLowerCase()),this.getRowsHeight(e))}setContentElemRows(e){this.content_elem.innerHTML="",this.content_elem.append(...e)}getRowsHeight(e){const t=this.options,a=t.item_height;t.cluster_height=0;const i=this.content_elem.children;if(e.length&&i.length){const e=i[Math.floor(i.length/2)];if(t.item_height=e.offsetHeight,"tr"==t.tag&&"collapse"!=uk("borderCollapse",this.content_elem)&&(t.item_height+=parseInt(uk("borderSpacing",this.content_elem),10)||0),"tr"!=t.tag){const a=parseInt(uk("marginTop",e),10)||0,i=parseInt(uk("marginBottom",e),10)||0;t.item_height+=Math.max(a,i)}}return t.block_height=t.item_height*t.rows_in_block,t.rows_in_cluster=t.blocks_in_cluster*t.rows_in_block,t.cluster_height=t.blocks_in_cluster*t.block_height,a!=t.item_height}generate(){const e=this.options,t=this.ds.getNumberOfRows();if(t<e.rows_in_block){const e=this.ds.generateRows(0,t);return{top_offset:0,bottom_offset:0,rows_above:0,rows:t?e:this.generateEmptyRow()}}let a=Math.max((e.rows_in_cluster-e.rows_in_block)*this.getClusterNum(t),0),i=a+e.rows_in_cluster,s=Math.max(a*e.item_height,0),o=Math.max((t-i)*e.item_height,0),n=[],r=a;return s<1&&r++,n=this.ds.generateRows(a,i),{top_offset:s,bottom_offset:o,rows_above:r,rows:n}}generateEmptyRow(){const e=this.options;if(!e.tag||!e.show_no_data_row)return[];const t=document.createElement(e.tag);let a,i=document.createTextNode(e.no_data_text);return t.className=e.no_data_class,"tr"==e.tag&&(a=document.createElement("td"),a.colSpan=100,a.appendChild(i)),t.appendChild(a||i),[t]}getClusterNum(e){const t=this.options;t.scroll_top=this.scroll_elem.scrollTop;const a=Math.max(t.cluster_height-t.block_height,1),i=Math.floor(t.scroll_top/a),s=Math.floor(e*t.item_height/a);return Math.min(i,s)}renderExtraTag(e,t){const a=document.createElement(this.options.tag),i="clusterize-";return a.className=[i+"extra-row",i+e].join(" "),a.style.marginTop="0",a.style.marginBottom="0",t&&(a.style.height=t+"px"),a}checkChanges(e,t,a){const i=t!=a[e];return a[e]=t,i}}const mk={[mt.UNSPECIFIED]:oe.t("gear_tab.gear_picker.filters.faction_labels.none"),[mt.ALLIANCE_ONLY]:oe.t("gear_tab.gear_picker.filters.faction_labels.alliance_only"),[mt.HORDE_ONLY]:oe.t("gear_tab.gear_picker.filters.faction_labels.horde_only")};class gk extends Wr{constructor(e,t,a){super(e,"filters-menu",{size:"md",title:oe.t("gear_tab.gear_picker.filters.title"),disposeOnClose:!1});const i=this.newSection(oe.t("gear_tab.gear_picker.filters.general")),s=H("div",{className:"ilvl-filters"});i.appendChild(s),new rl(s,t.sim,{id:"filters-min-ilvl",label:oe.t("gear_tab.gear_picker.filters.min_ilvl"),showZeroes:!1,changedEvent:e=>e.filtersChangeEmitter,getValue:e=>e.getFilters().minIlvl,setValue:(e,t,a)=>{const i=t.getFilters();i.minIlvl=a,t.setFilters(e,i)}}),s.appendChild(H("span",{className:"ilvl-filters-separator"},"-")),new rl(s,t.sim,{id:"filters-max-ilvl",label:oe.t("gear_tab.gear_picker.filters.max_ilvl"),showZeroes:!1,changedEvent:e=>e.filtersChangeEmitter,getValue:e=>e.getFilters().maxIlvl,setValue:(e,t,a)=>{const i=t.getFilters();i.maxIlvl=a,t.setFilters(e,i)}}),new Ag(i,t.sim,{id:"filters-faction-restriction",label:oe.t("gear_tab.gear_picker.filters.faction_restrictions"),values:[mt.UNSPECIFIED,mt.ALLIANCE_ONLY,mt.HORDE_ONLY].map(e=>({name:mk[e],value:e})),changedEvent:e=>e.filtersChangeEmitter,getValue:e=>e.getFilters().factionRestriction,setValue:(e,t,a)=>{const i=t.getFilters();i.factionRestriction=a,t.setFilters(e,i)}});const o=this.newSection(oe.t("gear_tab.gear_picker.filters.source"));o.classList.add("filters-menu-section-bool-list");const n=Object.keys(jn);ik.ALL_SOURCES.sort((e,t)=>n.indexOf(e)-n.indexOf(t)).forEach(e=>{const a=Hn(e);a&&new gc(o,t.sim,{id:`filters-source-${e}`,label:a,inline:!0,changedEvent:e=>e.filtersChangeEmitter,getValue:t=>t.getFilters().sources.includes(e),setValue:(t,a,i)=>{const s=a.getFilters();i?s.sources.push(e):s.sources=s.sources.filter(t=>t!=e),a.setFilters(t,s)}})});const r=this.newSection(oe.t("gear_tab.gear_picker.filters.raids"));if(r.classList.add("filters-menu-section-bool-list"),ik.ALL_RAIDS.forEach(e=>{new gc(r,t.sim,{id:`filters-raid-${e}`,label:Un(e),inline:!0,changedEvent:e=>e.filtersChangeEmitter,getValue:t=>t.getFilters().raids.includes(e),setValue:(t,a,i)=>{const s=a.getFilters();i?s.raids.push(e):s.raids=s.raids.filter(t=>t!=e),a.setFilters(t,s)}})}),Tk.ARMOR_SLOTS.includes(a)){const e=t.getPlayerClass().armorTypes;if(e.length>1){const a=this.newSection(oe.t("gear_tab.gear_picker.armor_type"));a.classList.add("filters-menu-section-bool-list"),e.forEach(e=>{new gc(a,t.sim,{id:`filters-armor-type-${e}`,label:Bn(e),inline:!0,changedEvent:e=>e.filtersChangeEmitter,getValue:t=>t.getFilters().armorTypes.includes(e),setValue:(t,a,i)=>{const s=a.getFilters();i?s.armorTypes.push(e):s.armorTypes=s.armorTypes.filter(t=>t!=e),a.setFilters(t,s)}})})}}else if(Tk.WEAPON_SLOTS.includes(a)){if(t.getPlayerClass().weaponTypes.length>0){const e=this.newSection(oe.t("gear_tab.gear_picker.weapon_type"));e.classList.add("filters-menu-section-bool-list");t.getPlayerClass().weaponTypes.map(e=>e.weaponType).forEach(a=>{new gc(e,t.sim,{id:`filters-weapon-type-${a}`,label:Wn(a),inline:!0,changedEvent:e=>e.filtersChangeEmitter,getValue:e=>e.getFilters().weaponTypes.includes(a),setValue:(e,t,i)=>{const s=t.getFilters();i?s.weaponTypes.push(a):s.weaponTypes=s.weaponTypes.filter(e=>e!=a),t.setFilters(e,s)}})});const a=this.newSection(oe.t("gear_tab.gear_picker.weapon_speed"));a.classList.add("filters-menu-section-number-list"),new rl(a,t.sim,{id:"filters-min-weapon-speed",label:oe.t("gear_tab.gear_picker.min_mh_speed"),float:!0,positive:!0,changedEvent:e=>e.filtersChangeEmitter,getValue:e=>e.getFilters().minMhWeaponSpeed,setValue:(e,t,a)=>{const i=t.getFilters();i.minMhWeaponSpeed=a,t.setFilters(e,i)}}),new rl(a,t.sim,{id:"filters-max-weapon-speed",label:oe.t("gear_tab.gear_picker.max_mh_speed"),float:!0,positive:!0,changedEvent:e=>e.filtersChangeEmitter,getValue:e=>e.getFilters().maxMhWeaponSpeed,setValue:(e,t,a)=>{const i=t.getFilters();i.maxMhWeaponSpeed=a,t.setFilters(e,i)}}),t.getPlayerSpec().canDualWield&&(new rl(a,t.sim,{id:"filters-min-oh-weapon-speed",label:oe.t("gear_tab.gear_picker.min_oh_speed"),float:!0,positive:!0,changedEvent:e=>e.filtersChangeEmitter,getValue:e=>e.getFilters().minOhWeaponSpeed,setValue:(e,t,a)=>{const i=t.getFilters();i.minOhWeaponSpeed=a,t.setFilters(e,i)}}),new rl(a,t.sim,{id:"filters-max-oh-weapon-speed",label:oe.t("gear_tab.gear_picker.max_oh_speed"),float:!0,positive:!0,changedEvent:e=>e.filtersChangeEmitter,getValue:e=>e.getFilters().maxOhWeaponSpeed,setValue:(e,t,a)=>{const i=t.getFilters();i.maxOhWeaponSpeed=a,t.setFilters(e,i)}}))}const e=t.getPlayerClass().rangedWeaponTypes;if(e.length<1)return;const a=this.newSection(oe.t("gear_tab.gear_picker.filters.ranged_weapon_type"));a.classList.add("filters-menu-section-bool-list"),e.forEach(e=>{new gc(a,t.sim,{id:`filter-ranged-weapon-type-${e}`,label:Vn(e),inline:!0,changedEvent:e=>e.filtersChangeEmitter,getValue:t=>t.getFilters().rangedWeaponTypes.includes(e),setValue:(t,a,i)=>{const s=a.getFilters();i?s.rangedWeaponTypes.push(e):s.rangedWeaponTypes=s.rangedWeaponTypes.filter(t=>t!=e),a.setFilters(t,s)}})});const i=this.newSection(oe.t("gear_tab.gear_picker.filters.ranged_weapon_speed"));i.classList.add("filters-menu-section-number-list"),new rl(i,t.sim,{id:"filters-min-ranged-weapon-speed",label:oe.t("gear_tab.gear_picker.filters.min_ranged_speed"),float:!0,positive:!0,changedEvent:e=>e.filtersChangeEmitter,getValue:e=>e.getFilters().minRangedWeaponSpeed,setValue:(e,t,a)=>{const i=t.getFilters();i.minRangedWeaponSpeed=a,t.setFilters(e,i)}}),new rl(i,t.sim,{id:"filters-max-ranged-weapon-speed",label:oe.t("gear_tab.gear_picker.filters.max_ranged_speed"),float:!0,positive:!0,changedEvent:e=>e.filtersChangeEmitter,getValue:e=>e.getFilters().maxRangedWeaponSpeed,setValue:(e,t,a)=>{const i=t.getFilters();i.maxRangedWeaponSpeed=a,t.setFilters(e,i)}})}}newSection(e){const t=document.createElement("div");return t.classList.add("menu-section",`${e.toLowerCase().replaceAll(" ","-")}-section`),this.body.appendChild(t),t.innerHTML=`\n\t\t\t<div class="menu-section-header">\n\t\t\t\t<h6 class="menu-section-title">${e}</h6>\n\t\t\t</div>\n\t\t\t<div class="menu-section-content"></div>\n\t\t`,t.getElementsByClassName("menu-section-content")[0]}}class fk{constructor(e,t,a,s,o,n,r,l,c,h,d,u,p,m){this.sortBy=1,this.sortDirection=Yn.DESC,this.id=e,this.label=r,this.simUI=a,this.player=n,this.itemData=c,this.socketColor=h,this.computeEP=d,this.equippedToItemFn=u,this.onItemClick=m,this.slot=s,this.gearData=l,this.currentFilters=this.player.sim.getFilters();const g=r===o,f=U(),b=U(),y=U(),w=U(),v=U(),x=U(),S=U(),_=U(),k=U(),C=U(),I=U(),E=![i.ItemSlotTrinket1,i.ItemSlotTrinket2].includes(s);if(this.tabContent=H("div",{id:this.id,className:"selector-modal-tab-pane tab-pane fade "+(g?"active show":"")},H("div",{className:"selector-modal-filters"},H("input",{ref:f,className:"selector-modal-search form-control",type:"text",placeholder:oe.t("common.search")}),r===bk.Items&&H("button",{ref:y,className:"selector-modal-filters-button btn btn-primary"},oe.t("gear_tab.gear_picker.filters_button")),H("div",{ref:v,className:"selector-modal-phase-selector"}),H("div",{ref:S,className:"sim-input selector-modal-boolean-option selector-modal-show-1h-weapons hide"}),H("div",{ref:_,className:"sim-input selector-modal-boolean-option selector-modal-show-2h-weapons hide"}),H("div",{ref:x,className:"sim-input selector-modal-boolean-option selector-modal-show-matching-gems"}),E&&H("div",{ref:w,className:"sim-input selector-modal-boolean-option selector-modal-show-ep-values"}),H("button",{ref:C,className:"selector-modal-remove-button btn btn-danger"},oe.t("gear_tab.gear_picker.unequip_item"))),H("div",{className:"selector-modal-list-labels"},(r===bk.Items||r===bk.Upgrades)&&H("h6",{className:"ilvl-label interactive",onclick:e=>{e.preventDefault(),this.sort(1)}},oe.t("gear_tab.gear_picker.table_headers.ilvl")),H("h6",{className:"item-label"},r===bk.Items?yk(bk.Items):r===bk.Enchants?yk(bk.Enchants):[bk.Gem1,bk.Gem2,bk.Gem3].includes(r)?yk(bk.Gem1):r===bk.Reforging?yk(bk.Reforging):r===bk.Upgrades?yk(bk.Upgrades):r===bk.Tinkers?yk(bk.Tinkers):""),r===bk.Items&&H("h6",{className:"source-label"},oe.t("gear_tab.gear_picker.table_headers.source")),H("h6",{className:"ep-label interactive",onclick:e=>{e.preventDefault(),this.sort(0)}},H("span",null,"EP"),H("i",{className:"fa-solid fa-plus-minus fa-2xs"}),H("button",{ref:b,className:"btn btn-link p-0 ms-1"},H("i",{className:"far fa-question-circle fa-lg"}))),H("h6",{className:"favorite-label"}),H("h6",{ref:I,className:"compare-label hide"})),H("ul",{ref:k,className:"selector-modal-list"})),t.appendChild(this.tabContent),this.label===bk.Items&&this.bindToggleCompare(I.value),r===bk.Items&&n.getPlayerClass().weaponTypes.length>0&&(s===i.ItemSlotMainHand||s===i.ItemSlotOffHand&&n.getClass()===q.ClassWarrior)&&(S.value&&function(e,t){e.classList.remove("hide"),new gc(e,t,{id:"show-1h-weapons-selector",extraCssClasses:["show-1h-weapons-selector","mb-0"],label:oe.t("settings_tab.other.show_1h_weapons.label"),inline:!0,changedEvent:e=>e.filtersChangeEmitter,getValue:e=>e.getFilters().oneHandedWeapons,setValue:(e,t,a)=>{const i=t.getFilters();i.oneHandedWeapons=a,t.setFilters(e,i)}})}(S.value,n.sim),_.value&&function(e,t){e.classList.remove("hide"),new gc(e,t,{id:"show-2h-weapons-selector",extraCssClasses:["show-2h-weapons-selector","mb-0"],label:oe.t("settings_tab.other.show_2h_weapons.label"),inline:!0,changedEvent:e=>e.filtersChangeEmitter,getValue:e=>e.getFilters().twoHandedWeapons,setValue:(e,t,a)=>{const i=t.getFilters();i.twoHandedWeapons=a,t.setFilters(e,i)}})}(_.value,n.sim)),E&&(w.value&&function(e,t){new gc(e,t,{id:"show-ep-values-selector",extraCssClasses:["show-ep-values-selector","input-inline","mb-0"],label:oe.t("settings_tab.other.show_ep_values.label"),inline:!0,changedEvent:e=>e.showEPValuesChangeEmitter,getValue:e=>e.getShowEPValues(),setValue:(e,t,a)=>{t.setShowEPValues(e,a)}})}(w.value,n.sim),ie(b.value,{content:oe.t("gear_tab.gear_picker.ep_tooltip")})),x.value&&(!function(e,t){new gc(e,t,{id:"show-matching-gems-selector",extraCssClasses:["show-matching-gems-selector","input-inline","mb-0"],label:oe.t("settings_tab.other.show_matching_gems.label"),inline:!0,changedEvent:e=>e.filtersChangeEmitter,getValue:e=>e.getFilters().matchingGemsOnly,setValue:(e,t,a)=>{const i=t.getFilters();i.matchingGemsOnly=a,t.setFilters(e,i)}})}(x.value,n.sim),r.startsWith("Gem")||x.value?.classList.add("hide")),v.value&&function(e,t){new Ag(e,t,{id:"phase-selector",extraCssClasses:["phase-selector"],values:[{name:oe.t("common.phases.1"),value:1},{name:oe.t("common.phases.2"),value:2},{name:oe.t("common.phases.3"),value:3},{name:oe.t("common.phases.4"),value:4},{name:oe.t("common.phases.5"),value:5}],changedEvent:e=>e.phaseChangeEmitter,getValue:e=>e.getPhase(),setValue:(e,t,a)=>{t.setPhase(e,a)}})}(v.value,n.sim),r===bk.Items){const e=new gk(t,n,s);y.value?.addEventListener("click",()=>e.open())}this.listElem=k.value,this.itemsToDisplay=[],this.scroller=new pk({getNumberOfRows:()=>this.itemsToDisplay.length,generateRows:(e,t)=>{const a=[];for(let i=e;i<t&&!(i>=this.itemsToDisplay.length);++i)a.push(this.createItemElem({idx:this.itemsToDisplay[i],data:this.itemData[this.itemsToDisplay[i]]}));return a}},{rows:[],scroll_elem:this.listElem,content_elem:this.listElem,item_height:56,show_no_data_row:!1,no_data_text:"",tag:"li",rows_in_block:16,blocks_in_cluster:2});const T=C.value;if(T)switch(T.addEventListener("click",e=>{p(te.nextEventID())}),r){case bk.Enchants:T.textContent=oe.t("gear_tab.gear_picker.remove_buttons.remove_enchant");break;case bk.Tinkers:T.textContent=oe.t("gear_tab.gear_picker.remove_buttons.remove_tinkers");break;case bk.Reforging:T.textContent=oe.t("gear_tab.gear_picker.remove_buttons.remove_reforge");break;case bk.RandomSuffixes:T.textContent=oe.t("gear_tab.gear_picker.remove_buttons.remove_random_suffix");break;case bk.Upgrades:T.textContent=oe.t("gear_tab.gear_picker.remove_buttons.remove_upgrade");break;case bk.Gem1:case bk.Gem2:case bk.Gem3:T.textContent=oe.t("gear_tab.gear_picker.remove_buttons.remove_gem")}this.updateSelected(),this.searchInput=f.value,this.searchInput.addEventListener("input",()=>this.applyFilters())}sizeRefresh(){this.scroller.refresh(!0),this.applyFilters()}dispose(){this.scroller.dispose()}getItemIdByItemType(e){switch(this.label){case bk.Enchants:case bk.Tinkers:return e?.effectId;case bk.Reforging:return e?.reforge.id;case bk.Items:case bk.Gem1:case bk.Gem2:case bk.Gem3:case bk.RandomSuffixes:return e?.id;case bk.Upgrades:return e;default:return null}}updateSelected(){const e=this.gearData.getEquippedItem(),t=this.equippedToItemFn(e),a=this.getItemIdByItemType(t),i=null!=t?this.computeEP(t):0;this.scroller.elementUpdate(e=>{const t=e.dataset.idx,s=this.itemData[parseFloat(t)];s.id===a?e.classList.add("active"):e.classList.remove("active");const o=e.querySelector(".selector-modal-list-item-ep-delta");if(o&&(o.textContent="",null!==s.item)){const e=this.computeEP(s.item);i!==e&&Ue(o,i,e,0)}})}applyFilters(){this.currentFilters=this.player.sim.getFilters();let e=new Array(this.itemData.length);for(let a=0;a<this.itemData.length;++a)e[a]=a;const t=this.player.getEquippedItem(this.slot);this.label===bk.Items?e=this.player.filterItemData(e,e=>this.itemData[e].item,this.slot):this.label===bk.Enchants||this.label===bk.Tinkers?e=this.player.filterEnchantData(e,e=>this.itemData[e].item,this.slot,t):this.label!==bk.Gem1&&this.label!==bk.Gem2&&this.label!==bk.Gem3||(e=this.player.filterGemData(e,e=>this.itemData[e].item,this.slot,this.socketColor)),e=e.filter(e=>{const t=this.itemData[e];if(t.phase>this.player.sim.getPhase())return!1;if(this.searchInput.value.length){const e=e=>e.toLowerCase().replaceAll(/[^a-zA-Z0-9\s]/g,""),a=e(this.searchInput.value).split(" "),i=e(t.name.toString());let s=!0;if(a.some(e=>{i.includes(e)||(s=!1)}),!s)return!1}return!0}),[i.ItemSlotTrinket1,i.ItemSlotTrinket2].includes(this.slot)||this.label===bk.Upgrades?this.sortBy=1:this.sortBy=0,e=this.sortIdxs(e),this.itemsToDisplay=e,this.scroller.update(),this.hideOrShowEPValues()}sort(e){this.sortBy===e?this.sortDirection=1-this.sortDirection:this.sortDirection=Yn.DESC,this.sortBy=e,this.itemsToDisplay=this.sortIdxs(this.itemsToDisplay),this.scroller.update()}sortIdxs(e){let t=(e,t)=>{const a=this.sortDirection===Yn.DESC?t:e,i=this.sortDirection===Yn.DESC?e:t,s=this.computeEP(a)-this.computeEP(i);return Math.abs(s)<.01?(a.scalingOptions?.[x.Base].ilvl||a.ilvl)-(i.scalingOptions?.[x.Base].ilvl||i.ilvl):s};if(1===this.sortBy)t=(e,t)=>{const a=this.sortDirection===Yn.DESC?t:e,i=this.sortDirection===Yn.DESC?e:t;return(a.scalingOptions?.[x.Base].ilvl||a.ilvl)-(i.scalingOptions?.[x.Base].ilvl||i.ilvl)};return e.sort((e,a)=>{const i=this.itemData[e],s=this.itemData[a];return this.isItemFavorited(i)&&!this.isItemFavorited(s)?-1:this.isItemFavorited(s)&&!this.isItemFavorited(i)?1:t(i.item,s.item)})}hideOrShowEPValues(){const e=this.tabContent.querySelectorAll(".ep-label"),t=this.tabContent.querySelectorAll(".selector-modal-list"),a=this.player.sim.getShowEPValues(),i=a?"":"none";for(const s of e)s.style.display=i;for(const s of t)a?s.classList.remove("hide-ep"):s.classList.add("hide-ep")}createItemElem(e){const t=e.data,a=this.computeEP(t.item),s=this.equippedToItemFn(this.gearData.getEquippedItem()),n=null!=s,r=this.getItemIdByItemType(s),l=n?this.computeEP(s):0,c=U(),h=U(),d=U(),u=U(),p=U(),m=U(),g=U(),f=U(),b=H("li",{className:"selector-modal-list-item "+(r===t.id?"active":""),dataset:{idx:e.idx.toString()}},(this.label===bk.Items||this.label===bk.Upgrades)&&H("div",{className:"selector-modal-list-item-ilvl-container"},t.ilvl||t.item.ilvl),H("div",{className:"selector-modal-list-label-cell gap-1",ref:c},H("a",{className:"selector-modal-list-item-link",ref:d,dataset:{whtticon:"false"}},H("img",{className:"selector-modal-list-item-icon",ref:u}),H("label",{className:"selector-modal-list-item-name",ref:h},"string"==typeof t.name?t.name:t.name.cloneNode(!0),t.nameDescription&&nf(t.nameDescription)))),this.label===bk.Items&&H("div",{className:"selector-modal-list-item-source-container"},this.getSourceInfo(t.item,this.player.sim)),![i.ItemSlotTrinket1,i.ItemSlotTrinket2].includes(this.slot)&&H("div",{className:"selector-modal-list-item-ep"},H("span",{className:"selector-modal-list-item-ep-value"},a<9.95?a.toFixed(1).toString():Math.round(a).toString()),H("span",{className:"selector-modal-list-item-ep-delta",ref:e=>n&&l!==a&&Ue(e,l,a,0)})),H("div",{className:"selector-modal-list-item-favorite-container"},H("button",{className:"selector-modal-list-item-favorite btn btn-link p-0",ref:p},H("i",{ref:m,className:"far fa-star fa-xl"}))),H("div",{ref:g,className:"selector-modal-list-item-compare-container hide"},H("button",{className:"selector-modal-list-item-compare btn btn-link p-0",ref:f},H("i",{className:"fas fa-arrow-right-arrow-left fa-xl"})))),y=e=>{const a=this.player.sim.getFilters();let i,s;switch(this.label){case bk.Items:i="favoriteItems",s=t.id;break;case bk.Enchants:case bk.Tinkers:i="favoriteEnchants",s=Qg(t.item);break;case bk.Gem1:case bk.Gem2:case bk.Gem3:i="favoriteGems",s=t.id;break;case bk.RandomSuffixes:i="favoriteRandomSuffixes",s=t.id;break;case bk.Reforging:i="favoriteReforges",s=t.id;break;default:return}if(e)a[i].push(s);else{const e=a[i].indexOf(s);-1!==e&&a[i].splice(e,1)}p.value.classList.toggle("text-brand"),m.value.classList.toggle("fas"),m.value.classList.toggle("far"),b.dataset.fav=e.toString(),this.player.sim.setFilters(te.nextEventID(),a)};p.value.addEventListener("click",()=>y("false"===b.dataset.fav));this.isItemFavorited(t)?(p.value.classList.add("text-brand"),m.value?.classList.add("fas"),b.dataset.fav="true"):(m.value?.classList.add("far"),b.dataset.fav="false");const w=ie(p.value);var v;if(v="true"===b.dataset.fav,w.setContent(v?"Remove from favorites":"Add to favorites"),this.label===bk.Items){const e=ie(f.value);this.bindToggleCompare(g.value);const a=this.simUI instanceof hk?this.simUI:null;if(a){const i=()=>a.bt?.hasItem(o.create({id:t.id})),s=()=>{const t=i();e.setContent(t?"Remove from Batch Sim":"Add to Batch Sim"),f.value.classList[t?"add":"remove"]("text-brand")};s(),a.bt?.itemsChangedEmitter.on(()=>{s()}),f.value.addEventListener("click",()=>{const e=i();a.bt?.[e?"removeItem":"addItem"](o.create({id:t.id})),Km({action:"click",category:"batch",label:e?"remove-item":"add-item"})})}}d.value.addEventListener("click",e=>{if(e.preventDefault(),e.target===p.value)return!1;this.onItemClick(t)}),t.actionId.fill().then(e=>{e.setWowheadHref(d.value),u.value.src=e.iconUrl}),jr(h.value,t.quality);const x=new ef(this.player,{itemId:t.id});return x.hasNotice&&c.value?.appendChild(x.rootElem),b}isItemFavorited(e){return this.label===bk.Items?this.currentFilters.favoriteItems.includes(e.id):this.label===bk.Enchants||this.label===bk.Tinkers?this.currentFilters.favoriteEnchants.includes(Qg(e.item)):this.label.startsWith("Gem")?this.currentFilters.favoriteGems.includes(e.id):this.label===bk.RandomSuffixes?this.currentFilters.favoriteRandomSuffixes.includes(e.id):this.label===bk.Reforging&&this.currentFilters.favoriteReforges.includes(e.id)}getSourceInfo(e,t){const a=(e,t)=>H("a",{href:e,target:"_blank",dataset:{whtticon:"false"}},H("small",null,t));if(!e.sources?.length){if(e.randomSuffixOptions.length)return a(`${Lr.makeItemUrl(e.id)}#dropped-by`,"World Drop");if(qn(e)){const t=Xn(e);return t?a(Lr.makeItemUrl(e.id),H("span",null,t,H("br",null),"PVP")):H(de,null)}return H(de,null)}let i=e.sources[0];if("crafted"===i.source.oneofKind){const t=i.source.crafted;return t.spellId?a(Lr.makeSpellUrl(t.spellId),Kr.get(t.profession)??"Unknown"):a(Lr.makeItemUrl(e.id),Kr.get(t.profession)??"Unknown")}if("drop"===i.source.oneofKind){const s=i.source.drop,o=t.db.getZone(s.zoneId),n=t.db.getNpc(s.npcId);if(!o)return console.error("No zone found for item:",e),H(de,null);const r=s.category?` - ${s.category}`:"";return n?a(Lr.makeNpcUrl(n.id),H("span",null,o.name," (",el.get(s.difficulty)??"Unknown",")",H("br",null),n.name+r)):s.otherName?a(Lr.makeZoneUrl(o.id),H("span",null,o.name,H("br",null),s.otherName)):a(Lr.makeZoneUrl(o.id),o.name)}if("quest"===i.source.oneofKind&&i.source.quest.name){const t=i.source.quest;return a(Lr.makeQuestUrl(t.id),H("span",null,"Quest",e.factionRestriction===mt.ALLIANCE_ONLY&&H("img",{src:"/mop/assets/img/alliance.png",className:"ms-1",width:"15",height:"15"}),e.factionRestriction===mt.HORDE_ONLY&&H("img",{src:"/mop/assets/img/horde.png",className:"ms-1",width:"15",height:"15"}),H("br",null),t.name))}if("rep"===(i=e.sources.find(e=>"rep"===e.source.oneofKind)??i).source.oneofKind){const t=e.sources.filter(e=>"rep"===e.source.oneofKind).map(e=>"rep"===e.source.oneofKind?al[e.source.rep.repFactionId]:al[Z.RepFactionUnknown]),s=i.source.rep,o=il[s.repFactionId];return a(Lr.makeNpcUrl(o),H(de,null,t.map(t=>H("span",null,t,e.factionRestriction===mt.ALLIANCE_ONLY&&H("img",{src:"/mop/assets/img/alliance.png",className:"ms-1",width:"15",height:"15"}),e.factionRestriction===mt.HORDE_ONLY&&H("img",{src:"/mop/assets/img/horde.png",className:"ms-1",width:"15",height:"15"}),H("br",null))),H("span",null,tl[s.repLevel])))}if(qn(e)){const t=Xn(e);return t?a(Lr.makeItemUrl(e.id),H("span",null,t,H("br",null),"PVP")):H(de,null)}if("soldBy"===i.source.oneofKind){const e=i.source.soldBy;return a(Lr.makeNpcUrl(e.npcId),H("span",null,"Sold by",H("br",null),e.npcName))}return H(de,null)}bindToggleCompare(e){e.classList.remove("hide")}}var bk=(e=>(e.Items="Items",e.RandomSuffixes="Random Suffix",e.Enchants="Enchants",e.Tinkers="Tinkers",e.Reforging="Reforging",e.Upgrades="Upgrades",e.Gem1="Gem1",e.Gem2="Gem2",e.Gem3="Gem3",e))(bk||{});function yk(e){switch(e){case"Items":return oe.t("gear_tab.gear_picker.tabs.items");case"Random Suffix":return oe.t("gear_tab.gear_picker.tabs.random_suffix");case"Enchants":return oe.t("gear_tab.gear_picker.tabs.enchants");case"Tinkers":return oe.t("gear_tab.gear_picker.tabs.tinkers");case"Reforging":return oe.t("gear_tab.gear_picker.tabs.reforging");case"Upgrades":return oe.t("gear_tab.gear_picker.tabs.upgrades");case"Gem1":return oe.t("gear_tab.gear_picker.tabs.gem1");case"Gem2":return oe.t("gear_tab.gear_picker.tabs.gem2");case"Gem3":return oe.t("gear_tab.gear_picker.tabs.gem3");default:return e}}class wk extends Wr{constructor(e,t,a,s,o){super(e,"selector-modal",{disposeOnClose:!1,size:"xl"}),this.ilists=[],this.itemSlotTabElems=[],this.currentSlot=i.ItemSlotHead,this.currentTab="Items",this.disabledTabs=[],this.simUI=t,this.player=a,this.gearPicker=s,this.options={id:da(),...o},this.disabledTabs=this.options.disabledTabs||[],this.addItemSlotTabs(),this.header.insertAdjacentElement("afterbegin",H("div",null,H("h6",{className:"selector-modal-title"}),H("ul",{className:"nav nav-tabs selector-modal-tabs"}))),this.body.appendChild(H("div",{className:"tab-content selector-modal-tab-content"})),this.titleElem=this.rootElem.querySelector(".selector-modal-title"),this.tabsElem=this.rootElem.querySelector(".selector-modal-tabs"),this.contentElem=this.rootElem.querySelector(".selector-modal-tab-content"),this.body.appendChild(H("div",{className:"d-flex align-items-center form-text"},H("i",{className:"fas fa-circle-exclamation fa-xl me-2"}),H("span",null,oe.t("gear_tab.gear_picker.missing_gear_message.title"),H("br",null),oe.t("gear_tab.gear_picker.missing_gear_message.description"))))}openTab(e,t,a){this.titleElem.textContent=tt(e)??"",this.setData(e,t,a),this.setActiveItemSlotTab(e),this.open()}onShow(){if(this.gearPicker){const e=this.switchToPreviousItemSlotTab.bind(this),t=this.switchToNextItemSlotTab.bind(this);document.addEventListener("keydown",e),document.addEventListener("keydown",t),this.addOnHideCallback(()=>document.removeEventListener("keydown",e)),this.addOnHideCallback(()=>document.removeEventListener("keydown",t))}}setData(e,t,i){this.tabsElem.innerText="",this.contentElem.innerText="",this.ilists=[];const s=i.getEquippedItem(),o=this.player.getItems(e),n=this.player.getEnchants(e),r=this.player.getTinkers(e),l=!!s?.item&&!!this.player.getAvailableReforgings(s).length,c=!(this.player.getChallengeModeEnabled()||!s?.item)&&s.hasUpgradeOptions();("Enchants"===t&&!n.length||"Reforging"===t&&!l||"Upgrades"===t&&!c||["Gem1","Gem2","Gem3"].includes(t)&&0===s?.numSockets(this.player.isBlacksmithing()))&&(t="Items"),this.currentTab=t,this.currentSlot=e;!this.disabledTabs?.includes("Items")&&this.addTab({id:Wo(`${this.options.id}-Items`),label:"Items",gearData:i,itemData:o.map(e=>{const t=new Ir({item:e,challengeMode:this.player.getChallengeModeEnabled()});return{item:e,id:e.id,actionId:t.asActionId(),ilvl:e.scalingOptions?.[x.Base].ilvl||e.ilvl,name:e.name,quality:e.quality,nameDescription:e.nameDescription,phase:e.phase,ignoreEPFilter:!1,onEquip:(e,t)=>{const a=i.getEquippedItem();a?i.equipItem(e,a.withItem(t)):i.equipItem(e,new Ir({item:t,challengeMode:this.player.getChallengeModeEnabled()}))}}}),computeEP:t=>this.player.computeItemEP(t,e),equippedToItemFn:e=>e?.item,onRemove:e=>{i.equipItem(e,null),this.removeTabs("Enchants"),this.removeTabs("Random Suffix"),this.removeTabs("Reforging"),this.removeTabs("Upgrades"),this.removeTabs("Gem")}});!this.disabledTabs?.includes("Enchants")&&this.addTab({id:Wo(`${this.options.id}-Enchants`),label:"Enchants",gearData:i,itemData:n.sort((e,t)=>e.effectId>t.effectId?-1:e.effectId<t.effectId?1:0).map(e=>({item:e,id:e.effectId,actionId:e.itemId?Lr.fromItemId(e.itemId):Lr.fromSpellId(e.spellId),name:e.name,quality:e.quality,phase:e.phase||1,ignoreEPFilter:!0,nameDescription:"",onEquip:(e,t)=>{const a=i.getEquippedItem();a&&i.equipItem(e,a.withEnchant(t))}})),computeEP:e=>this.player.computeEnchantEP(e),equippedToItemFn:e=>e?.enchant,onRemove:e=>{const t=i.getEquippedItem();t&&i.equipItem(e,t.withEnchant(null))}});!this.disabledTabs?.includes("Tinkers")&&this.player.hasProfession(a.Engineering)&&this.addTab({id:Wo(`${this.options.id}-Tinkers`),label:"Tinkers",gearData:i,itemData:r.sort((e,t)=>e.effectId>t.effectId?-1:e.effectId<t.effectId?1:0).map(e=>({item:e,id:e.effectId,actionId:e.itemId?Lr.fromItemId(e.itemId):Lr.fromSpellId(e.spellId),name:e.name,quality:e.quality,phase:e.phase||1,ignoreEPFilter:!0,nameDescription:"",onEquip:(e,t)=>{const a=i.getEquippedItem();a&&i.equipItem(e,a.withTinker(t))}})),computeEP:e=>this.player.computeEnchantEP(e),equippedToItemFn:e=>e?.tinker,onRemove:e=>{const t=i.getEquippedItem();t&&i.equipItem(e,t.withTinker(null))}});!this.disabledTabs?.includes("Random Suffix")&&this.addRandomSuffixTab(s,i);!this.disabledTabs?.includes("Upgrades")&&this.addUpgradesTab(s,i);!this.disabledTabs?.includes("Reforging")&&this.addReforgingTab(s,i);!["Gem1","Gem2","Gem3"].some(e=>this.disabledTabs?.includes(e))&&this.addGemTabs(e,s,i),this.ilists.find(e=>t===e.label)?.sizeRefresh()}addItemSlotTabs(){this.gearPicker&&this.dialog.prepend(H("div",{className:"gear-picker-modal-slots"},this.gearPicker.itemPickers.map(e=>{const t=U(),a=H("div",{className:"item-picker-icon-wrapper",dataset:{slot:e.slot}},H("a",{ref:t,className:"item-picker-icon",href:"javascript:void(0)",onclick:t=>{t.preventDefault(),e.slot!=this.currentSlot&&e.openSelectorModal(this.currentTab)},dataset:{whtticon:"false"}})),i=()=>{e.item?(this.player.setWowheadData(e.item,t.value),e.item.asActionId().fill().then(e=>{e.setBackgroundAndHref(t.value)})):t.value.style.backgroundImage=`url('${of(e.slot)}')`};return i(),e.onUpdate(()=>i()),ie(t.value,{content:`Edit ${tt(e.slot)}`,placement:"left"}),this.itemSlotTabElems.push(a),a})))}setActiveItemSlotTab(e){this.itemSlotTabElems.forEach(t=>{t.dataset.slot===e.toString()?t.classList.add("active"):t.classList.contains("active")&&t.classList.remove("active")})}switchToPreviousItemSlotTab(e){if("ArrowUp"===e.key&&this.gearPicker){e.preventDefault();const t=$n(this.currentSlot-1,Object.keys(i).length/2);this.gearPicker.itemPickers[t].openSelectorModal(this.currentTab)}}switchToNextItemSlotTab(e){if("ArrowDown"===e.key&&this.gearPicker){e.preventDefault();const t=$n(this.currentSlot+1,Object.keys(i).length/2);this.gearPicker.itemPickers[t].openSelectorModal(this.currentTab)}}addGemTabs(e,t,a){if(!t)return;const i=this.player.computeStatsEP(new n(t.item.socketBonus))/(t.item.gemSockets.length||1);t.curSocketColors(this.player.isBlacksmithing()).forEach((e,t)=>{const s=bk[`Gem${t+1}`];this.addTab({id:Wo(`${this.options.id}-${s}`),label:s,gearData:a,itemData:this.player.getGems(e).map(e=>({item:e,id:e.id,actionId:Lr.fromItemId(e.id),name:e.name,quality:e.quality,phase:e.phase,nameDescription:"",ignoreEPFilter:!0,onEquip:(e,i)=>{const s=a.getEquippedItem();s&&a.equipItem(e,s.withGem(i,t))}})),computeEP:t=>{let a=this.player.computeGemEP(t);return rr(t,e)&&(a+=i),a},equippedToItemFn:e=>e?.gems[t],onRemove:e=>{const i=a.getEquippedItem();i&&a.equipItem(e,i.withGem(null,t))},setTabContent:i=>{const s=rf(e,null,t);i.appendChild(s),i.classList.add("selector-modal-tab-gem");const o=i.querySelector(".gem-icon"),n=fr(e),r=()=>{const e=a.getEquippedItem(),i=e?.gems[t];i?(o.classList.remove("hide"),Lr.fromItemId(i.id).fill().then(e=>{o.setAttribute("src",e.iconUrl)})):(o.classList.add("hide"),o.setAttribute("src",n))};a.changeEvent.on(r),this.addOnDisposeCallback(()=>a.changeEvent.off(r)),r()},socketColor:e})})}addRandomSuffixTab(e,t){if(!e||!e.item.randomSuffixOptions.length)return;const a=e.item;this.addTab({id:Wo(`${this.options.id}-Random Suffix`),label:"Random Suffix",gearData:t,itemData:this.player.getRandomSuffixes(a).map(e=>({item:e,id:e.id,actionId:Lr.fromRandomSuffix(a,e),name:ct(e.name),quality:a.quality,phase:a.phase,nameDescription:"",ignoreEPFilter:!0,onEquip:(e,a)=>{const i=t.getEquippedItem();i&&t.equipItem(e,i.withItem(i.item).withRandomSuffix(a))}})),computeEP:e=>this.player.computeRandomSuffixEP(e),equippedToItemFn:e=>e?.randomSuffix,onRemove:e=>{const a=t.getEquippedItem();a&&t.equipItem(e,a.withItem(a.item).withRandomSuffix(null)),this.removeTabs("Reforging"),this.removeTabs("Upgrades")}})}addReforgingTab(e,t){if(!e||e.hasRandomSuffixOptions()&&!e.randomSuffix)return;const a=e.item;this.addTab({id:Wo(`${this.options.id}-Reforging`),label:"Reforging",gearData:t,itemData:this.player.getAvailableReforgings(e).map(e=>({item:e,id:e.id,actionId:Lr.fromReforge(a,e.reforge),name:H("div",null,H("span",{className:"reforge-value negative"},e.fromAmount," ",ot(e.fromStat)),H("span",{className:"reforge-value positive"},"+",e.toAmount," ",ot(e.toStat))),quality:W.ItemQualityCommon,phase:a.phase,nameDescription:"",ignoreEPFilter:!0,onEquip:(e,a)=>{const i=t.getEquippedItem();i&&t.equipItem(e,i.withReforge(a.reforge))}})),computeEP:e=>this.player.computeReforgingEP(e),equippedToItemFn:e=>e?.getReforgeData()||null,onRemove:e=>{const a=t.getEquippedItem();a&&t.equipItem(e,a.withItem(a.item).withRandomSuffix(a._randomSuffix))}})}addUpgradesTab(e,t){if(!e||!e.hasUpgradeOptions()||e.hasRandomSuffixOptions()&&!e.randomSuffix)return;const a=e.item,i=e.getUpgrades(),s=Object.entries(i),o=s.length-1;this.addTab({id:Wo(`${this.options.id}-Upgrades`),label:"Upgrades",gearData:t,itemData:s.map(([i,s],n)=>{const r=Number(i),l=e.withUpgrade(r);return{item:Number(r),id:Number(r),actionId:Lr.fromItemId(a.id,0,e._randomSuffix?.id,0,r),name:H(de,null,n>0?H(de,null,"+ ",l.ilvlFromPrevious*n):H(de,null,"Base")," ",H("div",{className:"selector-modal-list-item-upgrade-step-container ms-2"},`(${r}/${o})`)),ilvl:s.ilvl,quality:W.ItemQualityCommon,phase:a.phase,nameDescription:"",ignoreEPFilter:!0,onEquip:(e,a)=>{const i=t.getEquippedItem();i&&t.equipItem(e,i.withUpgrade(a))}}}),computeEP:t=>this.player.computeUpgradeEP(e,t,this.currentSlot),equippedToItemFn:e=>e?._upgrade,onRemove:e=>{const a=t.getEquippedItem();a&&t.equipItem(e,a.withUpgrade(x.Base))}})}addTab({id:e,label:a,gearData:i,itemData:s,computeEP:o,equippedToItemFn:n,onRemove:r,setTabContent:l,socketColor:c}){if(!s.length)return;const h=a===this.currentTab,d=U();this.tabsElem.appendChild(H("li",{className:"nav-item"},H("button",{ref:d,className:xr("nav-link selector-modal-item-tab",h&&"active"),dataset:{label:a,bsToggle:"tab",bsTarget:`#${e}`},attributes:{role:"tab","aria-selected":h}}))),l?l(d.value):d.value.textContent=yk(a);const u=new fk(e,this.contentElem,this.simUI,this.currentSlot,this.currentTab,this.player,a,i,s,c||t.GemColorUnknown,o,n,r,e=>{const t=i.getEquippedItem(),a=e;e.onEquip(te.nextEventID(),a.item);const s=f.is(a.item),o=i.getEquippedItem()||null,n=t?._randomSuffix?.id!==o?.randomSuffix?.id,r=t?.id===o?.id&&t?.upgrade!==o?.upgrade;(s||n||r)&&(n||(this.removeTabs("Random Suffix"),this.addRandomSuffixTab(o,i)),r||(this.removeTabs("Upgrades"),this.addUpgradesTab(o,i)),this.removeTabs("Reforging"),this.addReforgingTab(o,i),this.removeTabs("Gem"),this.addGemTabs(this.currentSlot,o,i))}),p=()=>{u.updateSelected()},m=()=>{u.applyFilters()},g=()=>{u.hideOrShowEPValues()};i.changeEvent.on(p),this.player.sim.phaseChangeEmitter.on(m),this.player.sim.filtersChangeEmitter.on(m),this.player.sim.showEPValuesChangeEmitter.on(g),this.addOnDisposeCallback(()=>{i.changeEvent.off(p),this.player.sim.phaseChangeEmitter.off(m),this.player.sim.filtersChangeEmitter.off(m),this.player.sim.showEPValuesChangeEmitter.off(g),u.dispose()}),d.value.addEventListener("click",e=>{this.currentTab=a}),d.value.addEventListener("shown.bs.tab",e=>{u.sizeRefresh()}),this.ilists.push(u)}removeTabs(e){const t=[...this.tabsElem.querySelectorAll(".selector-modal-item-tab")].filter(t=>t.dataset?.label?.includes(e)),a=t.map(e=>document.querySelector(e.dataset.bsTarget)).filter(e=>Boolean(e));t.forEach(e=>e.parentElement?.remove()),a.forEach(e=>e.remove())}}class vk extends F{constructor(e,t,a,i){super(e,"icon-picker-root"),this.rootElem.classList.add("icon-picker"),this.player=a,this.slot=i;const s=U(),o=U();this.rootElem.prepend(H("a",{ref:s,className:"icon-picker-button",href:"#",attributes:{role:"button"}},H("div",{ref:o,className:"item-picker-sockets-container"}))),this.iconAnchor=s.value,this.socketsContainerElem=o.value;const n=new wk(t.rootElem,t,this.player);a.sim.waitForInit().then(()=>{this.iconAnchor.addEventListener("click",e=>{e.preventDefault(),n.openTab(this.slot,bk.Items,this.createGearData())})}),a.itemSwapSettings.changeEmitter.on(()=>{this.update(a.itemSwapSettings.getGear().getEquippedItem(i))})}update(e){this.iconAnchor.style.backgroundImage=`url('${of(this.slot)}')`,this.iconAnchor.removeAttribute("data-wowhead"),this.iconAnchor.href="#",e?(e.asActionId().fillAndSet(this.iconAnchor,!0,!0),this.player.setWowheadData(e,this.iconAnchor),this.socketsContainerElem.replaceChildren(H(de,null,e.allSocketColors().map((t,a)=>{const i=rf(t,e.gems[a],a);if(a===e.numPossibleSockets-1&&e.couldHaveExtraSocket()){const e=()=>{i.classList[this.player.isBlacksmithing()?"remove":"add"]("hide")};this.player.professionChangeEmitter.on(e),e()}return i}))),this.iconAnchor.classList.add("active")):(this.socketsContainerElem.replaceChildren(),this.iconAnchor.classList.remove("active"))}createGearData(){return{equipItem:(e,t)=>{this.player.itemSwapSettings.equipItem(e,this.slot,t)},getEquippedItem:()=>this.player.itemSwapSettings.getItem(this.slot),changeEvent:this.player.itemSwapSettings.changeEmitter}}}class xk{constructor(e){this.changeEmitter=new te("PlayerItemSwap"),this.enableItemSwap=!1,this.gear=new wr({}),this.bonusStats=new n,this.player=e}setItemSwapSettings(e,t,a,i){this.enableItemSwap=t,this.gear=a,this.bonusStats=i||new n,this.changeEmitter.emit(e)}setBonusStats(e,t){this.bonusStats=t,this.changeEmitter.emit(e)}getBonusStats(){return this.bonusStats}getEnableItemSwap(){return this.enableItemSwap}setEnableItemSwap(e,t){t!=this.enableItemSwap&&(this.enableItemSwap=t,this.changeEmitter.emit(e))}equipItem(e,t,a){this.setGear(e,this.gear.withEquippedItem(t,a,this.player.canDualWield2H()))}getItem(e){return this.gear.getEquippedItem(e)}getGear(){return this.gear}setGear(e,t){t.equals(this.gear)||(this.gear=t,this.changeEmitter.emit(e))}toProto(){return zo.create({prepullBonusStats:this.bonusStats.toProto(),items:this.gear.asArray().map(e=>e?e.asSpec():o.create())})}}class Sk extends F{constructor(e,t,a,i){super(e,"item-swap-picker-root"),this.itemSlots=i.itemSlots,new gc(this.rootElem,a,{id:"enable-item-swap",reverse:!0,label:oe.t("settings_tab.other.enable_item_swap.label"),labelTooltip:oe.t("settings_tab.other.enable_item_swap.tooltip"),extraCssClasses:["input-inline"],getValue:e=>e.itemSwapSettings.getEnableItemSwap(),setValue(e,t,a){t.itemSwapSettings.setEnableItemSwap(e,a)},changedEvent:e=>e.itemSwapSettings.changeEmitter});const s=U(),o=U(),n=U(),r=nl.newGroupContainer("icon-group");this.rootElem.appendChild(H(de,null,H("div",{ref:s,className:"input-root input-inline input-item-swap-container"},H("label",{className:"form-label"},oe.t("settings_tab.other.item_swap.label")),H("button",{ref:o,className:"gear-swap-icon"},H("i",{className:"fas fa-arrows-rotate me-1"})),r),i.note&&H("p",{ref:n,className:"form-text"},i.note)));const l=()=>{a.itemSwapSettings.getEnableItemSwap()?(s.value?.classList.remove("hide"),n.value?.classList.remove("hide")):(s.value?.classList.add("hide"),n.value?.classList.add("hide"))};a.itemSwapSettings.changeEmitter.on(l),l(),o.value&&(o.value.addEventListener("click",e=>this.swapWithGear(te.nextEventID(),a)),ie(o.value,{content:oe.t("settings_tab.other.item_swap.tooltip")}));const c=H(de,null);this.itemSlots.forEach(e=>{new vk(c,t,a,e)}),r.appendChild(c)}swapWithGear(e,t){let a=t.getGear(),i=t.itemSwapSettings.getGear();this.itemSlots.forEach(e=>{const s=t.getGear().getEquippedItem(e),o=t.itemSwapSettings.getGear().getEquippedItem(e);a=a.withEquippedItem(e,o,t.canDualWield2H()),i=i.withEquippedItem(e,s,t.canDualWield2H())}),te.freezeAllAndDo(()=>{t.setGear(e,a),t.itemSwapSettings.setGear(e,i)})}}class _k{constructor(){this.name="",this.auras=[],this.spells=[]}getName(){return this.name}getAuras(){return this.auras.slice()}getSpells(){return this.spells.slice()}async update(e){let t=e.spells.map(e=>({data:e,id:Lr.fromProto(e.id)})),a=e.auras.map(e=>({data:e,id:Lr.fromProto(e.id)}));await Promise.all([...t,...a].map(e=>e.id.fill().then(t=>e.id=t))),t=t.sort((e,t)=>pe(e.id.name,t.id.name)),a=a.sort((e,t)=>pe(e.id.name,t.id.name));let i=!1;return e.name!=this.name&&(this.name=e.name,i=!0),(t.length!=this.spells.length||t.some((e,t)=>!e.id.equals(this.spells[t].id)))&&(this.spells=t,i=!0),(a.length!=this.auras.length||a.some((e,t)=>!e.id.equals(this.auras[t].id)))&&(this.auras=a,i=!0),i}}class kk{constructor(){this.metadatas=[]}async update(e){const t=this.metadatas.length;if(e.length>t)for(let i=t;i<e.length;i++)this.metadatas.push(new _k);else e.length<t&&(this.metadatas=this.metadatas.slice(0,e.length));const a=await Promise.all(e.map((e,t)=>this.metadatas[t].update(e)));return t!=this.metadatas.length||a.some(e=>e)}asList(){return this.metadatas.slice()}}const Ck={};function Ik(e){const t=Ck[e];if(t.secondaryResource=dl.create(e),!t)throw new Error("No config registered for Spec: "+e);return t}const Ek=class e{constructor(t,a){this.name="",this.buffs=Oo.create(),this.consumables=Go.create(),this.bonusStats=new n,this.gear=new yr({}),this.profession1=0,this.profession2=0,this.aplRotation=fo.create(),this.talentsString="",this.glyphs=Vt.create(),this.reactionTime=0,this.channelClipDelay=0,this.inFrontOfTarget=!1,this.distanceFromTarget=0,this.healingModel=Fo.create(),this.healingEnabled=!1,this.challengeModeEnabled=!1,this.autoRotationGenerator=null,this.simpleRotationGenerator=null,this.itemEPCache=new Array,this.gemEPCache=new Map,this.randomSuffixEPCache=new Map,this.enchantEPCache=new Map,this.upgradeEPCache=new Map,this.talents=null,this.epRatios=new Array(e.numEpRatios).fill(0),this.epWeights=new n,this.currentStats=Zn.create(),this.metadata=new _k,this.petMetadatas=new kk,this.nameChangeEmitter=new te("PlayerName"),this.buffsChangeEmitter=new te("PlayerBuffs"),this.consumesChangeEmitter=new te("PlayerConsumes"),this.bonusStatsChangeEmitter=new te("PlayerBonusStats"),this.gearChangeEmitter=new te("PlayerGear"),this.professionChangeEmitter=new te("PlayerProfession"),this.raceChangeEmitter=new te("PlayerRace"),this.rotationChangeEmitter=new te("PlayerRotation"),this.talentsChangeEmitter=new te("PlayerTalents"),this.glyphsChangeEmitter=new te("PlayerGlyphs"),this.specOptionsChangeEmitter=new te("PlayerSpecOptions"),this.inFrontOfTargetChangeEmitter=new te("PlayerInFrontOfTarget"),this.distanceFromTargetChangeEmitter=new te("PlayerDistanceFromTarget"),this.healingModelChangeEmitter=new te("PlayerHealingModel"),this.epWeightsChangeEmitter=new te("PlayerEpWeights"),this.miscOptionsChangeEmitter=new te("PlayerMiscOptions"),this.challengeModeChangeEmitter=new te("ChallengeMode"),this.currentStatsEmitter=new te("PlayerCurrentStats"),this.epRatiosChangeEmitter=new te("PlayerEpRatios"),this.epRefStatChangeEmitter=new te("PlayerEpRefStat"),this.sim=a,this.party=null,this.raid=null,this.playerSpec=t,this.playerClass=_e.getPlayerClass(t),this.race=this.playerClass.races[0],this.specTypeFunctions=Wt[this.getSpec()],this.specOptions=this.specTypeFunctions.optionsCreate(),this.specConfig=Ik(this.getSpec()),this.secondaryResource=this.specConfig.secondaryResource,this.autoRotationGenerator=this.specConfig.autoRotation,this.specConfig.simpleRotation?this.simpleRotationGenerator=this.specConfig.simpleRotation:this.simpleRotationGenerator=null,this.hiddenMCDs=this.specConfig.hiddenMCDs||new Array;for(let e=0;e<i.ItemSlotOffHand+1;++e)this.itemEPCache[e]=new Map;this.itemSwapSettings=new xk(this),this.bindChallengeModeChange(),this.changeEmitter=te.onAny([this.nameChangeEmitter,this.buffsChangeEmitter,this.consumesChangeEmitter,this.bonusStatsChangeEmitter,this.gearChangeEmitter,this.professionChangeEmitter,this.raceChangeEmitter,this.rotationChangeEmitter,this.talentsChangeEmitter,this.glyphsChangeEmitter,this.specOptionsChangeEmitter,this.miscOptionsChangeEmitter,this.inFrontOfTargetChangeEmitter,this.distanceFromTargetChangeEmitter,this.healingModelChangeEmitter,this.epWeightsChangeEmitter,this.epRatiosChangeEmitter,this.epRefStatChangeEmitter,this.challengeModeChangeEmitter],"PlayerChange")}bindChallengeModeChange(){this.challengeModeChangeEmitter.on(()=>{this.setGear(te.nextEventID(),this.gear,!0)})}getSpecIcon(){return this.playerSpec.getIcon("medium")}getPlayerSpec(){return this.playerSpec}getSpec(){return this.getPlayerSpec().specID}getPlayerClass(){return this.playerClass}getClass(){return this.playerSpec.classID}getClassColor(){return this.playerClass.hexColor}canEnableTargetDummies(){return[q.ClassDruid,q.ClassPaladin,q.ClassPriest,q.ClassShaman,q.ClassMonk].includes(this.getClass())}shouldEnableTargetDummies(){if(this.getPlayerSpec().isHealingSpec||this.getPlayerSpec().isTankSpec)return!0;if(!this.itemSwapSettings.getEnableItemSwap())return!1;return this.itemSwapSettings.getGear().hasTrinketFromOptions([72898,77969,77204,77989])}isSpec(e){return this.getSpec()==e}isClass(e){return this.getClass()==e}getParty(){return this.party}getRaid(){return this.raid}getPartyIndex(){if(null==this.party)throw new Error("Can't get party index for player without a party!");return this.party.getPlayers().indexOf(this)}getRaidIndex(){if(null==this.party)throw new Error("Can't get raid index for player without a party!");return 5*this.party.getIndex()+this.getPartyIndex()}setParty(e){null==e?(this.party=null,this.raid=null):(this.party=e,this.raid=e.raid)}getOtherPartyMembers(){return null==this.party?[]:this.party.getPlayers().filter(e=>null!=e&&e!=this)}getItems(e){return this.sim.db.getItems(e).filter(t=>pt(t,this.playerSpec,e))}getRandomSuffixes(e){return e.randomSuffixOptions.map(e=>this.sim.db.getRandomSuffixById(e)).filter(e=>!!e&&this.computeRandomSuffixEP(e)>0)}getAvailableReforgings(e){return this.sim.db.getAvailableReforges(e.item).map(t=>e.getReforgeData(t))}getReforge(e){return this.sim.db.getReforgeById(e)}getEnchants(e){return this.sim.db.getEnchants(e).filter(e=>Kn(e,this.playerSpec))}getTinkers(e){return this.sim.db.getEnchants(e).filter(e=>e.requiredProfession==a.Engineering)}getGems(e){return this.sim.db.getGems(e)}getEpWeights(){return this.epWeights}setEpWeights(e,t){this.epWeights=t,this.epWeightsChangeEmitter.emit(e),this.gemEPCache=new Map,this.enchantEPCache=new Map,this.randomSuffixEPCache=new Map,this.upgradeEPCache=new Map;for(let a=0;a<i.ItemSlotOffHand+1;++a)this.itemEPCache[a]=new Map}getDefaultEpRatios(t,a){const i=new Array(e.numEpRatios).fill(0);return a?i[1]=1:t?(i[2]=1,i[3]=1,this.getSpec()==K.SpecBloodDeathKnight&&(i[1]=1)):i[0]=1,i}getEpRatios(){return this.epRatios.slice()}setEpRatios(e,t){this.epRatios=t,this.epRatiosChangeEmitter.emit(e)}hasCustomEPWeights(){return!this.getSpecConfig().presets.epWeights.some(e=>e.epWeights.equals(this.epWeights))}async computeStatWeights(e,t,a,i,s){try{const e=await this.sim.statWeights(this,t,a,i,s);return e.error?(e.error.type==En.ErrorOutcomeAborted&&new Dg({variant:"info",body:"Statweight sim cancelled."}),null):e}catch(o){return console.error(o),new Dg({variant:"error",body:o?.message||"Something went wrong calculating your stat weights. Reload the page and try again."}),null}}getCurrentStats(){return Zn.clone(this.currentStats)}setCurrentStats(e,t){this.currentStats=t,this.currentStatsEmitter.emit(e)}getMetadata(){return this.metadata}getPetMetadatas(){return this.petMetadatas}async updateMetadata(){const e=this.metadata.update(this.currentStats.metadata),t=this.petMetadatas.update(this.currentStats.pets.map(e=>e.metadata)),a=await e,i=await t;return a||i}getName(){return this.name}setName(e,t){t!=this.name&&(this.name=t,this.nameChangeEmitter.emit(e))}getLabel(){return this.party?`${this.name} (#${this.getRaidIndex()+1})`:this.name}getRace(){return this.race}setRace(e,t){t!=this.race&&(this.race=t,this.raceChangeEmitter.emit(e))}getProfession1(){return this.profession1}setProfession1(e,t){t!=this.profession1&&(this.profession1=t,this.professionChangeEmitter.emit(e))}getProfession2(){return this.profession2}setProfession2(e,t){t!=this.profession2&&(this.profession2=t,this.professionChangeEmitter.emit(e))}getProfessions(){return[this.profession1,this.profession2].filter(e=>e!=a.ProfessionUnknown)}setProfessions(e,t){te.freezeAllAndDo(()=>{this.setProfession1(e,t[0]||a.ProfessionUnknown),this.setProfession2(e,t[1]||a.ProfessionUnknown)})}hasProfession(e){return this.getProfessions().includes(e)}isBlacksmithing(){return this.hasProfession(a.Blacksmithing)}getFaction(){return Jn[this.getRace()]}getBuffs(){return Oo.clone(this.buffs)}setBuffs(e,t){Oo.equals(this.buffs,t)||(this.buffs=Oo.clone(t),this.buffsChangeEmitter.emit(e))}getConsumes(){return Go.clone(this.consumables)}setConsumes(e,t){Go.equals(this.consumables,t)||(this.consumables=Go.clone(t),this.consumesChangeEmitter.emit(e))}canDualWield2H(){return this.getSpec()==K.SpecFuryWarrior}equipItem(e,t,a){this.setGear(e,this.gear.withEquippedItem(t,a,this.canDualWield2H()))}getEquippedItem(e){return this.gear.getEquippedItem(e)}getEquippedItems(){return this.gear.getEquippedItems()}getGear(){return this.gear}setGear(e,t,a){t.equals(this.gear)&&!a||(this.gear=t.withChallengeMode(this.challengeModeEnabled),this.gearChangeEmitter.emit(e))}async setGearAsync(e,t,a){if(t.equals(this.gear)&&!a)return;const i=new Promise(e=>this.currentStatsEmitter.once(()=>e()));this.setGear(e,t),await i}getBonusStats(){return this.bonusStats}setBonusStats(e,t){t.equals(this.bonusStats)||(this.bonusStats=t,this.bonusStatsChangeEmitter.emit(e))}getMeleeCritCapInfo(){const e=this.currentStats.finalStats?.pseudoStats[T.PseudoStatPhysicalCritPercent]||0,t=this.currentStats.finalStats?.pseudoStats[T.PseudoStatPhysicalHitPercent]||0,a=(this.currentStats.finalStats?.stats[ee.StatExpertiseRating]||0)/he/4,s=void 0!==this.getGear().getEquippedItem(i.ItemSlotOffHand)?.item.weaponSpeed,o=s&&this.getClass()!=q.ClassWarrior?27:8,n=this.getInFrontOfTarget()?14:0,r=6.5+n,l=Math.max(o-t,0),c=Math.max(6.5-a,0)+Math.max(n-a,0),h=80.8-l-c-0;return{meleeCrit:e,meleeHit:t,expertise:a,suppression:4.8,glancing:24,hasOffhandWeapon:s,meleeHitCap:o,expertiseCap:r,remainingMeleeHitCap:l,remainingExpertiseCap:c,baseCritCap:h,specSpecificOffset:0,playerCritCapDelta:e-h}}getMeleeCritCap(){return this.getMeleeCritCapInfo().playerCritCapDelta}setAplRotation(e,t){fo.equals(t,this.aplRotation)||(this.aplRotation=fo.clone(t),this.rotationChangeEmitter.emit(e))}getSimpleRotation(){const e=this.aplRotation.simple?.specRotationJson||"";if(!e)return this.specTypeFunctions.rotationCreate();try{const t=JSON.parse(e);return this.specTypeFunctions.rotationFromJson(t)}catch(t){return console.warn(`Error parsing rotation spec options: ${t}\n\nSpec options: '${e}'`),this.specTypeFunctions.rotationCreate()}}setSimpleRotation(e,t){this.specTypeFunctions.rotationEquals(t,this.getSimpleRotation())||(this.aplRotation.simple||(this.aplRotation.simple=Qn.create()),this.aplRotation.simple.specRotationJson=JSON.stringify(this.specTypeFunctions.rotationToJson(t)),this.rotationChangeEmitter.emit(e))}getSimpleCooldowns(){return zn.clone(this.aplRotation.simple?.cooldowns||zn.create())}setSimpleCooldowns(e,t){zn.equals(this.getSimpleCooldowns(),t)||(this.aplRotation.simple||(this.aplRotation.simple=Qn.create()),this.aplRotation.simple.cooldowns=t,this.rotationChangeEmitter.emit(e))}getRotationType(){return this.aplRotation.type==uo.TypeUnknown?uo.TypeAPL:this.aplRotation.type}hasSimpleRotationGenerator(){return null!=this.simpleRotationGenerator}getResolvedAplRotation(e){const t=this.getRotationType();if(t==uo.TypeAuto&&this.autoRotationGenerator){const e=fo.clone(this.autoRotationGenerator(this));return e.type=uo.TypeAuto,e}if(t==uo.TypeSimple&&this.simpleRotationGenerator){const e=this.getSimpleRotation(),t=fo.clone(this.simpleRotationGenerator(this,e,this.getSimpleCooldowns()));return t.simple=this.aplRotation.simple,t.type=uo.TypeSimple,t}return e?this.aplRotation:po(this.aplRotation,["uuid"])}getTalents(){return null==this.talents&&(this.talents=eb(this.playerSpec,this.talentsString)),this.talents}getTalentsString(){return this.talentsString}setTalentsString(e,t){t!=this.talentsString&&(this.talentsString=t,this.talents=null,this.talentsChangeEmitter.emit(e))}getTalentTreePoints(){return er(this.getTalentsString())}getTalentTreeIcon(){return this.playerSpec.getIcon("medium")}getGlyphs(){return Vt.clone(this.glyphs)}setGlyphs(e,t){Vt.equals(this.glyphs,t)||(this.glyphs=Vt.clone(t),this.glyphsChangeEmitter.emit(e))}getMajorGlyphs(){return[this.glyphs.major1,this.glyphs.major2,this.glyphs.major3].filter(e=>0!=e)}getMinorGlyphs(){return[this.glyphs.minor1,this.glyphs.minor2,this.glyphs.minor3].filter(e=>0!=e)}getAllGlyphs(){return this.getMajorGlyphs().concat(this.getMinorGlyphs())}getClassOptions(){return this.getSpecOptions().classOptions}setClassOptions(e,t){const a=this.getSpecOptions();a.classOptions=t,this.specTypeFunctions.optionsEquals(a,this.specOptions)||(this.specOptions=this.specTypeFunctions.optionsCopy(a),this.specOptionsChangeEmitter.emit(e))}getSpecOptions(){return this.specTypeFunctions.optionsCopy(this.specOptions)}setSpecOptions(e,t){this.specTypeFunctions.optionsEquals(t,this.specOptions)||(this.specOptions=this.specTypeFunctions.optionsCopy(t),this.specOptionsChangeEmitter.emit(e))}getReactionTime(){return this.reactionTime}setReactionTime(e,t){t!=this.reactionTime&&(this.reactionTime=t,this.miscOptionsChangeEmitter.emit(e))}getChannelClipDelay(){return this.channelClipDelay}setChannelClipDelay(e,t){t!=this.channelClipDelay&&(this.channelClipDelay=t,this.miscOptionsChangeEmitter.emit(e))}getChallengeModeEnabled(){return this.challengeModeEnabled}setChallengeModeEnabled(e,t){t!==this.challengeModeEnabled&&(this.challengeModeEnabled=t,this.challengeModeChangeEmitter.emit(e))}getInFrontOfTarget(){return this.inFrontOfTarget}setInFrontOfTarget(e,t){t!=this.inFrontOfTarget&&(this.inFrontOfTarget=t,this.inFrontOfTargetChangeEmitter.emit(e))}getDistanceFromTarget(){return this.distanceFromTarget}setDistanceFromTarget(e,t){t!=this.distanceFromTarget&&(this.distanceFromTarget=t,this.distanceFromTargetChangeEmitter.emit(e))}setDefaultHealingParams(e){const t=this.sim.encounter.primaryTarget,a=t.dualWield;if(0==e.cadenceSeconds){let i=1.5*t.swingSpeed;a&&(i/=2),e.cadenceSeconds=.4,e.cadenceVariation=i-e.cadenceSeconds}0==e.hps&&(e.hps=.25*t.minBaseDamage/t.swingSpeed,a&&(e.hps*=1.5))}enableHealing(){this.healingEnabled=!0;const e=this.getHealingModel();0!=e.cadenceSeconds&&0!=e.hps||(this.setDefaultHealingParams(e),this.setHealingModel(0,e))}getHealingModel(){return Fo.clone(this.healingModel)}setHealingModel(e,t){Fo.equals(this.healingModel,t)||(this.healingModel=Fo.clone(t),this.healingEnabled&&this.setDefaultHealingParams(this.healingModel),this.healingModelChangeEmitter.emit(e))}computeStatsEP(e){return null==e?0:e.computeEP(this.epWeights)}computeGemEP(e){if(this.gemEPCache.has(e.id))return this.gemEPCache.get(e.id);const t=this.computeStatsEP(new n(e.stats)),a=tr(this.playerSpec,e,n.fromProto(this.currentStats.finalStats));let i=0;e.unique&&(i-=.01);const s=t+a+i;return this.gemEPCache.set(e.id,s),s}computeEnchantEP(e){if(this.enchantEPCache.has(e.effectId))return this.enchantEPCache.get(e.effectId);const t=this.computeStatsEP(new n(e.stats));return this.enchantEPCache.set(e.effectId,t),t}computeRandomSuffixEP(e){if(this.randomSuffixEPCache.has(e.id))return this.randomSuffixEPCache.get(e.id);const t=this.computeStatsEP(new n(e.stats));return this.randomSuffixEPCache.set(e.id,t),t}computeReforgingEP(e){let t=new n([]);return t=t.addStat(e.fromStat,e.fromAmount),t=t.addStat(e.toStat,e.toAmount),this.computeStatsEP(t)}computeUpgradeEP(e,t,a){const i=`${e.id}-${JSON.stringify(this.epWeights)}-${a}-${e.randomSuffix?.id}-${t}`;if(this.upgradeEPCache.has(i))return this.upgradeEPCache.get(i);const s=e.withUpgrade(t).withDynamicStats().calcStats(a),o=this.computeStatsEP(s);return this.upgradeEPCache.set(i,o),o}computeItemEP(e,t){if(null==e)return 0;const a=`${e.id}-${JSON.stringify(this.epWeights)}-${this.challengeModeEnabled}`,i=this.itemEPCache[t].get(a);if(void 0!==i)return i;const s=new Ir({item:e,challengeMode:this.challengeModeEnabled}).withDynamicStats(),o=s.calcStats(t);let r=0;if(e.randomSuffixOptions.length){const e=s.item.randomSuffixOptions.map(e=>this.computeRandomSuffixEP(this.sim.db.getRandomSuffixById(e)||0));r=Math.max(...e)*s.item.randPropPoints/1e4}let l=0;if(this.getAvailableReforgings(s).length){const e=this.getAvailableReforgings(s).map(e=>this.computeReforgingEP(e));l=Math.max(...e)}let c=o.computeEP(this.epWeights)+r+l;e.unique&&(c-=.01);const h=d(e.gemSockets.map(e=>{const t=this.sim.db.getGems(e).filter(e=>cr(e,this.sim.getPhase()));return t.length>0?Math.max(...t.map(e=>this.computeGemEP(e))):0})),u=d(e.gemSockets.map(e=>{const t=this.sim.db.getGems(e).filter(t=>cr(t,this.sim.getPhase())&&rr(t,e));return t.length>0?Math.max(...t.map(e=>this.computeGemEP(e))):0}))+this.computeStatsEP(new n(e.socketBonus));return c+=Math.max(u,h),this.itemEPCache[t].set(a,c),c}async setWowheadData(e,t){const i=this.hasProfession(a.Blacksmithing),s=e.gems.length?e.curGems(i).map(e=>e?e.id:0):[],o=[e.enchant?.effectId,e.tinker?.effectId].filter(e=>void 0!==e);e.asActionId().setWowheadDataset(t,{gemIds:s,itemLevel:Number(e.ilvl),enchantIds:o,reforgeId:e.reforge?.id,randomEnchantmentId:e.randomSuffix?.id,setPieceIds:this.gear.asArray().filter(e=>null!=e).map(e=>e.item.id),hasExtraSocket:e.hasExtraSocket(i),upgradeStep:e.upgrade}),t.dataset.whtticon="false"}get armorSpecializationArmorType(){return this.playerClass.armorTypes[0]}hasArmorSpecializationBonus(){return[i.ItemSlotHead,i.ItemSlotShoulder,i.ItemSlotChest,i.ItemSlotWrist,i.ItemSlotHands,i.ItemSlotWaist,i.ItemSlotLegs,i.ItemSlotFeet].some(e=>{const t=this.getEquippedItem(e)?.item;if(!t)return!1;return t.armorType!==this.armorSpecializationArmorType})}hasEotBPItemEquipped(){return[i.ItemSlotMainHand,i.ItemSlotOffHand].some(e=>{const t=this.getEquippedItem(e)?.item;return t&&(kr(t)||_r(t))})}filterItemData(t,a,s){const o=this.sim.getFilters(),n=(e,t)=>e.filter(e=>t(a(e)));0!=o.minIlvl&&(t=n(t,e=>(e.scalingOptions?.[x.Base].ilvl||e.ilvl)>=o.minIlvl)),0!=o.maxIlvl&&(t=n(t,e=>(e.scalingOptions?.[x.Base].ilvl||e.ilvl)<=o.maxIlvl)),o.factionRestriction!=mt.UNSPECIFIED&&(t=n(t,e=>e.factionRestriction==o.factionRestriction||e.factionRestriction==mt.UNSPECIFIED)),o.sources.includes(Ln.SourceSoldBy)||(t=n(t,e=>!e.sources.some(e=>"soldBy"==e.source.oneofKind))),o.sources.includes(Ln.SourceCrafting)||(t=n(t,e=>!e.sources.some(e=>"crafted"==e.source.oneofKind))),o.sources.includes(Ln.SourceQuest)||(t=n(t,e=>!e.sources.some(e=>"quest"==e.source.oneofKind))),o.sources.includes(Ln.SourceReputation)||(t=n(t,e=>!e.sources.some(e=>"rep"==e.source.oneofKind))),o.sources.includes(Ln.SourcePvp)||(t=n(t,e=>!qn(e)));for(const[i,r]of Object.entries(e.DIFFICULTY_SRCS)){const a=parseInt(i);if(!o.sources.includes(a)&&(t=n(t,e=>!e.sources.some(e=>"drop"==e.source.oneofKind&&e.source.drop.difficulty==r)),r==X.DifficultyRaid10H||r==X.DifficultyRaid25H)){const a=e.HEROIC_TO_NORMAL[r];t=n(t,e=>!e.sources.some(e=>"drop"==e.source.oneofKind&&e.source.drop.difficulty==a&&e.source.drop.category==or))}}for(const[i,r]of Object.entries(e.RAID_IDS)){const e=parseInt(i);o.raids.includes(e)||(t=n(t,e=>!e.sources.some(e=>"drop"==e.source.oneofKind&&e.source.drop.zoneId==r)))}return e.ARMOR_SLOTS.includes(s)?t=n(t,e=>!!o.armorTypes.includes(e.armorType)):e.WEAPON_SLOTS.includes(s)&&(t=n(t,e=>{if(e.handType==h.HandTypeUnknown&&e.rangedWeaponType==E.RangedWeaponTypeUnknown)return!1;if(!o.weaponTypes.includes(e.weaponType)&&e.handType>h.HandTypeUnknown)return!1;if(!o.oneHandedWeapons&&e.handType!=h.HandTypeTwoHand)return!1;if(!o.twoHandedWeapons&&e.handType==h.HandTypeTwoHand)return!1;if(!o.rangedWeaponTypes.includes(e.rangedWeaponType)&&e.rangedWeaponType>E.RangedWeaponTypeUnknown)return!1;let t=s==i.ItemSlotMainHand?o.minMhWeaponSpeed:o.minOhWeaponSpeed,a=s==i.ItemSlotMainHand?o.maxMhWeaponSpeed:o.maxOhWeaponSpeed;return e.rangedWeaponType>0&&(t=o.minRangedWeaponSpeed,a=o.maxRangedWeaponSpeed),!(t>0&&e.weaponSpeed<t)&&!(a>0&&e.weaponSpeed>a)})),t}filterEnchantData(e,t,a,i){return i?e.filter(e=>{const a=t(e);return!!C(a,i.item)}):e}filterGemData(e,t,i,s){const o=this.sim.getFilters(),n=this.hasProfession(a.Jewelcrafting);return e.filter(e=>{const i=t(e);if(!n&&i.requiredProfession==a.Jewelcrafting)return!1;if(o.matchingGemsOnly&&!rr(i,s))return!1;const r=this.specConfig.gemStats??this.specConfig.epStats,l=i.stats.map((e,t)=>e>0?t:-1).filter(e=>e>=0);return!!l.length&&!l.some(e=>!r.includes(e))})}makeUnitReference(){return null==this.party?Bo():ar(this.getRaidIndex())}toDatabase(){const e=this.getGear().toDatabase(this.sim.db),t=this.itemSwapSettings.getGear().toDatabase(this.sim.db);return Ar.mergeSimDatabases(e,t)}toProto(e,t,a){const i=e=>!a||0==a.length||a.includes(e),s=this.getGear(),o=t?this.getResolvedAplRotation(t):po(this.aplRotation,["uuid"]);let n=pn.create({class:this.getClass(),database:e?void 0:this.toDatabase()});return i(ff.Gear)&&pn.mergePartial(n,{equipment:s.asSpec(),bonusStats:this.getBonusStats().toProto(),enableItemSwap:this.itemSwapSettings.getEnableItemSwap(),itemSwap:this.itemSwapSettings.toProto()}),i(ff.Talents)&&pn.mergePartial(n,{talentsString:this.getTalentsString(),glyphs:this.getGlyphs()}),i(ff.Rotation)&&pn.mergePartial(n,{cooldowns:zn.create({hpPercentForDefensives:this.getSimpleCooldowns().hpPercentForDefensives}),rotation:o}),i(ff.Consumes)&&pn.mergePartial(n,{consumables:this.getConsumes()}),i(ff.Miscellaneous)&&(pn.mergePartial(n,{name:this.getName(),race:this.getRace(),profession1:this.getProfession1(),profession2:this.getProfession2(),reactionTimeMs:this.getReactionTime(),channelClipDelayMs:this.getChannelClipDelay(),inFrontOfTarget:this.getInFrontOfTarget(),distanceFromTarget:this.getDistanceFromTarget(),healingModel:this.getHealingModel(),challengeMode:this.getChallengeModeEnabled()}),n=ir(this.getSpec(),n,this.getSpecOptions())),i(ff.External)&&pn.mergePartial(n,{buffs:this.getBuffs()}),n}fromProto(t,a,i){te.freezeAllAndDo(()=>{e.updateProtoVersion(a);const s=e=>!i||0==i.length||i.includes(e);t=te.nextEventID(),s(ff.Gear)&&(this.setGear(t,a.equipment?this.sim.db.lookupEquipmentSpec(a.equipment):new yr({})),this.itemSwapSettings.setItemSwapSettings(t,a.enableItemSwap,a.itemSwap?this.sim.db.lookupItemSwap(a.itemSwap):new wr({}),n.fromProto(a.itemSwap?.prepullBonusStats)),this.setBonusStats(t,n.fromProto(a.bonusStats||ha.create()))),s(ff.Talents)&&(this.setTalentsString(t,a.talentsString),this.setGlyphs(t,a.glyphs||Vt.create())),s(ff.Rotation)&&(a.rotation?.type==uo.TypeUnknown&&(a.rotation||(a.rotation=fo.create()),a.rotation.type=uo.TypeAuto),this.setAplRotation(t,a.rotation||fo.create())),s(ff.Consumes)&&this.setConsumes(t,a.consumables||Go.create()),s(ff.Miscellaneous)&&(this.setSpecOptions(t,this.specTypeFunctions.optionsFromPlayer(a)),this.setName(t,a.name),this.setRace(t,a.race),this.setProfession1(t,a.profession1),this.setProfession2(t,a.profession2),this.setReactionTime(t,a.reactionTimeMs),this.setChannelClipDelay(t,a.channelClipDelayMs),this.setInFrontOfTarget(t,a.inFrontOfTarget),this.setDistanceFromTarget(t,a.distanceFromTarget),this.setHealingModel(t,a.healingModel||Fo.create()),this.setChallengeModeEnabled(t,a.challengeMode)),s(ff.External)&&this.setBuffs(t,a.buffs||Oo.create())})}clone(t){const a=new e(this.playerSpec,this.sim);return a.fromProto(t,this.toProto()),a}applySharedDefaults(e){te.freezeAllAndDo(()=>{this.setReactionTime(e,100),this.setInFrontOfTarget(e,this.playerSpec.isTankSpec),this.setHealingModel(e,Fo.create({burstWindow:this.playerSpec.isTankSpec?6:0})),this.setSimpleCooldowns(e,zn.create({hpPercentForDefensives:this.playerSpec.isTankSpec?.4:0})),this.setBonusStats(e,new n)})}getBaseMastery(){return 8}getMasteryPerPointModifier(){return sr.get(this.getSpec())||0}static updateProtoVersion(e){e.apiVersion}getSpecConfig(){return this.specConfig}getActiveRacialExpertiseBonuses(){const e=this.getEquippedItem(i.ItemSlotMainHand),t=this.getEquippedItem(i.ItemSlotOffHand);if(!e&&!t)return[!1,!1];switch(this.getRace()){case Y.RaceDwarf:return[e?.item.weaponType===A.WeaponTypeMace||e?.item.rangedWeaponType===E.RangedWeaponTypeBow||e?.item.rangedWeaponType===E.RangedWeaponTypeCrossbow||e?.item.rangedWeaponType===E.RangedWeaponTypeGun,t?.item.weaponType===A.WeaponTypeMace];case Y.RaceGnome:return[e?.item.weaponType===A.WeaponTypeDagger||e?.item.handType!==h.HandTypeTwoHand&&e?.item.weaponType===A.WeaponTypeSword,t?.item.weaponType===A.WeaponTypeDagger||t?.item.handType!==h.HandTypeTwoHand&&t?.item.weaponType===A.WeaponTypeSword];case Y.RaceHuman:return[e?.item.weaponType===A.WeaponTypeMace||e?.item.weaponType===A.WeaponTypeSword,t?.item.weaponType===A.WeaponTypeMace||t?.item.weaponType===A.WeaponTypeSword];case Y.RaceOrc:return[e?.item.weaponType===A.WeaponTypeAxe||e?.item.weaponType===A.WeaponTypeFist,t?.item.weaponType===A.WeaponTypeAxe||t?.item.weaponType===A.WeaponTypeFist];case Y.RaceTroll:return[e?.item.rangedWeaponType===E.RangedWeaponTypeBow||e?.item.rangedWeaponType===E.RangedWeaponTypeCrossbow||e?.item.rangedWeaponType===E.RangedWeaponTypeGun,!1]}return[!1,!1]}};Ek.numEpRatios=6,Ek.ARMOR_SLOTS=[i.ItemSlotHead,i.ItemSlotShoulder,i.ItemSlotChest,i.ItemSlotWrist,i.ItemSlotHands,i.ItemSlotLegs,i.ItemSlotWaist,i.ItemSlotFeet],Ek.WEAPON_SLOTS=[i.ItemSlotMainHand,i.ItemSlotOffHand],Ek.DIFFICULTY_SRCS={[Ln.SourceDungeon]:X.DifficultyNormal,[Ln.SourceDungeonH]:X.DifficultyHeroic,[Ln.SourceRaidRF]:X.DifficultyRaid25RF,[Ln.SourceRaid]:X.DifficultyRaid25,[Ln.SourceRaidH]:X.DifficultyRaid25H,[Ln.SourceRaidFlex]:X.DifficultyRaidFlex},Ek.HEROIC_TO_NORMAL={[X.DifficultyHeroic]:X.DifficultyNormal,[X.DifficultyRaid10H]:X.DifficultyRaid10,[X.DifficultyRaid25H]:X.DifficultyRaid25},Ek.RAID_IDS={[oa.RaidMogushanVaults]:6125,[oa.RaidHeartOfFear]:6297,[oa.RaidTerraceOfEndlessSpring]:6067,[oa.RaidThroneOfThunder]:6622,[oa.RaidSiegeOfOrgrimmar]:6738};let Tk=Ek;const Ak=(e,t,a)=>{const i=s.fromJson(t);return Pk(e,i,a||{})},Pk=(e,t,a)=>{const i=[];return void 0!==a.faction&&i.push(e=>e.getFaction()==a.faction),void 0!==a.customCondition&&i.push(a.customCondition),{name:e,tooltip:a.tooltip||oe.t("sim.basic_bis_disclaimer"),gear:t,enableWhen:i.length?e=>i.every(t=>t(e)):void 0,onLoad:a?.onLoad}},Rk=(e,t,a)=>Dk(e,t,a||{}),Dk=(e,t,a)=>{const i=[];return void 0!==a?.customCondition&&i.push(a.customCondition),{name:e,epWeights:t,enableWhen:i.length?e=>i.every(t=>t(e)):void 0,onLoad:a?.onLoad}},Mk=(e,t,a)=>{const i=mo.create({rotation:fo.fromJson(t)});return Nk(e,i,a)},Lk=(e,t,a,i)=>{const s=t==K.SpecBloodDeathKnight||t==K.SpecGuardianDruid||t==K.SpecProtectionPaladin||t==K.SpecProtectionWarrior,o=mo.create({rotation:{type:uo.TypeSimple,simple:{specRotationJson:JSON.stringify(Wt[t].rotationToJson(a)),cooldowns:zn.create({hpPercentForDefensives:s?.4:0})}}});return Nk(e,o,i)},Nk=(e,t,a)=>{const i=[];return null!=a?.talents&&i.push(e=>(a.talents||[]).join("")===e.getTalentTreePoints().join("")),{name:e,rotation:t,enableWhen:i.length?e=>i.every(t=>t(e)):void 0,onLoad:a?.onLoad}},Ok=(e,t,a,i,s,o)=>({name:e,encounter:t,targetDummies:s,tanks:i,healingModel:a,...o}),Gk=(e,t)=>{const a=zo.fromJson(t);return zk(e,a)},zk=(e,t)=>({name:e,itemSwap:t}),Fk=(e,t)=>({name:e,...t}),Hk=(e,t,a,{settings:i,...s}={},o)=>{const r=nt.fromJson(a),l={};r.player&&(r.player.equipment&&(l.gear=Ak(e,r.player.equipment,o)),(r.player?.talentsString||r.player?.glyphs)&&(l.talents=((e,t)=>{const a=[];return{name:e,data:t,enableWhen:a.length>0?e=>a.every(t=>t(e)):void 0}})(e,Uo.create({talentsString:r.player?.talentsString,glyphs:r.player?.glyphs}))),r.player?.rotation&&r.player?.rotation.type!==uo.TypeAuto&&(l.rotation=Nk(e,mo.create({rotation:r.player.rotation}),o))),r.encounter&&(l.encounter=Ok(e,r.encounter,r.player?.healingModel,r.tanks,r.targetDummies,o));const c=((e,t,a)=>{const i={name:e};return a.player?.race&&(i.race=a.player.race),a.player&&(i.specOptions=Wt[t].optionsFromPlayer(a.player),a.player.buffs&&(i.buffs=a.player.buffs),a.player.consumables&&(i.consumables=a.player.consumables),i.playerOptions={reactionTimeMs:a.player.reactionTimeMs,channelClipDelayMs:a.player.channelClipDelayMs,inFrontOfTarget:a.player.inFrontOfTarget,distanceFromTarget:a.player.distanceFromTarget,enableItemSwap:a.player.enableItemSwap},a.player.profession1&&(i.playerOptions.profession1=a.player.profession1),a.player.profession2&&(i.playerOptions.profession2=a.player.profession2),a.player.itemSwap&&(i.playerOptions.itemSwap=a.player.itemSwap)),a.raidBuffs&&(i.raidBuffs=a.raidBuffs),a.partyBuffs&&(i.partyBuffs=a.partyBuffs),a.debuffs&&(i.debuffs=a.debuffs),i})(e,t,r);return(Object.keys(c).length>1||i)&&(l.settings={...c,...i}),r.epWeightsStats&&(l.epWeights=Dk(e,n.fromProto(r.epWeightsStats),o)),Fk(e,{...l,...s})},Uk=(e,t,a)=>{const i=e.map(({condition:e,message:a})=>e(t)&&a).filter(e=>!!e);i.length&&new Dg({variant:"warning",body:H(de,null,i.map(e=>H("p",null,e))),delay:5e3*i.length,...a})};export{mx as $,Lr as A,Wr as B,T_ as C,sg as D,Av as E,A_ as F,P_ as G,E_ as H,yf as I,R_ as J,__ as K,NS as L,j_ as M,rx as N,Fk as O,Tk as P,Uk as Q,Gg as R,ik as S,C_ as T,Jv as U,S_ as V,PS as W,KS as X,XS as Y,sx as Z,Ok as _,yS as a,gx as a0,RS as a1,yx as a2,dx as a3,Kv as a4,gc as a5,ix as a6,rl as a7,MS as a8,AS as a9,LS as aa,TS as ab,GS as ac,FS as ad,zS as ae,WS as af,HS as ag,BS as ah,JS as ai,DS as aj,Og as ak,Lk as al,ox as am,lx as an,Qv as ao,$S as ap,ZS as aq,Ag as b,W_ as c,xr as d,Bg as e,Pg as f,Ik as g,nl as h,fx as i,wS as j,bx as k,nk as l,Jm as m,vv as n,Ak as o,Kr as p,Gk as q,qr as r,Mk as s,Rk as t,Hk as u,lk as v,hk as w,k_ as x,v_ as y,I_ as z};
